{"tx_hash": "GSzWuGXBRMCPN64Sm9SFDk9KNZAPCEQ7bwCk7L4R4Grv", "action_id_social": "8LpPw8Nxz5bo5UJPhE88R5oMY1eVDaF6mmh3Ro3xSzu6-0-widget", "block_id": 98881025, "block_timestamp": "2023-08-15T18:58:05.997Z", "signer_id": "kudos.ndctools.near", "widget_name": "NDC.Kudos.AddKudo", "source_code": "const { onHide, kind } = props;\n\nconst kudosContract = \"kudos.ndctools.near\";\nconst socialContract = \"social.near\";\nconst widgets = {\n  styledComponents: \"nomination.ndctools.near/widget/NDC.StyledComponents\",\n};\n\nconst Modal = styled.div`\n  position: fixed;\n  display: flex;\n  z-index: 1;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.7);\n`;\n\nconst ComponentWrapper = styled.div`\n  position: absolute;\n  width: 100%;\n  z-index: 100;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n`;\n\nconst ModalContent = styled.div`\n  background: #f8f8f9;\n  margin: 20% auto;\n  padding: 20px;\n  border-radius: 10px;\n  width: 50%;\n\n  @media (max-width: 768px) {\n    width: 90%;\n  }\n\n  .content {\n    margin: 18px 0;\n\n    h6 {\n      margin-bottom: -10px;\n    }\n  }\n`;\n\nconst InputField = styled.div`\n  margin: 20px 0;\n`;\n\nconst Section = styled.div`\n  margin: 12px 0;\n`;\n\nconst handleAddKudo = () => {\n  const mentions = state.message.match(/@[\\w][^\\s]*/g);\n  const mentionData =\n    mentions.length > 0\n      ? mentions.map((user) => {\n          return {\n            key: user.slice(1),\n            value: { type: \"mention\" },\n          };\n        })\n      : {};\n\n  let data = [\n    {\n      contractName: kudosContract,\n      methodName: \"give_kudos\",\n      args: {\n        receiver_id: state.receiverId,\n        message: state.message,\n        icon_cid: state.img.cid,\n        kind,\n        hashtags: state.tags,\n      },\n      gas: \"70000000000000\",\n      deposit: 100000000000000000000000,\n    },\n    // {\n    //   contractName: socialContract,\n    //   methodName: \"set\",\n    //   args: {\n    //     data: {\n    //       index: {\n    //         notify: JSON.stringify({\n    //           key: state.receiverId,\n    //           value: { type: \"kudo_created\" },\n    //         }),\n    //       },\n    //     },\n    //   },\n    // },\n  ];\n\n  // if (mentionData.length > 0)\n  //   data.push({\n  //     contractName: socialContract,\n  //     methodName: \"set\",\n  //     args: {\n  //       data: {\n  //         index: {\n  //           notify: JSON.stringify(mentionData),\n  //         },\n  //       },\n  //     },\n  //   });\n\n  Near.call(data).then((data) => {\n    onHide();\n  });\n};\n\nState.init({\n  receiverId: \"\",\n  message: \"\",\n  img: null,\n  tags: \"\",\n});\n\nreturn (\n  <Modal>\n    <ComponentWrapper>\n      <ModalContent>\n        <h4>Give a {kind === \"k\" ? \"Kudo\" : \"Ding\"}</h4>\n        <div className=\"content\">\n          <Section>\n            <Widget\n              src={\"rubycop.near/widget/Common.Compose\"}\n              props={{\n                type: \"input\",\n                placeholder: \"NEAR account\",\n                withoutSeparator: true,\n                handleChange: (text) => State.update({ receiverId: text }),\n              }}\n            />\n          </Section>\n          <Section>\n            <Widget\n              src={\"rubycop.near/widget/Common.Compose\"}\n              props={{\n                placeholder: \"Left a comment\",\n                handleChange: (text) => {\n                  if (text.length > 1000) return;\n                  State.update({ message: text });\n                },\n              }}\n            />\n          </Section>\n          <Section>\n            <div className=\"h-25\">\n              <IpfsImageUpload image={state.img} />\n            </div>\n          </Section>\n          <Section>\n            <Widget\n              src={\"sayalot.near/widget/TagsEditor\"}\n              props={{\n                label: \"Tags\",\n                placeholder: \"Enter tags\",\n                setTagsObject: (tags) =>\n                  State.update({ tags: Object.keys(tags) }),\n              }}\n            />\n          </Section>\n        </div>\n        <div className=\"d-grid gap-3 d-flex align-items-center justify-content-end\">\n          <Widget\n            src={widgets.styledComponents}\n            props={{\n              Button: {\n                text: \"Cancel\",\n                className: \"secondary dark\",\n                onClick: onHide,\n              },\n            }}\n          />\n          <Widget\n            src={widgets.styledComponents}\n            props={{\n              Button: {\n                text: \"Submit\",\n                onClick: handleAddKudo,\n              },\n            }}\n          />\n        </div>\n      </ModalContent>\n    </ComponentWrapper>\n  </Modal>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/kudos.ndctools.near/widget/NDC.Kudos.AddKudo", "fact_widget_deployments_id": "8c5603c1fbbd7b28377261423320dd36", "inserted_timestamp": "2023-08-15T20:43:50.875Z", "modified_timestamp": "2023-08-15T20:43:50.875Z", "__row_index": 0}
{"tx_hash": "FptFmsjAmzkVGfDPtAh7KZtwnVtyDsVTc9ANa7T3gSH8", "action_id_social": "HFeNbKmFLxTicVKd5kX5emKN5354eWQrrLTHGF4bUDx2-0-widget", "block_id": 98292807, "block_timestamp": "2023-08-07T18:53:45.397Z", "signer_id": "kudos.ndctools.near", "widget_name": "NDC.Kudos.AddComment", "source_code": "const { onHide, kudo, comment } = props;\n\nconst kudosContract = \"kudos.ndctools.near\";\nconst widgets = {\n  styledComponents: \"nomination.ndctools.near/widget/NDC.StyledComponents\",\n};\n\nState.init({\n  receiverId: \"\",\n  message: \"\",\n  imageCid: \"\",\n  tags: \"\",\n});\n\nconst Modal = styled.div`\n  position: fixed;\n  display: flex;\n  z-index: 1;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.7);\n`;\n\nconst ComponentWrapper = styled.div`\n  position: absolute;\n  width: 100%;\n  z-index: 100;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n`;\n\nconst ModalContent = styled.div`\n  background: #f8f8f9;\n  margin: 20% auto;\n  padding: 20px;\n  border-radius: 10px;\n  width: 50%;\n\n  @media (max-width: 768px) {\n    width: 90%;\n  }\n\n  .content {\n    margin: 18px 0;\n\n    h6 {\n      margin-bottom: -10px;\n    }\n  }\n`;\n\nconst InputField = styled.div`\n  margin: 20px 0;\n`;\n\nconst Section = styled.div`\n  margin: 12px 0;\n`;\n\nconst StyledLink = styled.a`\n  color: inherit !important;\n  width: 100px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 16px;\n  margin-left: 5px;\n`;\n\nconst CreatedAt = styled.div`\n  font-size: 12px;\n  font-style: italic;\n  font-weight: 300;\n\n  b {\n    font-weight: 500;\n  }\n`;\n\nconst Description = styled.div`\n  max-height: 100px;\n  white-space: pre-line;\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-weight: 400;\n  font-size: 14px;\n`;\n\nconst handleAddComment = () => {\n  Near.call(\n    kudosContract,\n    \"leave_comment\",\n    {\n      parent_comment_id: comment.id,\n      receiver_id: kudo.receiver_id,\n      kudos_id: kudo.id,\n      message: state.message.slice(0, 1000),\n    },\n    \"300000000000000\",\n    \"17000000000000000000000\"\n  ).then((_data) => onHide());\n};\n\nconst UserLink = ({ title, src }) => (\n  <StyledLink href={src}>{title}</StyledLink>\n);\n\nconst getDateAgo = () => {\n  const now = new Date().getTime();\n  const current = new Date(parseInt(comment.created_at)).getTime();\n\n  const diff = now - current;\n  let days = Math.floor(diff / (1000 * 60 * 60 * 24));\n  let hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n  let minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n  let seconds = Math.floor((diff % (1000 * 60)) / 1000);\n\n  if (days > 0) return `${days} days ago`;\n  if (hours > 0) return `${hours} hours ago`;\n  if (minutes > 0) return `${minutes} minutes ago`;\n  if (seconds > 0) return `${seconds} seconds ago`;\n\n  return \"\";\n};\n\nreturn (\n  <Modal>\n    <ComponentWrapper>\n      <ModalContent>\n        <h4>Comment to Reply</h4>\n        <div className=\"content\">\n          <div className=\"d-flex justify-content-between align-items-center\">\n            <div>\n              <Widget\n                src=\"mob.near/widget/ProfileImage\"\n                props={{\n                  accountId: comment.owner_id,\n                  imageClassName: \"rounded-circle w-100 h-100\",\n                  style: { width: \"32px\", height: \"32px\", marginRight: 5 },\n                }}\n              />\n              <UserLink\n                src={`https://near.org/near/widget/ProfilePage?accountId=${comment.owner_id}`}\n                title={comment.owner_id}\n              />\n            </div>\n            <CreatedAt>\n              <i className=\"bi bi-clock\" />\n              {getDateAgo()}\n            </CreatedAt>\n          </div>\n          <Description className=\"text-secondary\">\n            {comment.message}\n          </Description>\n          <hr className=\"text-secondary\" />\n          <Widget\n            src={widgets.styledComponents}\n            props={{\n              TextArea: {\n                label: \"Reply\",\n                value: state.message,\n                maxLength: 1000,\n                placeholder: \"Left a comment\",\n                handleChange: (e) => {\n                  const text = e.target.value;\n                  if (text.length > 1000) return;\n\n                  State.update({ message: text });\n                },\n              },\n            }}\n          />\n        </div>\n        <div className=\"d-grid gap-3 d-flex align-items-center justify-content-end\">\n          <Widget\n            src={widgets.styledComponents}\n            props={{\n              Button: {\n                text: \"Cancel\",\n                className: \"secondary dark\",\n                onClick: onHide,\n              },\n            }}\n          />\n          <Widget\n            src={widgets.styledComponents}\n            props={{\n              Button: {\n                text: \"Submit\",\n                onClick: handleAddComment,\n              },\n            }}\n          />\n        </div>\n      </ModalContent>\n    </ComponentWrapper>\n  </Modal>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/kudos.ndctools.near/widget/NDC.Kudos.AddComment", "fact_widget_deployments_id": "c6f5d45a7a41a73295b20a01007c3ca8", "inserted_timestamp": "2023-08-07T20:17:33.946Z", "modified_timestamp": "2023-08-07T20:17:33.946Z", "__row_index": 9}
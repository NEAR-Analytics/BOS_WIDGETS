{"tx_hash": "xPVEdfKcrN4bx57mJxi4rg4SPymFrXA6wh9Sua3VaeH", "action_id_social": "9X8tGe34FhUSt3iftwferFqhYAd488RuFfshJ2wjerRj-0-widget", "block_id": 97696228, "block_timestamp": "2023-07-30T15:58:23.386Z", "signer_id": "agruzdev.near", "widget_name": "CompTree.View.ComponentCard", "source_code": "const DEFAULT_OPEN = false;\n\nconst [accountId, widget, widgetName] = props.src.split('/');\nconst metadata = Social.get(\n  `${accountId}/widget/${widgetName}/metadata/**`,\n  'final'\n);\n\nconst tags = Object.keys(metadata.tags || {});\nconst detailsUrl = `#/near/widget/ComponentDetailsPage?src=${accountId}/widget/${widgetName}`;\nconst appUrl = `#/${accountId}/widget/${widgetName}`;\nconst accountUrl = `#/near/widget/ProfilePage?accountId=${accountId}`;\n\nfunction distinct(arr) {\n  return [...new Set(arr)];\n}\n\nconst filterDeps = (widget) => {\n  const pattern = /<Widget\\s+src=(?:{['\"]([^'\"}]+)['\"]}|['\"]([^'\"}]+)['\"])/g;\n\n  let matches = [];\n  let match;\n  while ((match = pattern.exec(widget.toString())) !== null) {\n    const srcValue = match[1] || match[2];\n    matches.push(srcValue);\n  }\n\n  return distinct(matches);\n};\n\nconst updateDeps = () => {\n  setLoading(true);\n  const widget = Social.get(props.src);\n\n  if (!widget) return;\n\n  setDeps(filterDeps(widget));\n  setLoading(false);\n};\n\nconst deps = state.deps;\nconst setDeps = (value) => {\n  State.update({ deps: value });\n};\n\nconst loading = state.loading;\nconst setLoading = (value) => {\n  State.update({ loading: value });\n};\n\nconst isShown = state.isShown;\nconst toggleShown = () => {\n  State.update((prev) => {\n    return {\n      isShown: !prev.isShown,\n    };\n  });\n};\n\nState.init({ deps: null, isShown: DEFAULT_OPEN, loading: false });\n\nupdateDeps();\n\nconst Card = styled.div`\n  position: relative;\n  width: 100%;\n  border-radius: 12px;\n  background: #fff;\n  border: 1px solid #eceef0;\n  box-shadow: 0px 1px 3px rgba(16, 24, 40, 0.1),\n    0px 1px 2px rgba(16, 24, 40, 0.06);\n  overflow: hidden;\n`;\n\nconst CardBody = styled.div`\n  padding: 16px;\n  display: flex;\n  gap: 16px;\n  align-items: center;\n\n  > * {\n    min-width: 0;\n  }\n`;\n\nconst CardContent = styled.div`\n  width: 100%;\n`;\n\nconst CardFooter = styled.div`\n  display: grid;\n  grid-template-columns: ${state.deps && state.deps.length === 0\n    ? '1fr'\n    : '1fr 1fr 1fr'};\n  gap: 16px;\n  padding: 16px;\n  border-top: 1px solid #eceef0;\n`;\n\nconst CardTag = styled.p`\n  margin: 0;\n  font-size: 9px;\n  line-height: 14px;\n  background: #eceef0;\n  color: #687076;\n  font-weight: 400;\n  white-space: nowrap;\n  position: absolute;\n  top: 0;\n  right: 0;\n  border-bottom-left-radius: 3px;\n  padding: 0 4px;\n\n  i {\n    margin-right: 3px;\n  }\n`;\n\nconst TextLink = styled.a`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 18px;\n  color: ${(p) => (p.bold ? '#11181C !important' : '#687076 !important')};\n  font-weight: ${(p) => (p.bold ? '600' : '400')};\n  font-size: ${(p) => (p.small ? '12px' : '14px')};\n  overflow: ${(p) => (p.ellipsis ? 'hidden' : 'visible')};\n  text-overflow: ${(p) => (p.ellipsis ? 'ellipsis' : 'unset')};\n  white-space: nowrap;\n  outline: none;\n\n  &:focus,\n  &:hover {\n    text-decoration: underline;\n  }\n`;\n\nconst Text = styled.p`\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  color: ${(p) => (p.bold ? '#11181C' : '#687076')};\n  font-weight: ${(p) => (p.bold ? '600' : '400')};\n  font-size: ${(p) => (p.small ? '12px' : '14px')};\n  overflow: ${(p) => (p.ellipsis ? 'hidden' : '')};\n  text-overflow: ${(p) => (p.ellipsis ? 'ellipsis' : '')};\n  white-space: nowrap;\n\n  i {\n    margin-right: 3px;\n  }\n`;\n\nconst Thumbnail = styled.a`\n  display: block;\n  width: 60px;\n  height: 60px;\n  flex-shrink: 0;\n  border: 1px solid #eceef0;\n  border-radius: 8px;\n  overflow: hidden;\n  outline: none;\n  transition: border-color 200ms;\n\n  &:focus,\n  &:hover {\n    border-color: #d0d5dd;\n  }\n\n  img {\n    object-fit: cover;\n    width: 100%;\n    height: 100%;\n  }\n`;\n\nconst TagsWrapper = styled.div`\n  position: relative;\n  margin-top: 4px;\n`;\n\nconst ButtonLink = styled.a`\n  padding: 8px;\n  height: 32px;\n  border: 1px solid #d7dbdf;\n  border-radius: 100px;\n  font-weight: 600;\n  font-size: 12px;\n  line-height: 15px;\n  text-align: center;\n  cursor: pointer;\n  color: ${(p) => (p.primary ? '#006ADC' : '#11181C')} !important;\n  background: #fbfcfd;\n  white-space: nowrap;\n\n  &:hover,\n  &:focus {\n    background: #ecedee;\n    text-decoration: none;\n    outline: none;\n  }\n`;\n\nconst DepsContainer = styled.div`\n  display: flex;\n  justify-content: space-between;\n  width: 80%;\n  flex-direction: column;\n`;\n\nconst Dep = styled.div`\n  margin-top: 10px;\n  margin-left: 20%;\n`;\n\nreturn (\n  <>\n    {!loading ? (\n      <>\n        <Card>\n          {\n            <CardTag>\n              <i className=\"bi bi-clock\"></i>{' '}\n              <Widget\n                src=\"mob.near/widget/TimeAgo\"\n                props={{\n                  blockHeight: props.blockHeight,\n                  keyPath: `${accountId}/widget/${widgetName}`,\n                }}\n              />{' '}\n              ago\n            </CardTag>\n          }\n\n          <CardBody>\n            <Thumbnail href={detailsUrl}>\n              <Widget\n                src=\"mob.near/widget/Image\"\n                props={{\n                  image: metadata.image,\n                  fallbackUrl:\n                    'https://ipfs.near.social/ipfs/bafkreifc4burlk35hxom3klq4mysmslfirj7slueenbj7ddwg7pc6ixomu',\n                  alt: metadata.name,\n                }}\n              />\n            </Thumbnail>\n\n            <CardContent>\n              <TextLink as=\"a\" href={detailsUrl} bold ellipsis>\n                {metadata.name || widgetName}\n              </TextLink>\n\n              <TextLink small as=\"a\" href={accountUrl} ellipsis>\n                @{accountId}\n              </TextLink>\n\n              {tags.length > 0 && (\n                <TagsWrapper>\n                  <Widget\n                    src=\"near/widget/Tags\"\n                    props={{\n                      tags,\n                      scroll: true,\n                    }}\n                  />\n                </TagsWrapper>\n              )}\n            </CardContent>\n          </CardBody>\n\n          <CardFooter>\n            <ButtonLink href={detailsUrl}>View Details</ButtonLink>\n            {deps && deps.length !== 0 ? (\n              <>\n                <ButtonLink onClick={toggleShown}>\n                  {isShown ? 'Close' : 'Show'}\n                </ButtonLink>\n                <ButtonLink\n                  target={'_blank'}\n                  href={`#/agruzdev.near/widget/CompTree.View.ComponentCard?src=${props.src}&reset=true`}\n                  primary\n                >\n                  Root\n                </ButtonLink>\n              </>\n            ) : null}\n          </CardFooter>\n        </Card>\n        {isShown && deps && deps.length !== 0 ? (\n          <DepsContainer>\n            {deps.map((dep) => (\n              <Dep>\n                <Widget\n                  src={'agruzdev.near/widget/CompTree.View.ComponentCard'}\n                  props={{ src: dep }}\n                />\n              </Dep>\n            ))}\n          </DepsContainer>\n        ) : null}\n      </>\n    ) : (\n      <Widget src={'nui.sking.near/widget/Feedback.Spinner'} />\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/agruzdev.near/widget/CompTree.View.ComponentCard", "fact_widget_deployments_id": "9acc51cf49ca3cd27209a032ee2decf6", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 0}
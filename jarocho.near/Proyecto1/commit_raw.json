{"tx_hash": "33kqFVAeq2pwZ1EBbdT6bLa1CTAKtpjumAjN96WKhKCV", "action_id_social": "7EK6XCvXaVDjLcFSf3oCazKDoq9U6EDfH1npCJp8zWuP-0-widget", "block_id": 106769739, "block_timestamp": "2023-11-29T00:05:37.300Z", "signer_id": "jarocho.near", "widget_name": "Proyecto1", "source_code": "const contract = \"guest-book.near\";\r\nconst total_messages = Near.view(contract, \"totalMessages\", {});\r\nconst messages = Near.view(contract, \"getMessages\", {\r\n  from_index: total - 10,\r\n}).reverse();\r\nconsole.log(messages);\r\n\r\nState.init({\r\n  newMessage: \"\",\r\n});\r\n\r\nconst addNewMessage = () => {\r\n  if (state.newMessage.trim() == \"\") {\r\n    return;\r\n  }\r\n\r\n  Near.call(contract, \"add_message\", {\r\n    text: state.newMessage,\r\n  });\r\n};\r\n\r\nreturn (\r\n  <div class=\"p-3\">\r\n    <h3 class=\"text-center\">Libro de Visitas</h3>\r\n    <br />\r\n    {context.accountId ? (\r\n      <div class=\"border border-black p-3 text-center\">\r\n        <h3>Este texto se mueve de derecha a izquierda</h3>\r\n        <div class=\"row\">\r\n          <div>\r\n            <input\r\n              placeholder=\"Ingresa tu mensaje aqui\"\r\n              onChange={(e) => State.update({ newMessage: e.target.value })}\r\n            />\r\n          </div>\r\n        </div>\r\n        <button\r\n          class=\"btn btn-primary mt-2\"\r\n          onClick={async () => {\r\n            addNewMessage();\r\n          }}\r\n        >\r\n          Guardar\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-dark mt-2\"\r\n          data-bs-toggle=\"modal\"\r\n          data-bs-target=\"#exampleModal\"\r\n        >\r\n          Listado de Mensajes\r\n        </button>\r\n      </div>\r\n    ) : (\r\n      <p class=\"text-center py-2\">\r\n        Debes iniciar sesi\u00f3n para guardar un mensaje\r\n      </p>\r\n    )}\r\n    <br />\r\n    <div\r\n      class=\"modal fade\"\r\n      id=\"exampleModal\"\r\n      tabindex=\"-1\"\r\n      aria-labelledby=\"exampleModalLabel\"\r\n      aria-hidden=\"true\"\r\n    >\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h1 class=\"modal-title fs-5\" id=\"exampleModalLabel\">\r\n              Listado de Mensajes\r\n            </h1>\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn-close\"\r\n              data-bs-dismiss=\"modal\"\r\n              aria-label=\"Close\"\r\n            ></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"border border-black p-4\">\r\n              <h3>Listado de Mensajes</h3>\r\n              <table className=\"table table-sm\">\r\n                <thead>\r\n                  <tr class=\"table-primary text-center\">\r\n                    <th>Cuenta</th>\r\n                    <th>Mensaje</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {messages.map((data, key) => {\r\n                    return (\r\n                      <tr class=\"text-center table-info\">\r\n                        <td>{data.sender}</td>\r\n                        <td>{data.text}</td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-danger\"\r\n              data-bs-dismiss=\"modal\"\r\n            >\r\n              Close\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/jarocho.near/widget/Proyecto1", "fact_widget_deployments_id": "f03e74fc205fd20be631b00ce880878c", "inserted_timestamp": "2023-11-29T02:03:07.475Z", "modified_timestamp": "2023-11-29T02:03:07.475Z", "__row_index": 0}
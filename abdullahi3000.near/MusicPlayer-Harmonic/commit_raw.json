{"tx_hash": "LSSx623UqJZ9C697BFTu8XZ8WFrYFZ4PTV8XqNUTEHq", "action_id_social": "Ffo1zApKkxnUDWS5AK6hXQa8XT8UrYeZnfFaffjG2ZA1-0-widget", "block_id": 116042542, "block_timestamp": "2024-04-03T10:36:12.089Z", "signer_id": "abdullahi3000.near", "widget_name": "MusicPlayer-Harmonic", "source_code": "const accountId = props.accountId || context.accountId;\nconst autoPlay = props.autoPlay || false;\n\nconst data = fetch(\"https://graph.mintbase.xyz\", {\n  method: \"POST\",\n  headers: {\n    \"mb-api-key\": \"omni-site\",\n    \"Content-Type\": \"application/json\",\n    \"x-hasura-role\": \"anonymous\",\n  },\n  body: JSON.stringify({\n    query: `\n     query MyQuery {\n  mb_views_active_listings(\n    order_by: {}\n    where: {nft_contract_id: {_eq: \"daorecords.mintbase1.near\"}}\n    distinct_on: metadata_id\n  ) {\n    listed_by\n    created_at\n    price\n    nft_contract_id\n    token_id\n    metadata_id\n    title\n    reference_blob(path: \"animation_url\")\n  }\n}\n`,\n  }),\n});\n\nconst InnerContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  background: #F8F8F8;\n  border-color: #F5F5F5;\n  border-radius: 0.5rem;\n  //border: 1px solid, // Add a black border\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), // Add a shadow effect;\n\n  @media (max-width: 400px) {\n    /* Set styles for smaller screens */\n    display: flex;\n    flex-direction: column;\n    background: white;\n  }\n`;\n\n//CSS\nconst styles = {\n  container: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    //justifyContent: \"center\",\n    alignItems: \"center\",\n    padding: \"1rem\",\n    borderRadius: \"0.5rem\",\n  },\n  // innerContainer: {\n  //   display: \"flex\",\n  //   flexDirection: \"row\",\n  //   backgroundColor: \"#F8F8F8\",\n  //   borderColor: \"#F5F5F5\",\n  //   borderRadius: \"0.5rem\",\n  //   //border: \"1px solid\", // Add a black border\n  //   boxShadow: \"0 2px 4px rgba(0, 0, 0, 0.1)\", // Add a shadow effect\n  // },\n  playerContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"\",\n    padding: \"1rem\",\n  },\n  buttonContainer: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    marginTop: \"1rem\",\n  },\n  songListContainer: {\n    width: \"24rem\",\n    height: \"24rem\",\n    overflowY: \"auto\",\n    padding: \"1rem\",\n  },\n  heading: {\n    textAlign: \"center\",\n    fontWeight: \"bold\",\n    margin: \"1.5rem\",\n  },\n  song: {\n    cursor: \"pointer\",\n    padding: \"0.5rem\",\n    borderRadius: \"0.5rem\",\n    marginBottom: \"0.5rem\",\n  },\n  selectedSong: {\n    backgroundColor: \"#60A5FA\",\n  },\n};\n\n// Initialize state\nlet songs = data.body.data.mb_views_active_listings.filter(\n  (listing) => listing.reference_blob !== \"https://near.social/null\"\n);\n\nState.init({\n  currentSongIndex: 0,\n  autoPlay: autoPlay,\n});\n\nconst currentSong = songs[state.currentSongIndex].reference_blob;\nconst audioElem = new Audio(currentSong);\n\nfunction playSong() {\n  audioElem.play();\n}\n\nif (state.autoPlay) {\n  playSong();\n}\n\n// Call this when you want to play the current song\nfunction playCurrentSong() {\n  audioElem.play();\n}\n\n// Call this when you want to pause the current song\nfunction pauseCurrentSong() {\n  audioElem.pause();\n}\n\n// Call this when you want to play the next song\nfunction playNextSong() {\n  audioElem.pause();\n  // Update the current song index\n  let nextSongIndex = (state.currentSongIndex + 1) % songs.length;\n  State.update({\n    currentSongIndex: nextSongIndex,\n    autoPlay: true,\n  });\n}\n\n// Call this when you want to play the previous song\nfunction playPreviousSong() {\n  audioElem.pause();\n  // Calculate the previous song index\n  let previousSongIndex =\n    (state.currentSongIndex - 1 + songs.length) % songs.length;\n  State.update({\n    currentSongIndex: previousSongIndex,\n    autoPlay: true,\n  });\n}\n\n// Call this when you want to select a specific song\nfunction selectSong(index) {\n  State.update({\n    currentSongIndex: index,\n  });\n}\nreturn (\n  <div\n    className=\"container py-3\"\n    style={{ height: \"100%\", width: \"100%\", backgroundColor: \"#fff\" }}\n  >\n    <div className=\"row\">\n      <div className=\"col-lg-6\">\n        {/* Widget for displaying the NftImage */}\n        <Widget\n          src=\"mob.near/widget/NftImage\"\n          props={{\n            nft: {\n              tokenId: songs[state.currentSongIndex].token_id,\n              contractId: songs[state.currentSongIndex].nft_contract_id,\n            },\n            style: {\n              width: \"100%\",\n              height: \"auto\",\n              objectFit: \"cover\",\n            },\n            fallbackUrl:\n              \"https://ipfs.near.social/ipfs/bafkreihdiy3ec4epkkx7wc4wevssruen6b7f3oep5ylicnpnyyqzayvcry\",\n          }}\n        />\n        {/* Control buttons */}\n        <div className=\"d-flex justify-content-center my-3\">\n          <button className=\"btn btn-primary mx-2\" onClick={playPreviousSong}>\n            Previous\n          </button>\n          <button className=\"btn btn-secondary mx-2\" onClick={pauseCurrentSong}>\n            Pause\n          </button>\n          <button className=\"btn btn-success mx-2\" onClick={playCurrentSong}>\n            Play\n          </button>\n          <button className=\"btn btn-primary mx-2\" onClick={playNextSong}>\n            Next\n          </button>\n        </div>\n      </div>\n\n      <div className=\"col-lg-6\">\n        {/* Scrollable list of songs */}\n        <div\n          className=\"overflow-auto\"\n          style={{\n            width: \"24rem\",\n            height: \"24rem\",\n            overflowY: \"auto\",\n            padding: \"1rem\",\n          }}\n        >\n          {\" \"}\n          {/* Adjust maxHeight as needed */}\n          <h3 className=\"font-weight-bold text-center my-3\">Songs</h3>\n          {songs.map((song, i) => (\n            <Widget\n              key={i}\n              src=\"efiz.near/widget/MusicPlayer-Harmonic.Track\"\n              props={{\n                selected: state.currentSongIndex === i,\n                selectSong: () => selectSong(i),\n                song,\n                // Make sure this Widget is also styled or accepts Bootstrap classes for responsiveness\n              }}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/abdullahi3000.near/widget/MusicPlayer-Harmonic", "fact_widget_deployments_id": "7029acbc8b789be8df8e027d78947c55", "inserted_timestamp": "2024-04-03T12:46:41.257Z", "modified_timestamp": "2024-04-03T12:46:41.257Z", "__row_index": 2}
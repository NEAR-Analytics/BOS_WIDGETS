{"tx_hash": "6DfPgZZi3jy9uprAV53S5d6R1YJUAn7GiVdRNCZy5z3", "action_id_social": "5ZxsbvLahbJmvCE4wQ5QPbUcLEtLmBQakJ24xuMFfSML-0-widget", "block_id": 105888388, "block_timestamp": "2023-11-17T08:08:17.128Z", "signer_id": "sergiotechx.near", "widget_name": "TipeMe", "source_code": "//Contrato desplegado en aurora testnet\nconst tipMeContract = \"0x57E094946e737694fCdADfdF2f2FfbfC8c6F99e4\";\n\n//Abi del contrato\nconst tipMetAbi = fetch(\n  \"https://raw.githubusercontent.com/Noisk8/Componente-BOS/main/Forwarder_abi.txt\"\n);\n//aproximadamente medio dolar en aurora\nconst donationAmount = ethers.utils.parseEther(\"0.000282233502538071\");\nlet amountToSend = 0;\n\nlet donators = [];\nlet qty = 0;\nState.init({\n  qty, //cantidad de donaciones\n  donators, //arreglo de los ultimas donaciones\n  name: \"\", //nombre del donador\n  message: \"\", //mensaje\n  amountToSend: 0, //equivalente a 1 dolar\n});\n\n//Funci\u00f3n que convierte 1 dolar a eth precio mercado\nconst ethQty = () => {\n  asyncFetch(`https://api.coingecko.com/api/v3/coins/ethereum`)\n    .catch((err) => {\n      console.log(err);\n    })\n    .then((res) => {\n      let data = res.body;\n      let ethPrice = data.tickers[0].last;\n      let qty = 1 / ethPrice;\n\n      let roundedNumber = parseFloat(qty.toFixed(18));\n      State.update({ amountToSend: roundedNumber });\n      amountToSend = roundedNumber;\n    });\n};\n\nconst tipMe = () => {\n  const contract = new ethers.Contract(\n    tipMeContract,\n    tipMetAbi.body,\n    Ethers.provider().getSigner()\n  );\n  //llamado para hacer la donaci\u00f3n\n  const amount = ethers.utils.parseEther(amountToSend.toString());\n  contract\n    .donateCoffee(\n      \"El articulo\",\n      \"0x2929a620D5C1c6246FBCBB68AF7966968CBe9c12\",\n      state.name,\n      state.message,\n      5,\n      {\n        value: amount,\n      }\n    )\n    .then((res) => console.log(res));\n};\n\nconst tipsQty = () => {\n  //llamado para traer cuando donaciones se han realizado\n  const contract = new ethers.Contract(\n    tipMeContract,\n    tipMetAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  contract.getCoffeeQTY().then((res) => {\n    let qtyDonations = parseInt(res, 16);\n    State.update({ qty: qtyDonations });\n  });\n};\n\nconst getDonators = () => {\n  const contract = new ethers.Contract(\n    tipMeContract,\n    tipMetAbi.body,\n    Ethers.provider().getSigner()\n  );\n  //llamado al contrato de las donadiones y formateo de la infomacion\n  contract.getCoffeeLog().then((info) => {\n    donators = [];\n    info.map((data) => {\n      if (data[1] != \"\") {\n        let date = parseInt(data[0], 16);\n\n        const myDate = new Date(date * 1000);\n        donators.push({\n          date: myDate.toLocaleString(),\n          title: data[1],\n          name: data[3],\n          message: data[4],\n          rating: data[5],\n        });\n      }\n    });\n    State.update({ donators: donators });\n  });\n};\n\nethQty();\n// estrellitas\nconst RatingContainer = styled.div`\n  display: flex;\n  flex-direction: row-reverse;\n  gap: 0.3rem;\n  --stroke: #666;\n  --fill: #ffc73a;\n\n  input {\n    appearance: unset;\n    display: none;\n\n  }\n\n  label {\n    cursor: pointer;\n  }\n\n  svg {\n    width: 2rem;\n    height: 2rem;\n    overflow: visible;\n    fill: transparent;\n    stroke: var(--stroke);\n    stroke-linejoin: bevel;\n    stroke-dasharray: 12;\n    animation: idle 4s linear infinite;\n    transition: stroke 0.2s, fill 0.5s;\n  }\n\n  label:hover svg {\n    stroke: var(--fill);\n  }\n\n  input:checked ~ label svg {\n    transition: 0s;\n    animation: idle 4s linear infinite, yippee 0.75s backwards;\n    fill: var(--fill);\n    stroke: var(--fill);\n    stroke-opacity: 0;\n    stroke-dasharray: 0;\n    stroke-linejoin: miter;\n    stroke-width: 8px;\n  }\n\n  @keyframes idle {\n    from {\n      stroke-dashoffset: 24;\n    }\n  }\n\n  @keyframes yippee {\n    0% {\n      transform: scale(1);\n      fill: var(--fill);\n      fill-opacity: 0;\n      stroke-opacity: 1;\n      stroke: var(--stroke);\n      stroke-dasharray: 10;\n      stroke-width: 1px;\n      stroke-linejoin: bevel;\n    }\n\n    30% {\n      transform: scale(0);\n      fill: var(--fill);\n      fill-opacity: 0;\n      stroke-opacity: 1;\n      stroke: var(--stroke);\n      stroke-dasharray: 10;\n      stroke-width: 1px;\n      stroke-linejoin: bevel;\n    }\n\n    30.1% {\n      stroke: var(--fill);\n      stroke-dasharray: 0;\n      stroke-linejoin: miter;\n      stroke-width: 8px;\n    }\n\n    60% {\n      transform: scale(1.2);\n      fill: var(--fill);\n    }\n  }`;\n\nconst giveme = () => {};\nconst Button0018 = styled.button`\n  outline: none;\n  cursor: pointer;\n  border: none;\n  padding: 0.4rem 3rem;\n  margin: 20px ;\n  font-family: inherit;\n  font-size: inherit;\n  position: relative;\n  display: inline-block;\n  letter-spacing: 0.05rem;\n  border-radius: 5px;\n  overflow: hidden;\n  background: #1974D2;\n  color: ghostwhite;\n\n  span {\n    position: relative;\n    z-index: 10;\n    transition: color 0.4s;\n  }\n\n  &:hover span {\n    color: black;\n  }\n\n  &::before,\n  &::after {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 0;\n  }\n\n  &::before {\n    content: \"\";\n    background: #000;\n    width: 120%;\n    left: -10%;\n    transform: skew(30deg);\n    transition: transform 0.4s cubic-bezier(0.3, 1, 0.8, 1);\n  }\n\n  &:hover::before {\n    transform: translate3d(100%, 0, 0);\n  }`;\nconst text = props.text || \"Button0018\";\nconst fontsize = props.fontsize;\nconst fontweight = props.fontweight;\n\nreturn (\n  <>\n    <div className=\"bg-light-subtle\">\n      <div class=\"navbar navbar-expand-lg bg-body-tertiary\">\n        <div class=\"container-fluid\">\n          <button\n            class=\"navbar-toggler\"\n            type=\"button\"\n            data-bs-toggle=\"collapse\"\n            data-bs-target=\"#navbarSupportedContent\"\n            aria-controls=\"navbarSupportedContent\"\n            aria-expanded=\"false\"\n            aria-label=\"Toggle navigation\"\n          >\n            <span class=\"navbar-toggler-icon\"></span>\n          </button>\n          <div\n            class=\"collapse navbar-collapse btn-group \"\n            role=\"group\"\n            id=\"navbarSupportedContent\"\n            aria-label=\"Basic outlined example\"\n          >\n            <ul class=\"navbar-nav me-auto mb-2 mb-lg-0\">\n              <li class=\"nav-item\">\n                <a class=\"nav-link active\" aria-current=\"page\" href=\"#\">\n                  <button type=\"button\" class=\"btn btn-outline-primary\">\n                    Acerca De\n                  </button>\n                </a>\n              </li>\n              <li class=\"nav-item\">\n                <a class=\"nav-link\" href=\"#\">\n                  <button type=\"button\" class=\"btn btn-outline-primary\">\n                    Docomentaci\u00f3n\n                  </button>\n                </a>\n              </li>\n              <li class=\"nav-item dropdown\">\n                <a\n                  class=\"nav-link dropdown-toggle\"\n                  href=\"#\"\n                  role=\"button\"\n                  data-bs-toggle=\"dropdown\"\n                  aria-expanded=\"false\"\n                >\n                  <button type=\"button\" class=\"btn btn-outline-primary\">\n                    Github\n                  </button>\n                </a>\n                <ul class=\"dropdown-menu\">\n                  <li>\n                    <a class=\"dropdown-item\" href=\"#\">\n                      <button type=\"button\" class=\"btn btn-outline-primary\">\n                        Middle\n                      </button>\n                    </a>\n                  </li>\n                  <li>\n                    <a class=\"dropdown-item\" href=\"#\">\n                      <button type=\"button\" class=\"btn btn-outline-primary\">\n                        Left\n                      </button>\n                    </a>\n                  </li>\n\n                  <li>\n                    <a class=\"dropdown-item\" href=\"#\">\n                      <button type=\"button\" class=\"btn btn-outline-primary\">\n                        Middle\n                      </button>\n                    </a>\n                  </li>\n                </ul>\n              </li>\n            </ul>\n            <div class=\"d-flex\">\n              <Web3Connect\n                className=\"ConnectButton \"\n                connectLabel=\"Conetar Billetera\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container text-center mt-5\">\n        <div className=\"d-flex flex-column align-items-center mb-3\">\n          <h1> Tipe Me </h1>\n          <img\n            src=\"https://raw.githubusercontent.com/Noisk8/Componente-BOS/main/img/tipeme.png\"\n            alt=\"Gif\"\n            width=\"200px\"\n            className=\"mb-4\"\n          />\n\n          <div className=\"d-flex justify-content-center align-items-center flex-column bg-light p-3 shadow-lg rounded mb-4\">\n            <div className=\"form-group\">\n              <input\n                className=\"form-control mt-2\"\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                required\n                minLength=\"4\"\n                maxLength=\"8\"\n                size=\"10\"\n                placeholder=\"Nombre del Donante\"\n                onChange={(event) => State.update({ name: event.target.value })}\n              />\n            </div>\n\n            <div className=\"form-group mb-4\">\n              <textarea\n                class=\"form-control mt-4\"\n                placeholder=\"Sugerencias\"\n                aria-label=\"With textarea\"\n                onChange={(event) =>\n                  State.update({ message: event.target.value })\n                }\n              ></textarea>\n            </div>\n            <div class=\"mb-2\">\n              <RatingContainer>\n                <input\n                  type=\"radio\"\n                  id=\"star-1\"\n                  name=\"star-radio\"\n                  value=\"star-1\"\n                />\n                <label for=\"star-1\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                    <path\n                      pathLength=\"360\"\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\n                    ></path>\n                  </svg>\n                </label>\n                <input\n                  type=\"radio\"\n                  id=\"star-2\"\n                  name=\"star-radio\"\n                  value=\"star-1\"\n                />\n                <label for=\"star-2\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                    <path\n                      pathLength=\"360\"\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\n                    ></path>\n                  </svg>\n                </label>\n                <input\n                  type=\"radio\"\n                  id=\"star-3\"\n                  name=\"star-radio\"\n                  value=\"star-1\"\n                />\n                <label for=\"star-3\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                    <path\n                      pathLength=\"360\"\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\n                    ></path>\n                  </svg>\n                </label>\n                <input\n                  type=\"radio\"\n                  id=\"star-4\"\n                  name=\"star-radio\"\n                  value=\"star-1\"\n                />\n                <label for=\"star-4\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                    <path\n                      pathLength=\"360\"\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\n                    ></path>\n                  </svg>\n                </label>\n                <input\n                  type=\"radio\"\n                  id=\"star-5\"\n                  name=\"star-radio\"\n                  value=\"star-1\"\n                />\n                <label for=\"star-5\">\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                    <path\n                      pathLength=\"360\"\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\n                    ></path>\n                  </svg>\n                </label>\n              </RatingContainer>\n\n              <div></div>\n            </div>\n\n            <Button0018\n              fontsize={fontsize}\n              fontweight={fontweight}\n              onClick={tipMe}\n            >\n              <span>Tipe Me </span>\n            </Button0018>\n          </div>\n\n          <h1 className=\"mt-4 mb-4 text-center\"> Ultimas Donaciones</h1>\n\n          <div class=\" bg-light p-3 shadow-lg rounded\">\n            <div class=\"mb-4\">\n              <button onClick={tipsQty}>cantidad donaciones</button>\n            </div>\n            <h2 className=\" mt-2\">cantidad tips: {state.qty}</h2>\n\n            <div class=\"mt-4\">\n              <button onClick={getDonators}>ultimos donantes</button>\n            </div>\n          </div>\n          <div class=\"mt-4\">\n            <table className=\"table table-bordered table-hover table-responsive bg-light p-3 shadow-lg rounded\">\n              <thead className=\"thead-dark\">\n                <tr>\n                  <th scope=\"col\">Fecha</th>\n                  <th scope=\"col\">Articulo</th>\n                  <th scope=\"col\">Donante</th>\n                  <th scope=\"col\">Mensaje</th>\n                  <th scope=\"col\">Rating</th>\n                </tr>\n              </thead>\n              <tbody>\n                {console.log(state.donators)}\n                {state.donators.map((donator) => {\n                  return (\n                    <tr>\n                      <td>{donator.date}</td>\n                      <td>{donator.title}</td>\n                      <td>{donator.name}</td>\n                      <td>{donator.message}</td>\n                      <td>{donator.rating}</td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n        </div>\n        <div class=\"card-footer bg-transparent border-success mb-4 \">\n          Tipe Me 2023\n        </div>\n      </div>\n    </div>\n  </>\n);\n", "metadata": {"platform": "jutsu.ai"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/sergiotechx.near/widget/TipeMe", "fact_widget_deployments_id": "cee7f5476c96e682134cb8b2d1ab9b6b", "inserted_timestamp": "2023-11-17T10:18:42.745Z", "modified_timestamp": "2023-11-17T10:18:42.745Z", "__row_index": 0}
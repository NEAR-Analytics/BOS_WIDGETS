{"tx_hash": "FnhEFsBmbTCZrX2bb81XL6CY5QZAZKreBRvcYhXJHaxt", "action_id_social": "7fcNxVMVJf1iRgwKbQsGD6XZ5BLW39zrU3Xb5fLbwU6Q-0-widget", "block_id": 105916186, "block_timestamp": "2023-11-17T17:21:11.951Z", "signer_id": "sergiotechx.near", "widget_name": "TipMe", "source_code": "//Contrato desplegado en aurora testnet\r\nconst tipMeContract = \"0x57E094946e737694fCdADfdF2f2FfbfC8c6F99e4\";\r\n\r\n//Abi del contrato\r\nconst tipMetAbi = fetch(\r\n  \"https://raw.githubusercontent.com/Noisk8/Componente-BOS/main/Forwarder_abi.txt\"\r\n);\r\n//aproximadamente medio dolar en aurora\r\nconst donationAmount = ethers.utils.parseEther(\"0.000282233502538071\");\r\nlet amountToSend = 0;\r\n\r\nlet donators = [];\r\nlet qty = 0;\r\nState.init({\r\n  qty, //cantidad de donaciones\r\n  donators, //arreglo de los ultimas donaciones\r\n  name: \"\", //nombre del donador\r\n  message: \"\", //mensaje\r\n  amountToSend: 0, //equivalente a 1 dolar\r\n});\r\n\r\n//Funci\u00f3n que convierte 1 dolar a eth precio mercado\r\nconst ethQty = () => {\r\n  asyncFetch(`https://api.coingecko.com/api/v3/coins/ethereum`)\r\n    .catch((err) => {\r\n      console.log(err);\r\n    })\r\n    .then((res) => {\r\n      let data = res.body;\r\n      let ethPrice = data.tickers[0].last;\r\n      let qty = 1 / ethPrice;\r\n\r\n      let roundedNumber = parseFloat(qty.toFixed(18));\r\n      State.update({ amountToSend: roundedNumber });\r\n      amountToSend = roundedNumber;\r\n    });\r\n};\r\n\r\nconst tipMe = () => {\r\n  const contract = new ethers.Contract(\r\n    tipMeContract,\r\n    tipMetAbi.body,\r\n    Ethers.provider().getSigner()\r\n  );\r\n  //llamado para hacer la donaci\u00f3n\r\n  const amount = ethers.utils.parseEther(amountToSend.toString());\r\n  contract\r\n    .donateCoffee(\r\n      \"El articulo\",\r\n      \"0x2929a620D5C1c6246FBCBB68AF7966968CBe9c12\",\r\n      state.name,\r\n      state.message,\r\n      5,\r\n      {\r\n        value: amount,\r\n      }\r\n    )\r\n    .then((res) => console.log(res));\r\n};\r\n\r\nconst tipsQty = () => {\r\n  //llamado para traer cuando donaciones se han realizado\r\n  const contract = new ethers.Contract(\r\n    tipMeContract,\r\n    tipMetAbi.body,\r\n    Ethers.provider().getSigner()\r\n  );\r\n\r\n  contract.getCoffeeQTY().then((res) => {\r\n    let qtyDonations = parseInt(res, 16);\r\n    State.update({ qty: qtyDonations });\r\n  });\r\n};\r\n\r\nconst getDonators = () => {\r\n  const contract = new ethers.Contract(\r\n    tipMeContract,\r\n    tipMetAbi.body,\r\n    Ethers.provider().getSigner()\r\n  );\r\n  //llamado al contrato de las donadiones y formateo de la infomacion\r\n  contract.getCoffeeLog().then((info) => {\r\n    donators = [];\r\n    info.map((data) => {\r\n      if (data[1] != \"\") {\r\n        let date = parseInt(data[0], 16);\r\n\r\n        const myDate = new Date(date * 1000);\r\n        donators.push({\r\n          date: myDate.toLocaleString(),\r\n          title: data[1],\r\n          name: data[3],\r\n          message: data[4],\r\n          rating: data[5],\r\n        });\r\n      }\r\n    });\r\n    State.update({ donators: donators });\r\n  });\r\n};\r\n\r\nethQty();\r\n// estrellitas\r\nconst RatingContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: row-reverse;\r\n  gap: 0.3rem;\r\n  --stroke: #666;\r\n  --fill: #ffc73a;\r\n\r\n  input {\r\n    appearance: unset;\r\n    display: none;\r\n\r\n  }\r\n\r\n  label {\r\n    cursor: pointer;\r\n  }\r\n\r\n  svg {\r\n    width: 2rem;\r\n    height: 2rem;\r\n    overflow: visible;\r\n    fill: transparent;\r\n    stroke: var(--stroke);\r\n    stroke-linejoin: bevel;\r\n    stroke-dasharray: 12;\r\n    animation: idle 4s linear infinite;\r\n    transition: stroke 0.2s, fill 0.5s;\r\n  }\r\n\r\n  label:hover svg {\r\n    stroke: var(--fill);\r\n  }\r\n\r\n  input:checked ~ label svg {\r\n    transition: 0s;\r\n    animation: idle 4s linear infinite, yippee 0.75s backwards;\r\n    fill: var(--fill);\r\n    stroke: var(--fill);\r\n    stroke-opacity: 0;\r\n    stroke-dasharray: 0;\r\n    stroke-linejoin: miter;\r\n    stroke-width: 8px;\r\n  }\r\n\r\n  @keyframes idle {\r\n    from {\r\n      stroke-dashoffset: 24;\r\n    }\r\n  }\r\n\r\n  @keyframes yippee {\r\n    0% {\r\n      transform: scale(1);\r\n      fill: var(--fill);\r\n      fill-opacity: 0;\r\n      stroke-opacity: 1;\r\n      stroke: var(--stroke);\r\n      stroke-dasharray: 10;\r\n      stroke-width: 1px;\r\n      stroke-linejoin: bevel;\r\n    }\r\n\r\n    30% {\r\n      transform: scale(0);\r\n      fill: var(--fill);\r\n      fill-opacity: 0;\r\n      stroke-opacity: 1;\r\n      stroke: var(--stroke);\r\n      stroke-dasharray: 10;\r\n      stroke-width: 1px;\r\n      stroke-linejoin: bevel;\r\n    }\r\n\r\n    30.1% {\r\n      stroke: var(--fill);\r\n      stroke-dasharray: 0;\r\n      stroke-linejoin: miter;\r\n      stroke-width: 8px;\r\n    }\r\n\r\n    60% {\r\n      transform: scale(1.2);\r\n      fill: var(--fill);\r\n    }\r\n  }`;\r\n\r\nconst giveme = () => {};\r\nconst Button0018 = styled.button`\r\n  outline: none;\r\n  cursor: pointer;\r\n  border: none;\r\n  padding: 0.4rem 3rem;\r\n  margin: 20px ;\r\n  font-family: inherit;\r\n  font-size: inherit;\r\n  position: relative;\r\n  display: inline-block;\r\n  letter-spacing: 0.05rem;\r\n  border-radius: 5px;\r\n  overflow: hidden;\r\n  background: #1974D2;\r\n  color: ghostwhite;\r\n\r\n  span {\r\n    position: relative;\r\n    z-index: 10;\r\n    transition: color 0.4s;\r\n  }\r\n\r\n  &:hover span {\r\n    color: black;\r\n  }\r\n\r\n  &::before,\r\n  &::after {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    z-index: 0;\r\n  }\r\n\r\n  &::before {\r\n    content: \"\";\r\n    background: #000;\r\n    width: 120%;\r\n    left: -10%;\r\n    transform: skew(30deg);\r\n    transition: transform 0.4s cubic-bezier(0.3, 1, 0.8, 1);\r\n  }\r\n\r\n  &:hover::before {\r\n    transform: translate3d(100%, 0, 0);\r\n  }`;\r\nconst text = props.text || \"Button0018\";\r\nconst fontsize = props.fontsize;\r\nconst fontweight = props.fontweight;\r\n\r\nreturn (\r\n  <>\r\n    <div className=\"bg-light-subtle\">\r\n      <div class=\"navbar navbar-expand-lg bg-body-tertiary\">\r\n        <div class=\"container-fluid\">\r\n          <button\r\n            class=\"navbar-toggler\"\r\n            type=\"button\"\r\n            data-bs-toggle=\"collapse\"\r\n            data-bs-target=\"#navbarSupportedContent\"\r\n            aria-controls=\"navbarSupportedContent\"\r\n            aria-expanded=\"false\"\r\n            aria-label=\"Toggle navigation\"\r\n          >\r\n            <span class=\"navbar-toggler-icon\"></span>\r\n          </button>\r\n          <div\r\n            class=\"collapse navbar-collapse btn-group \"\r\n            role=\"group\"\r\n            id=\"navbarSupportedContent\"\r\n            aria-label=\"Basic outlined example\"\r\n          >\r\n            <ul class=\"navbar-nav me-auto mb-2 mb-lg-0\">\r\n              <li class=\"nav-item\">\r\n                <a class=\"nav-link active\" aria-current=\"page\" href=\"#\">\r\n                  <button type=\"button\" class=\"btn btn-outline-primary\">\r\n                    Acerca De\r\n                  </button>\r\n                </a>\r\n              </li>\r\n              <li class=\"nav-item\">\r\n                <a class=\"nav-link\" href=\"#\">\r\n                  <button type=\"button\" class=\"btn btn-outline-primary\">\r\n                    Docomentaci\u00f3n\r\n                  </button>\r\n                </a>\r\n              </li>\r\n              <li class=\"nav-item dropdown\">\r\n                <a\r\n                  class=\"nav-link dropdown-toggle\"\r\n                  href=\"#\"\r\n                  role=\"button\"\r\n                  data-bs-toggle=\"dropdown\"\r\n                  aria-expanded=\"false\"\r\n                >\r\n                  <button type=\"button\" class=\"btn btn-outline-primary\">\r\n                    Github\r\n                  </button>\r\n                </a>\r\n                <ul class=\"dropdown-menu\">\r\n                  <li>\r\n                    <a class=\"dropdown-item\" href=\"#\">\r\n                      <button type=\"button\" class=\"btn btn-outline-primary\">\r\n                        Middle\r\n                      </button>\r\n                    </a>\r\n                  </li>\r\n                  <li>\r\n                    <a class=\"dropdown-item\" href=\"#\">\r\n                      <button type=\"button\" class=\"btn btn-outline-primary\">\r\n                        Left\r\n                      </button>\r\n                    </a>\r\n                  </li>\r\n\r\n                  <li>\r\n                    <a class=\"dropdown-item\" href=\"#\">\r\n                      <button type=\"button\" class=\"btn btn-outline-primary\">\r\n                        Middle\r\n                      </button>\r\n                    </a>\r\n                  </li>\r\n                </ul>\r\n              </li>\r\n            </ul>\r\n            <div class=\"d-flex\">\r\n              <Web3Connect\r\n                className=\"ConnectButton \"\r\n                connectLabel=\"Conectar Billetera\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"container text-center mt-5\">\r\n        <div className=\"d-flex flex-column align-items-center mb-3\">\r\n          <h1> Tipe Me </h1>\r\n          <img\r\n            src=\"https://raw.githubusercontent.com/Noisk8/Componente-BOS/main/img/tipeme.png\"\r\n            alt=\"Gif\"\r\n            width=\"200px\"\r\n            className=\"mb-4\"\r\n          />\r\n\r\n          <div className=\"d-flex justify-content-center align-items-center flex-column bg-light p-3 shadow-lg rounded mb-4\">\r\n            <div className=\"form-group\">\r\n              <input\r\n                className=\"form-control mt-2\"\r\n                type=\"text\"\r\n                id=\"name\"\r\n                name=\"name\"\r\n                required\r\n                minLength=\"4\"\r\n                maxLength=\"8\"\r\n                size=\"10\"\r\n                placeholder=\"Nombre del Donante\"\r\n                onChange={(event) => State.update({ name: event.target.value })}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group mb-4\">\r\n              <textarea\r\n                class=\"form-control mt-4\"\r\n                placeholder=\"Sugerencias\"\r\n                aria-label=\"With textarea\"\r\n                onChange={(event) =>\r\n                  State.update({ message: event.target.value })\r\n                }\r\n              ></textarea>\r\n            </div>\r\n            <div class=\"mb-2\">\r\n              <RatingContainer>\r\n                <input\r\n                  type=\"radio\"\r\n                  id=\"star-1\"\r\n                  name=\"star-radio\"\r\n                  value=\"star-1\"\r\n                />\r\n                <label for=\"star-1\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\r\n                    <path\r\n                      pathLength=\"360\"\r\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\r\n                    ></path>\r\n                  </svg>\r\n                </label>\r\n                <input\r\n                  type=\"radio\"\r\n                  id=\"star-2\"\r\n                  name=\"star-radio\"\r\n                  value=\"star-1\"\r\n                />\r\n                <label for=\"star-2\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\r\n                    <path\r\n                      pathLength=\"360\"\r\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\r\n                    ></path>\r\n                  </svg>\r\n                </label>\r\n                <input\r\n                  type=\"radio\"\r\n                  id=\"star-3\"\r\n                  name=\"star-radio\"\r\n                  value=\"star-1\"\r\n                />\r\n                <label for=\"star-3\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\r\n                    <path\r\n                      pathLength=\"360\"\r\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\r\n                    ></path>\r\n                  </svg>\r\n                </label>\r\n                <input\r\n                  type=\"radio\"\r\n                  id=\"star-4\"\r\n                  name=\"star-radio\"\r\n                  value=\"star-1\"\r\n                />\r\n                <label for=\"star-4\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\r\n                    <path\r\n                      pathLength=\"360\"\r\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\r\n                    ></path>\r\n                  </svg>\r\n                </label>\r\n                <input\r\n                  type=\"radio\"\r\n                  id=\"star-5\"\r\n                  name=\"star-radio\"\r\n                  value=\"star-1\"\r\n                />\r\n                <label for=\"star-5\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\r\n                    <path\r\n                      pathLength=\"360\"\r\n                      d=\"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z\"\r\n                    ></path>\r\n                  </svg>\r\n                </label>\r\n              </RatingContainer>\r\n\r\n              <div></div>\r\n            </div>\r\n\r\n            <Button0018\r\n              fontsize={fontsize}\r\n              fontweight={fontweight}\r\n              onClick={tipMe}\r\n            >\r\n              <span>Tipe Me </span>\r\n            </Button0018>\r\n          </div>\r\n\r\n          <h1 className=\"mt-4 mb-4 text-center\"> Ultimas Donaciones</h1>\r\n\r\n          <div class=\" bg-light p-3 shadow-lg rounded\">\r\n            <div class=\"mb-4\">\r\n              <button onClick={tipsQty}>cantidad donaciones</button>\r\n            </div>\r\n            <h2 className=\" mt-2\">cantidad tips: {state.qty}</h2>\r\n\r\n            <div class=\"mt-4\">\r\n              <button onClick={getDonators}>ultimos donantes</button>\r\n            </div>\r\n          </div>\r\n          <div class=\"mt-4\">\r\n            <table className=\"table table-bordered table-hover table-responsive bg-light p-3 shadow-lg rounded\">\r\n              <thead className=\"thead-dark\">\r\n                <tr>\r\n                  <th scope=\"col\">Fecha</th>\r\n                  <th scope=\"col\">Articulo</th>\r\n                  <th scope=\"col\">Donante</th>\r\n                  <th scope=\"col\">Mensaje</th>\r\n                  <th scope=\"col\">Rating</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {console.log(state.donators)}\r\n                {state.donators.map((donator) => {\r\n                  return (\r\n                    <tr>\r\n                      <td>{donator.date}</td>\r\n                      <td>{donator.title}</td>\r\n                      <td>{donator.name}</td>\r\n                      <td>{donator.message}</td>\r\n                      <td>{donator.rating}</td>\r\n                    </tr>\r\n                  );\r\n                })}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div class=\"card-footer bg-transparent border-success mb-4 \">\r\n          Tipe Me 2023\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sergiotechx.near/widget/TipMe", "fact_widget_deployments_id": "1a04d15c4eae7530ad9d9afc1720dedb", "inserted_timestamp": "2023-11-17T19:24:48.701Z", "modified_timestamp": "2023-11-17T19:24:48.701Z", "__row_index": 0}
{"tx_hash": "5r2GPeEGSruZiNToYbfKMhtkqQAaeoEKq7THdSy5qkTx", "action_id_social": "CzcmhKJULQ6YRyRoJ2M4S6czcJFd92W7zokJ6UTnsTpJ-0-widget", "block_id": 113445532, "block_timestamp": "2024-02-23T22:02:27.073Z", "signer_id": "valecreativo.near", "widget_name": "ElOraculo", "source_code": "const contract = \"guest-book.near\";\n\nconst total_messages = Near.view(contract, \"total_messages\");\n\nconst messages = Near.view(contract, \"get_messages\", {\n  from_index: total_messages - 10,\n}).reverse();\n\nState.init({\n  new_message: \"\",\n  author: null,\n  quote: null,\n  img: null,\n});\n\nconst fetchQuote = () => {\n  asyncFetch(\"https://stoic.tekloon.net/stoic-quote\", {\n    method: \"GET\",\n    headers: {\n      accept: \"application/json\",\n      \"content-type\": \"application/json\",\n    },\n  })\n    .then(({ body }) => {\n      console.log(body);\n      State.update({ author: body.author, quote: body.quote });\n    })\n    .catch((err) => console.log(err));\n};\n\nasyncFetch(\"https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY\")\n  .then(({ body }) => {\n    console.log(body);\n    State.update({ img: body.url });\n  })\n  .catch((err) => console.log(err));\n\nconst handleGuestBookEntry = async () => {\n  const newMessage = State.get(\"new_message\").text; // Extraer el texto del mensaje\n\n  console.log(\"Valor del nuevo mensaje:\", newMessage);\n\n  if (!newMessage) {\n    console.log(\"El mensaje no debe estar vac\u00edo\");\n    return;\n  }\n\n  try {\n    await Near.call(contract, \"add_message\", {\n      text: newMessage,\n    });\n\n    console.log(\"Mensaje a\u00f1adido con \u00e9xito al libro de visitas\");\n  } catch (error) {\n    console.error(\"Error al agregar el mensaje al libro de visitas:\", error);\n  }\n\n  // Limpiar el campo de entrada despu\u00e9s de agregar el mensaje\n  State.update({ new_message: { text: \"\" } });\n};\n\nconst shareOnTwitter = () => {\n  const textToShare = `\u00a1El or\u00e1culo dice: \"${state.quote}\" - ${\n    state.author || \"Autor Desconocido\"\n  }!`;\n  const twitterShareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(\n    textToShare\n  )}`;\n\n  window.open(twitterShareUrl, \"_blank\");\n};\n\nconst Main = styled.div`\n  width: 100%;\n  height: 750px;\n  background: linear-gradient(135deg, #003d96, #01762F);\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  border: 6px solid #01762F;\n  border-radius: 20px;\n`;\n\nconst Header = styled.div`\n  width: 100%;\n  height: 40px;\n  background: linear-gradient(135deg, #032049, #7323b4);\n  border-top-left-radius: 20px;\n  border-top-right-radius: 20px;\n  box-shadow: 15px 20px 30px -10px #7323b4;\n  color: #FFFFFF;\n`;\n\nconst InputContainer = styled.div`\n  margin-top: 20px;\n`;\n\nconst ButtonContainer = styled.div`\n  margin-top: 15px;\n`;\n\nconst QuoteContainer = styled.div`\n  margin-top: 10px;\n  color: #FFFFFF;\n  text-align: center;\n`;\n\nconst GuestBookSection = styled.div`\n  margin-top: 40px;\n  width: 80%;\n  background: linear-gradient(135deg, #003d96, #01762F);\n  border-radius: 10px;\n  padding: 10px;\n  color: #FFFFFF;\n`;\n\nconst GuestBookInput = styled.input`\n  margin-bottom: 10px;\n  width: 100%;\n  padding: 8px;\n  background-color: #FFFFFF;\n  border: 2px solid #01762F;\n  border-radius: 5px;\n`;\n\nconst GuestBookButton = styled.button`\n  width: 100%;\n  padding: 8px;\n  background-color: #01762F;\n  color: #FFFFFF;\n  cursor: pointer;\n  border: none;\n  border-radius: 5px;\n  transition: background-color 0.3s ease;\n\n  &:hover {\n    background-color: #014019;\n  }\n`;\n\nreturn (\n  <Main>\n    <Header style={{ textAlign: \"center\", marginTop: \"2px\" }}>\n      <h4>\u00bfQu\u00e9 mensaje tiene el or\u00e1culo para ti hoy?</h4>\n    </Header>\n\n    <InputContainer>\n      <input\n        type=\"text\"\n        placeholder=\"\u00bfQu\u00e9 pregunta quieres hacer?\"\n        className=\"form-control\"\n        style={{ height: \"100px\", width: \"250px\" }}\n      />\n    </InputContainer>\n\n    <ButtonContainer>\n      <button\n        className=\"btn btn-success mb-2\"\n        onClick={fetchQuote}\n        style={{ fontSize: \"16px\" }}\n      >\n        Respuesta del universo\n      </button>\n    </ButtonContainer>\n\n    {state.img != null && (\n      <div style={{ marginTop: \"7px\", marginBottom: \"1px\" }}>\n        <img\n          src={state.img}\n          alt=\"NASA\"\n          style={{ width: \"100%\", height: \"140px\" }}\n        />\n      </div>\n    )}\n\n    {state.quote != null && (\n      <QuoteContainer style={{ marginTop: \"10px\" }}>\n        <p>{state.quote}</p>\n      </QuoteContainer>\n    )}\n\n    <GuestBookSection>\n      <h4>\u00a1Comparte tu frase!</h4>\n      <GuestBookInput\n        type=\"text\"\n        placeholder=\"\u00a1Regala un mensaje positivo! \"\n        className=\"form-control\"\n        value={State.get(\"new_message\").text}\n        onChange={(e) =>\n          State.update({ new_message: { text: e.target.value } })\n        }\n      />\n\n      <GuestBookButton onClick={handleGuestBookEntry}>\n        Dejar Mensaje\n      </GuestBookButton>\n    </GuestBookSection>\n\n    <ButtonContainer>\n      <button\n        className=\"btn btn-info\"\n        style={{ fontSize: \"14px\", marginTop: \"202px\" }}\n        onClick={shareOnTwitter}\n      >\n        Compartir en Twitter\n      </button>\n    </ButtonContainer>\n  </Main>\n);\n", "metadata": {"description": "Explora la magia del Or\u00e1culo: \u00a1Recibe sabidur\u00eda universal y contribuye con tus mensajes positivos para iluminar el camino de otros!", "fork_of": "valecreativo.near/widget/Untitled-8@113445185", "image": {"ipfs_cid": "bafkreichhtmifiddcls5txdkmjrdvid5vzrw3cku63x3wmm52f4lfjyli4"}, "name": "El Or\u00e1culo", "tags": {"component": "", "dapp": "", "oracle": "", "owa": ""}}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/valecreativo.near/widget/ElOraculo", "fact_widget_deployments_id": "b0d606d32ba8e15935fec3d43a491bbc", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
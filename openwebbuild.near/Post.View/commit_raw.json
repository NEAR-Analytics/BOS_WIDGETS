{"tx_hash": "EnppfQ2LANSLTfRJbEMPsEFRWhz3Cq1M75bUH79gnMnm", "action_id_social": "4ccGPMrW8M1VFw5qJX8NXjbdteQWMzDTNrS24os3kMuo-0-widget", "block_id": 96397936, "block_timestamp": "2023-07-13T19:27:24.461Z", "signer_id": "openwebbuild.near", "widget_name": "Post.View", "source_code": "// config\nfunction getConfig(network) {\n  switch (network) {\n    case \"mainnet\":\n      return {\n        ownerId: \"openwebbuild.near\",\n        discoveryAccountId: \"near\",\n        gatewayDomain: \"near.org\",\n      };\n    case \"testnet\":\n      return {\n        ownerId: \"openwebbuild.testnet\",\n        discoveryAccountId: \"one.testnet\",\n        gatewayDomain: \"test.near.org\",\n      };\n    default:\n      throw Error(`Unconfigured environment '${network}'.`);\n  }\n}\nconst config = getConfig(context.networkId);\n\nconst accountId = props.accountId;\nconst blockHeight =\n  props.blockHeight === \"now\" ? \"now\" : parseInt(props.blockHeight);\nconst subscribe = !!props.subscribe;\nconst notifyAccountId = accountId;\nconst postUrl = `https://${config.gatewayDomain}/${config.discoveryAccountId}/widget/PostPage?accountId=${accountId}&blockHeight=${blockHeight}`;\n\nconst content =\n  props.content ??\n  JSON.parse(Social.get(`${accountId}/post/main`, blockHeight) ?? \"null\");\n\nconst item = {\n  type: \"social\",\n  path: `${accountId}/post/main`,\n  blockHeight,\n};\n\nconst Post = styled.div`\n  position: relative;\n\n  &::before {\n    content: \"\";\n    display: block;\n    position: absolute;\n    left: 19px;\n    top: 0px;\n    bottom: 12px;\n    width: 2px;\n    background: #eceef0;\n  }\n`;\n\nconst Header = styled.div`\n  margin-bottom: 0;\n  display: inline-flex;\n`;\n\nconst Body = styled.div`\n  padding-left: 52px;\n  padding-bottom: 1px;\n`;\n\nconst Content = styled.div`\n  img {\n    display: block;\n    max-width: 100%;\n    max-height: 80vh;\n    margin: 0 0 12px;\n  }\n`;\n\nconst Text = styled.p`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 400;\n  color: #687076;\n  white-space: nowrap;\n`;\n\nconst Actions = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: -6px -6px 6px;\n`;\n\nconst Comments = styled.div`\n  > div > div:first-child {\n    padding-top: 12px;\n  }\n`;\n\nreturn (\n  <Post>\n    {props.showAvatar && (\n      <Header>\n        <Widget\n          src={`${config.discoveryAccountId}/widget/AccountProfile`}\n          props={{\n            accountId,\n            hideAccountId: true,\n            inlineContent: (\n              <>\n                <Text as=\"span\">\uff65</Text>\n                <Text>\n                  {blockHeight === \"now\" ? (\n                    \"now\"\n                  ) : (\n                    <>\n                      <Widget\n                        src={`${config.discoveryAccountId}/widget/TimeAgo`}\n                        props={{ blockHeight }}\n                      />{\" \"}\n                      ago\n                    </>\n                  )}\n                </Text>\n              </>\n            ),\n          }}\n        />\n      </Header>\n    )}\n\n    <Body>\n      <Content>\n        {content.text && (\n          <Widget\n            src={`${config.ownerId}/widget/Post.Markdown`}\n            props={{ text: content.text }}\n          />\n        )}\n\n        {content.image && (\n          <Widget\n            src=\"eugenethedream/widget/Image\"\n            props={{\n              image: content.image,\n            }}\n          />\n        )}\n      </Content>\n\n      {blockHeight !== \"now\" && (\n        <Actions>\n          <Widget\n            src={`${config.discoveryAccountId}/widget/LikeButton`}\n            props={{\n              item,\n              notifyAccountId,\n            }}\n          />\n          <Widget\n            src={`${config.discoveryAccountId}/widget/CommentButton`}\n            props={{\n              item,\n              onClick: () => State.update({ showReply: !state.showReply }),\n            }}\n          />\n          <Widget\n            src={`${config.discoveryAccountId}/widget/CopyUrlButton`}\n            props={{\n              url: postUrl,\n            }}\n          />\n        </Actions>\n      )}\n\n      {state.showReply && (\n        <div className=\"mb-2\">\n          <Widget\n            src={`${config.discoveryAccountId}/widget/Comments.Compose`}\n            props={{\n              notifyAccountId,\n              item,\n              onComment: () => State.update({ showReply: false }),\n            }}\n          />\n        </div>\n      )}\n\n      {props.showComments && (\n        <Comments>\n          <Widget\n            src={`${config.discoveryAccountId}/widget/Comments.Feed`}\n            props={{\n              item,\n              highlightComment: props.highlightComment,\n              limit: props.commentsLimit,\n              subscribe,\n              raw,\n            }}\n          />\n        </Comments>\n      )}\n    </Body>\n  </Post>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/openwebbuild.near/widget/Post.View", "fact_widget_deployments_id": "88e2dc0f529461dae23f3d818f4e473a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 9}
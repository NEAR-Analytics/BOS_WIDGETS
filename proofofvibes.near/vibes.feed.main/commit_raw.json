{"tx_hash": "2D9HwWbBvkPZjbfwTh2mTpgCU1kyFxe7AFprH25PFV1H", "action_id_social": "2LLhYizXSe9eycDGcFc2NEuhpiV5K3uS87cWy7F7v11M-0-widget", "block_id": 98578713, "block_timestamp": "2023-08-11T16:55:05.492Z", "signer_id": "proofofvibes.near", "widget_name": "Vibes.Feed.main", "source_code": "// const firstGetLocation = () => {\n//   asyncFetch(\n//     \"https://api.geoapify.com/v1/ipinfo?&apiKey=0485481476634b4d98f7d337d4821f52\"\n//   ).then((data) => {\n//     if (data.body.city.name) {\n//       return data.body.city.name;\n//     }\n//   });\n// };\n// location = firstGetLocation();\nconsole.log(\"Location: \" + location);\nconst hashtag = props.hashtag || \"ProofOfVibes\";\n\n// Vibes Enter lookcation proofofvibes.near/widget/Vibes.Feed.main // add location,\n// need to make chain agnositc\n// make sure shows in hastag\n// need to put automatic location in the hastag\n// Suggested location. use onChange like for nft selector\n\n// State.init({ thisComponent, mention });\n// location enter field\n\nconst findLocation = () => {\n  asyncFetch(\n    \"https://api.geoapify.com/v1/ipinfo?&apiKey=0485481476634b4d98f7d337d4821f52\"\n  ).then((data) => {\n    console.log(\"Location from request: \" + data.body.city.name);\n    // location = data.body.city.name;\n    State.update({\n      location: data.body.city.name,\n      // location: data.body.city.name + \", \" + data.body.country.name,\n    });\n  });\n};\nfindLocation();\nconst location = props.location || state.location;\n\nconsole.log(\"Location after find location: \" + state.location);\n\nconst hashtags = hashtag && hashtag.split(\",\")?.map((it) => it.trim());\nhashtags.push(location);\nconst mention = props.mention || \"\";\nconst mentions = mention && mention.split(\",\")?.map((it) => it.trim());\nconst thisComponent = `https://near.org/proofofvibes.near/widget/Vibes.Feed.main?mention=${state.mention}&location=${state.location}`; // need to onchange to this\n\nState.update({ thisComponent, mention });\nconst onChangeLocation = (location) => {\n  State.update({\n    location,\n  });\n  recalculateComponent();\n};\nconst recalculateComponent = () => {\n  const componentName = `https://near.org/proofofvibes.near/widget/Vibes.Feed.main?mention=${state.mention}&location=${state.location}`;\n  State.update({\n    thisComponent: componentName,\n  });\n};\nconst Card = styled.div`\npadding: 1em;\nborder: 1px solid #e5e8eb;\ngap: 2em;\nmargin: 10px auto;\nborder-radius: .7em;\n`;\nconst Actions = styled.div`\n  display: flex;\n  gap: 6px;\n`;\nconst Input = styled.input`\n  display: block;\n  padding:.5em;\n  width:100%;\n  border: 1px solid #e5e8eb;\n  border-radius: 10px;\n  outline: none;\n  background: #f4f5f6;\n  color: #525c76;\n  :focus{\n    border:1px solid #0d99ff;\n  }\n  ::placeholder {\n    color: palevioletred;\n  }\n`;\nconst FollowButtonWrapper = styled.div`\n  width: 100%;\n  div,\n  button {\n    width: 100%;\n  }\n  @media (max-width: 1200px) {\n    width: auto;\n    div,\n    button {\n      width: auto;\n    }\n  }\n`;\nconst Wrapper = styled.div`\n .bi-search {\n    position: absolute;\n    top: 0;\n    z-index: 100;\n    font-size: 14px;\n    width: 100%;\n    line-height: 40px;\n    color: #687076;\n  }\n\n  .input-group {\n    height: 100%;\n    wdith: 100%;\n  }\n\n  input {\n    padding: 0 14px 0 42px;\n    border: 1px solid #d0d5dd !important;\n    background: #ffffff;\n    border-radius: 100px;\n  }\n    .location-button {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    padding: 8px 16px;\n    height: 32px;\n    border-radius: 100px;\n    font-weight: 600;\n    font-size: 12px;\n    line-height: 15px;\n    text-align: center;\n    cursor: pointer;\n    background: #FBFCFD;\n    border: 1px solid #D7DBDF;\n    color: ${props.primary ? \"#006ADC\" : \"#11181C\"} !important;\n    white-space: nowrap;\n\n    &:hover,\n    &:focus {\n      background: #ECEDEE;\n      text-decoration: none;\n      outline: none;\n    }\n\n    i {\n      display: inline-block;\n\n      color: #7E868C;\n    }\n  }\n  \n`;\n\nreturn (\n  <div>\n    <Card>\n      <div className=\"row\">\n        <div className=\"col-9\">\n          <Input\n            type=\"text\"\n            onChange={(e) => onChangeLocation(e.target.value)}\n            placeholder={\"Current Location: \" + state.location}\n          />\n        </div>\n        <div className=\"col-3\">\n          <Actions>\n            <Wrapper>\n              <a href={state.thisComponent} target=\"_blank\">\n                <button\n                  disabled={context.loading}\n                  onClick={donate}\n                  className=\"location-button\"\n                >\n                  <i className=\"bi-geo-fill\"></i>\n                  Update Location\n                </button>\n              </a>\n            </Wrapper>\n          </Actions>\n        </div>\n      </div>\n    </Card>\n\n    <Widget\n      src=\"efiz.near/widget/every.feed.view\"\n      props={{\n        location: state.location,\n        data: {\n          hashtagWhitelist: hashtags,\n          typeWhitelist: [\"md\"],\n          embedMentions: mentions,\n          postTemplate: \"proofofvibes.near/widget/Vibes.Feed.View.main\",\n          composeTemplate: \"proofofvibes.near/widget/Vibes.Feed.Post.create\",\n        },\n      }}\n    />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/proofofvibes.near/widget/Vibes.Feed.main", "fact_widget_deployments_id": "9f5d4ef4b27f013791e5844f0212cce0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "HfVBdM2BZQmmX65sEspsv8ZMGLK4h7nL9Yn1XGUu99HD", "action_id_social": "8uhAnCGY81ps8tZPRKnRhW4r5iruUnGM3V71g49DdfEt-0-widget", "block_id": 97836821, "block_timestamp": "2023-08-01T11:43:54.167Z", "signer_id": "proofofvibes.near", "widget_name": "Vibes.Feed.main", "source_code": "const location = props.location;\n// const firstGetLocation = () => {\n//   asyncFetch(\n//     \"https://api.geoapify.com/v1/ipinfo?&apiKey=0485481476634b4d98f7d337d4821f52\"\n//   ).then((data) => {\n//     if (data.body.city.name) {\n//       return data.body.city.name;\n//     }\n//   });\n// };\n// location = firstGetLocation();\nconsole.log(\"Location: \" + location);\nconst hashtag = props.hashtag || \"ProofOfVibes\";\n\n// Vibes Enter lookcation proofofvibes.near/widget/Vibes.Feed.main // add location\n\n// make sure shows in hastag\n// need to put automatic location in the hastag\n// Suggested location. use onChange like for nft selector\n\nState.init({ thisComponent, mention });\n// location enter field\n\nconst findLocation = () => {\n  asyncFetch(\n    \"https://api.geoapify.com/v1/ipinfo?&apiKey=0485481476634b4d98f7d337d4821f52\"\n  ).then((data) => {\n    console.log(\"Location from request: \" + data.body.city.name);\n    location = data.body.city.name;\n    State.update({\n      location: data.body.city.name,\n      // location: data.body.city.name + \", \" + data.body.country.name,\n    });\n  });\n};\nfindLocation();\nconsole.log(\"Location after find location: \" + location);\n\nconst hashtags = hashtag && hashtag.split(\",\")?.map((it) => it.trim());\nhashtags.push(state.location);\nconst mention = props.mention || \"\";\nconst mentions = mention && mention.split(\",\")?.map((it) => it.trim());\nconst thisComponent = `https://app.proofofvibes.com/#/proofofvibes.near/widget/Vibes.Feed.main?mention=${state.mention}&location=${state.location}`; // need to onchange to this\n\nState.init({ thisComponent, mention });\nconst onChangeLocation = (location) => {\n  State.update({\n    location,\n  });\n  recalculateComponent();\n};\nconst recalculateComponent = () => {\n  const componentName = `https://app.proofofvibes.com/#/proofofvibes.near/widget/Vibes.Feed.main?mention=${state.mention}&location=${state.location}`;\n  State.update({\n    thisComponent: componentName,\n  });\n};\nconst Card = styled.div`\npadding: 1em;\nborder: 1px solid #e5e8eb;\ngap: 2em;\nmargin: 10px auto;\nborder-radius: .7em;\n`;\nconst Actions = styled.div`\n  display: flex;\n  gap: 6px;\n`;\nconst Input = styled.input`\n  display: block;\n  padding:.5em;\n  width:100%;\n  border: 1px solid #e5e8eb;\n  border-radius: 10px;\n  outline: none;\n  background: #f4f5f6;\n  color: #525c76;\n  :focus{\n    border:1px solid #0d99ff;\n  }\n  ::placeholder {\n    color: palevioletred;\n  }\n`;\nconst FollowButtonWrapper = styled.div`\n  width: 100%;\n  div,\n  button {\n    width: 100%;\n  }\n  @media (max-width: 1200px) {\n    width: auto;\n    div,\n    button {\n      width: auto;\n    }\n  }\n`;\nconst Wrapper = styled.div`\n .bi-search {\n    position: absolute;\n    top: 0;\n    z-index: 100;\n    font-size: 14px;\n    width: 100%;\n    line-height: 40px;\n    color: #687076;\n  }\n\n  .input-group {\n    height: 100%;\n    wdith: 100%;\n  }\n\n  input {\n    padding: 0 14px 0 42px;\n    border: 1px solid #d0d5dd !important;\n    background: #ffffff;\n    border-radius: 100px;\n  }\n    .location-button {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    padding: 8px 16px;\n    height: 32px;\n    border-radius: 100px;\n    font-weight: 600;\n    font-size: 12px;\n    line-height: 15px;\n    text-align: center;\n    cursor: pointer;\n    background: #FBFCFD;\n    border: 1px solid #D7DBDF;\n    color: ${props.primary ? \"#006ADC\" : \"#11181C\"} !important;\n    white-space: nowrap;\n\n    &:hover,\n    &:focus {\n      background: #ECEDEE;\n      text-decoration: none;\n      outline: none;\n    }\n\n    i {\n      display: inline-block;\n\n      color: #7E868C;\n    }\n  }\n  \n`;\n\nreturn (\n  <div>\n    <Card>\n      <div className=\"row\">\n        <div className=\"col-9\">\n          <Input\n            type=\"text\"\n            onChange={(e) => onChangeLocation(e.target.value)}\n            placeholder={\"Current Location: \" + state.location}\n          />\n        </div>\n        <div className=\"col-3\">\n          <Actions>\n            <Wrapper>\n              <a href={state.thisComponent} target=\"_blank\">\n                <button\n                  disabled={context.loading}\n                  onClick={donate}\n                  className=\"location-button\"\n                >\n                  <i className=\"bi-geo-fill\"></i>\n                  Update Location\n                </button>\n              </a>\n            </Wrapper>\n          </Actions>\n        </div>\n      </div>\n    </Card>\n\n    <Widget\n      src=\"efiz.near/widget/every.feed.view\"\n      props={{\n        location: state.location,\n        data: {\n          hashtagWhitelist: hashtags,\n          typeWhitelist: [\"md\"],\n          embedMentions: mentions,\n          postTemplate: \"proofofvibes.near/widget/Vibes.Feed.View.main\",\n          composeTemplate: \"proofofvibes.near/widget/Vibes.Feed.Post.create\",\n        },\n      }}\n    />\n  </div>\n);\n", "metadata": {"platform": "jutsu.ai"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/proofofvibes.near/widget/Vibes.Feed.main", "fact_widget_deployments_id": "a4ce381e9c9814c46ad846ce2c175b51", "inserted_timestamp": "2023-08-01T13:39:00.399Z", "modified_timestamp": "2023-08-01T13:39:00.399Z", "__row_index": 7}
{"tx_hash": "5k2gmzoehaQXFe8n5xHEGYz9mwz667cvb5msD9EhjQn5", "action_id_social": "4xhpcdehhz6rxZeDoh6bcKKmhHZJnFfAVFbgWeEt3ro-0-widget", "block_id": 96917510, "block_timestamp": "2023-07-20T13:34:49.771Z", "signer_id": "proofofvibes.near", "widget_name": "Vibes.Feed.View.main", "source_code": "const path = props.path;\nconst blockHeight =\n  props.blockHeight === \"now\" ? \"now\" : parseInt(props.blockHeight);\nconst subscribe = !!props.subscribe;\nconst parts = path.split(\"/\");\nconst accountId = parts[0];\nconst notifyAccountId = accountId;\nconst issuer = props.issuer ?? \"issuer.proofofvibes.near\";\nconst receiver = props.receiver ?? \"daoshe.near\";\nconst showReciever = props.showReciever ?? true;\nconst showIssuer = props.showIssuer ?? true;\nconst showReference = props.showReference ?? true;\nconst showDAO = props.showDAO ?? true;\nconst showClass = props.showClass ?? true;\nconst showHeader = props.showHeader ?? true;\nconst classId = props.classId ?? 1;\nconst reference = props.reference ?? null;\nconst accountLoggedIn = context.accountId; // use this just in case\nconst postUrl = `https://near.org#/near/widget/PostPage?accountId=${accountId}&blockHeight=${blockHeight}`;\n\nState.init({\n  receiver: receiver,\n  issuer: issuer,\n  reference: reference,\n  daoId: daoId,\n  classId: classId,\n});\nconst post_args = JSON.stringify({\n  receiver: state.receiver,\n  metadata: {\n    class: state.classId,\n  },\n  reference: state.reference,\n});\n\nconst proposal_args = Buffer.from(post_args, \"utf-8\").toString(\"base64\");\n//   const gas = 200000000000000;\n//   const deposit = 80000000000000000000000; // 0.008 //\nconst policy = Near.view(daoId, \"get_policy\");\n\nconst content = props.content ?? JSON.parse(Social.get(path, blockHeight));\nconst type = content.type;\nconst metadata = content.metadata;\n\nconst item = {\n  type: \"social\",\n  path: path,\n  blockHeight,\n};\n\nconst Post = styled.div`\n  position: relative;\n\n  &::before {\n    content: \"\";\n    display: block;\n    position: absolute;\n    left: 19px;\n    top: 52px;\n    bottom: 12px;\n    width: 2px;\n    background: #eceef0;\n  }\n`;\n\nconst Header = styled.div`\n  margin-bottom: 0;\n  display: inline-flex;\n`;\n\nconst Body = styled.div`\n  padding-left: 52px;\n  padding-bottom: 1px;\n`;\n\nconst Content = styled.div`\n  img {\n    display: block;\n    max-width: 100%;\n    max-height: 80vh;\n    margin: 0 0 12px;\n  }\n`;\n\nconst Text = styled.p`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 400;\n  color: #687076;\n  white-space: nowrap;\n`;\n\nconst Actions = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: -6px -6px 6px;\n`;\n\nfunction renderContent() {\n  if (type === \"md\" || type === \"social\") {\n    return (\n      <>\n        {content.text && (\n          <Widget\n            src=\"near/widget/SocialMarkdown\"\n            props={{ text: content.text }}\n          />\n        )}\n\n        {content.image && (\n          <Widget\n            src=\"mob.near/widget/Image\"\n            props={{\n              image: content.image,\n            }}\n          />\n        )}\n      </>\n    );\n  }\n}\n\nconst daoId = props.daoId ?? \"vibes.sputnik-dao.near\";\nconst role = props.role ?? \"vibee\";\n\nif (!accountId) {\n  return \"Please connect your NEAR wallet :)\";\n}\n\n// need to check role if tastemaker\n\nconst proposeVibee = () => {\n  const gas = 200000000000000;\n  const deposit = 100000000000000000000000;\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"Recommended as a vibee\",\n          kind: {\n            AddMemberToRole: {\n              member_id: accountId,\n              role: role,\n            },\n          },\n        },\n      },\n      gas: gas,\n      deposit: deposit,\n    },\n  ]);\n};\n\n// change this\nconst sbtMint = () => {\n  Near.call([\n    {\n      contractName: state.daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"create proposal to mint SBT\",\n          kind: {\n            FunctionCall: {\n              receiver_id: state.issuer,\n              actions: [\n                {\n                  method_name: \"sbt_mint\",\n                  args: proposal_args,\n                  deposit: \"80000000000000000000000\",\n                  gas: \"200000000000000\",\n                },\n              ],\n            },\n          },\n        },\n      },\n      deposit: deposit,\n      gas: \"219000000000000\",\n    },\n  ]);\n};\n\nreturn (\n  <div className=\"border-bottom pt-3 pb-1\">\n    <div>\n      <div className=\"d-flex flex-row align-items-center\">\n        <div className=\"flex-grow-1 text-truncate\">\n          <a\n            className=\"text-dark text-decoration-none text-truncate\"\n            href={`#/mob.near/widget/ProfilePage?accountId=${accountId}`}\n          >\n            <Widget\n              src=\"mob.near/widget/Profile.ShortInlineBlock\"\n              props={{ accountId, tooltip: true }}\n            />\n          </a>\n        </div>\n\n        <span className=\"text-nowrap text-muted\">\n          <Widget\n            src=\"efiz.near/widget/SBT.Badge\"\n            props={{ accountId: accountId }}\n          />\n          <small>\n            {blockHeight === \"now\" ? (\n              \"now\"\n            ) : (\n              <a className=\"text-muted\" href={link}>\n                <Widget src=\"mob.near/widget/TimeAgo\" props={{ blockHeight }} />\n              </a>\n            )}\n          </small>\n          {true && blockHeight !== \"now\" && (\n            <div>\n              <span>\n                <a\n                  href=\"javascript:void\"\n                  className=\"link-secondary ms-2\"\n                  data-bs-toggle=\"dropdown\"\n                  aria-expanded=\"false\"\n                >\n                  <i className=\"fs-6 bi bi-three-dots\" />\n                </a>\n                <ul className=\"dropdown-menu\">\n                  <li className=\"dropdown-item\">\n                    <a\n                      className=\"link-dark text-decoration-none\"\n                      onClick={proposeVibee}\n                    >\n                      <i className=\"bi bi-emoji-sunglasses\" /> Recommend as\n                      Vibee\n                    </a>\n                  </li>\n                </ul>\n              </span>\n              <span>\n                <a\n                  href=\"javascript:void\"\n                  className=\"link-secondary ms-2\"\n                  data-bs-toggle=\"dropdown\"\n                  aria-expanded=\"false\"\n                >\n                  <i className=\"fs-6 bi bi-three-dots\" />\n                </a>\n                <ul className=\"dropdown-menu\">\n                  <li className=\"dropdown-item\">\n                    <a\n                      className=\"link-dark text-decoration-none\"\n                      onClick={sbtMint}\n                    >\n                      <i className=\"bi bi-shield-lock\" /> Propose to Mint Proof\n                      of Vibe SBT\n                    </a>\n                  </li>\n                </ul>\n              </span>\n            </div>\n          )}\n        </span>\n      </div>\n    </div>\n    <div className=\"mt-3 text-break\">\n      <Widget\n        src=\"mob.near/widget/MainPage.Post.Content\"\n        props={{ content, raw }}\n      />\n    </div>\n    {blockHeight !== \"now\" && (\n      <div className=\"mt-1 d-flex justify-content-between\">\n        <div className=\"me-4\">\n          <Widget\n            src=\"mob.near/widget/CommentButton\"\n            props={{\n              onClick: () =>\n                !state.showReply && State.update({ showReply: true }),\n            }}\n          />\n        </div>\n        <div className=\"me-4\">\n          <Widget\n            src=\"mob.near/widget/LikeButton\"\n            props={{\n              notifyAccountId,\n              item,\n            }}\n          />\n        </div>\n        <div>\n          <Widget\n            src=\"mob.near/widget/MainPage.Post.ShareButton\"\n            props={{ accountId, blockHeight, postType: \"post\" }}\n          />\n        </div>\n      </div>\n    )}\n    <div className=\"mt-3 ps-5\">\n      {state.showReply && (\n        <div className=\"mb-2\">\n          <Widget\n            src=\"mob.near/widget/MainPage.Comment.Compose\"\n            props={{\n              notifyAccountId,\n              item,\n              onComment: () => State.update({ showReply: false }),\n            }}\n          />\n        </div>\n      )}\n      <Widget\n        src=\"mob.near/widget/MainPage.Comment.Feed\"\n        props={{\n          item,\n          highlightComment: props.highlightComment,\n          limit: props.commentsLimit,\n          subscribe,\n          raw,\n        }}\n      />\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/proofofvibes.near/widget/Vibes.Feed.View.main", "fact_widget_deployments_id": "cc94e7579c09e18a4454190f4c63dd42", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 12}
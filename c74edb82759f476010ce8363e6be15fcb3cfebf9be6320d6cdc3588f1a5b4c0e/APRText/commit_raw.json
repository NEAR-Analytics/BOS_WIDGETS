{"tx_hash": "25kcBKZR9SRd3Cb6WUgps43EhW6axYhGyJW3ioDo4X1z", "action_id_social": "ERnhtc2v7DjfTZkZkdPkASrNdZytf3g2ZZQLSqWddLut-0-widget", "block_id": 96851353, "block_timestamp": "2023-07-19T16:59:40.230Z", "signer_id": "c74edb82759f476010ce8363e6be15fcb3cfebf9be6320d6cdc3588f1a5b4c0e", "widget_name": "APRText", "source_code": "function hexToNumString(hex) {\n  return ethers.BigNumber.from(hex).toString();\n}\n/**\n * @param {string} chainId\n * @param {string} poolId\n * @returns {APRApiResponse | undefined}\n */\nconst getApr = (chainId, poolId) => {\n  console.log(\"poolId\", poolId);\n  console.log(\"chainId\", chainId);\n  const url = `https://api.balancer.fi/pools/${chainId}/${poolId}`;\n  const res = fetch(url).body;\n  return res;\n};\nconst pools = fetch(graphqlUrl, {\n  method: \"POST\",\n  headers: { \"Content-Type\": \"application/json\" },\n  body: JSON.stringify({ query }),\n}).body.data.pools;\n\nfunction formatAPR(aprRes) {\n  const total = aprRes?.apr.tokenAprs.total;\n  const apr =\n    typeof total === \"number\" || typeof total === \"string\"\n      ? parseInt(total) / 100 + \"%\"\n      : \"N/A\";\n  return apr;\n}\n\nconst missingProps = [];\nif (!props.poolId) missingProps.push(\"poolId (string)\");\nif (!props.chainId) missingProps.push(\"chainId (string)\");\nif (missingProps.length > 0) {\n  return (\n    <pre className=\"card text-white bg-danger pt-3 px-3\">\n      {`APR missing props:\n\n- ${missingProps.join(\"\\n- \")}`}\n    </pre>\n  );\n}\n\nconst _chainId = props.chainId;\n// if it starts with 0x, dehex it, otherwise pass it raw\nconst chainId =\n  typeof _chainId === \"string\"\n    ? _chainId.startsWith(\"0x\")\n      ? hexToNumString(_chainId)\n      : _chainId\n    : _chainId;\nconst poolId = props.poolId;\nconst aprRes = getApr(chainId, poolId);\nconst apr = formatAPR(aprRes);\n\nreturn <>{apr}</>;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/c74edb82759f476010ce8363e6be15fcb3cfebf9be6320d6cdc3588f1a5b4c0e/widget/APRText", "fact_widget_deployments_id": "1e3e44b28c82c149a4b111761e70a8d5", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "B4urXZ94CemKd8WopF9ENX1oTApjVNYdcqAeJ1u4ft8a", "action_id_social": "D8WKE9TWGAoFWFNk8VHEbRTSQ1rGnYr6BjgTjM5tTQHf-0-widget", "block_id": 104828726, "block_timestamp": "2023-11-03T09:13:29.318Z", "signer_id": "toch.near", "widget_name": "SocialComment", "source_code": "State.init({\n  m: \"\",\n});\n\nconst code = `\n<script src=\"https://unpkg.com/react@18/umd/react.development.js\" crossorigin></script>\n<script src=\"https://unpkg.com/react-dom@18/umd/react-dom.development.js\" crossorigin></script>\n<script src=\"https://unpkg.com/react-markdown-editor-lite@1.3.4/lib/index.js\" crossorigin></script>\n<link rel=\"stylesheet\" href=\"https://unpkg.com/react-markdown-editor-lite@1.3.4/lib/index.css\" />\n\n\n<div id=\"react-root\"></div>\n\n<script>\nfunction TestReact(props) {\n  const [value, setValue] = React.useState(props.initialText || \"\");\n  return React.createElement(ReactMarkdownEditorLite.default, {\n      value,\n      view: { menu: true, md: true, html: false },\n      canView: { menu: true, md: false, html: false, fullScreen: false, hideMenu: true },\n      onChange: ({ text }) => {\n        setValue(text);\n        window.top.postMessage(text, \"*\");\n      },\n      renderHTML: () => {},\n      className: \"full\",\n    }); \n}\n\nconst domContainer = document.querySelector('#react-root');\nconst root = ReactDOM.createRoot(domContainer);\n\nwindow.addEventListener(\"message\", (event) => {\n  root.render(React.createElement(TestReact, {\n    initialText: event.data,\n  }));\n});\n\n</script>\n`;\n\nconst mainData = {\n  type: \"md\",\n  text: state.m,\n  item: {\n    type: \"social\",\n    path: `${context.accountId}/post/main`,\n    blockHeight: props.blockHeight,\n  },\n};\n\nconst postData = {\n  key: {\n    type: \"social\",\n    path: `${context.accountId}/post/main`,\n    blockHeight: prop.blockHeight,\n  },\n  value: {\n    type: \"md\",\n  },\n};\n\nconst composeData = {\n  post: {\n    comment: JSON.stringify(mainData),\n  },\n  index: {\n    comment: JSON.stringify(postData),\n  },\n};\n\nconst handleClick = () => {\n  Social.set(composeData);\n};\n\nconst handleChange = (m) => {\n  State.update({ m });\n};\n\nreturn (\n  <div>\n    <iframe\n      className=\"w-100\"\n      style={{ height: \"300px\" }}\n      srcDoc={code}\n      message={state.m}\n      onMessage={handleChange}\n    />\n    <Markdown text={state.m} />\n    <button\n      onClick={handleClick}\n      style={{ background: \"teal\", border: \"none\" }}\n    >\n      Comment\n    </button>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/toch.near/widget/SocialComment", "fact_widget_deployments_id": "ee45739fcd82ea0b2bb4d931f06c57f7", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
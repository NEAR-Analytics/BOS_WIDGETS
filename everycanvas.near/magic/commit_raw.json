{"tx_hash": "F98Cbq7WBXQHSNAAh272C5GjRbHyJ8ucJJ7gCYMRpkyd", "action_id_social": "71Mk8HzvZxsNJdFkLQu58QDm3hngtACSL1SBL2hF7uLm-0-widget", "block_id": 119359673, "block_timestamp": "2024-05-20T17:41:53.121Z", "signer_id": "everycanvas.near", "widget_name": "magic", "source_code": "const systemPrompt = `You are an expert web developer who specializes in inline bootstrap css classes.\nA user will provide you with a low-fidelity wireframe of an application. \nYou will return a single html file that uses HTML, tailwind css, and JavaScript to create a high fidelity website.\nInclude any extra CSS and JavaScript in the html file.\nIf you have any images, load them from Unsplash or use solid colored rectangles.\nThe user will provide you with notes in blue or red text, arrows, or drawings.\nThe user may also include images of other websites as style references. Transfer the styles as best as you can, matching fonts / colors / layouts.\nThey may also provide you with the html of a previous design that they want you to iterate from.\nCarry out any changes they request from you.\nIn the wireframe, the previous design's html will appear as a white rectangle.\nFor your reference, all text from the image will also be provided to you as a list of strings, separated by newlines. Use them as a reference if any text is hard to read.\nUse creative license to make the application more fleshed out.\nUse JavaScript modules and unpkg to import any necessary dependencies.\n\nRespond ONLY with the contents of the html file.`;\n\nconst {\n  shapes,\n  getSelectionAsText,\n  getSelectionAsImageDataUrl,\n  getContentOfPreviousResponse,\n  makeEmptyResponseShape,\n  populateResponseShape,\n} = props;\n\nconst Button = styled.button``;\n\nconst [text, setText] = useState(\"\");\nconst [dataUrl, setDataUrl] = useState(null);\nconst [previousResponse, setPreviousResponse] = useState(null);\nconst [prompt, setPrompt] = useState(systemPrompt);\nconst [model, setModel] = useState(\"gpt-4-vision-preview\");\nconst [messages, setMessages] = useState([]);\nconst [responseShapeId, setResponseShapeId] = useState([]);\nconst [response, setResponse] = useState(null);\n\nconst convertToText = () => {\n  setText(getSelectionAsText());\n};\n\nconst convertToDataUrl = () => {\n  getSelectionAsImageDataUrl()\n    .then((data) => {\n      console.log(data);\n      setDataUrl(data);\n    })\n    .catch((error) => {\n      console.error(error);\n    });\n};\n\nconst getPreviousResponse = () => {\n  setText(getContentOfPreviousResponse());\n};\n\nconst createMessages = () => {\n  const userMessages = [\n    {\n      type: \"text\",\n      text: \"Turn this into a single html file using tailwind.\",\n    },\n  ];\n\n  if (text) {\n    userMessages.push({\n      type: \"text\",\n      text: text,\n    });\n  }\n\n  if (dataUrl) {\n    userMessages.push({\n      type: \"image_url\",\n      image_url: {\n        // send an image of the current selection to gpt-4 so it can see what we're working with\n        url: dataUrl,\n        detail: \"high\",\n      },\n    });\n  }\n  if (previousResponse) {\n    userMessages.push({\n      type: \"text\",\n      text: previousResponse,\n    });\n  }\n\n  // combine the user prompt with the system prompt\n  setMessages([\n    { role: \"system\", content: prompt },\n    { role: \"user\", content: userMessages },\n  ]);\n};\n\nconst createEmptyShape = () => {\n  setResponseShapeId(makeEmptyResponseShape());\n};\n\nconst updateResponseShape = () => {\n  populateResponseShape(responseShapeId, response);\n};\n\nreturn (\n  <>\n    <h5>selected shapes</h5>\n    <textarea style={{ width: \"100%\" }} value={shapes} disabled />\n    <Button onClick={convertToText}>convert to text</Button>\n    <textarea style={{ width: \"100%\" }} value={text} disabled />\n    <Button onClick={convertToDataUrl}>convert to image</Button>\n    <div className=\"d-flex\">{dataUrl && <img src={dataUrl} height={100} width={200} />}</div>\n    <Button onClick={getPreviousResponse}>get previous response</Button>\n    <textarea style={{ width: \"100%\" }} value={previousResponse} disabled />\n    <h5>prompt</h5>\n    <textarea\n      style={{ width: \"100%\" }}\n      value={prompt}\n      onChange={(e) => setPrompt(e.target.value)}\n    />\n    <h5>model</h5>\n    <select style={{ width: \"100%\" }} onChange={(e) => setModel(e.target.value)} value={model}>\n      <option value=\"gpt-3.5-turbo\">gpt-3.5-turbo</option>\n      <option value=\"gpt-4\">gpt-4</option>\n      <option value=\"gpt-4-vision-preview\">gpt-4-vision-preview</option>\n    </select>\n    <Button onClick={createMessages}>create messages</Button>\n    <textarea style={{ width: \"100%\" }} value={JSON.stringify(messages)} disabled />\n    <Button onClick={createEmptyShape}>create empty response shape</Button>\n    <Widget\n      src=\"everycanvas.near/widget/near-openai\"\n      props={{ model: model, messages: messages, setResponse: setResponse }}\n    />\n    <textarea style={{ width: \"100%\" }} value={JSON.stringify(response)} disabled />\n    <Button onClick={updateResponseShape}>update response shape</Button>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/everycanvas.near/widget/magic", "fact_widget_deployments_id": "56947d71559c46a5b5fb23aeaefd970f", "inserted_timestamp": "2024-05-20T19:51:25.009Z", "modified_timestamp": "2024-05-20T19:51:25.009Z", "__row_index": 0}
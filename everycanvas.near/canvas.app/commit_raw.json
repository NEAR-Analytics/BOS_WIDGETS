{"tx_hash": "C7LXnagJjnj68tLFe6Rfkq6kBYvg412xvKGnrfkzCsdB", "action_id_social": "FS7NUkeQZdEY6LvrG4p273LTPaUfkVqa1yAkgi1HEYfc-0-widget", "block_id": 105307639, "block_timestamp": "2023-11-09T16:59:00.997Z", "signer_id": "everycanvas.near", "widget_name": "canvas.app", "source_code": "const canvasSrc = props.canvasSrc || \"efiz.near/thing/canvas\";\n\nconst accountId = context.accountId;\n\nconst Container = styled.div`\n  height: 95vh;\n  width: 100vw;\n`;\n\nlet data;\n\n\nif (canvasSrc) {\n  data = JSON.parse(Social.get(canvasSrc, \"final\") || \"null\");\n\n  if (!data) {\n    return <Container>Invalid canvas</Container>;\n  }\n} else {\n  data = JSON.parse(Social.get(\"*/thing/canvas\", \"final\") || \"null\");\n}\n\n\n// return <p>{JSON.stringify(data)}</p>\n\nconst [snapshot, setSnapshot] = useState(data);\n\nconst [trigger, setTrigger] = useState(false);\nconst [canvasSnapshot, setCanvasSnapshot] = useState(null);\n\nconst getDataFromChild = () => {\n  setTrigger(true); // Triggers the effect in the child\n};\n\nconst handleDataFromChild = (data) => {\n  setCanvasSnapshot(data);\n  setTrigger(false); // Reset the trigger\n};\n\nconst handlePublish = () => {\n  Social.set({\n    thing: {\n      canvas: canvasSnapshot,\n    },\n  });\n};\n\nconst Button = styled.button``;\n\nconst ButtonRow = styled.div`\n  display: flex;\n  flex-direction: row;\n  height: auto;\n`;\n\nreturn (\n  <Container>\n    <ButtonRow>\n      <Button onClick={getDataFromChild}>get canvas data</Button>\n      <Button onClick={handlePublish} disabled={!canvasSnapshot}>\n        publish\n      </Button>\n    </ButtonRow>\n    <Widget\n      src=\"everycanvas.near/widget/canvas.core\"\n      props={{ snapshot, trigger, handleDataFromChild }}\n    />\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/everycanvas.near/widget/canvas.app", "fact_widget_deployments_id": "e4178cbe4d87f891ebb92e26fb71a7b1", "inserted_timestamp": "2023-11-09T18:51:31.487Z", "modified_timestamp": "2023-11-09T18:51:31.487Z", "__row_index": 3}
{"tx_hash": "F98Cbq7WBXQHSNAAh272C5GjRbHyJ8ucJJ7gCYMRpkyd", "action_id_social": "71Mk8HzvZxsNJdFkLQu58QDm3hngtACSL1SBL2hF7uLm-0-widget", "block_id": 119359673, "block_timestamp": "2024-05-20T17:41:53.121Z", "signer_id": "everycanvas.near", "widget_name": "GrantPermissions", "source_code": "const path = props.path;\nconst connected_account = context.accountId;\n\nconst social_contract_id = \"social.near\";\n\nState.init({\n  account: \"\",\n});\n\nlet data = {\n  accountId: state.account,\n};\n\nconst accounts_granted_permissions = Near.view(social_contract_id, \"debug_get_permissions\", {\n  account_id: connected_account,\n});\n\nconst handleGrantAccount = () => {\n  Near.call([\n    {\n      contractName: social_contract_id,\n      methodName: \"grant_write_permission\",\n      args: { predecessor_id: data.accountId, keys: [path] },\n      deposit: \"1\",\n    },\n  ]);\n};\n\nconst filtered_accounts_granted_permissions =\n  accounts_granted_permissions &&\n  accounts_granted_permissions.filter((permissions) => {\n    return Object.keys(permissions[0])[0] === \"AccountId\";\n  });\n\nconst map_filtered_accounts_granted_permissions =\n  accounts_granted_permissions &&\n  filtered_accounts_granted_permissions.map((filter) => {\n    return filter[0].AccountId;\n  });\n\nreturn (\n  <div class=\"d-flex flex-column gap-4\">\n    <div>\n      <h4>Grant Permissions</h4>\n      {!!data.accountId && (\n        <>\n          <p>\n            You are granting write permissions to <span class=\"fw-bold\">{data.accountId}</span>{\" \"}\n          </p>\n          <p>\n            for the path: <span class=\"fw-bold\">{path}</span>\n          </p>\n        </>\n      )}\n    </div>\n    <div class=\"w-100 d-flex gap-4\">\n      <input id=\"accountid\" type=\"text\" value={state.account}></input>\n      <button\n        onClick={() => {\n          handleGrantAccount();\n        }}\n        disabled={\n          !state.account || !/.near$/.test(state.account) || state.account === connected_account\n        }\n      >\n        Grant\n      </button>\n    </div>\n\n    <a href=\"https://near.social/#/mob.near/widget/MainPage.Post.Page?accountId=root.near&blockHeight=85026336\">\n      Learn more (Illia's post)\n    </a>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/everycanvas.near/widget/GrantPermissions", "fact_widget_deployments_id": "4963d70eea49f95e3cd087c382fda2f3", "inserted_timestamp": "2024-05-20T19:51:25.009Z", "modified_timestamp": "2024-05-20T19:51:25.009Z", "__row_index": 3}
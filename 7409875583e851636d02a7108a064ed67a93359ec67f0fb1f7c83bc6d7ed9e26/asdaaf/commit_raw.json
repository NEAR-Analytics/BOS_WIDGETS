{"tx_hash": "5tT2wqytrKFpCcfA66Ppxs6fCykcGRw8KUd7B42ekSUi", "action_id_social": "6Hd8Y7XcqgL5Pbsmubhw6YBwU5cdzSCCkbFZZCCJrquw-0-widget", "block_id": 105231049, "block_timestamp": "2023-11-08T15:48:53.030Z", "signer_id": "7409875583e851636d02a7108a064ed67a93359ec67f0fb1f7c83bc6d7ed9e26", "widget_name": "asdaaf", "source_code": "const accountId = props.accountId || context.accountId;\nconst contracts = props.contracts ||\n  context.contracts || [\n    \"core.namesky.near\",\n    \"asac.near\",\n    \"mrbrownproject.near\",\n    \"spin-nft-contract.near\",\n    \"citizen.bodega-lab.near\",\n    \"ff.nekotoken.near\",\n  ];\nconst marketId = \"simple.market.mintbase1.near\";\n\nconst AFFILIATE_ACCOUNT = props.affiliateAccount || \"mintbase.near\";\n\nconst data = fetch(\"https://graph.mintbase.xyz\", {\n  method: \"POST\",\n  headers: {\n    \"mb-api-key\": \"omni-site\",\n    \"Content-Type\": \"application/json\",\n    \"x-hasura-role\": \"anonymous\",\n  },\n  body: JSON.stringify({\n    query: `\n      query MyQuery($contracts: [String]) {\n        mb_views_active_listings_by_contract(limit: 100, order_by: {created_at: desc}, where: {market_id: {_eq: \"simple.market.mintbase1.near\"}, nft_contract_id: {_in: $contracts}}) {\n            listed_by\n            created_at\n            price\n            nft_contract_id\n            token_id\n            metadata_id\n        }   \n      }\n`,\n    variables: {\n      contracts: contracts,\n    },\n  }),\n});\n\nconst YoctoToNear = (amountYocto) =>\n  new Big(amountYocto).div(new Big(10).pow(24)).toString();\n\nlet buy = (price, token_id, nft_contract_id) => {\n  const gas = 200000000000000;\n  const deposit = new Big(price).toFixed(0);\n\n  Near.call(\n    marketId,\n    \"buy\",\n    {\n      nft_contract_id: nft_contract_id,\n      token_id: token_id,\n      referrer_id: AFFILIATE_ACCOUNT,\n    },\n    gas,\n    deposit\n  );\n};\n\nif (!data.ok) {\n  return \"Loading\";\n}\n\nconst size = \"100%\";\n\nconst theme = props.theme;\n\nconst MainContainer = styled.div`\n  width: 100%;\n  padding-block: 32px;\n  \n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  gap:32px;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  text-align: center;\n  max-width: 600px;\n`;\nconst ContentContainer = styled.div`\n  width: 100%;\n\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 16px;\n`;\n\nconst ItemContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  border-radius: 5px;\n  overflow: hidden;\n`;\n\nconst ActionButton = styled.button`\n  border: none;\n  background-color: #01e1d3;\n  color: black;\n\n  height: 45px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  font-size: 18px;\n  font-weight: 600;\n  cursor: pointer;\n  border-radius: 0px;\n\n  :hover {\n    background-color: #47fff3;\n  }\n`;\n\nreturn data !== null ? (\n  <MainContainer>\n    <Header>\n      <h2 style={{ fontWeight: 600 }}>NFT Marketplace List on Jutsu</h2>\n      <p>\n        The Jutsu Marketplace component is a customizable widget for NFT-based\n        dApps that allows developers to easily integrate a fully functional NFT\n        marketplace.\n      </p>\n    </Header>\n\n    <ContentContainer>\n      {data.body.data?.mb_views_active_listings_by_contract.map(\n        (listing, i) => {\n          const priceYocto = listing.price.toLocaleString().replace(/,/g, \"\");\n          const priceNear = YoctoToNear(priceYocto);\n\n          return (\n            <ItemContainer>\n              <a\n                href={`https://mintbase.xyz/meta/${listing.metadata_id}/`}\n                target=\"_blank\"\n              >\n                <Widget\n                  src=\"mob.near/widget/NftImage\"\n                  props={{\n                    nft: {\n                      tokenId: listing.token_id,\n                      contractId: listing.nft_contract_id,\n                    },\n                    style: {\n                      width: size,\n                      height: size,\n                      objectFit: \"cover\",\n                      minWidth: size,\n                      minHeight: size,\n                      maxWidth: size,\n                      maxHeight: size,\n                      overflowWrap: \"break-word\",\n                    },\n                    className: \"\",\n                    fallbackUrl:\n                      \"https://ipfs.near.social/ipfs/bafkreihdiy3ec4epkkx7wc4wevssruen6b7f3oep5ylicnpnyyqzayvcry\",\n                  }}\n                />\n              </a>\n\n              <ActionButton\n                disabled={!accountId}\n                onClick={() => {\n                  if (!accountId) return;\n                  buy(priceYocto, listing.token_id, listing.nft_contract_id);\n                }}\n              >\n                Buy {priceNear} N\n              </ActionButton>\n            </ItemContainer>\n          );\n        }\n      )}\n    </ContentContainer>\n  </MainContainer>\n) : (\n  <p>loading...</p>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/7409875583e851636d02a7108a064ed67a93359ec67f0fb1f7c83bc6d7ed9e26/widget/asdaaf", "fact_widget_deployments_id": "d45bd7fc577406d553f7722dbbabb986", "inserted_timestamp": "2023-11-08T17:42:47.319Z", "modified_timestamp": "2023-11-08T17:42:47.319Z", "__row_index": 1}
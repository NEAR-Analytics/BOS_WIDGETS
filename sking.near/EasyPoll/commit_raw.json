{"tx_hash": "8cDanA9UEirvS3BB8xStHTrb4fKf7N138uHFdjNNDp6q", "action_id_social": "4nLb4B7ExgKXF2uqwRxY9SJrUGQV4gumZi7nVsgjW2Fg-0-widget", "block_id": 96050452, "block_timestamp": "2023-07-09T06:52:22.411Z", "signer_id": "sking.near", "widget_name": "EasyPoll", "source_code": "const widgetOwner = \"sking.near\";\n\nconst page = (props.page ?? \"OFFICIAL_POLLS\").toUpperCase();\n\nconst tabs = {\n  OFFICIAL_POLLS: {\n    text: \"Official Polls by NDC\",\n    description:\n      \"Explore polls officially conducted by the NDC. These are verified, authoritative, and can provide valuable insights! Participating in the Official Polls by the NDC may eventually contribute to your on-chain reputation!\",\n    href: `#/${widgetOwner}/widget/EasyPoll?page=official_polls`,\n    active: page === \"OFFICIAL_POLLS\",\n  },\n  PUBLIC_POLLS: {\n    text: \"All Public Polls\",\n    description:\n      \"Dive into the world of public opinion. These are polls created by users like you, a melting pot of diverse thoughts and perspectives!\",\n    href: `#/${widgetOwner}/widget/EasyPoll?page=public_polls`,\n    active: page === \"PUBLIC_POLLS\",\n  },\n  MY_POLLS: {\n    text: \"My Polls\",\n    description:\n      \"Your personal polling station! Manage and review your own polls, watch them gain traction, and get insights from responses.\",\n    href: `#/${widgetOwner}/widget/EasyPoll?page=my_polls`,\n    active: page === \"MY_POLLS\",\n  },\n  CREATE_POLL: {\n    href: `#/${widgetOwner}/widget/EasyPoll?page=create_poll`,\n    active: page === \"CREATE_POLL\",\n    hideSidebar: true,\n  },\n  DELETE_POLL: {\n    href: (src, blockHeight) =>\n      `#/${widgetOwner}/widget/EasyPoll?page=delete_poll&src=${src}`,\n    active: page === \"DELETE_POLL\",\n    hideSidebar: true,\n  },\n  EDIT_POLL: {\n    href: (src, blockHeight) =>\n      `#/${widgetOwner}/widget/EasyPoll?page=create_poll&src=${src}`,\n    active: page === \"EDIT_POLL\",\n    hideSidebar: true,\n  },\n  VIEW_POLL: {\n    href: (src, blockHeight) =>\n      `#/${widgetOwner}/widget/EasyPoll?page=view_poll&src=${src}`,\n    active: page === \"VIEW_POLL\",\n    hideSidebar: true,\n  },\n  RESULTS: {\n    href: (src, blockHeight) =>\n      `#/${widgetOwner}/widget/EasyPoll?page=results&src=${src}`,\n    active: page === \"RESULTS\",\n    hideSidebar: true,\n  },\n};\n\nconst getFirstSBTToken = () => {\n  const view = Near.view(\"registry.i-am-human.near\", \"sbt_tokens_by_owner\", {\n    account: `${context.accountId}`,\n    issuer: \"fractal.i-am-human.near\",\n  });\n  return view?.[0]?.[1]?.[0];\n};\n\nconst whitelist = [\n  \"neardigitalcollective.near\",\n  \"blaze.near\",\n  \"jlw.near\",\n  \"joep.near\",\n  \"sarahkornfeld.near\",\n  \"yuensid.near\",\n  \"chloe.near\",\n];\n\nconst blackList = []; // use it to hide bad users\n\nconst indexVersion = \"4.0.0\";\n\nconst hasSBTToken = getFirstSBTToken() !== undefined;\n\nconst canOperate = hasSBTToken || whitelist.includes(context.accountId);\n\nconst SectionHeader = styled.h2`\n  font-size: 28px;\n  font-weight: 700;\n  letter-spacing: -1px;\n`;\n\nconst SectionDescription = styled.p`\n  font-size: 15px;\n  font-weight: 500;\n  padding-bottom: 8px;\n  opacity: 0.6;\n  color: \"#828688\";\n`;\n\n// Styles\nconst Wrapper = styled.div`\n  display: flex;\n  align-items: stretch;\n  justify-content: space-between;\n  flex-direction: column;\n  max-width: 100%;\n  overflow: hidden;\n  background: #fff;\n  margin: auto;\n  margin-bottom: 2rem;\n\n  a {\n    color: #4f46e5;\n  }\n\n  @media (min-width: 768px) {\n    flex-direction: row;\n  }\n  @media (min-width: 900px) {\n    gap: 40px;\n  }\n`;\n\nconst SidebarWrapper = styled.div`\n  flex: 1;\n  width: 100%;\n  min-height: 100%;\n  display: ${tabs[page].hideSidebar ? \"none\" : \"initial\"};\n\n  @media (min-width: 768px) {\n    max-width: 300px;\n  }\n`;\nconst MainWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  flex: 3;\n  width: 100%;\n  min-height: 100%;\n`;\n\nconst isLoggedIn = context.accountId ? true : false;\n\nreturn (\n  <>\n    <Widget src={`${widgetOwner}/widget/Common.OpenSansFont`} />\n    <div\n      style={{\n        backgroundColor: \"#fff\",\n        fontStyle: \"normal\",\n        borderRadius: \"20px\",\n        fontFamily: \"Open Sans, sans-serif\",\n        margin: \"auto\",\n      }}\n    >\n      <div className=\"d-flex flex-wrap gap-3 justify-content-between align-items-center pb-1\">\n        <a\n          className=\"d-flex align-items-center text-decoration-none\"\n          href={tabs.OFFICIAL_POLLS.href}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 188.35 188.35\"\n            height={40}\n            width={40}\n          >\n            <rect\n              width={188.35}\n              height={188.35}\n              rx={55.32}\n              ry={55.32}\n              fill=\"#4f46e5\"\n            />\n            <rect\n              width={19.21}\n              height={24.02}\n              x={55.75}\n              y={103.78}\n              fill=\"#ffd50d\"\n            />\n            <rect\n              width={19.21}\n              height={43.23}\n              x={84.57}\n              y={84.57}\n              fill=\"#ffd50d\"\n            />\n            <rect\n              width={19.21}\n              height={67.25}\n              x={113.63}\n              y={60.55}\n              fill=\"#ffd50d\"\n            />\n          </svg>\n          <h3\n            style={{\n              margin: \"0 0.5rem\",\n              color: \"#000\",\n              fontWeight: \"500\",\n              fontSize: \"28px\",\n              letterSpacing: \"-1px\",\n            }}\n          >\n            EasyPoll\n          </h3>\n        </a>\n\n        <div className=\"p-2 ms-auto\">\n          <p\n            style={{\n              margin: \"0\",\n              fontWeight: \"bold\",\n              fontSize: \"15px\",\n              color: hasSBTToken ? \"#239F28\" : \"#DD5E56\",\n            }}\n          >\n            {!isLoggedIn\n              ? \"Sign In To Use EasyPoll\"\n              : hasSBTToken\n              ? \"Verified Human\"\n              : \"Non-Verified Human\"}\n          </p>\n        </div>\n\n        {isLoggedIn &&\n          (hasSBTToken ? (\n            !tabs.CREATE_POLL.active && (\n              <a href={tabs.CREATE_POLL.href} className=\"text-decoration-none\">\n                <Widget\n                  src=\"rubycop.near/widget/NDC.StyledComponents\"\n                  props={{\n                    Button: {\n                      text: \"Create a Poll\",\n                      icon: <i className=\"bi bi-plus-lg\" />,\n                      onClick: handleClickFunction,\n                    },\n                  }}\n                />\n              </a>\n            )\n          ) : (\n            <a\n              href=\"https://i-am-human.app\"\n              target=\"_blank\"\n              className=\"text-decoration-none\"\n            >\n              <Widget\n                src=\"rubycop.near/widget/NDC.StyledComponents\"\n                props={{\n                  Button: {\n                    text: \"Verify as Human\",\n                    icon: (\n                      // should be replaced with I-AM-HUMAN logo svg but I couldn't find it :(\n                      <img\n                        height={25}\n                        width={25}\n                        style={{\n                          filter: \"brightness(100)\",\n                        }}\n                        src=\"data:image/png;base64,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\"\n                      />\n                    ),\n                    className: \"primary dark d-flex gap-2 align-items-center\",\n                    onClick: () => {},\n                  },\n                }}\n              />\n            </a>\n          ))}\n      </div>\n      <Wrapper>\n        <SidebarWrapper>\n          <Widget\n            src={`${widgetOwner}/widget/EasyPoll.Sidebar`}\n            props={{ tabs }}\n          />\n        </SidebarWrapper>\n\n        <MainWrapper className=\"pt-4 pb-3\">\n          {tabs[page].text && <SectionHeader>{tabs[page].text}</SectionHeader>}\n          {tabs[page].description && (\n            <SectionDescription>{tabs[page].description}</SectionDescription>\n          )}\n          {page === \"OFFICIAL_POLLS\" ? (\n            <Widget\n              src={`${widgetOwner}/widget/EasyPoll.Polls`}\n              props={{\n                indexVersion,\n                filterByUser: whitelist,\n                skipHumanVericationFor: whitelist,\n                blackList,\n                tabs,\n              }}\n            />\n          ) : page === \"PUBLIC_POLLS\" ? (\n            <Widget\n              src={`${widgetOwner}/widget/EasyPoll.Polls`}\n              props={{\n                indexVersion,\n                skipHumanVericationFor: whitelist,\n                onlyVerifiedHumans: false,\n                blackList,\n                tabs,\n              }}\n            />\n          ) : page === \"MY_POLLS\" ? (\n            <>\n              <h4 className=\"mb-1\">Drafts</h4>\n              <Widget\n                src={`${widgetOwner}/widget/EasyPoll.Polls`}\n                props={{\n                  indexVersion,\n                  onlyVerifiedHumans: false,\n                  blackList,\n                  tabs,\n                  filterByUser: [context.accountId],\n                  draft: true,\n                }}\n              />\n              <h4 className=\"mt-4 mb-1\">Published</h4>\n              <Widget\n                src={`${widgetOwner}/widget/EasyPoll.Polls`}\n                props={{\n                  indexVersion,\n                  filterByUser: [context.accountId],\n                  onlyVerifiedHumans: false,\n                  blackList,\n                  tabs,\n                }}\n              />\n            </>\n          ) : page === \"VIEW_POLL\" ? (\n            <Widget\n              src={`${widgetOwner}/widget/EasyPoll.ViewPoll`}\n              props={{\n                shouldDisplayViewAll: false,\n                tabs,\n                isHuman: hasSBTToken,\n                src: props.src,\n                blockHeight: props.blockHeight,\n                indexVersion,\n              }}\n            />\n          ) : page === \"CREATE_POLL\" ? (\n            <Widget\n              src={`${widgetOwner}/widget/EasyPoll.CreatePoll`}\n              props={{\n                indexVersion,\n                blockHeight: props.blockHeight,\n                src: props.src,\n              }}\n            />\n          ) : page === \"RESULTS\" ? (\n            <Widget\n              src={`${widgetOwner}/widget/EasyPoll.Results`}\n              props={{\n                blockHeight: props.blockHeight,\n                src: props.src,\n                indexVersion,\n              }}\n            />\n          ) : page === \"DELETE_POLL\" ? (\n            <Widget\n              src={`${widgetOwner}/widget/EasyPoll.DeletePoll`}\n              props={{\n                blockHeight: props.blockHeight,\n                src: props.src,\n                tabs,\n              }}\n            />\n          ) : (\n            \"404\"\n          )}\n        </MainWrapper>\n      </Wrapper>\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sking.near/widget/EasyPoll", "fact_widget_deployments_id": "1f9f2f20a816cd89fbc7c0f03c12525d", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 12}
{"tx_hash": "C5uikAgg5MBedX3UWnXC61Uy2sPqvGmcJfMuByzKJDpU", "action_id_social": "2VbFLTUzXAV5YArFPAvvbMeQrPRWeHBZDUbBFpUPxSt7-0-widget", "block_id": 91971934, "block_timestamp": "2023-05-16T06:53:28.249Z", "signer_id": "sking.near", "widget_name": "Proposal", "source_code": "const daoId = props.daoId ?? \"multi.sputnik-dao.near\";\n\nconst proposal = JSON.parse(JSON.stringify(props.proposal)) ?? {\n  id: 1,\n  proposer: \"hack.near\",\n  description:\n    \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur ut pharetra orci. Aliquam vitae enim tincidunt sapien fermentum scelerisque.\",\n  kind: { AddMemberToRole: { member_id: \"hack.near\", role: \"community\" } },\n  status: \"Approved\",\n  vote_counts: { council: [1, 0, 0] },\n  votes: { \"infinity.near\": \"Approve\" },\n  submission_time: \"1682527782646393764\",\n};\n\nconsole.log(`Rendering proposal ${proposal.id}...`);\n\nconst proposal_type_value =\n  typeof proposal.kind === \"string\"\n    ? proposal.kind\n    : Object.keys(proposal.kind)[0];\nconst proposal_type = proposal_type_value.replace(/([A-Z])/g, \" $1\").trim(); // Add spaces between camelCase\n\nconst proposal_status = proposal.status.replace(/([A-Z])/g, \" $1\").trim(); // Add spaces between camelCase\n\nconsole.log(proposal);\n\n// ==============================\n// Styled Components\n// ==============================\n\nconst statusColor =\n  proposal.status === \"Approved\"\n    ? \"#28a930\"\n    : proposal.status === \"In Progress\"\n    ? \"#58a1ff\"\n    : proposal.status === \"Failed\"\n    ? \"#dc3545\"\n    : \"#6c757d\";\n\nconst Wrapper = styled.div`\n  margin: 16px auto;\n  max-width: 900px;\n  background-color: #fff;\n  border-radius: 16px;\n  padding: 24px;\n  box-shadow: rgba(0, 0, 0, 0.18) 0px 2px 4px;\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n  min-height: 500px;\n\n  p {\n    line-height: 1.4;\n    font-weight: 400;\n    font-size: 15px;\n    color: #868682;\n    margin: 0;\n  }\n\n  h3 {\n    font-weight: 600;\n    font-size: 24px;\n    color: #1b1b18;\n  }\n\n  h5 {\n    font-size: 14px;\n    font-weight: 500;\n    line-height: 1.2;\n    color: #6c757d;\n  }\n\n  .status {\n    font-size: 14px;\n    font-weight: 600;\n    line-height: 1.2;\n    color: ${statusColor};\n  }\n`;\n\nconst MarkdownContainer = styled.div`\n  position: relative;\n  width: 100%;\n  padding: 24px;\n  background-color: #f8f9fa;\n  color: #1b1b18;\n  border-radius: 16px;\n  max-height: 800px;\n  overflow-y: auto;\n  color: #333;\n  line-height: 1.6;\n  box-shadow: rgba(0, 0, 0, 0.05) 0px 0px 0px 1px;\n\n  h1 {\n    font-size: 2em;\n    color: #111;\n    border-bottom: 1px solid #ccc;\n    padding-bottom: 0.3em;\n    margin-bottom: 1em;\n  }\n\n  h2 {\n    font-size: 1.5em;\n    color: #222;\n    margin-bottom: 0.75em;\n  }\n\n  h3 {\n    font-size: 1.3em;\n    color: #333;\n    margin-bottom: 0.6em;\n  }\n\n  h4 {\n    font-size: 1.2em;\n    color: #444;\n    margin-bottom: 0.5em;\n  }\n\n  h5 {\n    font-size: 1.1em;\n    color: #555;\n    margin-bottom: 0.4em;\n  }\n\n  p {\n    font-size: 1em;\n    margin-bottom: 1em;\n  }\n\n  a {\n    color: #0645ad;\n    text-decoration: none;\n  }\n\n  a:hover {\n    text-decoration: underline;\n  }\n`;\n\nconst RenderProposalArgs = () => {\n  if (proposal_type_value === \"Vote\") return null;\n\n  if (proposal_type_value === \"Transfer\")\n    return (\n      <>\n        <div>\n          <h5>Amount</h5>\n          <Widget\n            src=\"sking.near/widget/Common.TokenAmount\"\n            props={{\n              amountWithoutDecimals: proposal.kind.Transfer.amount,\n              address: proposal.kind.Transfer.token_id,\n            }}\n          />\n        </div>\n        <div>\n          <h5>Receiver</h5>\n          <Widget\n            src=\"mob.near/widget/Profile.ShortInlineBlock\"\n            props={{\n              accountId: proposal.kind.Transfer.receiver_id,\n              tooltip: true,\n            }}\n          />\n        </div>\n      </>\n    );\n\n  if (proposal_type_value === \"FunctionCall\") {\n    return proposal.kind.FunctionCall.actions.reduce(\n      (acc, { method_name, args, deposit }) => {\n        return acc.concat(\n          <div\n            className=\"d-flex flex-wrap align-items-start w-100\"\n            style={{\n              columnGap: \"48px\",\n              rowGap: \"16px\",\n            }}\n          >\n            <div>\n              <h5>Smart Contract Address</h5>\n              <p>{proposal.kind.FunctionCall.receiver_id}</p>\n            </div>\n            <div>\n              <h5>Method Name</h5>\n              <p>{method_name}</p>\n            </div>\n            <div>\n              <h5>Deposit</h5>\n              <Widget\n                src=\"sking.near/widget/Common.TokenAmount\"\n                props={{\n                  amountWithoutDecimals: deposit,\n                  address: \"\",\n                }}\n              />\n            </div>\n            <div className=\"w-100\">\n              <h5>Arguments</h5>\n              <Markdown\n                // Decode the args (Base64) to String then Parse the Json then format it and display it as markdown code\n                text={\n                  \"```json\\n\" +\n                  JSON.stringify(\n                    JSON.parse(Buffer.from(args, \"base64\").toString(\"utf8\")),\n                    null,\n                    2\n                  ) +\n                  \"\\n```\"\n                }\n              />\n            </div>\n          </div>\n        );\n      },\n      []\n    );\n  }\n\n  if (\n    proposal_type_value === \"AddMemberToRole\" ||\n    proposal_type_value === \"RemoveMemberFromRole\"\n  )\n    return (\n      <>\n        <div>\n          <h5>Member</h5>\n          <Widget\n            src=\"mob.near/widget/Profile.ShortInlineBlock\"\n            props={{\n              accountId: proposal.kind.AddMemberToRole.member_id,\n              tooltip: true,\n            }}\n          />\n        </div>\n        <div>\n          <h5>Role</h5>\n          <p>{proposal.kind.AddMemberToRole.role}</p>\n        </div>\n      </>\n    );\n\n  if (proposal_type_value === \"AddBounty\")\n    return (\n      <>\n        <div>\n          <h5>Amount</h5>\n          <Widget\n            src=\"sking.near/widget/Common.TokenAmount\"\n            props={{\n              amountWithoutDecimals: proposal.kind.AddBounty.bounty.amount,\n              address: proposal.kind.AddBounty.bounty.token,\n            }}\n          />\n        </div>\n        <div>\n          <h5>Times</h5>\n          <p>{proposal.kind.AddBounty.bounty.times}</p>\n        </div>\n        <div>\n          <h5>Deadline</h5>\n          <p>\n            {new Date(\n              proposal.kind.AddBounty.bounty.max_deadline\n            ).toLocaleString()}\n          </p>\n        </div>\n        <div>\n          <h5>Bounty Description</h5>\n          <p>{proposal.kind.AddBounty.bounty.description}</p>\n        </div>\n      </>\n    );\n\n  if (proposal_type_value === \"BountyDone\")\n    return (\n      <>\n        <div>\n          <h5>Receiver</h5>\n          <Widget\n            src=\"mob.near/widget/Profile.ShortInlineBlock\"\n            props={{\n              accountId: proposal.kind.BountyDone.receiver_id,\n              tooltip: true,\n            }}\n          />\n        </div>\n        <div>\n          <h5>Bounty ID</h5>\n          <p>{proposal.kind.BountyDone.bounty_id}</p>\n        </div>\n      </>\n    );\n};\n\nreturn (\n  <Wrapper>\n    <div className=\"d-flex justify-content-between align-items-center\">\n      <div>\n        <h5>Proposal ID: {proposal.id}</h5>\n        <h3>{proposal_type}</h3>\n      </div>\n      <div className=\"d-flex flex-column align-items-end\">\n        <h5>Status</h5>\n        <span className=\"status\">{proposal.status}</span>\n      </div>\n    </div>\n    <div>\n      <h5>Proposer</h5>\n      <Widget\n        src=\"mob.near/widget/Profile.ShortInlineBlock\"\n        props={{ accountId: proposal.proposer, tooltip: true }}\n      />\n    </div>\n    <div>\n      <h5>Description</h5>\n      {proposal_type !== \"Vote\" && <p>{proposal.description}</p>}\n      {proposal_type === \"Vote\" && (\n        <MarkdownContainer>\n          <Markdown text={proposal.description} />\n        </MarkdownContainer>\n      )}\n    </div>\n    <div className=\"d-flex gap-5 flex-wrap align-items-start\">\n      <RenderProposalArgs />\n    </div>\n\n    <div className=\"w-100\">\n      <h5>Votes</h5>\n      <Widget\n        src=\"sking.near/widget/DAO.Proposal.Vote\"\n        props={{\n          daoId: daoId,\n          proposal: proposal,\n        }}\n      />\n    </div>\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sking.near/widget/Proposal", "fact_widget_deployments_id": "4b87b6bd78997e8da20b037436150cd2", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
{"tx_hash": "EeVdN2npJwjU4imkLrA6F6FQ7bngfFV9JFEU1P53H72", "action_id_social": "3T98obejELyZ9f2674eYShAunJRh5Ltv8tGCVirtc5Sy-0-widget", "block_id": 93421772, "block_timestamp": "2023-06-04T08:04:55.283Z", "signer_id": "sking.near", "widget_name": "IAH.Signup", "source_code": "const referrer = props.referrer ?? Storage.privateGet(\"IAH.Signup.Referrer\");\nconst accountId = props.accountId ?? context.accountId;\nconst NFT_CONTRACT = \"v1.humanft.near\";\nconst IAH_CONTRACT = \"registry.i-am-human.near\";\nconst GD_CONTRACT = \"fractal.i-am-human.near\";\nconst WIDGET_AUTHOR = \"sking.near\";\n\nif (!accountId) {\n  // not logged in\n  return <Widget src={`${WIDGET_AUTHOR}/widget/IAH.Signup.Guest`} />;\n}\n\nState.init({\n  tokens: undefined,\n});\n\nStorage.privateSet(\"IAH.Signup.Referrer\", referrer);\n\nconst hasBadge = Near.view(\n  NFT_CONTRACT,\n  \"already_verified\",\n  {\n    account_id: accountId,\n  },\n  undefined,\n  false\n);\nif (hasBadge === null) return \"Loading...\";\n\nconsole.log(\"hasBadge\", hasBadge);\n\nif (hasBadge) {\n  // already claimed his nft badge\n  return <Widget src={`${WIDGET_AUTHOR}/widget/IAH.Signup.Complete`} />;\n}\n\nconst tokens = Near.view(\n  IAH_CONTRACT,\n  \"sbt_tokens_by_owner\",\n  {\n    account: accountId,\n  },\n  undefined,\n  true\n);\nif (tokens === null) return \"Loading...\";\n\nif (isVerified) {\n  // is verified on IAH but didn't claim his nft badge yet\n  return (\n    <Widget\n      src={`${WIDGET_AUTHOR}/widget/IAH.Signup.Verified`}\n      props={{\n        accountId,\n        referrerId: referrer ?? \"sking.near\",\n        NFT_CONTRACT,\n      }}\n    />\n  );\n}\n\nreturn (\n  <Widget\n    src={`${WIDGET_AUTHOR}/widget/IAH.Signup.Invited`}\n    props={{\n      accountId,\n      referrerId: referrer ?? \"sking.near\",\n      NFT_CONTRACT,\n      tokens,\n      GD_CONTRACT,\n    }}\n  />\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sking.near/widget/IAH.Signup", "fact_widget_deployments_id": "72ef4fda8c42cd87ff5f9272e8a5ce5a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 4}
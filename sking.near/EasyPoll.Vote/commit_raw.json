{"tx_hash": "H2ydRyapFrRyeds2y9XWqfSrMBEy14Ag8eiXPVqsqUzb", "action_id_social": "3zeCoij3CsZbJZadX8YTp9wKSZeoM1P97Y4ohkCotkyP-0-widget", "block_id": 95772550, "block_timestamp": "2023-07-05T16:29:01.662Z", "signer_id": "sking.near", "widget_name": "EasyPoll.Vote", "source_code": "const hasVoted = props.hasVoted ?? false;\nconst src = props.src;\nconst widgetOwner = props.widgetOwner ?? \"sking.near\";\nconst blockHeight = props.blockHeight;\nconst { questions } = props.poll;\nconst userAnswers = props.userAnswers;\nconst humansOnly = props.poll.verifiedHumansOnly;\nconst isHuman = props.isHuman ?? false;\nconst alreadyVoted = userAnswers.length > 0;\nconst resultsHref = props.resultsHref ?? \"\";\nif (!questions) return <></>;\n\nif (!src) return \"Please provide poll src\";\n\nconst isUpcoming = props.poll.startTimestamp > Date.now();\nconst isEnded = props.poll.endTimestamp < Date.now();\n\nconst ViewResultsButton = () => (\n  <a href={resultsHref} className=\"text-decoration-none\">\n    <Widget\n      src=\"rubycop.near/widget/NDC.StyledComponents\"\n      props={{\n        Button: {\n          text: \"View Results\",\n          icon: <i className=\"bi bi-eye-fill\"></i>,\n          className: \"primary d-flex flex-row-reverse gap-2 align-items-center\",\n          onClick: () => {},\n        },\n      }}\n    />\n  </a>\n);\n\nif (isEnded) {\n  return (\n    <div\n      className=\"d-flex flex-column gap-3 justify-content-center align-items-center\"\n      style={{\n        border: \"1.5px solid #4f46e520\",\n        padding: \"60px 12px\",\n        borderRadius: \"16px\",\n      }}\n    >\n      <span\n        style={{\n          fontWeight: \"bold\",\n          fontsize: 15,\n          color: \"#239f28\",\n        }}\n      >\n        Vote Ended!\n      </span>\n      <ViewResultsButton />\n    </div>\n  );\n}\n\nif (isUpcoming) {\n  return (\n    <div\n      className=\"d-flex flex-column gap-3 justify-content-center align-items-center\"\n      style={{\n        border: \"1.5px solid #4f46e520\",\n        padding: \"60px 12px\",\n        borderRadius: \"16px\",\n      }}\n    >\n      <span\n        style={{\n          fontWeight: \"bold\",\n          fontsize: 15,\n          color: \"#239f28\",\n        }}\n      >\n        Vote Begins:{\" \"}\n        <span style={{ color: \"#000\" }}>\n          {new Date(Date(poll.startTimestamp)).toLocaleString()}\n        </span>\n      </span>\n    </div>\n  );\n}\n\nif (humansOnly && !isHuman) {\n  return (\n    <div\n      className=\"d-flex flex-column gap-3 justify-content-center align-items-center\"\n      style={{\n        border: \"1.5px solid #4f46e520\",\n        padding: \"60px 12px\",\n        borderRadius: \"16px\",\n      }}\n    >\n      <img\n        height={80}\n        width={80}\n        style={{\n          marginBottom: 6,\n          marginLeft: 6,\n        }}\n        src=\"data:image/png;base64,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\"\n      />\n      <span\n        style={{\n          fontWeight: \"bold\",\n          fontsize: 15,\n          color: \"#000\",\n        }}\n      >\n        This poll requires Human Verification. Complete the verification process\n        to cast your vote.\n      </span>\n      <a\n        href=\"https://i-am-human.app\"\n        target=\"_blank\"\n        className=\"text-decoration-none\"\n      >\n        <Widget\n          src=\"rubycop.near/widget/NDC.StyledComponents\"\n          props={{\n            Button: {\n              text: \"Verify as Human\",\n              icon: (\n                // should be replaced with I-AM-HUMAN logo svg but I couldn't find it :(\n                <img\n                  height={25}\n                  width={25}\n                  style={{\n                    filter: \"brightness(100)\",\n                  }}\n                  src=\"data:image/png;base64,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\"\n                />\n              ),\n              className: \"primary dark d-flex gap-2 align-items-center\",\n              onClick: () => {},\n            },\n          }}\n        />\n      </a>\n    </div>\n  );\n}\n\nState.init({\n  step: 0,\n  form: {\n    0: {\n      value: \"\",\n      error: null,\n    },\n  },\n});\n\nconst currentQuestion = questions[state.step];\n\nconst ipfsUrl = (cid) => `https://ipfs.near.social/ipfs/${cid}`;\n\nconst handleNext = () => {\n  if (state.form[state.step].error) return;\n\n  if (questions.length === state.step) {\n    return onFinish();\n  }\n  State.update({\n    step: questions.length === state.step ? state.step : state.step + 1,\n  });\n};\nconst handlePrev = () => {\n  State.update({\n    step: state.step - 1,\n  });\n};\n\nconst onFormFieldChange = (step, key, value) => {\n  State.update({\n    ...state,\n    form: {\n      ...state.form,\n      [step]: {\n        ...state.form[step],\n        [key]: value,\n      },\n    },\n  });\n};\n\nconst onValidate = (value, setError, options) => {\n  if (options.required) {\n    if (!value || value === \"\" || value.length < 1) {\n      return setError(\"This field is required\");\n    }\n  }\n\n  if (options.minLength) {\n    if (value.length < options.minLength) {\n      return setError(\n        `Input is too short. Minimum length is ${options.minLength} characters.`\n      );\n    }\n  }\n\n  if (options.maxLength) {\n    if (value.length > options.maxLength) {\n      return setError(\n        `Input is too long. Maximum length is ${options.maxLength} characters.`\n      );\n    }\n  }\n\n  if (options.custom) {\n    const customError = options.custom(value);\n    if (customError) {\n      return setError(customError);\n    }\n  }\n\n  setError(null);\n};\n\nconst formatStateForDB = (input) => {\n  let answers = input;\n\n  Object.keys(answers).forEach((key, index) => {\n    answers[key] = answers[key].value;\n  });\n\n  return {\n    answers: answers,\n    timestamp: Date.now(),\n    pollBlockHeight: blockHeight,\n  };\n};\n\nconst onFinish = () => {\n  const formattedAnswers = formatStateForDB(state.form);\n\n  const commit = {\n    index: {\n      easypoll_answer: JSON.stringify(\n        {\n          key: `${src}`,\n          value: formattedAnswers,\n        },\n        undefined,\n        0\n      ),\n    },\n  };\n\n  State.update({ commitLoading: true });\n  Social.set(commit, {\n    force: true,\n    onCommit: () => {\n      State.update({ commitLoading: false, committed: true });\n    },\n    onCancel: () => {\n      State.update({ commitLoading: false });\n    },\n  });\n};\n\nif (state.committed) {\n  return (\n    <div\n      className=\"text-center d-flex flex-column align-items-center flex-wrap\"\n      style={{\n        padding: \"60px 12px\",\n        color: \"#239f28\",\n      }}\n    >\n      <i\n        className=\"bi bi-check-circle\"\n        style={{\n          fontSize: 60,\n        }}\n      />\n      <span\n        style={{\n          fontWeight: \"bold\",\n          fontsize: 15,\n          color: \"#239f28\",\n          marginBottom: 10,\n        }}\n      >\n        Voted Successfully!\n      </span>\n\n      <ViewResultsButton />\n    </div>\n  );\n}\n\nif (state.commitLoading) {\n  return (\n    <div\n      className=\"d-flex flex-column gap-1\"\n      style={{\n        border: \"1.5px solid #4f46e520\",\n        padding: \"60px 12px\",\n        borderRadius: \"16px\",\n      }}\n    >\n      <Widget\n        src={`sking.near/widget/Common.Spinner`}\n        props={{\n          color1: \"#ffd50d\",\n          color2: \"#4f46e5\",\n        }}\n      />\n      <span\n        style={{\n          fontWeight: \"bold\",\n          fontsize: 15,\n          color: \"#4f46e5\",\n          textAlign: \"center\",\n        }}\n      >\n        Saving...\n      </span>\n    </div>\n  );\n}\n\nreturn (\n  <div\n    className=\"d-flex flex-column gap-1\"\n    style={{\n      border: \"1.5px solid #4f46e520\",\n      padding: \"12px\",\n      borderRadius: \"16px\",\n    }}\n  >\n    {alreadyVoted && (\n      <div\n        className=\"py-2 d-flex align-content-center gap-1\"\n        style={{\n          fontWeight: \"bold\",\n          fontsize: 15,\n          color: \"#239f28\",\n        }}\n      >\n        <i className=\"bi bi-check-lg h5\" />\n        <span className=\"me-auto\">You've already voted</span>\n        <ViewResultsButton />\n      </div>\n    )}\n    <div className=\"d-flex\">\n      <p\n        style={{\n          backgroundColor: \"#4f46e5\",\n          color: \"#ffd50d\",\n          borderRadius: \"100px\",\n          minWidth: 36,\n          height: 36,\n          fontSize: 17,\n          fontWeight: \"700\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n        }}\n      >\n        {state.step + 1}\n      </p>\n      <div\n        style={{\n          fontWeight: \"700\",\n          fontSize: currentQuestion.question.length > 200 ? 17 : 24,\n          marginLeft: \"15px\",\n          maxHeight: 1000,\n          overflow: \"auto\",\n        }}\n      >\n        <Markdown text={currentQuestion.question} />\n      </div>\n    </div>\n\n    {currentQuestion.imageIPFS && (\n      <div className=\"d-flex w-100 mb-3\">\n        <img\n          src={ipfsUrl(currentQuestion.imageIPFS)}\n          style={{\n            maxHeight: 400,\n            minHeight: 200,\n            maxWidth: \"100%\",\n            minWidth: \"100px\",\n            objectFit: \"contain\",\n          }}\n        />\n      </div>\n    )}\n\n    {(currentQuestion.questionType === \"0\" ||\n      currentQuestion.questionType === \"1\" ||\n      currentQuestion.questionType === \"2\") && (\n      <Widget\n        src={`${widgetOwner}/widget/EasyPoll.Inputs.Choices`}\n        props={{\n          label:\n            currentQuestion.questionType === \"0\" ||\n            currentQuestion.questionType === \"1\"\n              ? \"Select one option:\"\n              : \"Select multiple options:\",\n          placeholder: \"Type Your Answer Here...\",\n          value: alreadyVoted\n            ? userAnswers[0].value.answers[state.step]\n            : state.form[state.step].value,\n          error: state.form[state.step].error,\n          onChange: (v) => onFormFieldChange(state.step, \"value\", v),\n          choices:\n            currentQuestion.questionType === \"0\"\n              ? [\"Yes\", \"No\"]\n              : currentQuestion.choicesOptions,\n          type: currentQuestion.questionType === \"2\" ? \"multiple\" : \"single\",\n          disabled: alreadyVoted,\n        }}\n      />\n    )}\n    {currentQuestion.questionType === \"3\" && (\n      <Widget\n        src={`${widgetOwner}/widget/EasyPoll.Inputs.Text`}\n        props={{\n          label: \"Answer\",\n          placeholder: \"Type Your Answer Here...\",\n          value: alreadyVoted\n            ? userAnswers[0].value.answers[state.step]\n            : state.form[state.step].value,\n          error: state.form[state.step].error,\n          onChange: (v) => onFormFieldChange(state.step, \"value\", v),\n          validate: () =>\n            onValidate(\n              state.form[state.step].value,\n              (e) => onFormFieldChange(state.step, \"error\", e),\n              {\n                maxLength: 2000,\n              }\n            ),\n          inputProps: {\n            maxLength: 2000,\n            autoFocus: true,\n          },\n          textarea: true,\n          disabled: alreadyVoted,\n        }}\n      />\n    )}\n\n    <Widget\n      src={`${widgetOwner}/widget/EasyPoll.Inputs.Footer`}\n      props={{\n        hasNext: questions.length > 1 && state.step !== questions.length - 1,\n        onNext: handleNext,\n        hasSubmit: !alreadyVoted && state.step === questions.length - 1,\n        onSubmit: onFinish,\n        hasPrev: state.step > 0,\n        onPrev: handlePrev,\n      }}\n    />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sking.near/widget/EasyPoll.Vote", "fact_widget_deployments_id": "5fa1ee6b0103719d1aca100ade62211e", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
{"tx_hash": "DArYzjcTRj62hx6AqwGosq6rUd33pzA8sgGtAEjMnNhJ", "action_id_social": "8r23ZEj79DDkG2xfzPJsan5wfKeQDbrTsRdCtTNYVkJF-0-widget", "block_id": 111028701, "block_timestamp": "2024-01-22T10:04:09.862Z", "signer_id": "devj.near", "widget_name": "Wordle.Profile", "source_code": "State.init({\n  loading: true,\n});\n\nconst CONTRACT = \"w0rdle.near\";\nconst API = \"https://nearwordle.com/api\";\n\nconst headers = {\n  \"Content-Type\": \"application/json\",\n  \"X-Account-ID\": context.accountId,\n  \"X-Auth-Key\": props.key,\n};\n\nconst loadProfile = () => {\n  asyncFetch(`${API}/profile/info`, {\n    method: \"GET\",\n    headers,\n  }).then((resProfile) => {\n    if (!resProfile.ok) return props.handleToast(\"error\", \"Error\", \"\");\n    if (resProfile.body.error)\n      return props.handleToast(\n        \"error\",\n        \"Fail to load the pr\",\n        res.body.message\n      );\n\n    Near.asyncView(CONTRACT, \"get_score\", {\n      accountId: context.accountId,\n    }).then((score) => {\n      State.update({\n        profile: { ...resProfile.body.profile, score },\n        loading: false,\n      });\n    });\n  });\n};\n\nconst ProgressBar = ({ proportion }) => {\n  const width = (proportion * 100).toFixed(2) + \"%\";\n\n  return (\n    <div\n      className=\"progress\"\n      style={{ height: \"1rem\", backgroundColor: \"transparent\" }}\n    >\n      <div\n        className=\"progress-bar rounded\"\n        style={{\n          width: width,\n          background: \"linear-gradient(to right, #0E9045, #17B52D)\",\n        }}\n      ></div>\n    </div>\n  );\n};\n\nconst Attempts = ({ number, proportion, wins }) => {\n  return (\n    <div class=\"d-flex justify-content-center align-items-center text-white py-1\">\n      <div class=\"col-1 text-center\">{number}</div>\n      <div class=\"col-8\">\n        <ProgressBar proportion={proportion} />\n      </div>\n      <div\n        class=\"col-3 text-center rounded ms-2\"\n        style={{\n          backgroundColor: \"#053036\",\n        }}\n      >\n        {wins}\n      </div>\n    </div>\n  );\n};\n\nconst InfoItem = ({ title, value }) => (\n  <div class=\"col-3 text-center text-white\">\n    <div class=\"fs-4 fw-bold\">{value}</div>\n    <div style={{ fontSize: \"12px\" }}>{title}</div>\n  </div>\n);\n\nuseEffect(() => {\n  loadProfile();\n}, []);\n\nif (state.loading)\n  return <p class=\"text-center text-white py-4\">Loading ...</p>;\n\nif (!state.loading) {\n  const wins = state.profile.guessDistribution.reduce(\n    (acc, val) => acc + val,\n    0\n  );\n  const played = wins + state.profile.lost;\n  return (\n    <div class=\"container\">\n      <div class=\"row justify-content-center\">\n        <div class=\"col-12 col-md-10 col-lg-8 col-xl-6\">\n          <div\n            class=\"rounded p-3\"\n            style={{ backgroundColor: \"rgba(5, 48, 54, 0.5)\" }}\n          >\n            <h4 class=\"text-white text-center\">GUESS DISTRIBUTION</h4>\n            <div class=\"mt-1\">\n              {state.profile.guessDistribution.map((g, i) => (\n                <Attempts number={i + 1} proportion={g / wins} wins={g} />\n              ))}\n            </div>\n\n            <h4 class=\"text-white text-center mt-2\">STATISTICS</h4>\n            <div\n              class=\"row rounded mx-0 py-1\"\n              style={{ backgroundColor: \"#053036\" }}\n            >\n              <InfoItem title=\"Played\" value={played} />\n              <InfoItem\n                title=\"Win %\"\n                value={wins > 0 ? (wins / played).toFixed(2) * 100 : 0}\n              />\n              <InfoItem\n                title=\"Current Streak\"\n                value={state.profile.currentStreak}\n              />\n              <InfoItem title=\"Max Streak\" value={state.profile.maxStreak} />\n            </div>\n            <div class=\"row align-items-center text-white mt-2 px-4\">\n              <div class=\"col-10 text-left\">{context.accountId}</div>\n              <div class=\"col-2 text-end fw-bold fs-4\">\n                {state.profile.score || 0}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n", "metadata": {"platform": "jutsu.ai"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/devj.near/widget/Wordle.Profile", "fact_widget_deployments_id": "95cece1a03530951f2ec2dde68ae8262", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
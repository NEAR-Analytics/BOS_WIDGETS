{"tx_hash": "257TMrmvtTxxhUhVA5GpQCz4F2bLsFNynsjFQUsiMUpd", "action_id_social": "3z4srJQcCZsgxZbZK26xuU5aRvA3ZDFxndG9ChU4SBS1-0-widget", "block_id": 120621570, "block_timestamp": "2024-06-07T07:23:49.573Z", "signer_id": "megha19.near", "widget_name": "near-prpsls-bos.components.molecule.AccountInput", "source_code": "/*\nLicense: MIT\nAuthor: devhub.near\nHomepage: https://github.com/NEAR-DevHub/near-prpsls-bos#readme\n*/\n/* INCLUDE: \"includes/common.jsx\" */\nconst REPL_DEVHUB = \"devhub.near\";\nconst REPL_INFRASTRUCTURE_COMMITTEE = \"megha19.near\";\nconst REPL_INFRASTRUCTURE_COMMITTEE_CONTRACT = \"truedove38.near\";\nconst REPL_RPC_URL = \"https://rpc.mainnet.near.org\";\nconst REPL_NEAR = \"near\";\nconst REPL_SOCIAL_CONTRACT = \"social.near\";\nconst RFP_IMAGE =\n  \"https://ipfs.near.social/ipfs/bafkreicbygt4kajytlxij24jj6tkg2ppc2dw3dlqhkermkjjfgdfnlizzy\";\n\nconst RFP_FEED_INDEXER_QUERY_NAME =\n  \"polyprogrammist_near_devhub_objects_s_rfps_with_latest_snapshot\";\n\nconst RFP_INDEXER_QUERY_NAME =\n  \"polyprogrammist_near_devhub_objects_s_rfp_snapshots\";\n\nconst PROPOSAL_FEED_INDEXER_QUERY_NAME =\n  \"polyprogrammist_near_devhub_objects_s_proposals_with_latest_snapshot\";\n\nconst PROPOSAL_QUERY_NAME =\n  \"polyprogrammist_near_devhub_objects_s_proposal_snapshots\";\nconst RFP_TIMELINE_STATUS = {\n  ACCEPTING_SUBMISSIONS: \"ACCEPTING_SUBMISSIONS\",\n  EVALUATION: \"EVALUATION\",\n  PROPOSAL_SELECTED: \"PROPOSAL_SELECTED\",\n  CANCELLED: \"CANCELLED\",\n};\n\nconst PROPOSAL_TIMELINE_STATUS = {\n  DRAFT: \"DRAFT\",\n  REVIEW: \"REVIEW\",\n  APPROVED: \"APPROVED\",\n  REJECTED: \"REJECTED\",\n  CANCELED: \"CANCELLED\",\n  APPROVED_CONDITIONALLY: \"APPROVED_CONDITIONALLY\",\n  PAYMENT_PROCESSING: \"PAYMENT_PROCESSING\",\n  FUNDED: \"FUNDED\",\n};\n\nconst QUERYAPI_ENDPOINT = `https://near-queryapi.api.pagoda.co/v1/graphql`;\n\nasync function fetchGraphQL(operationsDoc, operationName, variables) {\n  return asyncFetch(QUERYAPI_ENDPOINT, {\n    method: \"POST\",\n    headers: { \"x-hasura-role\": `polyprogrammist_near` },\n    body: JSON.stringify({\n      query: operationsDoc,\n      variables: variables,\n      operationName: operationName,\n    }),\n  });\n}\n\nconst CANCEL_RFP_OPTIONS = {\n  CANCEL_PROPOSALS: \"CANCEL_PROPOSALS\",\n  UNLINK_PROPOSALS: \"UNLINK_PROPOSALSS\",\n  NONE: \"NONE\",\n};\n\nfunction parseJSON(json) {\n  if (typeof json === \"string\") {\n    try {\n      return JSON.parse(json);\n    } catch (error) {\n      return json;\n    }\n  } else {\n    return json;\n  }\n}\n\nfunction isNumber(value) {\n  return typeof value === \"number\";\n}\n\nconst PROPOSALS_APPROVED_STATUS_ARRAY = [\n  PROPOSAL_TIMELINE_STATUS.APPROVED,\n  PROPOSAL_TIMELINE_STATUS.APPROVED_CONDITIONALLY,\n  PROPOSAL_TIMELINE_STATUS.PAYMENT_PROCESSING,\n  PROPOSAL_TIMELINE_STATUS.FUNDED,\n];\n\nfunction getLinkUsingCurrentGateway(url) {\n  const data = fetch(`https://httpbin.org/headers`);\n  const gatewayURL = data?.body?.headers?.Origin ?? \"\";\n  return `https://${\n    gatewayURL.includes(\"near.org\") ? \"dev.near.org\" : \"near.social\"\n  }/${url}`;\n}\n/* END_INCLUDE: \"includes/common.jsx\" */\n\nconst value = props.value;\nconst placeholder = props.placeholder;\nconst onUpdate = props.onUpdate;\n\nconst [account, setAccount] = useState(value);\nconst [showAccountAutocomplete, setAutoComplete] = useState(false);\nconst [isValidAccount, setValidAccount] = useState(true);\nconst AutoComplete = styled.div`\n  margin-top: 1rem;\n`;\n\nuseEffect(() => {\n  if (value !== account) {\n    setAccount(value);\n  }\n}, [value]);\n\nuseEffect(() => {\n  if (value !== account) {\n    onUpdate(account);\n  }\n}, [account]);\n\nuseEffect(() => {\n  const handler = setTimeout(() => {\n    const valid = account.length === 64 || (account ?? \"\").includes(\".near\");\n    setValidAccount(valid);\n    setAutoComplete(!valid);\n  }, 100);\n\n  return () => {\n    clearTimeout(handler);\n  };\n}, [account]);\n\nreturn (\n  <div>\n    <Widget\n      src={`${REPL_DEVHUB}/widget/devhub.components.molecule.Input`}\n      props={{\n        className: \"flex-grow-1\",\n        value: account,\n        onChange: (e) => {\n          setAccount(e.target.value);\n        },\n        skipPaddingGap: true,\n        placeholder: placeholder,\n        inputProps: {\n          max: 64,\n          prefix: \"@\",\n        },\n      }}\n    />\n    {account && !isValidAccount && (\n      <div style={{ color: \"red\" }} className=\"text-sm mt-1\">\n        Please enter valid account ID\n      </div>\n    )}\n    {showAccountAutocomplete && (\n      <AutoComplete>\n        <Widget\n          src={`${REPL_DEVHUB}/widget/devhub.components.molecule.AccountAutocomplete`}\n          props={{\n            term: account,\n            onSelect: (id) => {\n              setAccount(id);\n              setAutoComplete(false);\n            },\n            onClose: () => setAutoComplete(false),\n          }}\n        />\n      </AutoComplete>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/megha19.near/widget/near-prpsls-bos.components.molecule.AccountInput", "fact_widget_deployments_id": "a425eb8af3cbafd226e786df5daddee5", "inserted_timestamp": "2024-06-07T09:04:48.590Z", "modified_timestamp": "2024-06-07T09:04:48.590Z", "__row_index": 0}
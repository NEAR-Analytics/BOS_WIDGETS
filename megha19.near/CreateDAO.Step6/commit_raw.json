{"tx_hash": "4QWMmx64XRQt9wyWf1wax6Si7oYvd3EX8nHTEjGfpqak", "action_id_social": "FuCcHUF8qsfYtwZCGpbwZExaLVeyN5gfyH5uPN56pjJG-0-widget", "block_id": 111351654, "block_timestamp": "2024-01-26T10:04:45.933Z", "signer_id": "megha19.near", "widget_name": "CreateDAO.Step6", "source_code": "const {\n  formState,\n  errors,\n  renderFooter,\n  showSteps,\n  showCreateNewDAOInfo,\n  isConfigScreen,\n  updateParentState\n} = props;\n\nupdateParentState || (updateParentState = () => {});\n\nconst initialAnswers = {\n  profileImage: formState.profileImage ?? formState.flagLogo,\n  coverImage: formState.coverImage ?? formState.flagCover\n};\n\nState.init({\n  answers: initialAnswers\n});\n\nconst onValueChange = (key, value) => {\n  State.update({\n    answers: {\n      ...state.answers,\n      [key]: value\n    }\n  });\n};\n\nconst Profile = styled.div`\n  .avatar {\n    width: 15%;\n    max-width: 180px;\n    min-width: 100px;\n    margin-left: 50px;\n    transform: translateY(-50%);\n    background-color: #eee;\n    background-size: cover;\n    background-position: center;\n  }\n`;\n\nconst BG = styled.div`\n  --bs-aspect-ratio: 16%;\n  background-color: #eee;\n  background-size: cover;\n  background-position: center;\n  min-height: 120px;\n`;\n\nconst renderUploadButton = ({ onChange, value }) => {\n  return (\n    <Widget\n      src=\"nearui.near/widget/Social.ImageUpload\"\n      props={{\n        onChange: onChange,\n        value: value,\n        uploadButton: (otherProps) => (\n          <Widget\n            src=\"nearui.near/widget/Input.Button\"\n            props={{\n              children: <i className=\"bi bi-pen\" />,\n              variant: \"icon  info\",\n              size: \"md\",\n              className: \"position-absolute bottom-0 end-0 m-3\",\n              ...otherProps\n            }}\n          />\n        ),\n        deleteButton: (otherProps) => (\n          <Widget\n            src=\"nearui.near/widget/Input.Button\"\n            props={{\n              children: <i className=\"bi bi-trash\" />,\n              variant: \"icon  danger\",\n              size: \"md\",\n              className: \"position-absolute bottom-0 end-0 m-3\",\n              ...otherProps\n            }}\n          />\n        ),\n        loadingButton: (otherProps) => (\n          <Widget\n            src=\"nearui.near/widget/Input.Button\"\n            props={{\n              children: (\n                <div\n                  class=\"spinner-border text-light\"\n                  style={{\n                    width: \"1.1rem\",\n                    height: \"1.1rem\",\n                    borderWidth: \"0.15em\"\n                  }}\n                  role=\"status\"\n                ></div>\n              ),\n              variant: \"icon info\",\n              size: \"md\",\n              className: \"position-absolute bottom-0 end-0 m-3\",\n              ...otherProps\n            }}\n          />\n        )\n      }}\n    />\n  );\n};\n\nconst renderAssetsEditor = (hideEditButtons) => {\n  return (\n    <Profile\n      className=\"overflow-hidden w-100\"\n      style={{\n        marginBottom: \"-40px\"\n      }}\n    >\n      <BG\n        className=\"ratio rounded-4\"\n        style={{\n          backgroundImage: `url(${state.answers.coverImage})`\n        }}\n      >\n        <div>\n          {!hideEditButtons &&\n            renderUploadButton({\n              onChange: (v) => onValueChange(\"coverImage\", v),\n              value: state.answers.coverImage\n            })}\n        </div>\n      </BG>\n      <div\n        className=\"avatar rounded-4 border border-2 border-white ratio ratio-1x1 position-relative z-1\"\n        style={{\n          backgroundImage: `url(${state.answers.profileImage})`\n        }}\n      >\n        <div>\n          {!hideEditButtons &&\n            renderUploadButton({\n              onChange: (v) => onValueChange(\"profileImage\", v),\n              value: state.answers.profileImage\n            })}\n        </div>\n      </div>\n    </Profile>\n  );\n};\n\nconst daoPreviewState = `\n\\`\\`\\`json\n${JSON.stringify({ ...formState, ...state.answers }, null, 2)}\n\\`\\`\\`\n`;\n\nuseEffect(() => {\n  let timeoutId;\n\n  // Debounced function to update parent state\n  const debouncedUpdate = (value) => {\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => {\n      updateParentState(value);\n    }, 300); // Adjust the debounce delay as needed\n  };\n\n  // Call the debounced function when local value changes\n  debouncedUpdate({ ...formState, ...state.answers });\n\n  return () => {\n    // Cleanup on unmount\n    clearTimeout(timeoutId);\n  };\n}, [state.answers]);\n\nreturn (\n  <div className=\"mt-4 ndc-card p-4\">\n    <div className=\"d-flex flex-column gap-2\">\n      <div className=\"d-flex gap-2 justify-content-between align-items-center\">\n        {showSteps && (\n          <h2 className=\"h5 fw-bold\">\n            <span\n              className=\"rounded-circle d-inline-flex align-items-center justify-content-center fw-bolder h5 me-2 mb-0\"\n              style={{\n                width: \"48px\",\n                height: \"48px\",\n                border: \"1px solid #82E299\"\n              }}\n            >\n              6\n            </span>\n            Create DAO Assets\n          </h2>\n        )}\n        {!isConfigScreen && (\n          <Widget\n            src=\"megha19.near/widget/Layout.Modal\"\n            props={{\n              content: (\n                <div className=\"ndc-card p-4\">\n                  <h3 className=\"h6 fw-bold\">DAO Preview</h3>\n                  <Markdown text={daoPreviewState} />\n                  {renderFooter(state.answers, {\n                    hasPrevious: false\n                  })}\n                </div>\n              ),\n              toggle: (\n                <Widget\n                  src=\"nearui.near/widget/Input.Button\"\n                  props={{\n                    children: \"Preview DAO\",\n                    variant: \"outline info\",\n                    size: \"lg\"\n                  }}\n                />\n              )\n            }}\n          />\n        )}\n      </div>\n      <div className=\"d-flex gap-2 justify-content-between align-items-center\">\n        <div>\n          <h3 className=\"h6 fw-bold\">Set profile image and background image</h3>\n          <p className=\"text-black-50 fw-light small\">\n            Update the DAO profile image and background images below\n          </p>\n        </div>\n        <Widget\n          src=\"megha19.near/widget/Layout.Modal\"\n          props={{\n            content: (\n              <div className=\"ndc-card p-4\">\n                <h3 className=\"h5 fw-bold mb-4\">Preview DAO Assets</h3>\n                <h4 className=\"h6 fw-bold mb-2\">Profile & Background Image</h4>\n                {renderAssetsEditor(true)}\n                <h4 className=\"h6 fw-bold mb-2\">DAO Name</h4>\n                <h5 className=\"h5 fw-bold\">{formState.name}</h5>\n              </div>\n            ),\n            toggle: (\n              <Widget\n                src=\"nearui.near/widget/Input.Button\"\n                props={{\n                  children: (\n                    <>\n                      Preview DAO Assets <i className=\"bi bi-eye\" />\n                    </>\n                  ),\n                  variant: \"outline info\",\n                  size: \"lg\"\n                }}\n              />\n            )\n          }}\n        />\n      </div>\n      {renderAssetsEditor()}\n      {showCreateNewDAOInfo && (\n        <div\n          className=\"d-flex gap-2 flex-column p-3 rounded-4\"\n          style={{\n            border: \"1px solid #4498e0\"\n          }}\n        >\n          <h3 className=\"h6 fw-bold d-flex align-items-center\">\n            <i\n              className=\"bi bi-info-circle me-2\"\n              style={{\n                color: \"#4498e0\",\n                fontSize: \"22px\"\n              }}\n            />\n            Create a new DAO costs 6 NEAR.\n          </h3>\n          <p className=\"mb-0\">\n            The 6 NEAR will be used to pay for the contract deployment and\n            storage.\n          </p>\n        </div>\n      )}\n    </div>\n\n    {renderFooter(state.answers)}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/megha19.near/widget/CreateDAO.Step6", "fact_widget_deployments_id": "4f485a59f204809fa4ed83c89d18d205", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
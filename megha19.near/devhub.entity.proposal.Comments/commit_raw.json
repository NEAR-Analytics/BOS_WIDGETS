{"tx_hash": "T94qvx5ANRKD1jT5MXUoJybX8f7X2DwRoaSxsivGhWk", "action_id_social": "DS7tVQFdK8775Qhd2cp2GSbdhh6MqXsdHDij8VTjTjqL-0-widget", "block_id": 113732888, "block_timestamp": "2024-02-28T05:56:04.112Z", "signer_id": "megha19.near", "widget_name": "devhub.entity.proposal.Comments", "source_code": "const socialComments = Social.index(\"comment\", props.item);\n\nconst [showReplyIndex, setShowReplyIndex] = useState(null);\n\nconst CommentContainer = styled.div`\n  border: 1px solid lightgrey;\n`;\n\nconst Header = styled.div`\n  position: relative;\n  background-color: #f4f4f4;\n  height: 50px;\n\n  .menu {\n    position: absolute;\n    right: 10px;\n    top: 4px;\n    font-size: 30px;\n  }\n`;\n\nconst Comment = ({ commentItem, arrayIndex }) => {\n  const { accountId, blockHeight } = commentItem;\n  const item = {\n    type: \"social\",\n    path: `${accountId}/post/comment`,\n    blockHeight,\n  };\n  const content = JSON.parse(Social.get(item.path, blockHeight) ?? \"null\");\n\n  const optimisticallyHideItem = (message) => {\n    console.log(message);\n  };\n  const resolveHideItem = (message) => {\n    console.log(message);\n  };\n  const cancelHideItem = () => {};\n\n  const extractNotifyAccountId = (item) => {\n    if (!item || item.type !== \"social\" || !item.path) {\n      return undefined;\n    }\n    const accountId = item.path.split(\"/\")[0];\n    return `${accountId}/post/main` === item.path ? accountId : undefined;\n  };\n  const parentItem = content.item;\n  const link = `https://near.org/mob.near/widget/MainPage.N.Comment.Page?accountId=${accountId}&blockHeight=${blockHeight}`;\n  return (\n    <div>\n      <div className=\"d-flex gap-2 flex-1\">\n        <Widget\n          src={\"megha19.near/widget/devhub.entity.proposal.Profile\"}\n          props={{\n            accountId: accountId,\n          }}\n        />\n        <CommentContainer className=\"rounded-2 flex-1\">\n          <Header className=\"d-flex gap-3 align-items-center p-2 px-3\">\n            <div>\n              {accountId} commented\n              <Widget\n                src=\"near/widget/TimeAgo\"\n                props={{\n                  blockHeight: blockHeight,\n                }}\n              />\n            </div>\n            {context.accountId && (\n              <div className=\"menu\">\n                <Widget\n                  src=\"near/widget/Posts.Menu\"\n                  props={{\n                    accountId: accountId,\n                    blockHeight: blockHeight,\n                    contentPath: `/post/comment`,\n                    contentType: \"comment\",\n                    parentFunctions: {\n                      optimisticallyHideItem,\n                      resolveHideItem,\n                      cancelHideItem,\n                    },\n                  }}\n                />\n              </div>\n            )}\n          </Header>\n          <div className=\"p-2 px-3\">\n            <Widget\n              src={\n                \"megha19.near/widget/devhub.components.molecule.MarkdownViewer\"\n              }\n              props={{\n                text: content.text,\n              }}\n            />\n\n            <div className=\"d-flex gap-2 align-items-center mt-4\">\n              <Widget\n                src=\"near/widget/v1.LikeButton\"\n                props={{\n                  item: item,\n                }}\n              />\n              <Widget\n                src=\"near/widget/CommentButton\"\n                props={{\n                  item: item,\n                  onClick: () => setShowReplyIndex(arrayIndex),\n                }}\n              />\n              <Widget\n                src=\"near/widget/CopyUrlButton\"\n                props={{\n                  url: link,\n                }}\n              />\n              <Widget\n                src=\"near/widget/ShareButton\"\n                props={{\n                  postType: \"post\",\n                  url: link,\n                }}\n              />\n            </div>\n          </div>\n        </CommentContainer>\n      </div>\n      {showReplyIndex === arrayIndex && (\n        <div className=\"my-4\" style={{ marginLeft: \"50px\" }} key=\"reply\">\n          <Widget\n            src=\"megha19.near/widget/devhub.entity.proposal.ComposeComment\"\n            props={{\n              notifyAccountId: extractNotifyAccountId(parentItem),\n              item: parentItem,\n            }}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nif (socialComments.length) {\n  return (\n    <div className=\"d-flex flex-column gap-4\">\n      {socialComments.map((i, index) => (\n        <Comment commentItem={i} arrayIndex={index} />\n      ))}\n    </div>\n  );\n}\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/megha19.near/widget/devhub.entity.proposal.Comments", "fact_widget_deployments_id": "871550d16b9fdac0aa17d20877e2e0f7", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
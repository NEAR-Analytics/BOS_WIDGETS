{"tx_hash": "F1hbjPPowarKuXWb7o1fKdk9RqEf6CfABNdGriRZRBTg", "action_id_social": "3TfiAaHtv9pNk1G2oyhD2sxk8rjz94jNJ24wtYQ46NF3-0-widget", "block_id": 113234744, "block_timestamp": "2024-02-20T17:59:13.932Z", "signer_id": "megha19.near", "widget_name": "neardevhub-trustees.components.trustee.Treasury", "source_code": "/*\nLicense: MIT\nAuthor: devhub.near\nHomepage: https://github.com/NEAR-DevHub/neardevhub-treasury-dashboard.git#readme\n*/\n/* INCLUDE: \"includes//common.jsx\" */\nconst REPL_TREASURY_CONTRACT = \"treasurydevhub.near\";\nconst REPL_TREASURY = \"megha19.near\";\n// \"dashboard.treasury-devdao.near\";\nconst REPL_DEVHUB = \"devhub.near\";\n// devhub.near;\nconst REPL_PROPOSAL_CONTRACT =\n  \"713ed9aef61d14ce3dfeb3f5a55dfdf16c407280267e8de96bce0953d0e1af8c\";\nconst REPL_NEAR = \"near\";\n/* END_INCLUDE: \"includes//common.jsx\" */\n\nconst Container = styled.div`\n  .bg-dark-grey {\n    background-color: #7e868c;\n  }\n  .text-white {\n    color: white;\n  }\n\n  .py-3 {\n    padding-block: 1rem !important;\n  }\n\n  .flex-item {\n    flex: 1;\n  }\n\n  .text-small {\n    font-size: 12px;\n    font-weight: 400;\n  }\n\n  .gap-10 {\n    gap: 5rem;\n  }\n`;\n\nfunction numberWithCommas(number) {\n  return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\nfunction convertYoctoToNear(yoctoNear) {\n  return (\n    <div className=\"d-flex gap-2 align-items-center\">\n      {numberWithCommas(Big(yoctoNear).div(Big(10).pow(24)).toFixed(3))}\n      <img\n        src=\"https://ipfs.near.social/ipfs/bafkreify3fv4w3yq2vmqe2nobsznpd4pdtkjolaia2c3wfx627zykxvmdi\"\n        height={15}\n      />\n    </div>\n  );\n}\n\nconst tokensRes = fetch(\n  `https://api.nearblocks.io/v1/account/${REPL_TREASURY_CONTRACT}/tokens`\n);\nconst tokensAndBalances = [];\nconst tokens = tokensRes.body.tokens.fts ?? [];\nfor (const token of tokens) {\n  const balance = Near.view(token, \"ft_balance_of\", {\n    account_id: REPL_TREASURY_CONTRACT,\n  });\n  const ftMetadata = Near.view(token, \"ft_metadata\");\n  if (balance !== null) {\n    tokensAndBalances.push({\n      token,\n      balance: balance\n        ? numberWithCommas(\n            Big(balance).div(Big(10).pow(ftMetadata.decimals)).toFixed()\n          )\n        : 0,\n      symbol: ftMetadata.symbol,\n      icon: ftMetadata.icon,\n    });\n  }\n}\nconst res = fetch(\n  `https://api.nearblocks.io/v1/account/${REPL_TREASURY_CONTRACT}`\n);\nconst txns = fetch(\n  `https://api.nearblocks.io/v1/account/${REPL_TREASURY_CONTRACT}/ft-txns/count`\n);\n\nif (res === null || txns === null) {\n  return <>Loading</>;\n}\n\nreturn (\n  <Container className=\"d-flex flex-column gap-4\">\n    <div className=\"h5 bold mb-0\">Treasury</div>\n    <div className=\"bg-dark-grey text-white p-3 py-3 d-flex gap-2 align-items-center rounded-4\">\n      <div className=\"flex-item d-flex gap-2 align-items-center\">\n        <div className=\"h3 bold\">{REPL_TREASURY_CONTRACT}</div>\n        <i\n          class=\"bi bi-copy\"\n          onClick={() => clipboard.writeText(REPL_TREASURY_CONTRACT)}\n        ></i>\n      </div>\n      <div className=\"flex-item d-flex gap-10 text-small\">\n        <div>\n          <p>NEAR</p>\n          <p className=\"h5 bold\">\n            {convertYoctoToNear(res.body?.account[0]?.amount)}\n          </p>\n        </div>\n        {tokensAndBalances.map((item) => (\n          <div>\n            <p>{item.symbol}</p>\n            <p className=\"h5 bold\">\n              {item.balance} {item.icon && <img src={item.icon} height={20} />}\n            </p>\n          </div>\n        ))}\n        <div>\n          <p>Transactions</p>\n          <p className=\"h5 bold\">{txns?.body?.txns?.[0]?.count}</p>\n        </div>\n      </div>\n      <div>\n        <img\n          src=\"https://ipfs.near.social/ipfs/bafkreicprzqio2e42dd5pk2cklqdxkwprukwac236air7gfxez6rgl57y4\"\n          height={25}\n        />\n      </div>\n    </div>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/megha19.near/widget/neardevhub-trustees.components.trustee.Treasury", "fact_widget_deployments_id": "d9b4a878bfefc3d47440e986d5e3acde", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "9QctyMmzaJjumN7q7Qv5tvkJfotsCTG9vTdqdKXzWQyJ", "action_id_social": "9mMxGuYUaDffJ1pJJ1y7Th3UcawuskVHJrPU1C3hWPLd-0-widget", "block_id": 106820207, "block_timestamp": "2023-11-29T18:09:42.465Z", "signer_id": "megha19.near", "widget_name": "devhub.page.communities", "source_code": "const { getAllCommunitiesMetadata, createCommunity } = VM.require(\n  \"megha19.near/widget/core.adapter.devhub-contract\"\n);\n\nif (!getAllCommunitiesMetadata || !createCommunity) {\n  return <p>Loading modules...</p>;\n}\n\nconst onCommunitySubmit = (inputs) =>\n  createCommunity({\n    inputs: {\n      ...inputs,\n\n      bio_markdown: [\n        \"This is a sample text about your community.\",\n        \"You can change it on the community configuration page.\",\n      ].join(\"\\n\"),\n\n      logo_url:\n        \"https://ipfs.near.social/ipfs/bafkreibysr2mkwhb4j36h2t7mqwhynqdy4vzjfygfkfg65kuspd2bawauu\",\n\n      banner_url:\n        \"https://ipfs.near.social/ipfs/bafkreic4xgorjt6ha5z4s5e3hscjqrowe5ahd7hlfc5p4hb6kdfp6prgy4\",\n    },\n  });\n\nconst [showSpawner, setShowSpawner] = useState(false);\n\nconst [searchKey, setSearchKey] = useState(\"\");\nconst [sort, setSort] = useState(\"\");\n\nconst communitiesMetadata = getAllCommunitiesMetadata();\n\nif (!communitiesMetadata) {\n  return <p>Loading...</p>;\n}\n\nconst SortedAndFiltered = (searchKey, sortBy) => {\n  let communities = (communitiesMetadata ?? []).reverse();\n\n  let filtered = [...communities];\n  if (searchKey !== \"\") {\n    filtered = communities.filter((community) =>\n      community.name.toLowerCase().includes(searchKey.toLowerCase())\n    );\n  }\n\n  let sortedCommunities = [...filtered];\n  if (sortBy !== \"\") {\n    sortedCommunities.sort((a, b) => {\n      let nameA = a.name.toLowerCase();\n      let nameB = b.name.toLowerCase();\n\n      if (nameA < nameB) {\n        return -1;\n      }\n      if (nameA > nameB) {\n        return 1;\n      }\n      return 0;\n    });\n\n    if (sortBy === \"z-a\") {\n      sortedCommunities.reverse();\n    }\n  }\n\n  return sortedCommunities;\n};\n\nconst CTA = styled.button`\n  all: unset;\n\n  color: #f4f4f4;\n\n  font-size: 16px;\n  font-style: normal;\n  font-weight: 700;\n  line-height: 20px; /* 125% */\n\n  border-radius: 4px;\n  background: #04a46e;\n\n  display: flex;\n  padding: 14px 16px;\n  align-items: center;\n  gap: 8px;\n\n  &:hover {\n    background: #555555;\n  }\n`;\n\nreturn (\n  <div className=\"w-100\">\n    <Widget src={`megha19.near/widget/devhub.components.island.banner`} />\n    <div style={{ background: \"#f4f4f4\" }}>\n      <div\n        className=\"d-flex justify-content-between p-4\"\n        style={{ backgroundColor: \"\" }}\n      >\n        <div className=\"d-flex flex-column gap-3 w-100\">\n          <h1\n            className=\"m-0 fs-4\"\n            style={{ color: \"#555555\", fontSize: \"1.5rem\" }}\n          >\n            Communities\n          </h1>\n\n          <div className=\"d-flex flex-column-reverse flex-sm-row gap-3 justify-content-between align-items-center\">\n            <div className=\"d-flex flex-column flex-sm-row col-12 col-sm-6 mt-3 mt-lg-0 align-items-center gap-4\">\n              <input\n                type=\"text\"\n                placeholder=\"\ud83d\udd0d Search Communities\"\n                className=\"form-control w-100\"\n                value={searchKey}\n                onChange={(e) => setSearchKey(e.target.value)}\n              />\n              <div class=\"dropdown\">\n                <button\n                  class=\"btn dropdown-toggle bg-white\"\n                  type=\"button\"\n                  data-bs-toggle=\"dropdown\"\n                  aria-expanded=\"false\"\n                >\n                  Sort: {sort?.toUpperCase() || \"Latest\"}\n                </button>\n                <ul class=\"dropdown-menu px-2 shadow\">\n                  <li\n                    onClick={() => setSort(\"\")}\n                    class=\"dropdown-item link-underline link-underline-opacity-0\"\n                  >\n                    Latest\n                  </li>\n                  <li\n                    onClick={() => setSort(\"a-z\")}\n                    class=\"dropdown-item link-underline link-underline-opacity-0\"\n                  >\n                    A-Z\n                  </li>\n                  <li\n                    onClick={() => setSort(\"z-a\")}\n                    class=\"dropdown-item link-underline link-underline-opacity-0\"\n                  >\n                    Z-A\n                  </li>\n                </ul>\n              </div>\n            </div>\n            {context.accountId && (\n              <div className=\"d-flex flex-column justify-content-center\">\n                <CTA onClick={() => setShowSpawner(!showSpawner)}>\n                  <i className=\"bi bi-plus-circle-fill me-1\"></i> Create\n                  Community\n                </CTA>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n      <div className=\"d-flex flex-wrap align-content-start gap-4 p-4 w-100 h-100\">\n        {showSpawner && (\n          <Widget\n            src=\"megha19.near/widget/devhub.entity.community.Spawner\"\n            props={{\n              data: null,\n              onSubmit: onCommunitySubmit,\n              onCancel: () => setShowSpawner(false),\n            }}\n          />\n        )}\n        <div class=\"container\">\n          <div class=\"row\">\n            {searchKey === \"\" && sort === \"\"\n              ? (communitiesMetadata ?? [])\n                  .reverse()\n                  .map((communityMetadata) => (\n                    <div className=\"col-lg-4 col-sm-6 col-12 mb-3\">\n                      <Widget\n                        src=\"megha19.near/widget/devhub.entity.community.Card\"\n                        props={{\n                          format: \"small\",\n                          isBannerEnabled: false,\n                          metadata: communityMetadata,\n                        }}\n                      />\n                    </div>\n                  ))\n              : SortedAndFiltered(searchKey, sort).map((communityMetadata) => (\n                  <div className=\"col-lg-4 col-sm-6 col-12 mb-3\">\n                    <Widget\n                      src=\"megha19.near/widget/devhub.entity.community.Card\"\n                      props={{\n                        format: \"small\",\n                        isBannerEnabled: false,\n                        metadata: communityMetadata,\n                      }}\n                    />\n                  </div>\n                ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/megha19.near/widget/devhub.page.communities", "fact_widget_deployments_id": "18c86651aff1f022097e127105b8e45b", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 44}
{"tx_hash": "857sNxqygERJd45drHigvddz9GaGgXMaMXt2QvCKk7U", "action_id_social": "FULvwdHsq3XpmdcnYzkjZhMy3PemondQXQxhDoaYLUj1-0-widget", "block_id": 100082811, "block_timestamp": "2023-08-31T13:40:07.455Z", "signer_id": "phlay.near", "widget_name": "NearBootCampDao.chat", "source_code": "const contract =\r\n  \"ece61a112fbb05b5ff96fd4d63cb259c4bae966477829666d46ddc4e5121d801\";\r\n\r\n// const contract = \"dev-1693432953630-60212178005082\";\r\n\r\n//Getting the messages from the contract\r\nconst messages = Near.view(contract, \"get_messages\", { limit: 20 });\r\n\r\n//State for the message input\r\nconst handleOnMouseEnter = () => {\r\n  State.update({ show: true });\r\n};\r\nconst handleOnMouseLeave = () => {\r\n  State.update({ show: false });\r\n};\r\n\r\n//initializing state\r\nState.init({ message: \"\", show: false });\r\n\r\n//functionality for sending messages\r\nconst sendMessage = () => {\r\n  if (state.message.length != 0) {\r\n    Near.call(contract, \"send\", {\r\n      text: state.message,\r\n    });\r\n  }\r\n};\r\n\r\n//getting logged in user\r\nconst accountId = context.accountId;\r\n\r\n//Using Styled Controls\r\nconst SendControls = styled.div`\r\n  display: flex;\r\n  gap: 1em;\r\n  margin: 0.5em;\r\n  position: sticky;\r\n  bottom: 10px;\r\n`;\r\nconst container = {\r\n  display: \"flex\",\r\n  flexDirection: \"column\",\r\n  width: \"100%\",\r\n  gap: 20,\r\n  backgroundColor: \"#010322\",\r\n  padding: \"0.5em 4vw\",\r\n};\r\nconst Header = styled.div`\r\n  width: 100%;\r\n  padding: 50px 0;\r\n  font-weight: 600;\r\n  font-size: 30px;\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 100;\r\n  background-color: #ffffff;\r\n`;\r\n\r\nconst Wrapper = styled.div`\r\n  background-color: #010322;\r\n`;\r\n\r\n//handling Overlay\r\nconst overlay = (\r\n  <div\r\n    className=\"border m-3 p-3 rounded-4 bg-white shadow\"\r\n    style={{ maxWidth: \"24em\", zIndex: 1070 }}\r\n    onMouseEnter={handleOnMouseEnter}\r\n    onMouseLeave={handleOnMouseLeave}\r\n  >\r\n    <h3>Create A Proposal</h3>\r\n    <div className=\"mb-3\">\r\n      <label htmlFor=\"exampleFormControlInput1\" className=\"form-label\">\r\n        Title\r\n      </label>\r\n      <input placeholder=\"Enter Title For Proposal\" />\r\n    </div>\r\n    <div className=\"mb-3\">\r\n      <label htmlFor=\"exampleFormControlInput1\" className=\"form-label\">\r\n        Description\r\n      </label>\r\n      <div>\r\n        <textarea placeholder=\"Enter Description For Proposal\" />\r\n      </div>\r\n    </div>\r\n    <button type=\"submit\">Submit</button>\r\n  </div>\r\n);\r\n\r\nreturn (\r\n  <Wrapper>\r\n    <Header>\r\n      <p>\ud83e\udd77\ud83c\udffb Near BootCamp 23 DAO \u26d3\ufe0f \ud83d\udd75\ufe0f\u200d\u2642\ufe0f</p>\r\n      <button>Chat</button>\r\n      <button>Proposals</button>\r\n    </Header>\r\n    <div style={container}>\r\n      {messages.reverse().map((message) => (\r\n        <div\r\n          style={{\r\n            alignSelf: `${accountId === message.author && \"flex-end\"}`,\r\n            maxWidth: \"250px\",\r\n            display: \"flex\",\r\n            flexDirection: \"row\",\r\n            alignItems: \"flex-end\",\r\n            gap: 5,\r\n          }}\r\n        >\r\n          {/* Profile Picture */}\r\n          {accountId !== message.author && (\r\n            <div style={{ width: \"40px\" }}>\r\n              <Widget\r\n                src=\"calebjacob.near/widget/AccountProfile\"\r\n                props={{\r\n                  accountId: message.author,\r\n                }}\r\n              />\r\n            </div>\r\n          )}\r\n          <div style={{ position: \"relative\" }}>\r\n            <p\r\n              style={{\r\n                backgroundColor: `${\r\n                  accountId === message.author ? \"#7933FF\" : \"#FFFFFF\"\r\n                }`,\r\n                borderRadius: \"12px\",\r\n                padding: \"10px\",\r\n                color: `${\r\n                  accountId === message.author ? \"#FFFFFF\" : \"#000000\"\r\n                }`,\r\n              }}\r\n            >\r\n              {message.text}\r\n            </p>\r\n            <div\r\n              style={{\r\n                fontSize: \"12px\",\r\n                color: \"#FFFFFF\",\r\n                position: \"absolute\",\r\n                bottom: \"-5px\",\r\n                left: `${message.author !== accountId ? 0 : \"90%\"}`,\r\n              }}\r\n            >\r\n              <Widget\r\n                src=\"andyh.near/widget/TimeAgo\"\r\n                props={{\r\n                  blockHeight: message.block_height,\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ))}\r\n      <SendControls>\r\n        <OverlayTrigger\r\n          show={state.show}\r\n          trigger={[\"click\", \"focus\"]}\r\n          delay={{ show: 250, hide: 300 }}\r\n          placement=\"auto\"\r\n          overlay={overlay}\r\n        >\r\n          <button onClick={handleOnMouseEnter}>\ud83d\udcc3</button>\r\n        </OverlayTrigger>\r\n        <input\r\n          type=\"text\"\r\n          onInput={(e) => State.update({ message: e.target.value })}\r\n          value={state.message}\r\n        />\r\n        <button\r\n          onClick={() => {\r\n            sendMessage();\r\n          }}\r\n        >\r\n          Send\r\n        </button>\r\n      </SendControls>\r\n    </div>\r\n  </Wrapper>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/phlay.near/widget/NearBootCampDao.chat", "fact_widget_deployments_id": "edba7449f5b6d4d54dc06c16d20e4064", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "9D6J4crTCy8rYQWTW4jCENVdm8ruKYFcAw9YhD5XoSPW", "action_id_social": "GL7Ye4aHYgNxwxKx7FTM5foyfHeARnL2wp1U8HfSX32s-0-widget", "block_id": 96554109, "block_timestamp": "2023-07-15T20:00:34.503Z", "signer_id": "nearefi.near", "widget_name": "ReFi.DAO.Propose.profileUpdate", "source_code": "const accountId = context.accountId;\n\nlet profile = Social.getr(`${daoId}/profile`);\n\nif (profile === null) {\n  return \"Loading...\";\n}\n\nconst groups = [`${accountId}`];\n\nState.init({\n  args: {\n    config: {\n      name: state.name,\n      purpose: state.purpose,\n      metadata: \"\",\n    },\n    policy: {\n      groups,\n    },\n  },\n  profile,\n  name,\n  isDao: false,\n  isAvailable: false,\n});\nconst daoId = props.daoId ?? \"refi.sputnik-dao.near\";\n\n// const daoId = state.name + \".sputnik-dao.near\";\nconst name = state.name;\n\nconst groupId = props.groupId ?? \"community\";\nconst policy = Near.view(daoId, \"get_policy\");\n\nconst deposit = policy.proposal_bond;\n\nconst profile_args = JSON.stringify({\n  data: {\n    [daoId]: {\n      profile: state.profile,\n    },\n  },\n});\n\nconst proposal_args = Buffer.from(profile_args, \"utf-8\").toString(\"base64\");\n\nconst handleProposal = () => {\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"update DAO profile on NEAR Social\",\n          kind: {\n            FunctionCall: {\n              receiver_id: \"social.near\",\n              actions: [\n                {\n                  method_name: \"set\",\n                  args: proposal_args,\n                  deposit: \"80000000000000000000000\",\n                  gas: \"219000000000000\",\n                },\n              ],\n            },\n          },\n        },\n      },\n      deposit: deposit,\n      gas: \"219000000000000\",\n    },\n  ]);\n};\n\nconst dao_args = Buffer.from(JSON.stringify(state.args), \"utf-8\").toString(\n  \"base64\"\n);\n\nconst onChangeName = (name) => {\n  State.update({\n    name,\n  });\n};\n\nreturn (\n  <div className=\"mb-3\">\n    <div className=\"row\">\n      <div className=\"col-lg-6\">\n        <div>\n          <h4>Edit DAO Profile</h4>\n        </div>\n        <div className=\"mb-2\">\n          <Widget\n            src=\"mob.near/widget/MetadataEditor\"\n            props={{\n              initialMetadata: profile,\n              onChange: (profile) => State.update({ profile }),\n              options: {\n                name: { label: \"Name\" },\n                image: { label: \"Logo\" },\n                backgroundImage: { label: \"Background\" },\n                description: { label: \"About\" },\n                tags: {\n                  label: \"Tags\",\n                  tagsPattern: \"*/profile/tags/*\",\n                  placeholder: \"dev, gaming, nft, privacy, eth\",\n                },\n                linktree: {\n                  links: [\n                    {\n                      label: \"Twitter\",\n                      prefix: \"https://twitter.com/\",\n                      name: \"twitter\",\n                    },\n                    {\n                      label: \"Github\",\n                      prefix: \"https://github.com/\",\n                      name: \"github\",\n                    },\n                    {\n                      label: \"Telegram\",\n                      prefix: \"https://t.me/\",\n                      name: \"telegram\",\n                    },\n                    {\n                      label: \"Website\",\n                      prefix: \"https://\",\n                      name: \"website\",\n                    },\n                  ],\n                },\n              },\n            }}\n          />\n        </div>\n\n        <p>\u2b06\ufe0f input existing DAO account!</p>\n\n        <div className=\"mb-2\">\n          <button\n            className=\"btn btn-outline-success m-1\"\n            onClick={handleProposal}\n          >\n            Propose Changes\n          </button>\n          <button\n            className=\"btn btn-outline-primary m-1\"\n            href={`#/hack.near/widget/DAO.Profile?daoId=${daoId}`}\n          >\n            Request Permission to Post on Behalf of DAO\n          </button>\n        </div>\n      </div>\n      <div className=\"col-lg-6\">\n        <Widget\n          src=\"mob.near/widget/ProfileLarge\"\n          props={{\n            accountId: daoId,\n            profile: state.profile,\n          }}\n        />\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearefi.near/widget/ReFi.DAO.Propose.profileUpdate", "fact_widget_deployments_id": "ce0b9981343e21ddf6faa3f7b4da107d", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
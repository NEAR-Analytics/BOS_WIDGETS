{"tx_hash": "7c54fRVPdiPsjWbPpyUYViKgPb3Eo59FpXkzGVuua8dZ", "action_id_social": "2VYN7t7U2MNe1p2s77VopzkoPtfzVgJAugnhxP3vgms4-0-widget", "block_id": 99856420, "block_timestamp": "2023-08-28T13:55:07.992Z", "signer_id": "ijoh.near", "widget_name": "Calendar", "source_code": "\r\nconst holidays = [\r\n    [1, 1],   // New Year's Day\r\n    [3, 1],   // Independence Movement Day\r\n    [5, 5],   // Children's Day\r\n    [6, 6],   // Memorial Day\r\n    [8, 15],  // Liberation Day\r\n    [10, 3],  // National Foundation Day\r\n    [12, 25], // Christmas\r\n];\r\n\r\nconst Calendar = () => {\r\n    // //const [currentYear, setCurrentYear] = useState(new Date().getFullYear());\r\n    // const [currentMonth, setCurrentMonth] = useState(new Date().getMonth());\r\n    // const [notes, setNotes] = useState({});\r\n\r\n\r\n    State.init({ currentYear: new Date().getFullYear(), currentMonth: new Date().getMonth(), notes: {} });\r\n\r\n    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();\r\n    const firstDayOfWeek = new Date(currentYear, currentMonth, 1).getDay();\r\n\r\n    const createCalendar = () => {\r\n        const calendar = [];\r\n\r\n        for (let i = 0; i < firstDayOfWeek; i++) {\r\n            calendar.push(<div key={`empty-${i}`} className=\"day\"></div>);\r\n        }\r\n\r\n        for (let day = 1; day <= daysInMonth; day++) {\r\n            const currentDate = new Date(currentYear, currentMonth, day);\r\n            const dayOfWeek = currentDate.getDay();\r\n            let dayClasses = 'day';\r\n\r\n            if (dayOfWeek === 0) {\r\n                dayClasses += ' sunday';\r\n            } else if (dayOfWeek === 6) {\r\n                dayClasses += ' saturday';\r\n            }\r\n\r\n            for (const holiday of holidays) {\r\n                if (currentMonth === holiday[0] - 1 && day === holiday[1]) {\r\n                    dayClasses += ' holiday';\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (notes[`${currentYear}-${currentMonth + 1}-${day}`]) {\r\n                dayClasses += ' active';\r\n            }\r\n\r\n            calendar.push(\r\n                <div\r\n                    key={`day-${day}`}\r\n                    className={dayClasses}\r\n                    onClick={() => openNoteInput(currentYear, currentMonth, day)}\r\n                >\r\n                    {day}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return calendar;\r\n    };\r\n\r\n    const openNoteInput = (year, month, day) => {\r\n        const existingNote = notes[`${year}-${month + 1}-${day}`] || '';\r\n        const noteInput = prompt(`Enter note for ${year}-${month + 1}-${day}:`, existingNote);\r\n\r\n        if (noteInput !== null) {\r\n            // setNotes(prevNotes => ({\r\n            //     ...prevNotes,\r\n            //     [`${year}-${month + 1}-${day}`]: noteInput,\r\n            // }));\r\n\r\n            State.update({notes:prevNotes => ({\r\n                ...prevNotes,\r\n                [`${year}-${month + 1}-${day}`]: noteInput,\r\n            })});\r\n        }\r\n\r\n    };\r\n\r\n    const goToPrevMonth = () => {\r\n        setCurrentMonth(prevMonth => {\r\n            if (prevMonth === 0) {\r\n                // setCurrentYear(year => year - 1);\r\n                // return 11;\r\n                State.update({currentYear:year => year - 1});\r\n\r\n            }\r\n            return prevMonth - 1;\r\n        });\r\n        \r\n    };\r\n\r\n\r\n    const goToNextMonth = () => {\r\n        setCurrentMonth(prevMonth => {\r\n            if (prevMonth === 11) {\r\n                // setCurrentYear(year => year + 1);\r\n                State.update({currentYear:year => year + 1});\r\n                return 0;\r\n            }\r\n            return prevMonth + 1;\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"calendar\">\r\n            <div className=\"nav-buttons\">\r\n                <div className=\"nav-button\" onClick={goToPrevMonth}>\u2190 \uc774\uc804 \uc6d4</div>\r\n                <div className=\"nav-button\" onClick={goToNextMonth}>\ub2e4\uc74c \uc6d4 \u2192</div>\r\n            </div>\r\n            <div className=\"month-title\">{currentYear}\ub144 {currentMonth + 1}\uc6d4</div>\r\n            <div className=\"weekdays\">\r\n                {[\"\uc77c\", \"\uc6d4\", \"\ud654\", \"\uc218\", \"\ubaa9\", \"\uae08\", \"\ud1a0\"].map(day => (\r\n                    <div key={day} className=\"weekday\">{day}</div>\r\n                ))}\r\n            </div>\r\n            <div className=\"days\">\r\n                {createCalendar()}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nreturn Calendar();\r\n", "metadata": null, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/ijoh.near/widget/Calendar", "fact_widget_deployments_id": "11cc8dec1e8bf2945dec85c9be644e3d", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "47ghfbuVcf3c14YSBLa7g4nMuE6TVdvevoy8P3U5VibJ", "action_id_social": "2ghdgrJzGFnWtV8uup1Mp2pd7nU5mxwHsv31DhntBWZw-0-widget", "block_id": 96551037, "block_timestamp": "2023-07-15T19:03:18.148Z", "signer_id": "mintlu.near", "widget_name": "kp-ticket-handler", "source_code": "const kpContract = \"v2.keypom.near\";\nlet have_pk = false;\nlet curUse;\nif (\n  props.key != undefined &&\n  props.key != \"\" &&\n  props.pk != undefined &&\n  props.pk != \"\"\n) {\n  have_pk = true;\n  curUse = Near.view(kpContract, \"get_key_information\", {\n    key: props.key,\n  }).cur_key_use;\n  if (curUse == undefined) {\n    curUse = 0;\n  }\n}\n\nState.init({\n  keyUse: curUse,\n  contract: kpContract,\n  havePk: have_pk,\n});\n\nState.update({\n  keyUse: curUse,\n});\n\n// rendering stuff\nif (state.keyUse == 1) {\n  // QR code\n  return (\n    <>\n      <Widget\n        src=\"mintlu.near/widget/kp-ticket2\"\n        props={{ key: props.key, pk: props.pk }}\n      />\n    </>\n  );\n} else if (state.keyUse == 2) {\n  return (\n    <div className=\"content\">\n      <h1>You're all set! Enjoy the event</h1>\n      <a\n        href={`https://mynearwallet.com/linkdrop/${state.contract}/${props.pk}`}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        <button className=\"onboard_button\">Claim your POAP</button>\n      </a>\n    </div>\n  );\n} else if (state.keyUse == 0 && !state.havePk) {\n  // Event Landing Page\n  return (\n    <div className=\"content\">\n      <h1>Welcome to the Keypom Party!</h1>\n      <div>Drinks are on the house tonight!</div>\n    </div>\n  );\n} else if (state.keyUse == 0) {\n  // Key has been depleted, show resources for NEAR\n  return (\n    <div className=\"content\">\n      <h1>Now that you have a wallet...</h1>\n      <a\n        href={\"https://near.org/learn/#anker_near\"}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        <button className=\"onboard_button\">\n          Continue your journey into NEAR\n        </button>\n      </a>\n    </div>\n  );\n} else {\n  return (\n    <div>\n      <div style={{ textAlign: \"center\" }}>\n        Please visit drops page or enter key info in URL props\n      </div>{\" \"}\n    </div>\n  );\n}\n", "metadata": {"platform": "nearpad"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/mintlu.near/widget/kp-ticket-handler", "fact_widget_deployments_id": "473903c1444134cf2d9f26becceedc04", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 6}
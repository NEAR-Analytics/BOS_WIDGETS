{"tx_hash": "2CykLLccTYcUDVTW49NSLMv4xcsjJ1FhLRQyHxk43gnQ", "action_id_social": "ESYaA36st83dxRtzPedyRPnCYgf2N88UZzvzYYZ3BPnX-0-widget", "block_id": 112698817, "block_timestamp": "2024-02-12T19:51:32.683Z", "signer_id": "box_factory.near", "widget_name": "MysteryBox.Screens.Claim", "source_code": "console.log('Claim.props', props);\n\nconst base_ipfs = 'https://ipfs.near.social/ipfs/';\n\nState.init({\n  active: 0,\n});\n\nconst font = fetch(\n  'https://fonts.googleapis.com/css2?family=Kodchasan:wght@700&display=swap'\n).body;\n\nif (!font) {\n  return <></>;\n}\n\nconst Wrapper = styled.div`\n  position: fixed;\n  top: 64px;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  width: 100%;\n\n  ${font}\n`;\n\nconst WrapperContent = styled.div`\n  background: radial-gradient(50% 50% at 50% 50%, #203343 0%, #0e121e 100%);\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-evenly;\n  align-items: center;\n\n  overflow-y: scroll;\n  overflow-x: hidden;\n`;\n\nconst SliderWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n\n  flex-basis: 60%;\n  width: 320px;\n`;\n\nconst SingleBoxWrapper = styled.div`\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: center;\n  height: 100%;\n  flex-basis: 80%;\n\n  display: ${(props) => (props.active ? 'flex' : 'none')};\n`;\n\nconst levitation = styled.keyframes`\n  from {\n    transform: translateY(0px) rotate(0deg);\n  }\n  to {\n    transform: translateY(24px) rotate(6deg);\n  }\n`;\n\nconst BoxImageWrapper = styled.div`\n  animation-duration: 3s;\n  animation-iteration-count: ${(props) => (props.animate ? 'infinite' : '0')};\n  animation-name: ${levitation};\n  animation-timing-function: ease;\n  animation-direction: alternate;\n  text-align: center;\n\n  flex-basis: 50%;\n\n  svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 42px;\n  }\n`;\n\nconst BoxImage = styled.img`\n  width: 75%;\n  object-fit: cover;\n`;\n\nconst BoxTitleWrapper = styled.div`\n  flex-basis: 10%;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst BoxTitle = styled.div`\n  background: rgba(14, 18, 30, 0.6);\n  border-radius: 50px;\n  padding: 0.25em 3em;\n\n  font-size: 14px;\n  line-height: 20px;\n  font-family: 'Kodchasan', sans-serif;\n  font-weight: 700;\n  letter-spacing: 0em;\n  text-align: center;\n  color: #ffffff;\n  text-transform: uppercase;\n`;\n\nconst BoxRewardWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-evenly;\n\n  width: 100%;\n  flex-basis: 18%;\n`;\n\nconst BoxRewardAmounts = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: end;\n  justify-content: space-between;\n  margin: 0;\n  padding: 0;\n  flex-basis: 35%;\n`;\n\nconst BoxRewardAmount = styled.p`\n  overflow: hidden;\n  white-space: nowrap; /* Don't forget this one */\n  text-overflow: ellipsis;\n  color: rgba(161, 224, 234, 1);\n  font-family: 'Kodchasan', sans-serif;\n  font-size: 12px;\n  font-weight: 700;\n  line-height: 18px;\n  letter-spacing: 0em;\n  text-align: center;\n  text-transform: uppercase;\n  margin: 0;\n  padding: 0;\n`;\n\nconst BoxRewardTitles = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: start;\n  justify-content: space-between;\n  margin: 0;\n  padding: 0;\n\n  flex-basis: 50%;\n`;\n\nconst BoxRewardTitle = styled.p`\n  overflow: hidden;\n  white-space: nowrap; /* Don't forget this one */\n  text-overflow: ellipsis;\n  color: rgba(255, 255, 255, 1);\n  font-family: 'Kodchasan', sans-serif;\n  font-size: 12px;\n  font-weight: 700;\n  line-height: 18px;\n  letter-spacing: 0em;\n  text-align: center;\n  text-transform: uppercase;\n  margin: 0;\n  padding: 0;\n`;\n\nconst BoxLockedTitle = styled.p`\n  color: #a1e0ea;\n  font-family: 'Kodchasan', sans-serif;\n  font-size: 18px;\n  font-weight: 700;\n  letter-spacing: 0em;\n  text-align: center;\n  text-transform: uppercase;\n  margin: 0;\n  padding: 0;\n`;\n\nconst BoxBottomWrapper = styled.div`\n  flex-basis: 12%;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst ClaimButton = styled.div`\n  position: relative;\n\n  cursor: pointer;\n  text-align: none;\n  text-decoration: none;\n\n  @media (min-width: 512px) {\n    font-size: 20px;\n    padding: 0.65em 2.5em;\n  }\n\n  font-size: 16px;\n  line-height: 1;\n  padding: 0.6875em 2.5em;\n\n  font-family: 'Kodchasan', sans-serif;\n  font-weight: 700;\n  letter-spacing: 0em;\n  text-align: center;\n  color: #ffffff;\n  text-transform: uppercase;\n\n  background: none;\n\n  &:after {\n    content: '';\n    position: absolute;\n    inset: 0;\n    border-radius: 100px;\n    border: 3px solid transparent;\n    background: linear-gradient(\n        92.13deg,\n        #d2c659 -11.04%,\n        #cb84c3 40.76%,\n        #5c91df 101.98%\n      )\n      border-box;\n    -webkit-mask: /*4*/ linear-gradient(#fff 0 0) padding-box,\n      linear-gradient(#fff 0 0);\n    -webkit-mask-composite: xor; /*5'*/\n    mask-composite: exclude; /*5*/\n    // box-shadow: 0px 8px 24px rgba(21.48, 26.91, 35.06, 0.25);\n  }\n`;\n\nconst OpenedBoxRewardTitle = styled.p`\n  color: rgba(254, 185, 3, 1);\n  font-family: 'Kodchasan', sans-serif;\n  font-size: 16px;\n  font-weight: 700;\n  line-height: 22px;\n  letter-spacing: 0em;\n  text-align: center;\n  text-transform: uppercase;\n  margin: 0;\n  padding: 0;\n`;\n\nconst ClaimedButton = styled.div`\n  position: relative;\n\n  cursor: default;\n\n  text-align: none;\n  text-decoration: none;\n\n  @media (min-width: 512px) {\n    font-size: 20px;\n  }\n\n  font-size: 16px;\n  line-height: 1;\n  padding: 0.5em 2em;\n\n  font-family: 'Kodchasan', sans-serif;\n  font-weight: 700;\n  letter-spacing: 0em;\n  text-align: center;\n  color: #ffffff;\n  text-transform: uppercase;\n\n  background: none;\n  border-radius: 100px;\n  border: 3px solid rgb(43, 204, 194);\n  box-shadow: 0 0 25px rgba(43, 204, 194, 0.25),\n    inset 0 0 25px rgba(43, 204, 194, 0.25);\n`;\n\nconst Logo = styled.img`\n  height: 55px;\n`;\n\nconst BottomText = styled.p`\n  margin: 0;\n\n  color: white;\n\n  font-size: 14px;\n  font-family: 'Kodchasan', sans-serif;\n  font-weight: 700;\n  letter-spacing: 0em;\n  text-align: center;\n  text-transform: uppercase;\n`;\n\nconst WrapperSocial = styled.div`\n  display: flex;\n  width: 180px;\n  align-items: center;\n  justify-content: space-around;\n`;\n\nconst SocialText = styled.p`\n  font-family: 'Kodchasan', sans-serif;\n  font-size: 12px;\n  font-weight: 700;\n  line-height: 16px;\n  letter-spacing: 0em;\n  text-align: center;\n  color: #ffffff;\n  text-transform: uppercase;\n  margin: 0;\n`;\n\nconst SocialLink = styled.a`\n  cursor: pointer;\n  text-align: none;\n  height: 16px;\n  margin: 0;\n  padding: 0;\n`;\n\nconst SocialIcon = styled.img`\n  height: 100%;\n  vertical-align: unset;\n`;\n\nconst previousActiveBox = () => {\n  if (state.active === 0) return;\n\n  State.update({ active: state.active - 1 });\n};\n\nconst nextActiveBox = () => {\n  if (state.active === props.boxes.length - 1) return;\n\n  State.update({ active: state.active + 1 });\n};\n\nconst NonClaimedBoxComponent = ({ box }) => {\n  /** @todo: concat with the URL object */\n  const image = base_ipfs + box.ipfs;\n  const rarity = box.rarity;\n\n  const onClick = () => {\n    console.log('clicked claim button', box.id);\n\n    return props.onClaim(box.id);\n  };\n\n  const amounts = (box.rewards || []).map((reward) => {\n    const count = reward.available || reward.token_ids?.length;\n\n    const isPlural = count > 1;\n\n    const title = isPlural ? 'prizes' : 'prize';\n\n    return `${count} ${title}`;\n  });\n\n  const titles = (box.rewards || []).map((reward) => {\n    if (reward.kind === 'near') {\n      const amountInNear = Big(\n        Big(reward.amount).div(1e24).toFixed(2)\n      ).toNumber();\n\n      return `${amountInNear} near token`;\n    } else if (reward.kind === 'non_fungible_token') {\n      const { name } = Near.view(reward.contract_id, 'nft_metadata');\n\n      const maximumNameLength = 12;\n      const shortName =\n        name.length > maximumNameLength\n          ? name.substring(0, maximumNameLength) + '...'\n          : name;\n\n      return `${shortName} nft`;\n    }\n  });\n\n  return (\n    <>\n      <BoxTitleWrapper>\n        <BoxTitle>{rarity} box</BoxTitle>\n      </BoxTitleWrapper>\n      <BoxRewardWrapper>\n        <BoxRewardAmounts>\n          {amounts.map((text) => (\n            <BoxRewardAmount>{text}</BoxRewardAmount>\n          ))}\n        </BoxRewardAmounts>\n        <BoxRewardTitles>\n          {titles.map((text) => (\n            <BoxRewardTitle>{text}</BoxRewardTitle>\n          ))}\n        </BoxRewardTitles>\n      </BoxRewardWrapper>\n      <BoxImageWrapper animate>\n        <BoxImage src={image} />\n      </BoxImageWrapper>\n      <BoxBottomWrapper>\n        <ClaimButton onClick={onClick}>Claim</ClaimButton>\n      </BoxBottomWrapper>\n    </>\n  );\n};\n\nconst LockIcon = ({}) => {\n  return (\n    <svg\n      width=\"69\"\n      height=\"88\"\n      viewBox=\"0 0 69 88\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M29.644 87.956c-7.714-.479-13.857-1.268-20.106-2.582-2.028-.426-7.145-1.714-8.713-2.192l-.774-.237-.044-19.414C-.017 52.854.022 44.06.093 43.99c.259-.255 6.755-1.897 10.453-2.642 16.104-3.247 30.935-3.295 46.972-.15 2.984.585 8.008 1.791 10.151 2.438l1.032.311v39.035l-2.666.734c-6.868 1.89-14.393 3.227-22.024 3.91-2.848.256-12.134.469-14.367.33ZM36.96 70.38v-4.258l.98-.424c1.404-.61 3.156-2.315 3.897-3.798 1.653-3.304 1.04-7.006-1.599-9.644-3.364-3.365-8.366-3.365-11.73 0-2.638 2.638-3.252 6.34-1.6 9.644.742 1.483 2.494 3.189 3.899 3.798l.98.424v8.517h5.161V70.38h.012Zm-3.703-9.246c-2.143-.753-2.755-3.612-1.122-5.245 1.764-1.764 4.746-.925 5.328 1.5.282 1.18.02 2.1-.848 2.967-.979.978-2.067 1.23-3.358.777ZM7.06 30.4c.063-5.807.107-6.613.452-8.285C9.702 11.485 17.604 3.276 28.096.728c6.046-1.468 12.782-.692 18.41 2.12 7.626 3.812 12.943 10.768 14.743 19.287.307 1.45.361 2.486.435 8.181.076 5.955.06 6.511-.195 6.414-.512-.197-6.352-1.288-9.004-1.682l-2.624-.39v-4.603c0-4.817-.107-5.818-.853-7.968-1.304-3.756-4.482-7.208-8.18-8.886-2.265-1.026-3.528-1.276-6.452-1.276-2.256 0-2.873.06-4.007.388-5.854 1.695-9.978 6.09-11.229 11.967-.183.86-.25 2.412-.25 5.807 0 3.448-.051 4.634-.202 4.634-.862 0-10.701 1.73-11.43 2.01-.24.093-.261-.56-.199-6.33Z\"\n        fill=\"#fff\"\n        fill-opacity=\".3\"\n      />\n    </svg>\n  );\n};\n\nconst LockedBoxComponent = ({ box }) => {\n  /** @todo: concat with the URL object */\n  const image = base_ipfs + box.ipfs;\n  const rarity = box.rarity;\n\n  return (\n    <>\n      <BoxTitleWrapper>\n        <BoxTitle>{rarity} box</BoxTitle>\n      </BoxTitleWrapper>\n      <BoxRewardWrapper />\n      <BoxImageWrapper>\n        <BoxImage src={image} />\n        <LockIcon />\n      </BoxImageWrapper>\n      <BoxBottomWrapper>\n        <BoxLockedTitle>Rewards out of stock</BoxLockedTitle>\n      </BoxBottomWrapper>\n    </>\n  );\n};\n\nconst OpenedBoxComponent = ({ box }) => {\n  /** @todo: concat with the URL object */\n  const image = base_ipfs + box.ipfs;\n  const rarity = box.rarity;\n\n  const reward = box.status.reward;\n\n  let text;\n\n  if (reward.kind === 'near') {\n    const amountInNear = Big(\n      Big(reward.amount).div(1e24).toFixed(2)\n    ).toNumber();\n\n    text = `${amountInNear} near token`;\n  } else if (reward.kind === 'non_fungible_token') {\n    const { name } = Near.view(reward.contract_id, 'nft_metadata');\n\n    text = `${name} nft`;\n  } else if (reward.kind === 'nothing') {\n    text = 'Better luck next time';\n  }\n\n  return (\n    <>\n      <BoxTitleWrapper>\n        <BoxTitle>{rarity} box</BoxTitle>\n      </BoxTitleWrapper>\n      <BoxRewardWrapper>\n        <OpenedBoxRewardTitle>{text}</OpenedBoxRewardTitle>\n      </BoxRewardWrapper>\n      <BoxImageWrapper>\n        <BoxImage src={image} />\n      </BoxImageWrapper>\n      <BoxBottomWrapper>\n        <ClaimedButton>Claimed</ClaimedButton>\n      </BoxBottomWrapper>\n    </>\n  );\n};\n\nconst BoxComponent = ({ box }) => {\n  if (box.status.kind === 'claimed')\n    return <OpenedBoxComponent key={box.id} box={box} />;\n\n  if (box.status.kind === 'non_claimed' && box.rewards.length === 0)\n    return <LockedBoxComponent key={box.id} box={box} />;\n\n  if (box.status.kind === 'non_claimed')\n    return <NonClaimedBoxComponent key={box.id} box={box} />;\n\n  return <></>;\n};\n\nconst Svg = styled.svg`\n  height: 36px;\n  cursor: pointer;\n\n  ${(props) =>\n    !props.disabled\n      ? `filter: drop-shadow(0px 0px 4px rgba(43, 204, 193, 0.5));`\n      : `filter: none;`}\n`;\n\nconst RightArrow = ({ onClick, disabled }) => (\n  <Svg\n    viewBox=\"0 0 35 58\"\n    disabled={disabled}\n    onClick={onClick}\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <g xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fill-rule=\"evenodd\"\n        clip-rule=\"evenodd\"\n        d=\"M0.550369 4.94975L5.50011 0L29.521 24.0209L29.542 24L34.4917 28.9497L34.4708 28.9707L34.4915 28.9914L29.5417 33.9411L29.521 33.9204L5.50032 57.9411L0.550575 52.9914L24.5713 28.9707L0.550369 4.94975Z\"\n        fill={disabled ? '#818B94' : '#fff'}\n      />\n    </g>\n  </Svg>\n);\n\nconst LeftArrow = ({ onClick, disabled }) => (\n  <Svg\n    viewBox=\"0 0 35 58\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    disabled={disabled}\n    onClick={onClick}\n  >\n    <g xmlns=\"http://www.w3.org/2000/svg\" transform=\"matrix(-1 0 0 -1 35 58)\">\n      <path\n        fill-rule=\"evenodd\"\n        clip-rule=\"evenodd\"\n        d=\"M0.550369 4.94975L5.50011 0L29.521 24.0209L29.542 24L34.4917 28.9497L34.4708 28.9707L34.4915 28.9914L29.5417 33.9411L29.521 33.9204L5.50032 57.9411L0.550575 52.9914L24.5713 28.9707L0.550369 4.94975Z\"\n        fill={disabled ? '#818B94' : '#fff'}\n      />\n    </g>\n  </Svg>\n);\n\nconst available = (props.boxes || []).filter(\n  (box) => box.status.kind === 'non_claimed' && box.rewards.length > 0\n).length;\n\nreturn (\n  <>\n    <Wrapper>\n      <WrapperContent>\n        <Logo\n          src=\"https://ipfs.near.social/ipfs/bafkreiht32vi4vui77rf7p42gchxmf5hjwjqbateehry4frovxhhrqpi7i\"\n          alt=\"Near Box Gray logo\"\n        />\n        <SliderWrapper>\n          <LeftArrow\n            disabled={state.active === 0}\n            onClick={previousActiveBox}\n          />\n          {props.boxes.map((box, index) => {\n            return (\n              <SingleBoxWrapper active={state.active === index}>\n                <BoxComponent box={box} />\n              </SingleBoxWrapper>\n            );\n          })}\n          <RightArrow\n            disabled={state.active === props.boxes.length - 1}\n            onClick={nextActiveBox}\n          />\n        </SliderWrapper>\n\n        <BottomText>\n          <span style={{ color: '#2bccc2' }}>{props.totalSupply}</span>\n          minted boxes\n          <br />\n          <span style={{ color: available > 0 ? '#FFD951' : '#2bccc2' }}>\n            {available}\n          </span>\n          box{available === 1 ? '' : 'es'} available\n        </BottomText>\n\n        <WrapperSocial>\n          <SocialText>Follow us</SocialText>\n          <SocialLink href=\"https://twitter.com/nearuaguild\" target=\"_blank\">\n            <SocialIcon\n              src=\"https://ipfs.near.social/ipfs/bafkreibhvlipldq5qnolfb74ufbgqkbcwlim5vvtk3mbz6ujvbsar6fesq\"\n              alt=\"Twitter\"\n            />\n          </SocialLink>\n          <SocialLink href=\"https://t.me/nearprotocolua\" target=\"_blank\">\n            <SocialIcon\n              src=\"https://ipfs.near.social/ipfs/bafkreihcqu65spu6o5z6vw5atbjx7iqphzvlss3hvz4l7bj3syhvavzf5a\"\n              alt=\"Telegram\"\n            />\n          </SocialLink>\n          <SocialLink\n            href=\"https://near.org/near/widget/ProfilePage?accountId=nearukraineguild.near\"\n            target=\"_blank\"\n          >\n            <SocialIcon\n              src=\"https://ipfs.near.social/ipfs/bafkreier4aong3uumu4ndl6iahol2kgeisfqtl6c237x3q34ql6smjvare\"\n              alt=\"Near Social\"\n            />\n          </SocialLink>\n        </WrapperSocial>\n      </WrapperContent>\n    </Wrapper>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/box_factory.near/widget/MysteryBox.Screens.Claim", "fact_widget_deployments_id": "4725d2f19d321a74294646ec8bc1d4b2", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "8dyTaqjCzZphjiuRrzs3CAr2JNhGNwk1c9caavbhxYiq", "action_id_social": "8cy5EKGUHRGQMxFhWZ79if3qyHajKJXCa9Pf4b9ZzQZp-0-widget", "block_id": 99170659, "block_timestamp": "2023-08-19T14:07:11.943Z", "signer_id": "agwaze.near", "widget_name": "GenaDrop.NFTDetails", "source_code": "const nft = props.nft ?? {\n  contractId: props.contractId,\n  tokenId: props.tokenId,\n};\n\nconst currentChain = {\n  near: \"https://ipfs.near.social/ipfs/bafkreidptf634houwtbxryegonzyys3wnz3m75zqyxfcot5u42slwdtb2e\",\n  sui: \"https://blog.sui.io/content/images/2023/04/Sui_Droplet_Logo_Blue-3.png\",\n  aptos:\n    \"data:image/png;base64,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\",\n};\n\nconst contractId = nft.contractId;\nconst tokenId = nft.tokenId;\nconst className = props.className ?? \"img-fluid\";\nconst style = props.style;\nconst alt = props.alt;\nconst thumbnail = props.thumbnail;\nconst fallbackUrl = props.fallbackUrl;\nconst loadingUrl =\n  props.loadingUrl ??\n  \"https://ipfs.near.social/ipfs/bafkreidoxgv2w7kmzurdnmflegkthgzaclgwpiccgztpkfdkfzb4265zuu\";\n\nState.init({\n  contractId,\n  tokenId,\n  description: \"\",\n  listings: [],\n  title: \"\",\n  owner: \"\",\n  imageUrl: null,\n});\n\nconst NoNFTLoading = styled.div`\n  width: 100%;\n  min-height: 80vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst nftMetadata =\n  nft.contractMetadata ?? Near.view(contractId, \"nft_metadata\");\nconst tokenMetadata =\n  nft.tokenMetadata ??\n  Near.view(contractId, \"nft_token\", {\n    token_id: tokenId,\n  }).metadata;\n\nif (contractId !== state.contractId || tokenId !== tokenId) {\n  State.update({\n    contractId,\n    tokenId,\n    imageUrl: null,\n  });\n}\n\nlet imageUrl = null;\n\nfunction fetchTokens() {\n  asyncFetch(\"https://graph.mintbase.xyz/mainnet\", {\n    method: \"POST\",\n    headers: {\n      \"mb-api-key\": \"omni-site\",\n      \"Content-Type\": \"application/json\",\n      \"x-hasura-role\": \"anonymous\",\n    },\n    body: JSON.stringify({\n      query: `\n          query MyQuery {\n              mb_views_nft_tokens(\n              where: { nft_contract_id: { _eq: \"${contractId}\" }, token_id: {_eq: \"${tokenId}\"}}\n              order_by: {minted_timestamp: desc}\n            ) {\n                attributes {\n                    attribute_display_type\n                    attribute_value\n                }\n                media \n                owner\n                token_id\n                nft_contract_id\n                description\n                title\n                listings {\n                    price\n                    unlisted_at\n                    listed_by\n                }\n            }\n          }\n        `,\n    }),\n  }).then((res) => {\n    if (res.ok) {\n      const tokens = res.body.data.mb_views_nft_tokens;\n      const token = tokens[0];\n      State.update({\n        description: token.description,\n        owner: token.owner,\n        listings: token.listings[0],\n        title: token.title,\n      });\n      if (!token) {\n        const response = fetch(\"https://api.indexer.xyz/graphql\", {\n          method: \"POST\",\n          headers: {\n            \"x-api-key\": \"Krqwh4b.bae381951d6050d351945c0c750f1510\",\n            \"x-api-user\": \"Banyan\",\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            query: `query MyQuery {\n  ${props.chainState} {\n    nfts(\n      where: { contract_id: { _eq: \"${contractId}\" }, token_id: {_eq: \"${tokenId}\"}}\n    ) {\n      contract_id\n      name\n      media_url\n      token_id\n      media_type\n      owner\n      \n      staked_owner\n      listings {\n        listed\n        price\n      }\n      attributes {\n        rarity\n        value\n        type\n        score\n      }\n     }\n     }\n    }`,\n          }),\n        });\n        const token = response.body.data[props.chainState].nfts;\n        if (token) {\n          console.log(token);\n          State.update({\n            title: token[0].name,\n            listings: token[0].listings,\n            attributes: token[0].attributes,\n            imageUrl: token[0].media_url,\n          });\n        }\n      }\n    }\n  });\n}\n\nfetchTokens();\n\nif (props.contractId && props.tokenId && !state.title) {\n  return (\n    <NoNFTLoading>\n      <img\n        src=\"https://ipfs.near.social/ipfs/bafkreidoxgv2w7kmzurdnmflegkthgzaclgwpiccgztpkfdkfzb4265zuu\"\n        alt=\"\"\n      />\n    </NoNFTLoading>\n  );\n}\nif (nftMetadata && tokenMetadata) {\n  let tokenMedia = tokenMetadata.media || \"\";\n\n  imageUrl =\n    tokenMedia.startsWith(\"https://\") ||\n    tokenMedia.startsWith(\"http://\") ||\n    tokenMedia.startsWith(\"data:image\")\n      ? tokenMedia\n      : nftMetadata.base_uri\n      ? `${nftMetadata.base_uri}/${tokenMedia}`\n      : tokenMedia.startsWith(\"Qm\") || tokenMedia.startsWith(\"ba\")\n      ? `https://ipfs.near.social/ipfs/${tokenMedia}`\n      : tokenMedia;\n\n  if (!tokenMedia && tokenMetadata.reference) {\n    if (\n      nftMetadata.base_uri === \"https://arweave.net\" &&\n      !tokenMetadata.reference.startsWith(\"https://\")\n    ) {\n      const res = fetch(`${nftMetadata.base_uri}/${tokenMetadata.reference}`);\n      imageUrl = res.body.media;\n    } else if (\n      tokenMetadata.reference.startsWith(\"https://\") ||\n      tokenMetadata.reference.startsWith(\"http://\")\n    ) {\n      const res = fetch(tokenMetadata.reference);\n      imageUrl = JSON.parse(res.body).media;\n    } else if (tokenMetadata.reference.startsWith(\"ar://\")) {\n      const res = fetch(\n        `${\"https://arweave.net\"}/${tokenMetadata.reference.split(\"//\")[1]}`\n      );\n      imageUrl = JSON.parse(res.body).media;\n    }\n  }\n\n  if (!imageUrl) {\n    imageUrl = false;\n  }\n}\n\nconst replaceIpfs = (imageUrl) => {\n  if (state.oldUrl !== imageUrl && imageUrl) {\n    const match = rex.exec(imageUrl);\n    if (match) {\n      const newImageUrl = `https://ipfs.near.social/ipfs/${match[1]}${\n        match[2] || \"\"\n      }`;\n      if (newImageUrl !== imageUrl) {\n        State.update({\n          oldUrl: imageUrl,\n          imageUrl: newImageUrl,\n        });\n        return;\n      }\n    }\n  }\n  if (state.imageUrl !== false) {\n    State.update({\n      imageUrl: false,\n    });\n  }\n};\n\nconst thumb = (imageUrl) =>\n  thumbnail && imageUrl && !imageUrl.startsWith(\"data:image/\")\n    ? `https://i.near.social/${thumbnail}/${imageUrl}`\n    : imageUrl;\n\nconst img = state.imageUrl !== null ? state.imageUrl : imageUrl;\nconst src = img !== false ? img : fallbackUrl;\n\nconst Root = styled.div`\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    align-items: center;\n    justify-content: center;\n`;\nconst MainContainer = styled.div`\n    padding: 30px;\n    height: auto;\n    max-width: 1300px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n`;\n\nconst TopSection = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: flex-start;\n  justify-content: center;\n  width: 100%;\n  @media screen and (max-width: 600px) {\n    justify-content: center;\n    align-items: center;\n  }\n`;\n\nconst TopImageContainer = styled.div`\n  padding: 1em;\n  background: #ffffff;\n    width: 50%;\n    min-width: 355px;\n  border: 2px solid #cacdd5;\n  margin-right: 20px;\n  box-shadow: 2px 7px 22px rgba(28, 27, 28, 0.1);\n  border-radius: 0.7em;\n  &>img {\n    width: 100%;\n  }\n`;\n\nconst HeaderText = styled.h1`\n  font-size: 1.5rem;\n`;\n\nconst PriceArea = styled.div`\n  display: flex;\n  align-items: center;\n  color: #0d99ff;\n  &>*{\n  margin: 0px;\n  padding: 0px;\n  }\n  &>h6{\n    font-weight: 700;\n    margin-left: 5px;\n    margin-top: 4px;\n    margin-right: 3px;\n    font-size: 1.3rem;\n  }\n  &>span{\n  font-size: 1.2rem;\n  margin: 0px;\n  }\n`;\n\nconst PriceBucket = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-end;\n  justify-content: space-between;\n    margin-top: 30px;\n  width: 100%;\n`;\n\nconst Logo = styled.div`\n    &>img {\n        width: 30px;\n        border-radius: 100%;\n    }\n`;\n\nconst RightSection = styled.div`\n    width: 46%;\n    min-width: 350px;\n    margin-left: 10px;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    margin-right: 10px;\n`;\n\nconst Description = styled.div`\n     width: 100%;\n    border-radius: 1em;\n    background: #ffffff;\n    border: 2px solid #eeeff2;\n    padding: 1em;\n    margin-top: 40px;\n    box-shadow: 2px 7px 22px rgba(28, 27, 28, 0.1);\n    &>h6{\n        font-weight: 600;\n        font-size: 1.5rem;\n    }\n    \n`;\n\nconst AttributeContainer = styled.div`\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    align-items: center;\n    justify-content: space-between;\n    width: 100%;\n`;\n\nconst Attribute = styled.div`\n    display: flex;\n    align-items: flex-start;\n    justify-content: space-between;\n    padding: 0.5em;\n    border-radius: 0.5em;\n    width: 206px;\n    background: #fafafb;\n    margin-bottom: 20px;\n    border: 1px solid #86ccff;\n    border-radius: 10.6849px;\n    &>*span {\n        padding: 0;\n        color: #b2b7c2;\n    }\n`;\n\nconst TransactionTable = styled.div`\n     width: 100%;\n  max-width: 70%;\n  background: #ffffff;\n  border: 2px solid #eeeff2;\n  box-shadow: 2px 7px 22px rgba(28, 27, 28, 0.1);\n  border-radius: 16px;\n  margin-bottom: 40px;\n`;\n\nconst TableHeader = styled.div`\n    width: 100%;\n  padding: 0.5em;\n  font-weight: 600;\n  font-size: 1.5rem;\n  margin-bottom: 0.5em;\n  display: flex;\n  justify-content: flex-start;\n  gap: 1em;\n  background: #f5f6f7;\n  border-radius: 14px 14px 0px 0px;\n  &>h1 {\n    font-size: 24px;\n  }\n`;\n\nconst TableBody = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    padding: 0.5em;\n    justify-content: space-between;\n    border-bottom: 1px solid #dde1e6;\n`;\n\nconst RowType = styled.div`\n     display: inline-flex;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 0.5em;\n  font-size: 0.75rem;\n  padding: 0.25em 1em;\n  border-radius: 0.7em;\n  border: 1px solid #a4a9b6;\n`;\n\nconst RowBody = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    margin-top: 10px;\n    padding-left: 7px;\n    width: 100%;\n    justify-content: space-between;\n    p {\n        margin: 0;\n        border-bottom: 1px solid #e5e8eb;\n        font-size: 12px;\n        min-width: 100px;\n        text-align: center;\n    }\n    span {\n        font-size: 12px;\n    }\n`;\n\nconst MintDetails = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    color: #525c76;\n    &>span {\n        font-size: 14px;\n    }\n    &>a {\n        cursor: pointer;\n    }\n`;\n\nconst HandleList = () => {\n  console.log(props.singleNftProps);\n};\n\nreturn (\n  <Root>\n    <MainContainer>\n      <TopSection>\n        <TopImageContainer>\n          <HeaderText>{state.title || \"AI Sunset\"}</HeaderText>\n          <img\n            src={\n              src ||\n              \"https://genadrop.mypinata.cloud/ipfs/QmZbtU8RnMymJAJRpTriZgDXVeeCpm5RyXMJNquGoVc4Rb\"\n            }\n            alt=\"NFT\"\n            width=\"100%\"\n            height=\"100%\"\n            className=\"rounded-3\"\n          />\n          <div\n            style={{\n              display: \"flex\",\n              marginTop: \"10px\",\n              justifyContent: \"space-between\",\n            }}\n          >\n            <p\n              style={{\n                marginBottom: \"0.5em\",\n                fontSize: \"0.85rem\",\n                color: \"#0d99ff\",\n              }}\n            >\n              Created by\n            </p>\n            <a\n              target=\"_blank\"\n              style={{ textDecoration: \"none\" }}\n              href={`https://explorer.near.org/?query=${\n                state.owner || \"genadrop-contract.nftgen.near\"\n              }`}\n            >\n              <span style={{ fontSize: \"0.9rem\", fontWeight: 600 }}>\n                {state.owner.length > 12\n                  ? state.owner.slice(0, 12) + \"...\"\n                  : state.owner ||\n                    \"genadrop-contract.nftgen.near\".slice(0, 12) +\n                      \"...\" +\n                      \"near\"}\n              </span>\n            </a>\n          </div>\n        </TopImageContainer>\n        <RightSection>\n          <PriceBucket>\n            <div>\n              <p style={{ color: \"#b2b7c2\", marginBottom: 0 }}>CURRENT PRICE</p>\n              <PriceArea>\n                {props.chainState ? (\n                  <Logo>\n                    <img src={currentChain[props.chainState]} />\n                  </Logo>\n                ) : (\n                  <Widget src=\"agwaze.near/widget/GenaDrop.NearLogo\" />\n                )}\n                <h6>\n                  {`${\n                    state.listings.price\n                      ? (\n                          state.listings.price / 1000000000000000000000000\n                        ).toFixed(2)\n                      : \"0.00\"\n                  }`}\n                </h6>\n                <span>{` ($${\n                  state.listings.price\n                    ? (\n                        (state.listings.price / 1000000000000000000000000) *\n                        1.56\n                      ).toFixed(2)\n                    : \"0.00\"\n                })`}</span>\n              </PriceArea>\n            </div>\n            <div>\n              {state.listings.price && context.contractId !== state.owner ? (\n                <button>Buy</button>\n              ) : state.owner === context.accountId ? (\n                <a\n                  href={`#/agwaze.near/widget/GenaDrop.NFTListing?tokenId=${tokenId}&contractId=${contractId}`}\n                >\n                  <button>List</button>\n                </a>\n              ) : (\n                <button\n                  style={{\n                    backgroundColor: \"#525c76\",\n                    borderColor: \"#525c76\",\n                    cursor: \"not-allowed\",\n                  }}\n                >\n                  Not Listed\n                </button>\n              )}\n            </div>\n          </PriceBucket>\n          <Description>\n            <h6>Description</h6>\n            <span>{state.description || \"Ai generated sunset cliffs\"}</span>\n          </Description>\n          <Description>\n            <h6>Attributes</h6>\n            <AttributeContainer>\n              {state.attributes ? (\n                state.attributes.map((data) => (\n                  <Attribute>\n                    <div>\n                      <span style={{ color: \"#b2b7c2\" }}>File Type</span>\n                      <p style={{ marginTop: \"10px\" }}>{data.type}</p>\n                    </div>\n                    <div>\n                      <span style={{ color: \"#b2b7c2\" }}>Rarity</span>\n                      <p style={{ marginTop: \"10px\" }}>{data.rarity}%</p>\n                    </div>\n                  </Attribute>\n                ))\n              ) : (\n                <Attribute>\n                  <div>\n                    <span style={{ color: \"#b2b7c2\" }}>File Type</span>\n                    <p style={{ marginTop: \"10px\" }}>PNG</p>\n                  </div>\n                  <div>\n                    <span style={{ color: \"#b2b7c2\" }}>Rarity</span>\n                    <p style={{ marginTop: \"10px\" }}>1%</p>\n                  </div>\n                </Attribute>\n              )}\n            </AttributeContainer>\n          </Description>\n          <Description>\n            <h6>Details</h6>\n            <MintDetails>\n              <span>Mint Address</span>\n              <a\n                target=\"_blank\"\n                href={`https://explorer.near.org/?query=${\n                  state.owner || \"genadrop-contract.nftgen.near\"\n                }`}\n              >\n                {state.owner.length > 12\n                  ? state.owner.slice(0, 12) + \"...\" + \"near\"\n                  : state.owner ||\n                    \"genadrop-contract.nftgen.near\".slice(0, 8) +\n                      \"...\" +\n                      \"near\"}\n              </a>\n            </MintDetails>\n          </Description>\n        </RightSection>\n      </TopSection>\n    </MainContainer>\n    <Widget src=\"jgodwill.near/widget/GenaDrop.Footer\" />\n  </Root>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/agwaze.near/widget/GenaDrop.NFTDetails", "fact_widget_deployments_id": "9e24d9ecd812c6a0e2a23a2b1440079d", "inserted_timestamp": "2023-08-19T15:51:28.807Z", "modified_timestamp": "2023-08-19T15:51:28.807Z", "__row_index": 27}
{"tx_hash": "DwBvJCv9FmFjCgkEZZwaCE5N3RrsYkhGTfbs4uSp2erq", "action_id_social": "wVzWRe5Wo6fY3TfseY7R6QD3Pwd1nyiD2ByASMBmiPE-0-widget", "block_id": 101118909, "block_timestamp": "2023-09-14T16:21:41.670Z", "signer_id": "opencann.near", "widget_name": "substance.metadata", "source_code": "const substance = props.substance ?? \"#/opencann.near/widget/substance\";\r\nconst substanceMetadata = props.substanceMetadata ?? {};\r\nconst cannabis = props.cannabis;\r\nconst onChange = props.onChange;\r\n\r\nState.init({\r\n  substanceMetadata,\r\n  metadata: substanceMetadata,\r\n  reportedMetadata: substanceMetadata,\r\n  substance: metadata.substance ?? {},\r\n  description: substanceMetadata.description,\r\n  consumptionMethod: substanceMetadata.consumptionMethod,\r\n  physicalEffects: substanceMetadata.physicalEffects,\r\n  visualEffects: substanceMetadata.visualEffects,\r\n  auditoryEffects: substanceMetadata.auditoryEffects,\r\n  cognitiveEffects: substanceMetadata.cognitiveEffects,\r\n  multisensoryEffects: substanceMetadata.multisensoryEffects,\r\n  category: substanceMetadata.category,\r\n  image: substanceMetadata.image,\r\n  backgroundImage: substanceMetadata.backgroundImage,\r\n  hashtags: substanceMetadata.hashtags,\r\n  experiences: substanceMetadata.experiences ?? {},\r\n});\r\n\r\nconst metadata = {\r\n  name: options.name ? state.metadata.name : undefined,\r\n  description: options.name ? state.metadata.description : undefined,\r\n  linktree:\r\n    options.linktree && Object.keys(state.linktree).length > 0\r\n      ? state.linktree\r\n      : undefined,\r\n  image:\r\n    options.image && state.image && Object.keys(state.image).length > 0\r\n      ? state.image\r\n      : undefined,\r\n  backgroundImage:\r\n    options.backgroundImage &&\r\n    state.backgroundImage &&\r\n    Object.keys(state.backgroundImage).length > 0\r\n      ? state.backgroundImage\r\n      : undefined,\r\n  tags: options.tags ? state.metadata.tags : undefined,\r\n  screenshots: options.screenshots ? state.metadata.screenshots : undefined,\r\n  demographics:\r\n    options.demographics && Object.keys(state.demographics).length > 0\r\n      ? state.demographics\r\n      : undefined,\r\n};\r\n\r\nconst method = {\r\n  method: [\r\n    \"Smoke\",\r\n    \"Vapor (dry herb)\",\r\n    \"Vapor (concentrate)\",\r\n    \"Edible\",\r\n    \"Drink\",\r\n    \"Tincture\",\r\n    \"Topical\",\r\n    \"Sublingual/buccal\",\r\n  ],\r\n};\r\n\r\nconst physicalEffects = {\r\n  physicalEffects: [\r\n    \"None\",\r\n    \"Appetite enhancement\",\r\n    \"Appetite suppression\",\r\n    \"Bodily pressures (e.g. eye)\",\r\n    \"Changes felt in gravity\",\r\n    \"Decreased blood pressure\",\r\n    \"Dizziness\",\r\n    \"Dehydration\",\r\n    \"Dry mount\",\r\n    \"Gustatory (taste) enhancement\",\r\n    \"Increased heart rate\",\r\n    \"Increased perspiration\",\r\n    \"Insomnia\",\r\n    \"Loss of motor control\",\r\n    \"Muscle relaxation\",\r\n    \"Muscle spasms\",\r\n    \"Nausea\",\r\n    \"Nausea suppression\",\r\n    \"Pain relief\",\r\n    \"Physical euphoria\",\r\n    \"Red eye\",\r\n    \"Sedation\",\r\n    \"Seizure suppression\",\r\n    \"Spontaneous bodily sensations\",\r\n    \"Tactile enhancement\",\r\n  ],\r\n};\r\nconst visualEffects = {\r\n  visualEffects: [\r\n    \"None\",\r\n    \"Color enhancement\",\r\n    \"Blurry vision\",\r\n    \"Brightness alteration\",\r\n    \"Pattern recognition enhancement\",\r\n    \"Tracers\",\r\n    \"Geometry (visuals)\",\r\n    \"Internal hallucination\",\r\n  ],\r\n};\r\n\r\nconst auditoryEffects = {\r\n  auditoryEffects: [\"None\", \"Enhancements\", \"Distortions\", \"Hallucinations\"],\r\n};\r\n\r\nconst cognitiveEffects = {\r\n  cognitiveEffects: [\r\n    \"None\",\r\n    \"Anxiety\",\r\n    \"Anxiety suppression\",\r\n    \"Analysis enhancement\",\r\n    \"Analysis suppression\",\r\n    \"Conceptual thinking\",\r\n    \"Cognitive euphoria\",\r\n    \"Creativity enhancement\",\r\n    \"Delusion\",\r\n    \"Depersonalization\",\r\n    \"Dream suppression\",\r\n    \"Decreased libido\",\r\n    \"Increased libido\",\r\n    \"Emotion enhancement\",\r\n    \"Feelings of impending doom\",\r\n    \"Focus suppression\",\r\n    \"Focus enhancement\",\r\n    \"Immersion enhancement\",\r\n    \"Increased music appreciation\",\r\n    \"Increased sense of humor\",\r\n    \"Laughter fits\",\r\n    \"Memory suppression\",\r\n    \"Mindfulness\",\r\n    \"Motivation suppression\",\r\n    \"Novelty enhancement\",\r\n    \"Paranoia\",\r\n    \"Personal meaning enhancement\",\r\n    \"Psychosis\",\r\n    \"Sleepiness\",\r\n    \"Suggestibility enhancement\",\r\n    \"Thought connectivity\",\r\n    \"Thought deceleration\",\r\n    \"Time distortion\",\r\n  ],\r\n};\r\n\r\nconst multisensoryEffects = { multisensoryEffects: [\"None\", \"Synaesthesia\"] };\r\n\r\nif (\r\n  onChange &&\r\n  JSON.stringify(state.reportedMetadata) !== JSON.stringify(metadata)\r\n) {\r\n  State.update({\r\n    reportedMetadata: metadata,\r\n  });\r\n  onChange(metadata);\r\n}\r\n\r\nconst debounce = (func, wait) => {\r\n  const pause = wait || 350;\r\n  let timeout;\r\n\r\n  return (args) => {\r\n    const later = () => {\r\n      clearTimeout(timeout);\r\n      func(args);\r\n    };\r\n\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(later, pause);\r\n  };\r\n};\r\n\r\nconst onNameChange = debounce((e) => {\r\n  State.update({\r\n    metadata: {\r\n      ...state.metadata,\r\n      name: e.target.value,\r\n    },\r\n  });\r\n});\r\nconst onDescriptionChange = debounce((e) => {\r\n  State.update({\r\n    metadata: {\r\n      ...state.metadata,\r\n      description: e.target.value,\r\n    },\r\n  });\r\n});\r\nconst onLinkTreeChange = debounce((e) => {\r\n  State.update({\r\n    linktree: {\r\n      ...state.linktree,\r\n      [e.target.id]: e.target.value,\r\n    },\r\n  });\r\n});\r\nconst onDemographicsChange = debounce((e) => {\r\n  State.update({\r\n    demographics: {\r\n      ...state.demographics,\r\n      [e.target.id]: e.target.value,\r\n    },\r\n  });\r\n});\r\n\r\nreturn (\r\n  <>\r\n    {substance.name && (\r\n      <div className=\"mb-2\">\r\n        {options.name.label ?? \"Name\"}\r\n        <input\r\n          type=\"text\"\r\n          defaultValue={state.metadata.name}\r\n          onChange={onNameChange}\r\n        />\r\n      </div>\r\n    )}\r\n    {options.image && (\r\n      <div className=\"mb-2\">\r\n        {options.image.label ?? \"Image\"}\r\n        <Widget\r\n          src=\"near/widget/ImageEditorTabs\"\r\n          props={{\r\n            image: state.image,\r\n            onChange: (image) => State.update({ image }),\r\n          }}\r\n        />\r\n      </div>\r\n    )}\r\n    {options.backgroundImage && (\r\n      <div className=\"mb-2\">\r\n        {options.backgroundImage.label ?? \"Background image\"}\r\n        <Widget\r\n          src=\"near/widget/ImageEditorTabs\"\r\n          props={{\r\n            image: state.backgroundImage,\r\n            onChange: (backgroundImage) => State.update({ backgroundImage }),\r\n            debounce,\r\n          }}\r\n        />\r\n      </div>\r\n    )}\r\n    {options.description && (\r\n      <div className=\"mb-2\">\r\n        {options.description.label ?? \"Description\"}\r\n        <span className=\"text-secondary\"> (supports markdown)</span>\r\n        <textarea\r\n          className=\"form-control\"\r\n          rows={5}\r\n          defaultValue={state.metadata.description}\r\n          onChange={onDescriptionChange}\r\n        />\r\n      </div>\r\n    )}\r\n    {options.tags && (\r\n      <div className=\"mb-2\">\r\n        {options.tags.label ?? \"Tags\"}\r\n        <Widget\r\n          src=\"mob.near/widget/TagsEditor\"\r\n          props={{\r\n            substanceTagsObject: metadata.tags,\r\n            tagsPattern: options.tags.pattern,\r\n            placeholder:\r\n              options.tags.placeholder ??\r\n              \"rust, engineer, artist, humanguild, nft, learner, founder\",\r\n            setTagsObject: (tags) => {\r\n              state.metadata.tags = tags;\r\n              State.update();\r\n            },\r\n          }}\r\n        />\r\n      </div>\r\n    )}\r\n    {options.linktree &&\r\n      (options.linktree.links ?? []).map((link) => (\r\n        <div className=\"mb-2\">\r\n          {link.label}\r\n          <div className=\"input-group\">\r\n            <span className=\"input-group-text\">{link.prefix}</span>\r\n            <input\r\n              type=\"text\"\r\n              id={link.name}\r\n              defaultValue={state.linktree[link.name]}\r\n              onChange={onLinkTreeChange}\r\n            />\r\n          </div>\r\n        </div>\r\n      ))}\r\n    {options.demographics &&\r\n      (options.demographics.data ?? []).map((data) => (\r\n        <div className=\"mb-2\">\r\n          {data.label}\r\n          <div className=\"input-group\">\r\n            <span className=\"input-group-text\">{data.prefix}</span>\r\n            <input\r\n              type=\"text\"\r\n              id={data.name}\r\n              defaultValue={state.demographics[data.name]}\r\n              onChange={onDemographicsChange}\r\n            />\r\n          </div>\r\n        </div>\r\n      ))}\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/opencann.near/widget/substance.metadata", "fact_widget_deployments_id": "397a23e1b63b7d283329422efc3b4ff2", "inserted_timestamp": "2023-09-14T18:26:07.975Z", "modified_timestamp": "2023-09-14T18:26:07.975Z", "__row_index": 3}
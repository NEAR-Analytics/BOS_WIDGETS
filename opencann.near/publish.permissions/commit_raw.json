{"tx_hash": "3x7RxTTJF4HMGLyodsPk7aJKzqbKBjMq1rVeZkGX2Uoq", "action_id_social": "BWAgNVVqXZwn9q3hqLUAuNCibP8MmQeREJABGGySR7ox-0-widget", "block_id": 102392816, "block_timestamp": "2023-10-01T18:48:32.435Z", "signer_id": "opencann.near", "widget_name": "publish.permissions", "source_code": "const groups = [\n  \"Public\",\n  \"Members\",\n  \"Licensed Growers\",\n  \"OGs\",\n  \".edu emails\",\n  \"Admin\",\n];\n\nconst rights = {\n  AddMemberToGroup: {\n    title: \"Add Member To Group\",\n    description:\n      \"Add member to given group for only these files. This is a short cut to updating DAO-wide permissions.\",\n  },\n  RemoveMemberFromGroup: {\n    title: \"Remove Member From Group\",\n    description:\n      \"Remove member from given group for only these files. This is a short cut to updating DAO-wide permissions.\",\n  },\n  Vote: {\n    title: \"Text Vote\",\n    description: \"Just a text vote, with no outcome execution.\",\n  },\n  FunctionCall: {\n    title: \"Function Call\",\n    description:\n      \"Calls a smart contract with list of method names in a single promise.\",\n  },\n  Transfer: {\n    title: \"Transfer\",\n    description: \"Transfer NEAR or a fungible token to another account.\",\n  },\n  AddBounty: {\n    title: \"Create a Bounty\",\n    description: \"Add new bounty.\",\n  },\n  BountyDone: {\n    title: \"Bounty Done\",\n    description: \"Indicates that given bounty is done by given user.\",\n  },\n  ChangeConfig: {\n    title: \"Change Config\",\n    description: \"Change the group-level config for this set of files.\",\n  },\n  ChangePolicy: {\n    title: \"Change Policy\",\n    description: \"Change the permissions policy you are currently setting.\",\n  },\n  ChangePolicyAddOrUpdateGroup: {\n    title: \"Add Or Update Group\",\n    description:\n      \"Add new group to the policy. If the group already exists, update it. This is short cut to updating the whole policy.\",\n  },\n  ChangePolicyRemoveGroup: {\n    title: \"Remove Group\",\n    description:\n      \"Remove group from the policy. This is short cut to updating the whole policy.\",\n  },\n  ChangePolicyUpdateDefaultVotePolicy: {\n    title: \"Update Default Vote Policy\",\n    description:\n      \"Update the default vote policy from the policy. This is short cut to updating the whole policy.\",\n  },\n  ChangePolicyUpdateParameters: {\n    title: \"Update DAO Parameters\",\n    description:\n      \"Update the parameters from the policy. This is short cut to updating the whole policy.\",\n  },\n  UpgradeSelf: {\n    title: \"Upgrade Self\",\n    description: \"Upgrade the DAO smart contract code.\",\n  },\n  UpgradeRemote: {\n    title: \"Upgrade Remote\",\n    description: \"Upgrade another smart contract.\",\n  },\n  SetStakingContract: {\n    title: \"Set Staking Contract\",\n    description:\n      \"Set the staking contract. Can only be proposed if staking contract is not set yet\",\n  },\n  FactoryInfoUpdate: {\n    title: \"Factory Info Update\",\n    description: \"Change information about factory and auto update.\",\n  },\n};\n\n// Generate default permisisons\n// note: if you want different default permissions, you can change them here, they will not be overwritten\n// note 2: if you want to disable changing a right for a group, you can set disable to true\n\nlet defaultPermissions = {\n  council: {\n    ChangeConfig: {\n      value: true,\n      disabled: true,\n    },\n    ChangePolicy: {\n      value: true,\n      disabled: true,\n    },\n    RemoveMemberFromGroup: {\n      value: true,\n      disabled: true,\n    },\n    AddMemberToGroup: {\n      value: true,\n      disabled: true,\n    },\n  },\n};\n\ngroups.forEach((group) => {\n  if (defaultPermissions[group] === undefined) defaultPermissions[group] = {};\n  Object.keys(rights).forEach((right) => {\n    if (defaultPermissions[group][right] !== undefined) return;\n    defaultPermissions[group][right] = {\n      value: false,\n    };\n  });\n});\n\nState.init({\n  permissions: defaultPermissions,\n});\n\nconst handleChange = (group, right, value) => {\n  console.log(group, right, value);\n  State.update({\n    permissions: {\n      ...state.permissions,\n      [group]: {\n        ...state.permissions[group],\n        [right]: {\n          ...state.permissions[group][right],\n          value,\n        },\n      },\n    },\n  });\n};\n\nconst Wrapper = styled.div`\n  border-radius: 4px;\n  max-width: 1200px;\n  width: 100%;\n\n  ul {\n    list-style: none;\n    padding: 0;\n    display: flex;\n    flex-direction: column;\n  }\n\n  li {\n    flex: 1;\n    display: grid;\n    grid-template-columns: minmax(100px, 2fr) repeat(\n        auto-fit,\n        minmax(40px, 1fr)\n      );\n    padding: 1rem;\n    min-height: 90px;\n    align-items: center;\n\n    &:nth-child(odd) {\n      background: #f5f5f5;\n    }\n  }\n\n  h2 {\n    font-size: 1.1rem;\n    font-weight: 600;\n    margin: 0;\n  }\n\n  h3 {\n    font-size: 0.9rem;\n    font-weight: 600;\n    margin: 0;\n  }\n\n  p {\n    font-size: 0.8rem;\n    color: #666;\n    margin: 0;\n  }\n\n  .groups {\n    padding: 0;\n    margin: auto;\n    text-align: center;\n  }\n\n  li label {\n    display: none;\n  }\n\n  @media (max-width: 600px) {\n    li {\n      display: flex;\n      flex-wrap: wrap;\n    }\n    li > div:first-child {\n      margin-bottom: 1rem;\n      flex: 1;\n      min-width: 100%;\n    }\n    li label {\n      display: block;\n    }\n    .groups {\n      padding: 8px;\n    }\n    .hide-on-mobile {\n      display: none;\n    }\n  }\n`;\n\nconst Row = ({ right, groups, key }) => (\n  <li>\n    <div>\n      <h3>{right.title}</h3>\n      <p>{right.description}</p>\n    </div>\n    {groups.map((group) => (\n      <div className=\"groups\">\n        <Widget\n          src=\"sking.near/widget/Common.Inputs.Checkbox\"\n          props={{\n            label: group,\n            onChange: (checked) => {\n              handleChange(group, key, checked);\n            },\n            defaultChecked: defaultPermissions[group][key].value,\n            disabled: defaultPermissions[group][key].disabled,\n          }}\n        />\n      </div>\n    ))}\n  </li>\n);\n\nreturn (\n  <Wrapper>\n    <h2>Set group(s) to mangage selected file(s)</h2>\n    <hr></hr>\n    <i>Note: owners have all permissions \"on\" by default.</i>\n    <p></p>\n\n    <ul>\n      <li>\n        <div>\n          <h2>Permissions</h2>\n        </div>\n        {groups.map((group) => (\n          <h3 className=\"groups hide-on-mobile\">{group}</h3>\n        ))}\n      </li>\n      {Object.keys(rights).map((key) => (\n        <Row groups={groups} right={rights[key]} key={key} />\n      ))}\n    </ul>\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/opencann.near/widget/publish.permissions", "fact_widget_deployments_id": "a1d41f953ee6cdb0820e303eb3fb6a11", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
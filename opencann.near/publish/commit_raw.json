{"tx_hash": "3e61QvcpXXvG6wdha9uJSuG3SB9MnfXWuvXeo2FdAdgd", "action_id_social": "GqaxpZoTUvs2QRZakVVxmxS3rmGP6foxZh1m4zBDSQHb-0-widget", "block_id": 101089864, "block_timestamp": "2023-09-14T06:45:41.983Z", "signer_id": "opencann.near", "widget_name": "publish", "source_code": "//integrate with feed, proposals, create subdao groups,\r\n//integrate with marketplace\r\n\r\nconst accountId = props.accountId ?? context.accountId;\r\n\r\nconst defaultPolicy = [accountId];\r\n\r\nState.init({\r\n  name: \"\",\r\n  purpose: \"\",\r\n});\r\n\r\nconst dao_config = {\r\n  purpose: state.purpose,\r\n  bond: \"100000000000000000000000\",\r\n  vote_period: \"604800000000000\",\r\n  grace_period: \"86400000000000\",\r\n  policy: {\r\n    roles: [\r\n      {\r\n        name: \"council\",\r\n        slug: \"council\",\r\n        kind: {\r\n          Group: [accountId],\r\n        },\r\n        permissions: [\r\n          \"*:Finalize\",\r\n          \"policy:AddProposal\",\r\n          \"add_bounty:AddProposal\",\r\n          \"bounty_done:AddProposal\",\r\n          \"transfer:AddProposal\",\r\n          \"vote:AddProposal\",\r\n          \"remove_member_from_role:AddProposal\",\r\n          \"add_member_to_role:AddProposal\",\r\n          \"config:AddProposal\",\r\n          \"call:AddProposal\",\r\n          \"upgrade_remote:AddProposal\",\r\n          \"upgrade_self:AddProposal\",\r\n          \"set_vote_token:AddProposal\",\r\n          \"policy:VoteApprove\",\r\n          \"policy:VoteReject\",\r\n          \"policy:VoteRemove\",\r\n          \"add_bounty:VoteApprove\",\r\n          \"add_bounty:VoteReject\",\r\n          \"add_bounty:VoteRemove\",\r\n          \"bounty_done:VoteApprove\",\r\n          \"bounty_done:VoteReject\",\r\n          \"bounty_done:VoteRemove\",\r\n          \"transfer:VoteApprove\",\r\n          \"transfer:VoteReject\",\r\n          \"transfer:VoteRemove\",\r\n          \"vote:VoteApprove\",\r\n          \"vote:VoteReject\",\r\n          \"vote:VoteRemove\",\r\n          \"remove_member_from_role:VoteApprove\",\r\n          \"remove_member_from_role:VoteReject\",\r\n          \"remove_member_from_role:VoteRemove\",\r\n          \"add_member_to_role:VoteApprove\",\r\n          \"add_member_to_role:VoteReject\",\r\n          \"add_member_to_role:VoteRemove\",\r\n          \"call:VoteApprove\",\r\n          \"call:VoteReject\",\r\n          \"call:VoteRemove\",\r\n          \"config:VoteApprove\",\r\n          \"config:VoteReject\",\r\n          \"config:VoteRemove\",\r\n          \"set_vote_token:VoteApprove\",\r\n          \"set_vote_token:VoteReject\",\r\n          \"set_vote_token:VoteRemove\",\r\n          \"upgrade_self:VoteApprove\",\r\n          \"upgrade_self:VoteReject\",\r\n          \"upgrade_self:VoteRemove\",\r\n          \"upgrade_remote:VoteApprove\",\r\n          \"upgrade_remote:VoteReject\",\r\n          \"upgrade_remote:VoteRemove\",\r\n        ],\r\n        vote_policy: {},\r\n      },\r\n      {\r\n        name: \"all\",\r\n        slug: \"all\",\r\n        kind: \"Everyone\",\r\n        permissions: [\r\n          \"policy:AddProposal\",\r\n          \"add_bounty:AddProposal\",\r\n          \"bounty_done:AddProposal\",\r\n          \"transfer:AddProposal\",\r\n          \"vote:AddProposal\",\r\n          \"remove_member_from_role:AddProposal\",\r\n          \"add_member_to_role:AddProposal\",\r\n          \"config:AddProposal\",\r\n          \"call:AddProposal\",\r\n          \"upgrade_remote:AddProposal\",\r\n          \"upgrade_self:AddProposal\",\r\n          \"set_vote_token:AddProposal\",\r\n          \"vote:VoteApprove\",\r\n          \"vote:VoteReject\",\r\n          \"vote:VoteRemove\",\r\n        ],\r\n        vote_policy: {},\r\n      },\r\n    ],\r\n    default_vote_policy: {\r\n      weight_kind: \"RoleWeight\",\r\n      quorum: \"0\",\r\n      threshold: [1, 2],\r\n    },\r\n    proposal_bond: \"100000000000000000000000\",\r\n    proposal_period: \"604800000000000\",\r\n    bounty_bond: \"100000000000000000000000\",\r\n    bounty_forgiveness_period: \"604800000000000\",\r\n  },\r\n  config: {\r\n    name: state.name,\r\n    purpose: state.purpose,\r\n    metadata: \"\",\r\n  },\r\n};\r\n\r\nconst dao_args = Buffer.from(JSON.stringify(dao_config), \"utf-8\").toString(\r\n  \"base64\"\r\n);\r\n\r\nconst handleCreate = () => {\r\n  Near.call([\r\n    {\r\n      contractName: \"sputnik-dao.near\",\r\n      methodName: \"create\",\r\n      args: {\r\n        name: state.name,\r\n        args: dao_args,\r\n      },\r\n      deposit: \"7000000000000000000000000\",\r\n      gas: \"200000000000000\",\r\n    },\r\n  ]);\r\n};\r\n\r\nconst onChangeName = (name) => {\r\n  State.update({\r\n    name,\r\n  });\r\n};\r\n\r\nconst onChangePurpose = (purpose) => {\r\n  State.update({\r\n    purpose,\r\n  });\r\n};\r\n\r\nreturn (\r\n  <div className=\"mb-3\">\r\n    <h3>Publish New Data</h3>\r\n    <a\r\n      href=\"#/flowscience.near/widget/create.hypercert\"\r\n      target=\"_blank\"\r\n      rel=\"noopener noreferrer\"\r\n    >\r\n      <i>Click here to publish an impact certficate</i>\r\n    </a>\r\n    <hr></hr>\r\n    <h5>\r\n      <a\r\n        href=\"#/opencann.near/widget/ExperienceSurvey\"\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n      >\r\n        *Click here to submit a cannabis experience report\r\n      </a>\r\n    </h5>\r\n    <hr></hr>\r\n    <p>\r\n      Disclaimer: all parts of this component below this message are in\r\n      open-beta and still under active development. DO NOT publish any sensitive\r\n      or proprietary information. We will not be liable for data shared through\r\n      this platform.\r\n    </p>\r\n    <div className=\"mb-2\">\r\n      Name of Data Set\r\n      <input type=\"text\" onChange={(e) => onChangeName(e.target.value)} />\r\n    </div>\r\n    <div className=\"mb-2\">\r\n      Description\r\n      <input type=\"text\" onChange={(e) => onChangePurpose(e.target.value)} />\r\n    </div>\r\n    <div className=\"mb-2\">\r\n      Encrypted Data CID (only for data already on IPFS)\r\n      <input type=\"text\" onChange={(e) => onChangePurpose(e.target.value)} />\r\n    </div>\r\n    <Widget src=\"mob.near/widget/IpfsImageUploadDemo\" />{\" \"}\r\n    <Widget src=\"nearhorizon.near/widget/IpfsFilesUpload\" />\r\n    <Widget src=\"sking.near/widget/DAO.Permissions\" />\r\n    <div>\r\n      <h5> List on Optimism </h5>\r\n      <Widget src=\"ciocan.near/widget/op-bridge-demo\" props={{ ownerId }} />\r\n      <Widget src=\"ciocan.near/widget/op-bridge-list\" props={{ ownerId }} />\r\n    </div>\r\n    <button className=\"btn btn-outline-success mt-3\" onClick={handleCreate}>\r\n      Publish Data Set\r\n    </button>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/opencann.near/widget/publish", "fact_widget_deployments_id": "375fc465f0250d0f07b7b34b1e51ad68", "inserted_timestamp": "2023-09-14T08:42:58.207Z", "modified_timestamp": "2023-09-14T08:42:58.207Z", "__row_index": 10}
{"tx_hash": "7je8QDfFxoW6RaWXTtidhUsHgnZRnNwT3UZmjCe7EuSJ", "action_id_social": "B81ThMYRtQEDSTtxmxj9Ay34uzmg8W4Mncy5iNHmMLc3-0-widget", "block_id": 108717207, "block_timestamp": "2023-12-24T17:08:40.226Z", "signer_id": "cryptogarik.near", "widget_name": "MintNFT", "source_code": "let accountId = context.accountId;\n\nif (!accountId) {\n  return \"Please sign in with NEAR wallet\";\n}\n\nconst profile = socialGetr(`${accountId}/profile`);\n\nif (profile === null) {\n  IpfsImageUpload();\n  return \"Loading\";\n}\n\nconst handleMint = () => {\n  if (!(state.title && state.description && state.image.cid)) {\n    return;\n  }\n  const metadata = {\n    name: state.title,\n    description: state.description,\n    properties: [],\n    image: `ipfs://${state.image.cid}`,\n  };\n\n  asyncFetch(\"https://ipfs.near.social/add\", {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n    },\n    body: metadata,\n  }).then((res) => {\n    const cid = res.body.cid;\n    const deposit = 10000000000000000000000;\n    Near.call({\n      contractName: \"nft.primitives.near\",\n      methodName: \"nft_mint\",\n      args: {\n        token_id: `${Date.now()}`,\n        token_metadata: {\n          title: state.title,\n          description: state.description,\n          media: `https://ipfs.io/ipfs/${state.image.cid}`,\n          reference: `ipfs://${cid}`,\n        },\n        receiver_id: accountId,\n      },\n      deposit: 10000000000000000000000,\n    });\n  });\n};\n\ninitState({\n  title: \"\",\n  description: \"\",\n});\n\nconst onChangeTitle = (title) => {\n  State.update({\n    title,\n  });\n};\n\nconst onChangeDesc = (description) => {\n  State.update({\n    description,\n  });\n};\n\nreturn (\n  <div>\n    <div>Mint NFT primitive</div>\n    <div>\n      Title:\n      <input type=\"text\" onChange={(e) => onChangeTitle(e.target.value)} />\n    </div>\n    <div>\n      Description:\n      <input type=\"text\" onChange={(e) => onChangeDesc(e.target.value)} />\n    </div>\n    <div className=\"flex-grow-1\">\n      <IpfsImageUpload\n        image={state.image}\n        className=\"btn btn-outline-secondary border-0 rounded-3\"\n      />\n    </div>\n    <div>Preview</div>\n    <div>\n      <img\n        src={`https://ipfs.near.social/ipfs/` + state.image.cid}\n        alt=\"uploaded image\"\n        width=\"300\"\n        height=\"300\"\n      />\n    </div>\n    <div>\n      <button onClick={handleMint}>Mint</button>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/cryptogarik.near/widget/MintNFT", "fact_widget_deployments_id": "f8cd7d2634147594179de57d092c150b", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
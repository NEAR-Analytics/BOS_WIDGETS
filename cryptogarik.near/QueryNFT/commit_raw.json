{"tx_hash": "GUuUZrBXAKGvSscMRb5pH44RjaZ573d8kTexK2hPgSJX", "action_id_social": "A6rA9zMxD7ViQ1QEKixLS3UFaDE8YBMrPyQ1Ees1aZYa-0-widget", "block_id": 109990211, "block_timestamp": "2024-01-09T15:12:00.529Z", "signer_id": "cryptogarik.near", "widget_name": "QueryNFT", "source_code": "const image = props.image;\nconst onChange = props.onChange;\n\nState.init({\n  showTokenMetadataSection: false,\n  showTokenTransferSection: false,\n  url: image.url,\n  nft: image.nft ?? {},\n});\n\nconst showTokenMetadataSection = () => {\n  const tokenData = Near.view(state.nft.contractId, \"nft_token\", {\n    token_id: state.nft.tokenId,\n  });\n  State.update({\n    showTokenMetadataSection: !state.showTokenMetadataSection,\n    showTokenTransferSection: false,\n    tokenData,\n  });\n};\n\nconst showTokenTransferSection = () => {\n  State.update({\n    showTokenMetadataSection: false,\n    showTokenTransferSection: !state.showTokenTransferSection,\n  });\n};\n\nconst updateTokenData = () => {\n  const tokenData = Near.view(state.nft.contractId, \"nft_token\", {\n    token_id: state.nft.tokenId,\n  });\n  State.update({ tokenData });\n  console.log(tokenData);\n};\n\nif (state.nft.contractId && state.nft.tokenId) {\n  updateTokenData();\n}\n\nconst handleReceiverIdChange = (event) => {\n  State.update({\n    showTokenMetadataSection: false,\n    showTokenTransferSection: true,\n    receiverId: event.target.value,\n  });\n};\n\nconst handleTransfer = () => {\n  if (!(state.nft.contractId && state.nft.tokenId && state.receiverId)) {\n    return;\n  }\n\n  Near.call({\n    contractName: state.nft.contractId,\n    methodName: \"nft_transfer\",\n    args: {\n      token_id: state.nft.tokenId,\n      receiver_id: state.receiverId,\n    },\n    deposit: 1,\n  });\n};\n\nreturn (\n  <div>\n    <div\n      className=\"p-2\"\n      style={{\n        background: \"#fdfdfd\",\n        border: \"solid 1px #dee2e6\",\n        borderTop: 0,\n        borderBottomLeftRadius: \".375rem\",\n        borderBottomRightRadius: \".375rem\",\n        minHeight: \"9em\",\n      }}\n    >\n      <div>\n        NFT contract\n        <input\n          type=\"text\"\n          value={state.nft.contractId}\n          disabled\n          placeholder=\"Choose a NFT\"\n        />\n        NFT token id\n        <input\n          type=\"text\"\n          value={state.nft.tokenId}\n          onChange={updateTokenData}\n          disabled\n          placeholder=\"Choose a NFT\"\n        />\n        {state.nft.contractId && state.nft.tokenId ? (\n          <div>\n            <button onClick={showTokenTransferSection}>Transfer</button>\n            <button onClick={showTokenMetadataSection}>Show metadata</button>\n          </div>\n        ) : null}\n        {state.showTokenTransferSection ? (\n          <div>\n            <input\n              type=\"text\"\n              value={state.receiverId}\n              placeholder=\"Enter receiver id\"\n              onChange={handleReceiverIdChange}\n            />\n            <button onClick={handleTransfer}>Send NFT</button>\n          </div>\n        ) : null}\n        {state.showTokenMetadataSection && (\n          <div>\n            <div>\n              <h5>Token metadata</h5>\n            </div>\n            <div>{\"Title: \" + state.tokenData.metadata.title}</div>\n            <div>\n              {\"Description: \" + (state.tokenData.metadata.description || \"-\")}\n            </div>\n            <div>{\"Media: \" + state.tokenData.metadata.media}</div>\n            <div>{\"Extra: \" + (state.tokenData.metadata.extra || \"-\")}</div>\n          </div>\n        )}\n        <div className=\"mt-2\">\n          <Widget\n            src={`sainthiago.near/widget/nft-selector`}\n            props={{\n              onChange: ({ contractId, tokenId }) => {\n                State.update({\n                  nft: { contractId: contractId, tokenId: tokenId },\n                });\n              },\n            }}\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/cryptogarik.near/widget/QueryNFT", "fact_widget_deployments_id": "789e055986fc28c59e4d237ed0a493fb", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
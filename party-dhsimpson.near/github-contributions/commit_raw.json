{"tx_hash": "Ch94sZZK1oaVav1ujG4yRm5rz3RCiRGwj5KNxK3eN8Sa", "action_id_social": "2TYRiy8z5sdspQuX1bnkzPnH1NMB48BikotxmYZBZrCQ-0-widget", "block_id": 102971920, "block_timestamp": "2023-10-09T10:42:18.952Z", "signer_id": "party-dhsimpson.near", "widget_name": "github-contributions", "source_code": "//PR\n//https://api.github.com/search/issues?q=type:pr author:dhsimpson -user:dhsimpson\n//\uacf5\ubc31\uc73c\ub85c \uad6c\ubd84\n\n//ISSUE\n//https://api.github.com/search/issues?q=is:issue author:dhsimpson -user:dhsimpson ///state:open///\n\n//Sort \"sort=\" \ud544\uc218\n// &sort=created&order=desc&per_page=30&page=1\nconst [githubNickname, setGithubNickname] = useState(props.githubNickname);\n\nif (!props.token) {\n  return <p>your token is required.</p>;\n}\n\nconst searchBaseUrl = \"https://api.github.com/search/issues?q=\";\nconst nickName = \"dhsimpson\";\nconst defulatFilterList = [\n  `-user:${githubNickname}`,\n  `author:${githubNickname}`,\n];\nconst pullRequestDefaultFilterList = [\"type:pr\"];\nconst issueDefaultFilterList = [\"is:issue\"];\n// const filterOptionList = [\"state:open\", \"state:closed\"];\nconst allState = \"\";\nconst isOpen = \"state:open\";\nconst isClosed = \"state:closed\";\n\nconst config = {\n  headers: {\n    Authorization: `Bearer ${props.token}`,\n  },\n};\n\nconst mergeFilters = (filterLists) => {\n  return [].concat(...filterLists).join(\"%20\");\n};\n\nconst MyContributionWrapper = styled.div`\n    background-color: black;\n    border-radius: 25px;\n    color: white;\n    padding: 20px;\n`;\n\nconst MyContributionList = styled.ul`\n    width: 100%;\n    list-style-type: none;\n    padding: 20px;\n    margin: 0;\n    background-color: rgb(12,17,23);\n    color: white;\n    border-radius: 25px;\n    max-height: 400px;\n    overflow: scroll;\n`;\n\nconst MyContribution = styled.li`\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    height: 70px;\n    border-bottom: 1px solid rgba(125, 125, 225, 0.3);\n`;\n\nconst ContributionInfo = styled.div`\n    display: flex;\n    align-items: center;\n    width: 100%;\n`;\nconst ContributionTitle = styled.span`\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    font-size: 20px;\n`;\nconst ContributionTimeStamp = styled.p`\n    margin: 0;\n    font-size: 12px;\n    color: #BBB;\n`;\n\nconst ContributionBasicInfo = styled.div`\n    max-width: 70%;\n    display: flex;\n    flex-direction: column;\n`;\n\nconst Label = styled.div`\n    background-color: ${(props) => props.color};\n    width: 100px;\n    height: 30px;\n    border-radius: 25px;\n    text-align: center;\n    font-size: 20px;\n    font-weight: 600;\n    margin-left: 15px;\n`;\n\nconst StatusColors = {\n  open: \"rgba(10, 155, 10, 0.8)\", // \ucd08\ub85d\uc0c9\n  closed: \"rgba(255, 0, 0, 0.7)\", // \ube68\uac04\uc0c9\n};\n\nconst [contributionData, setContributionData] = useState([]);\n\nconst [searchOptions, setSearchOptions] = useState([\n  ...defulatFilterList,\n  ...pullRequestDefaultFilterList,\n]);\n\nconst togglePR = () => {\n  //  searchOptions \uc758 \ub0b4\uc6a9\uc5d0 issueDefaultFilterList \uc758 \ub0b4\uc6a9\uc774 \uc788\uc73c\uba74 \uc81c\uac70 \ud6c4\n  //  pullRequestDefaultFilterList\uc758 \ub0b4\uc6a9\ub9cc\uc744 \ucd94\uac00\n  const filteredOptions = searchOptions.filter((option) => {\n    return !issueDefaultFilterList.includes(option);\n  });\n  setSearchOptions([...filteredOptions, ...pullRequestDefaultFilterList]);\n};\n\nconst toggleIssue = () => {\n  //  searchOptions \uc758 \ub0b4\uc6a9\uc5d0 pullRequestDefaultFilterList \uc758 \ub0b4\uc6a9\uc774 \uc788\uc73c\uba74 \uc81c\uac70 \ud6c4\n  //  issueDefaultFilterList \ub0b4\uc6a9\ub9cc\uc744 \ucd94\uac00\n  const filteredOptions = searchOptions.filter((option) => {\n    return !pullRequestDefaultFilterList.includes(option);\n  });\n  setSearchOptions([...filteredOptions, ...issueDefaultFilterList]);\n};\nconst [all, setAll] = useState(true);\nconst [open, setOpen] = useState(false);\nconst [closed, setClosed] = useState(false);\n\nconst toggleAll = () => {\n  //allState isOpen isClosed\n  const filteredOptions = searchOptions.filter((option) => {\n    return ![isOpen, isClosed].includes(option);\n  });\n  setAll(true);\n  setOpen(false);\n  setClosed(false);\n  setSearchOptions([...filteredOptions]);\n};\n\nconst toggleOpen = () => {\n  const filteredOptions = searchOptions.filter((option) => {\n    return isClosed !== option;\n  });\n  setAll(false);\n  setOpen(true);\n  setClosed(false);\n  setSearchOptions([...filteredOptions, isOpen]);\n};\n\nconst toggleClosed = () => {\n  //allState isOpen isClosed\n  const filteredOptions = searchOptions.filter((option) => {\n    return isOpen !== option;\n  });\n  setAll(false);\n  setClosed(true);\n  setOpen(false);\n  setSearchOptions([...filteredOptions, isClosed]);\n};\n\nuseEffect(() => {\n  asyncFetch(`${searchBaseUrl}${mergeFilters([searchOptions])}`, config)\n    .then((res) => {\n      setContributionData(res.body?.items ?? []);\n    })\n    .catch((e) => {\n      setContributionData([]);\n    });\n}, [searchOptions]);\n\nconst [isChecked, setIsChecked] = useState(true);\n\nconst Toggle = ({\n  callbackOn,\n  callbackOff,\n  textOn,\n  textOff,\n  isChecked,\n  setIsChecked,\n}) => {\n  const ToggleBoxWrapper = styled.label`\n    background-color: rgba(20,50,125,1);\n    border-radius: 20px;\n    padding: 5px 10px;\n    font-weight: 600;\n    margin-bottom: 20px;\n`;\n\n  const ToggleBox = styled.input`\n  opacity: 0;\n  width: 0;\n  height: 0;\n`;\n\n  const handleToggle = () => {\n    // \uc5ec\uae30\uc5d0 \ud1a0\uae00 \uc0c1\ud0dc\uc5d0 \ub530\ub978 \ub85c\uc9c1\uc744 \uc2e4\ud589\ud558\uc2e4 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n    if (isChecked) {\n      callbackOn();\n      console.log(\"isChecked\");\n    } else {\n      callbackOff();\n      console.log(\"notChecked\");\n    }\n    setIsChecked(!isChecked);\n  };\n  return (\n    <ToggleBoxWrapper>\n      <ToggleBox\n        type=\"checkbox\"\n        checked={isChecked}\n        onChange={handleToggle}\n        value=\"\uccb4\ud06c \ubc15\uc2a4\"\n      />\n      {isChecked ? textOn : textOff}\n    </ToggleBoxWrapper>\n  );\n};\n\nconst FilterButton = styled.button`\n  background-color: ${(props) => (props.clicked ? \"green\" : \"red\")};\n  color: white;\n  font-weight: 650;\n  border-radius: 20px;\n  padding: 5px 10px;\n  border: none;\n`;\n\nconst OptionWrapper = styled.div`\n  margin: 20px 10px;\n`;\n\nconst FilterState = styled.span`\n  font-size: 24px;\n  font-weight: 650;\n`;\n\nfunction SwitchText({ asis, tobe }) {\n  const BigText = styled.span`\n      font-size: 24px;\n      margin-left: 15px;\n  `;\n\n  const SmallText = styled.span`\n      font-size: 14px;\n      margin-right: 15px;\n  `;\n\n  return (\n    <span>\n      <BigText>{asis}</BigText>\n      <Widget\n        src=\"party-dhsimpson.near/widget/SwitchButtonSvg\"\n        props={{\n          width: \"55\",\n          height: \"30\",\n        }}\n      />\n      <SmallText>{tobe}</SmallText>\n    </span>\n  );\n}\n\nfunction Profile() {\n  const ProfileWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  height: 110px;\n  background-color: rgba(55,55,125,0.5);\n  border-radius: 25px;\n  padding: 0 10px;\n  margin-bottom: 25px;\n`;\n\n  const ProfileImg = styled.img`\n  width: 50px;\n  border-radius: 100%;\n  margin-right: 10px;\n`;\n  const userProfileUrl = \"https://api.github.com/users/\";\n  const userProfile = fetch(`${userProfileUrl}${nickName}`, config)?.body;\n\n  return (\n    <ProfileWrapper>\n      <ProfileImg src={userProfile.avatar_url} />\n      <span>{userProfile.name}</span>\n    </ProfileWrapper>\n  );\n}\n\nconst changeName = (newName) => {\n  //allState isOpen isClosed\n  const filteredOptions = searchOptions.filter((option) => {\n    return `author:${githubNickname}` !== option;\n  });\n  setGithubNickname(newName);\n\n  setSearchOptions([...filteredOptions, `author:${newName}`]);\n};\n\nconst ChangeNameWrapper = styled.div`\n  display: flex;\n  margin-top: 10px;\n`;\nconst ChangeNameButton = styled.button`\n  width: 100px;\n  margin-left: 10px;\n  border: none;\n  background-color: rgba(40,70,145,0.8);\n  border-radius: 15px;\n  color: white;\n  font-weight: 600;\n`;\nconst [tempText, setTempText] = useState(\"\");\n\nconst handleInputChange = (event) => {\n  setTempText(event.target.value);\n};\n\nreturn (\n  <MyContributionWrapper>\n    <OptionWrapper>\n      <Profile />\n      <Toggle\n        callbackOn={toggleIssue}\n        callbackOff={togglePR}\n        textOn={<SwitchText asis={\"Pull Request\"} tobe={\"Issue\"} />}\n        textOff={<SwitchText asis={\"Issue\"} tobe={\"Pull Request\"} />}\n        isChecked={isChecked}\n        setIsChecked={setIsChecked}\n      />\n      <br />\n      <FilterState>STATE : </FilterState>\n      <FilterButton clicked={all} onClick={toggleAll}>\n        ALL State\n      </FilterButton>\n      <FilterButton clicked={open} onClick={toggleOpen}>\n        Open\n      </FilterButton>\n      <FilterButton clicked={closed} onClick={toggleClosed}>\n        Closed\n      </FilterButton>\n      {props.canChangeAuthor && (\n        <ChangeNameWrapper>\n          <input\n            type=\"text\"\n            name=\"github_nickname\"\n            placeholder=\"\ub2c9\ub124\uc784\uc744 \uc785\ub825\ud558\uc138\uc694.\"\n            onChange={handleInputChange}\n          />\n          <ChangeNameButton\n            onClick={() => {\n              changeName(tempText);\n            }}\n          >\n            \uc801\uc6a9\n          </ChangeNameButton>\n        </ChangeNameWrapper>\n      )}\n    </OptionWrapper>\n    <MyContributionList>\n      {contributionData.map((issue) => {\n        return (\n          <MyContribution>\n            <ContributionInfo>\n              <ContributionBasicInfo>\n                <ContributionTitle>{issue.title}</ContributionTitle>\n                <ContributionTimeStamp>\n                  opened :\n                  <Widget\n                    src=\"party-dhsimpson.near/widget/past-time-from\"\n                    props={{ date: issue.created_at }}\n                  />\n                  {issue.state === \"closed\" && (\n                    <>\n                      closed :\n                      <Widget\n                        src=\"party-dhsimpson.near/widget/past-time-from\"\n                        props={{ date: issue.closed_at }}\n                      />\n                    </>\n                  )}\n                </ContributionTimeStamp>\n              </ContributionBasicInfo>\n              <Label color={StatusColors[issue.state]}>{issue.state}</Label>\n            </ContributionInfo>\n            <a href={issue.html_url}>\n              <Widget\n                src=\"party-dhsimpson.near/widget/gotoSvg\"\n                props={{ width: 20, heigh: 20, color: \"gray\" }}\n              />\n            </a>\n          </MyContribution>\n        );\n      })}\n    </MyContributionList>\n  </MyContributionWrapper>\n);\n", "metadata": {}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/party-dhsimpson.near/widget/github-contributions", "fact_widget_deployments_id": "4b91191dcb3e1c182ab420f35737b520", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
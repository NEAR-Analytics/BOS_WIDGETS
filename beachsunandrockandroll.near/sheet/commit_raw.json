{"tx_hash": "CPotWkYBotLrru2KVFkV8hdVpdjbE7R4KYUf4R1zaJA", "action_id_social": "GT9z4JEZPrm4jr9dTZGx91NM5FTiixyMyTf2DFQpCM5T-0-widget", "block_id": 105980184, "block_timestamp": "2023-11-18T13:46:57.342Z", "signer_id": "beachsunandrockandroll.near", "widget_name": "sheet", "source_code": "const sheetIdx = props.sheetIdx || 0;\nconst back = props.back;\n\nconst { getNormalDate, ppdContract, ppdAbi } = VM.require(\n  \"beachsunandrockandroll.near/widget/utils\"\n);\n\nState.init({\n  userSheets: [],\n});\n\nconst getUserSheets = () => {\n  if (ppdContract == undefined) return;\n\n  const ppd = new ethers.Contract(\n    ppdContract,\n    ppdAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  ppd.getUserIdx().then((userIdx) => {\n    ppd.getUserSheets(parseInt(userIdx.toString())).then((userSheets) => {\n      userSheets.map((userSheet, i) => {\n        if (i === sheetIdx) {\n          const sheet = {\n            name: userSheet[0],\n            createdAt: getNormalDate(userSheet[1]),\n            difficulty: userSheet[2],\n            dataUri: userSheet[3],\n          };\n          State.update({ sheet });\n        }\n      });\n    });\n  });\n};\n\nif (state.sender === undefined) {\n  const accounts = Ethers.send(\"eth_requestAccounts\", []);\n  if (accounts.length) {\n    State.update({ sender: accounts[0] });\n    getUserSheets();\n  }\n}\n\nreturn (\n  <>\n    <h2>{state.sheet.name}</h2>\n    <button onClick={back}>Back</button>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/beachsunandrockandroll.near/widget/sheet", "fact_widget_deployments_id": "d03bd96352cb64bef922e4cfbc47cf0e", "inserted_timestamp": "2023-11-18T15:40:42.460Z", "modified_timestamp": "2023-11-18T15:40:42.460Z", "__row_index": 3}
{"tx_hash": "HBBuiBdP4T9fE3ro4xscACr2Q15ArcHoekZkjm3hV97g", "action_id_social": "FjPsZHeZqsLRsHKqH99yPmBtWKnNr5NjcKSpxqzp9fu3-0-widget", "block_id": 106021205, "block_timestamp": "2023-11-19T01:36:59.266Z", "signer_id": "beachsunandrockandroll.near", "widget_name": "composerList", "source_code": "const { getNormalDate, ppdContract, ppdAbi } = VM.require(\n  \"beachsunandrockandroll.near/widget/utils\"\n);\nconst [addComposer, setAddComposer] = useState(false);\n\nconst back = props.back;\n\nState.init({\n  composers: [],\n});\n\nconst getComposerList = () => {\n  if (ppdContract == undefined) return;\n\n  const ppd = new ethers.Contract(\n    ppdContract,\n    ppdAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  ppd.getComposers().then((res) => {\n    const composers = res.map((composer, i) => ({\n      name: composer[0],\n      birtdate: composer[1],\n    }));\n\n    State.update({ composers });\n  });\n};\n\nif (state.sender === undefined) {\n  const accounts = Ethers.send(\"eth_requestAccounts\", []);\n  if (accounts.length) {\n    State.update({ sender: accounts[0] });\n    getComposerList();\n  }\n}\n\nconst GridWrap = styled.div`\n\n.gap-4 {\n    gap: 1rem;\n}\n\n.grid-cols-2 {\n    grid-template-columns: repeat(4,minmax(0,1fr));\n}\n.grid {\n    display: grid;\n}\n  `;\n\nreturn (\n  <div class=\"px-3 py-5\">\n    <h3 class=\"text-center\">\n      {state.composers.length === 0 ? \"No Composers Found\" : \"Composer List\"}\n    </h3>\n    {!addComposer && (\n      <button onClick={() => setAddComposer(true)} class=\"mb-4 btn btn-primary\">\n        New Composer\n      </button>\n    )}\n\n    {addComposer ? (\n      <div class=\"pt-2 pb-2\">\n        <h5 class=\"text-center pb-2\">Fill the Form to Add a Composer</h5>\n        <Widget\n          src={`beachsunandrockandroll.near/widget/addComposer`}\n          props={{ setAddComposer }}\n        />\n      </div>\n    ) : (\n      <GridWrap>\n        <div class=\"grid gap-4 grid-cols-2\">\n          {state.composers.map((composer, i) => (\n            <Widget\n              src={`beachsunandrockandroll.near/widget/card`}\n              props={{\n                title: composer.name,\n                desc: composer.birtdate,\n              }}\n            />\n          ))}\n        </div>\n      </GridWrap>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/beachsunandrockandroll.near/widget/composerList", "fact_widget_deployments_id": "d8a85931881aa298a741352d79864e03", "inserted_timestamp": "2023-11-19T03:26:27.377Z", "modified_timestamp": "2023-11-19T03:26:27.377Z", "__row_index": 0}
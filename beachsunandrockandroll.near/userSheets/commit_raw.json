{"tx_hash": "FKQ2hV6HwfZaGSYaLGNRY8V8UQQXF6gm26TvwQn9LoyR", "action_id_social": "2kenFSkEYNVAfnvsL4DEqQRJoHd3wUt1NqAx179uFfTT-0-widget", "block_id": 105974535, "block_timestamp": "2023-11-18T12:08:38.452Z", "signer_id": "beachsunandrockandroll.near", "widget_name": "userSheets", "source_code": "// const ppdContract = props.ppdContract;\n// const ppdAbi = props.ppdAbi;\n\nconst ppdContract = \"0x4D8354Eda3c1Cd9D85E44C63535468Ec3EaF876C\";\n\nconst ppdAbi = fetch(\n  \"https://raw.githubusercontent.com/gonzalobarria/testpub/master/abis/abitest.json\"\n);\n\nState.init({\n  userSheets: [],\n});\n\nconst getNormalDate = (value) =>\n  new Date(parseInt(value.toString() + \"000\")).toLocaleString();\n\nconst getUserSheets = () => {\n  if (ppdContract == undefined) return;\n\n  const ppd = new ethers.Contract(\n    ppdContract,\n    ppdAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  ppd.getUserIdx().then((userIdx) => {\n    ppd.getUserSheets(parseInt(userIdx.toString())).then((res) => {\n      console.log(res);\n      // const comp = res && res.map((r) => r[0]);\n      State.update({ userSheets: res });\n    });\n  });\n};\n\nif (state.sender === undefined) {\n  const accounts = Ethers.send(\"eth_requestAccounts\", []);\n  if (accounts.length) {\n    State.update({ sender: accounts[0] });\n    console.log(\"asa\");\n    getUserSheets();\n  }\n}\n\nconst GridWrap = styled.div`\n.gap-4 {\n    gap: 1rem;\n}\n\n.grid-cols-2 {\n    grid-template-columns: repeat(2,minmax(0,1fr));\n}\n.grid {\n    display: grid;\n}\n  `;\n\nreturn (\n  <>\n    {state.userSheets.length === 0 && (\n      <h2 class=\"text-center\">No Sheets Founded</h2>\n    )}\n    {state.userSheets.map((userSheet, i) => {\n      return (\n        <GridWrap>\n          <div class=\"grid gap-4 grid-cols-2\">\n            <Widget\n              src={`beachsunandrockandroll.near/widget/card`}\n              props={{\n                title: userSheet[0],\n                desc: getNormalDate(userSheet[1]),\n                buttonTitle: \"View Sheet\",\n                // action:\n              }}\n            />\n\n            {/* <button\n              onClick={() => {\n                setAddRecord(true);\n                setSheetIdx(i);\n              }}\n            >\n              New Record\n            </button>*/}\n          </div>\n        </GridWrap>\n      );\n    })}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/beachsunandrockandroll.near/widget/userSheets", "fact_widget_deployments_id": "f20500771590cbc5be927a66df818c5d", "inserted_timestamp": "2023-11-18T13:56:37.404Z", "modified_timestamp": "2023-11-18T13:56:37.404Z", "__row_index": 0}
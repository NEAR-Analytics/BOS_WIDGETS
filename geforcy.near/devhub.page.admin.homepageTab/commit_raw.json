{"tx_hash": "6oW1u3F6rnFrrEwMSvryvPs5X4yhcSrFDCEeUVHJswfe", "action_id_social": "GEVwU6DKNeVjZUyK97hqm4GiNvgDGY5JBQndRzXBGK8z-0-widget", "block_id": 116350384, "block_timestamp": "2024-04-07T22:42:24.921Z", "signer_id": "geforcy.near", "widget_name": "devhub.page.admin.homepageTab", "source_code": "const {\n  getFeaturedCommunities,\n  setFeaturedCommunities,\n  getAllCommunitiesMetadata,\n} = VM.require(\"geforcy.near/widget/core.adapter.devhub-contract\");\n\nconst { Tile } =\n  VM.require(\"geforcy.near/widget/devhub.components.molecule.Tile\") ||\n  (() => <></>);\n\nif (\n  !getFeaturedCommunities ||\n  !setFeaturedCommunities ||\n  !getAllCommunitiesMetadata ||\n  !Tile\n) {\n  return <p>Loading modules...</p>;\n}\n\nconst fc = getFeaturedCommunities();\n// The state will stay empty even after the data right data has been retrieved\nif (!fc) {\n  return <p>Loading featured communities...</p>;\n}\nconst featuredCommunityList = fc || [];\n\nconst allCommunities = getAllCommunitiesMetadata();\n\nconst [communityMessage, setCommunityMessage] = useState(\"\");\nconst [previewConnect, setPreviewConnect] = useState(false);\n\nconst [communityHandles, setCommunityHandles] = useState(\n  featuredCommunityList.map(({ handle }) => handle)\n);\nconst handleResetItems = () => {\n  setCommunityHandles(featuredCommunityList.map(({ handle }) => handle));\n};\n\nfunction handleSubmit() {\n  if (communityHandles.length < 4) {\n    return setCommunityMessage(\"Can't set fewer than 4 communities\");\n  }\n  setFeaturedCommunities({ handles: communityHandles });\n}\n\nreturn (\n  <>\n    <Widget\n      src=\"geforcy.near/widget/devhub.components.atom.Alert\"\n      props={{\n        onClose: () => setCommunityMessage(\"\"),\n        message: communityMessage,\n      }}\n    />\n    <Tile className=\"p-3 mb-3\">\n      <h3> Manage featured communities</h3>\n      <Widget\n        src=\"geforcy.near/widget/devhub.components.molecule.ListEditor\"\n        props={{\n          data: {\n            maxLength: 5,\n            placeholder: \"Community handle\",\n            prefix: \"Community handle\",\n            list: communityHandles,\n          },\n          setList: setCommunityHandles,\n          validate: (newItem) => {\n            return allCommunities.map(({ handle }) => handle).includes(newItem);\n          },\n          invalidate: () =>\n            setCommunityMessage(\n              \"This community handle does not exist, make sure you use an existing handle.\"\n            ),\n        }}\n      />\n\n      <div\n        className={\"d-flex align-items-center justify-content-end gap-3 mt-4\"}\n      >\n        <Widget\n          src={\"geforcy.near/widget/devhub.components.molecule.Button\"}\n          props={{\n            classNames: {\n              root: \"btn-outline-danger shadow-none border-0\",\n            },\n            label: \"Cancel\",\n            onClick: handleResetItems,\n          }}\n        />\n        <Widget\n          src={\"geforcy.near/widget/devhub.components.molecule.Button\"}\n          props={{\n            classNames: { root: \"btn\" },\n            icon: {\n              type: \"bootstrap_icon\",\n              variant: \"bi-check-circle-fill\",\n            },\n            label: \"Submit\",\n            onClick: handleSubmit,\n          }}\n        />\n      </div>\n    </Tile>\n    <Widget\n      src={\"geforcy.near/widget/devhub.components.molecule.PostControls\"}\n      props={{\n        onClick: () => setPreviewConnect(!previewConnect),\n        icon: previewConnect ? \"bi bi-toggle-on\" : \"bi bi-toggle-off\",\n        title: \"Preview homepage\",\n        testId: \"preview-homepage\",\n      }}\n    />\n    <div class=\"mt-3\">\n      {previewConnect && (\n        <Widget\n          src=\"geforcy.near/widget/devhub.components.island.connect\"\n          props={{ ...props }}\n        />\n      )}\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/geforcy.near/widget/devhub.page.admin.homepageTab", "fact_widget_deployments_id": "8d7c1e71f165d7b7ab45c638a0bf9a41", "inserted_timestamp": "2024-04-08T00:45:59.861Z", "modified_timestamp": "2024-04-08T00:45:59.861Z", "__row_index": 4}
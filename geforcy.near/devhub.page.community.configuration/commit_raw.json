{"tx_hash": "6oW1u3F6rnFrrEwMSvryvPs5X4yhcSrFDCEeUVHJswfe", "action_id_social": "GEVwU6DKNeVjZUyK97hqm4GiNvgDGY5JBQndRzXBGK8z-0-widget", "block_id": 116350384, "block_timestamp": "2024-04-07T22:42:24.921Z", "signer_id": "geforcy.near", "widget_name": "devhub.page.community.configuration", "source_code": "const { Tile } =\n  VM.require(\"geforcy.near/widget/devhub.components.molecule.Tile\") ||\n  (() => <></>);\n\nif (!Tile) {\n  return <div>Loading...</div>;\n}\n\nconst {\n  permissions,\n  handle,\n  community,\n  setCommunityAddons,\n  deleteCommunity,\n  updateCommunity,\n} = props;\n\nconst [communityData, setCommunityData] = useState(community || {});\nconst [selectedAddon, setSelectedAddon] = useState(null);\nconst [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n\nconst sectionSubmit = (sectionData) => {\n  const updatedCommunityData = {\n    ...Object.entries(sectionData).reduce(\n      (update, [propertyKey, propertyValue]) => ({\n        ...update,\n\n        [propertyKey]:\n          typeof propertyValue !== \"string\" || (propertyValue?.length ?? 0) > 0\n            ? propertyValue ?? null\n            : null,\n      }),\n\n      communityData\n    ),\n  };\n  setCommunityData(updatedCommunityData);\n  setHasUnsavedChanges(true);\n};\n\nconst hasConfigurePermissions = permissions.can_configure;\nconst hasDeletePermissions = permissions.can_delete;\n\nreturn (\n  <div\n    className=\"d-flex flex-column align-items-center gap-4 w-100 p-4\"\n    style={{ maxWidth: 960, marginBottom: \"60px\" }}\n  >\n    <Tile className={\"bg-white\"}>\n      <Widget\n        src={\n          \"geforcy.near/widget/devhub.entity.community.configuration.BrandingConfigurator\"\n        }\n        props={{\n          onSubmit: sectionSubmit,\n          data: communityData,\n          hasConfigurePermissions,\n          link: `/geforcy.near/widget/app?page=community&handle=${handle}`,\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3 bg-white\"}>\n      <Widget\n        src={\n          \"geforcy.near/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"Community Information\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"geforcy.near/widget/devhub.entity.community.configuration.InformationConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3 bg-white\"}>\n      <Widget\n        src={\n          \"geforcy.near/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"About\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"geforcy.near/widget/devhub.entity.community.configuration.AboutConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3 bg-white\"}>\n      <Widget\n        src={\n          \"geforcy.near/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"Community Admins\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"geforcy.near/widget/devhub.entity.community.configuration.AccessControlConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    {hasConfigurePermissions && (\n      <Tile className={\"p-3 bg-white\"}>\n        <Widget\n          src={\n            \"geforcy.near/widget/devhub.entity.community.configuration.ConfigurationSection\"\n          }\n          props={{\n            title: \"Add-Ons\",\n            hasConfigurePermissions,\n            Configurator: (p) => (\n              <Widget\n                src={\n                  \"geforcy.near/widget/devhub.entity.community.configuration.AddonsConfigurator\"\n                }\n                props={{\n                  data: communityData.addons || [],\n                  onSubmit: (v) => setCommunityAddons({ handle, addons: v }),\n                  ...p,\n                }}\n              />\n            ),\n          }}\n        />\n      </Tile>\n    )}\n    {hasDeletePermissions && (\n      <div\n        className=\"d-flex justify-content-center gap-4 p-4 w-100\"\n        style={{ maxWidth: 896 }}\n      >\n        <Widget\n          src={\"geforcy.near/widget/devhub.components.molecule.Button\"}\n          props={{\n            classNames: { root: \"btn-lg btn-outline-danger border-none\" },\n            label: \"Delete community\",\n            onClick: () => deleteCommunity({ handle }),\n          }}\n        />\n      </div>\n    )}\n    {hasConfigurePermissions && hasUnsavedChanges && (\n      <div\n        className=\"position-fixed end-0 bottom-0 bg-transparent pe-4 pb-4\"\n        style={{ borderTopLeftRadius: \"100%\" }}\n      >\n        <Widget\n          src={\"geforcy.near/widget/devhub.components.molecule.Button\"}\n          props={{\n            classNames: { root: \"btn-lg btn-success\" },\n            icon: { type: \"svg_icon\", variant: \"floppy_drive\" },\n            label: \"Save\",\n            onClick: () =>\n              updateCommunity({ handle, community: communityData }), // TODO : Track changes in State\n          }}\n        />\n      </div>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/geforcy.near/widget/devhub.page.community.configuration", "fact_widget_deployments_id": "bc1480a18b704aec3b3eea2935ea5a3a", "inserted_timestamp": "2024-04-08T00:45:59.861Z", "modified_timestamp": "2024-04-08T00:45:59.861Z", "__row_index": 14}
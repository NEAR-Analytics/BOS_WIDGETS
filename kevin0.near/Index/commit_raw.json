{"tx_hash": "9JmpHJXtWVrJc7N4ZGDRcR7wvhTZ6meu32UabPw4dJSs", "action_id_social": "9Nha9QxTmDFX7z19dZX93xJ1STYRd5PecgdvJqRnAEgt-0-widget", "block_id": 111153979, "block_timestamp": "2024-01-23T23:00:31.346Z", "signer_id": "kevin0.near", "widget_name": "Index", "source_code": "const ownerId = \"nearhorizon.near\";\n\nState.init({\n  tnc: true,\n  tncIsFetched: false,\n  tosAccept: true,\n});\n\nif (context.accountId && !state.tncIsFetched) {\n  Near.asyncView(\n    \"social.near\",\n    \"get\",\n    {\n      keys: [\n        `${context.accountId}/profile/horizon_tnc`,\n        `${context.accountId}/index/tosAccept`,\n      ],\n    },\n    \"final\",\n    false,\n  ).then((data) =>\n    State.update({\n      tnc: data[context.accountId]?.profile?.horizon_tnc === \"true\",\n      tosAccept:\n        data[context.accountId]?.index?.tosAccept &&\n        data[context.accountId]?.index?.tosAccept.length > 0,\n      tncIsFetched: true,\n    }),\n  );\n}\n\nconst tabContentWidget = {\n  home: \"Dashboard\",\n  inbox: \"Inbox\",\n  manage: \"Manage\",\n  project: \"Project.Page\",\n  request: \"Request.Page\",\n  vendor: \"Vendor.Page\",\n  backer: \"Investor.Page\",\n  contribution: \"Contribution.Page\",\n  createproject: \"Project.Form\",\n  createrequest: \"Request.Form\",\n  createvendor: \"Vendor.Form\",\n  createbacker: \"Investor.Form\",\n  permissions: \"Inputs.SetUpPermissions\",\n  learn: \"Learn.Page\",\n  faq: \"FAQ.Page\",\n  help: \"Help.Page\",\n  legal: \"TNCPage\",\n  admin: \"Admin.Page\",\n  projects: \"Project.ListPage\",\n  investors: \"Investor.ListPage\",\n  backers: \"Investor.ListPage\",\n  vendors: \"Vendor.ListPage\",\n  contributors: \"Vendor.ListPage\",\n  requests: \"Request.ListPage\",\n  partners: \"Application.Page\",\n  partner: \"Application.DetailPage\",\n  \"my-projects\": \"Manage.Projects\",\n  \"my-requests\": \"Manage.Requests\",\n  \"my-contracts\": \"Manage.Contracts\",\n  \"my-applications\": \"Manage.Applications\",\n  events: \"Events.Page\",\n  perks: \"Perks.Page\",\n  profile: \"Profile.Page\",\n};\n\nconst getTabWidget = (tab) => {\n  if (tab in tabContentWidget) {\n    return tabContentWidget[tab];\n  }\n\n  return \"Dashboard\";\n};\n\nconst tabContent = (\n  <Widget\n    src={`${ownerId}/widget/${getTabWidget(props.tab)}`}\n    props={{\n      ...props,\n      urlProps: props,\n    }}\n  />\n);\n\nconst Page = styled.div`\n  width: 100%;\n  border-radius: 0.5rem;\n  border: 1px solid #eaeaea;\n`;\n\nconst Content = styled.div`\n  width: 100%;\n  background: #ffffff;\n  padding: 3em;\n  border-radius: 0rem 0rem 1.5rem 1.5rem;\n  border-top: 1px solid var(--ui-elements-light, #eceef0);\n  background: var(--base-white, #fff);\n\n  &.form {\n    border: none;\n    background: #fafafa;\n  }\n\n  * {\n    margin: 0;\n    padding: 0;\n  }\n`;\n\nconst showSidebar = ![\n  \"createproject\",\n  \"createrequest\",\n  \"createvendor\",\n  \"createbacker\",\n  \"permissions\",\n  \"legal\",\n].includes(props.tab);\nconst isForm = [\n  \"createproject\",\n  \"createrequest\",\n  \"createvendor\",\n  \"createbacker\",\n].includes(props.tab);\nconst showTncDialog = !state.tnc && state.tosAccept && props.tab !== \"legal\";\n\nreturn (\n  <>\n    <Widget src={`${ownerId}/widget/Help.FeedbackButton`} />\n    <Widget\n      src={`${ownerId}/widget/TNCModal`}\n      props={{\n        open: showTncDialog,\n        accept: () =>\n          Social.set(\n            { profile: { horizon_tnc: true } },\n            {\n              onCommit: () => {\n                State.update({ tnc: true });\n              },\n            },\n          ),\n      }}\n    />\n    <Widget src={`${ownerId}/widget/Header`} />\n    <Page>\n      <Widget\n        src={`${ownerId}/widget/NavbarControl`}\n        props={{ tab: props.tab }}\n      />\n      <Content className={isForm ? \"form\" : \"\"}>{tabContent}</Content>\n    </Page>\n  </>\n);\n", "metadata": {"fork_of": "nearhorizon.near/widget/Index@101408611"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/kevin0.near/widget/Index", "fact_widget_deployments_id": "2417b905a17d773b3f540203a59f0d16", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 216}
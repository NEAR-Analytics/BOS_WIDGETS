{"tx_hash": "EPHegbfNJ4NP5hjMGCSsTsu3bJRdWVykpryDiFKz9Lsf", "action_id_social": "GTpcYncFHKeb1g6oBSwPc85BZfeuc4KRMwVBUjfZpKUW-0-widget", "block_id": 101838918, "block_timestamp": "2023-09-24T09:35:32.472Z", "signer_id": "azbang.near", "widget_name": "peer2peerMakeOrder", "source_code": "const sender = Ethers.send(\"eth_requestAccounts\", [])[0];\nif (!sender) return \"Please login first\";\nconst signer = Ethers.provider().getSigner();\n\nconst PaymentRequest =\n  \"(address payable requester, uint256 amount, bytes32 zelleEmailHash, address payable executor)\";\nconst abi = [\n  \"function createPaymentRequest(uint256 amount, bytes32 _zelleEmailHash) external returns (uint256)\",\n  `function getPaymentRequestsByIds(uint256[] memory requestIds) external view returns (${PaymentRequest}[] memory)`,\n  \"function reservePayment(uint256 requestId)\",\n  \"function confirmPayment(uint256 requestId, uint256 transactionId)\",\n  \"event PaymentReserved(uint256 requestId, address indexed reserver)\",\n];\n\nconst CONTRACT = \"0xa3724030aA74016d1AE1e1B54bD79608F0E5866F\";\nconst tokenAddress = \"0x8c9e6c40d3402480ACE624730524fACC5482798c\";\nconst erc20abi = [\"function approve(address _spender, uint _value)\"];\nconst erc20 = new ethers.Contract(tokenAddress, erc20abi, signer);\nconst peer2peer = new ethers.Contract(CONTRACT, abi, signer);\nconst daiDecimal = 18;\n\npeer2peer.getPaymentRequestsByIds([props.order]).then(([data]) => {\n  State.update({\n    order: {\n      requester: data[0],\n      amount: ethers.utils.formatEther(data[1], daiDecimal),\n      zelleHash: data[2],\n      executor: data[3],\n    },\n  });\n});\n\nconst handleVerify = (proof) => {\n  console.log(proof);\n};\n\nconst order = state.order;\nif (!order) return \"\";\n\nconst Container = styled.div`\n    * {\n      font-family:  -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;\n    }\n\n    display: flex;\n    margin: 48px auto;\n    justify-content: center;\n    flex-direction: column;\n    width: 400px;\n`;\n\nreturn (\n  <Container>\n    <h4 style={{ lineBreak: \"anywhere\" }}>{order.requester}</h4>\n    <p style={{ marginBottom: 0 }}>{order.amount} DAI</p>\n\n    <div style={{ marginTop: -32 }}>\n      <Widget\n        src=\"azbang.near/widget/plaid\"\n        props={{ onVerified: handleVerify }}\n      />\n    </div>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/azbang.near/widget/peer2peerMakeOrder", "fact_widget_deployments_id": "28bca05c38235d3f07e9bac65aff297d", "inserted_timestamp": "2023-09-24T11:32:59.956Z", "modified_timestamp": "2023-09-24T11:32:59.956Z", "__row_index": 0}
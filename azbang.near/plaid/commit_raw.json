{"tx_hash": "3PkR5Q3SpuvnrhpLyEdD2eiHZE3wjxZUmo9gnDqxyykk", "action_id_social": "ET21ibA8MGah1pzjMEwFbNALqj985MGz3LMfBzxHBjTu-0-widget", "block_id": 101787110, "block_timestamp": "2023-09-23T16:56:35.659Z", "signer_id": "azbang.near", "widget_name": "plaid", "source_code": "const PLAID_API = \"http://localhost:3000\";\nState.init({ origin: null });\n\nconst accessToken = state.accessToken || Storage.privateGet(\"plaidAccessToken\");\nif (accessToken === null) {\n  return <p>Loading</p>;\n}\n\nif (accessToken) {\n  const response = fetch(`${PLAID_API}/transactions?token=${accessToken}`);\n  if (response.body == null) return <p>Loading</p>;\n\n  return (\n    <div>\n      <p>Bank connected {accessToken}</p>\n      {response.body.add.map((tx) => (\n        <div>\n          <p>{tx.name}</p>\n          <p>\n            {tx.amount} {tx.iso_currency_code}\n          </p>\n        </div>\n      ))}\n    </div>\n  );\n}\n\n// Connecting bank\nif (props.public_token) {\n  const response = fetch(`${PLAID_API}/exchange-public-token`, {\n    body: JSON.stringify({ public_token: props.public_token }),\n    headers: { \"Content-Type\": \"application/json\" },\n    method: \"POST\",\n  });\n\n  if (response.ok) {\n    Storage.privateSet(\"plaidAccessToken\", response.body.access_token);\n    State.update({ accessToken: response.body.access_token });\n    return <p>Bank connecting...</p>;\n  }\n}\n\nconst location = `${state.origin}/${context.widgetSrc}`;\nconst src = `\n<script>\nconst origin = document.location.ancestorOrigins[0];\nwindow.top.postMessage(origin, \"*\")\n</script>\n`;\n\nreturn (\n  <div>\n    <a href={`${PLAID_API}?return_url=${location}`}>Connect bank</a>{\" \"}\n    <iframe\n      style={{ display: \"none\" }}\n      onMessage={(origin) => {\n        console.log(origin);\n        State.update({ origin });\n      }}\n      srcDoc={src}\n    ></iframe>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/azbang.near/widget/plaid", "fact_widget_deployments_id": "ed19a875243a8132225ef4859ee90938", "inserted_timestamp": "2023-09-23T18:44:44.849Z", "modified_timestamp": "2023-09-23T18:44:44.849Z", "__row_index": 33}
{"tx_hash": "GcuxAr7fjw7n3crydibHBx2SRKuhG6UHpNdedJenqmUC", "action_id_social": "5UQhbiviGRnWh6mpaf3SEzhxP29jdc24vgkK9C42xL8x-0-widget", "block_id": 101780726, "block_timestamp": "2023-09-23T14:51:55.111Z", "signer_id": "azbang.near", "widget_name": "plaid", "source_code": "const PLAID_API = \"http://localhost:3000\";\nState.init({\n  accessToken: Storage.privateGet(\"plaidAccessToken\"),\n  origin: \"\",\n});\n\n// Connected!\nif (state.accessToken) {\n  const response = fetch(\"https://sandbox.plaid.com/transactions/get\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      client_id: \"650ec5e216ecbb001b12ca1d\",\n      secret: \"3618a4c3bb886629ad11e32c2e139b\",\n      access_token: state.accessToken,\n      start_date: \"2018-01-01\",\n      end_date: \"2018-02-01\",\n      options: {\n        count: 250,\n        offset: 100,\n        include_personal_finance_category: true,\n      },\n    }),\n  });\n\n  console.log(response);\n\n  return <p>Bank connected {state.accessToken}</p>;\n}\n\n// Connecting bank\nif (props.public_token) {\n  const response = fetch(`${PLAID_API}/exchange-public-token`, {\n    body: JSON.stringify({ public_token: props.public_token }),\n    headers: { \"Content-Type\": \"application/json\" },\n    method: \"POST\",\n  });\n\n  Storage.privateSet(\"plaidAccessToken\", response.body.access_token);\n  State.update({ accessToken: response.body.access_token });\n  return <p>Bank connecting...</p>;\n}\n\nconst location = `${state.origin}/${context.widgetSrc}`;\nconst src = `\n<script>\nconst origin = document.location.ancestorOrigins[0];\nwindow.top.postMessage(origin, \"*\")\n</script>\n`;\n\nreturn (\n  <div>\n    <a href={`${PLAID_API}?return_url=${location}`}>Connect bank</a>\n    <iframe\n      style={{ display: \"none\" }}\n      onMessage={(origin) => {\n        console.log(origin);\n        State.update({ origin });\n      }}\n      srcDoc={src}\n    ></iframe>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/azbang.near/widget/plaid", "fact_widget_deployments_id": "f9cdd89e76072c0cb97b24e7703a074b", "inserted_timestamp": "2023-09-23T16:44:10.047Z", "modified_timestamp": "2023-09-23T16:44:10.047Z", "__row_index": 26}
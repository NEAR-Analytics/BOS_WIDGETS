{"tx_hash": "13JCywgbvZ6Zo4aehc1ub6y5fSw4fsjFrXWduWrCGcfH", "action_id_social": "93PoHrvPzciDNjQ1MmDmiUt1JxgrJ3e5PV4z4QHEzDYB-0-widget", "block_id": 116535994, "block_timestamp": "2024-04-10T11:11:31.937Z", "signer_id": "socializer.near", "widget_name": "CampaignModal", "source_code": "const Owner = \"socializer.near\";\nconst accountId = context.accountId;\n\nif (!accountId) return;\n\nconst API_URL = props.API_URL || \"http://localhost:3000\";\n\nconst { onClose, data } = props;\nconst link = data.post_link.split(\"?\")[1].split(\"&\");\nconst posterId = link[0].split(\"=\")[1];\n\nState.init({\n  posterAvatar: `https://i.near.social/magic/large/https://near.social/magic/img/account/${posterId}`,\n  error: \"\",\n  like: false,\n  follow: false,\n  repost: false,\n  comment: false,\n  human: false,\n  loaded: false,\n  loading: false,\n});\n\nconst ModalOverlay = styled.div`\n  background: white;\n  position: absolute;\n  bottom: 0px;\n  right: 0px;\n  border-radius: 3px;\n  border: 1px solid;\n  display: flex;\n  flex-direction: column;\n  z-index: 100;\n  width: 400px;\n  height: 100%;\n  overflow: auto;\n  @media (max-width: 510px) {\n    right: 10px;\n    top: 54px;\n    width: 96%;\n  }\n`;\n\nconst ModalContent = styled.div`\n  padding: 20px;\n  width: 100%;\n  color: black;\n  border-radius: 4px;\n  display: flex;\n  flex-direction: column;\n  gap:1px;\n  & p{\n    margin: 0\n  }\n`;\n\nconst ModalAction = styled.div`\n  display: flex;\n  justify-content: space-between;\n  padding: 15px 40px;\n`;\n\nconst ModalTitle = styled.h4`\n  color: black;\n  font-weight: 700;\n  line-height: 27px;\n  margin: 0\n`;\n\nconst Button = styled.button`\n  padding: 8px 20px;\n  background-color:#121212;\n  color: white;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 600;\n  width: 150px;\n  &:hover {\n    background-color: grey;\n    color: #191a1a;\n  }\n  &:active {\n    background-color: grey;\n    color: #191a1a;\n  }\n`;\n\nconst PostLink = styled.a`\n  padding: 8px 20px;\n  background-color:#121212;\n  color: white;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 600;\n  width: 150px;\n  &:hover {\n    background-color: grey;\n    color: #191a1a;\n  }\n  &:active {\n    background-color: grey;\n    color: #191a1a;\n  }\n`;\n\nconst TextField = styled.input`\npadding: 10px 15px;\nfont-size: 16px;\nborder-radius: 6px;\nborder: 2px solid rgb(255, 255, 255);\nbackground-color: #191a1a;\n`;\n\nconst getVerifyState = () => {\n  State.update({ error: \"\", loading: true });\n  asyncFetch(\n    API_URL + `/api/campaign/verify?accountId=${accountId}&id=${data._id}`\n  ).then((res) => {\n    if (res.ok) {\n      const { error, data } = res.body;\n      if (error) State.update({ error, loading: false });\n      else if (data) {\n        const { like, follow, repost, comment, human, finished } = data;\n        State.update({\n          like,\n          follow,\n          repost,\n          comment,\n          human,\n          error: finished ? \"\" : \"Please complete all tasks\",\n          loaded: true,\n          loading: false,\n        });\n      }\n    }\n  });\n};\n\nif (!state.loaded) getVerifyState();\n\nconst verifyEnter = () => {\n  State.update({ error: \"\", loading: true });\n  asyncFetch(API_URL + `/api/campaign/verify`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ accountId, id: data._id }),\n  }).then((res) => {\n    if (res.ok) {\n      const { error, data } = res.body;\n      if (error) State.update({ error, loading: false });\n      else if (data) {\n        const { like, follow, repost, comment, human, finished } = data;\n        State.update({\n          like,\n          follow,\n          repost,\n          comment,\n          human,\n          loading: false,\n        });\n        if (finished) {\n          setTimeout(() => {\n            onClose(\"Participation Successful\");\n          }, 3000);\n        }\n      }\n    }\n  });\n};\n\nreturn (\n  <ModalOverlay>\n    <ModalContent>\n      <button\n        style={{\n          width: 40,\n          position: \"absolute\",\n          right: 19,\n          background: \"unset\",\n          borderColor: \"white\",\n          color: \"black\",\n        }}\n        onClick={() => onClose(\"\")}\n      >\n        X\n      </button>\n      <ModalTitle>{`NEAR DEGENS`}</ModalTitle>\n      <h4>{`Camaign Details`}</h4>\n      <img\n        style={{ width: \"100%\", height: 250 }}\n        src={state.posterAvatar}\n        onError={() => {\n          State.update({\n            myAvatar:\n              \"https://ipfs.near.social/ipfs/bafkreibmiy4ozblcgv3fm3gc6q62s55em33vconbavfd2ekkuliznaq3zm\",\n          });\n        }}\n      />\n\n      <div\n        className=\"d-flex\"\n        style={{ flexDirection: \"column\", gap: 25, padding: 20 }}\n      >\n        <p>\n          {`Please ensure you do the tasks below before clicking on Verify & Enter:`}\n        </p>\n        <p>{`Campaign Id: ${data.id}`}</p>\n        {data?.requirements.map((row, index) => (\n          <div className=\"d-flex justify-content-between align-items-center\">\n            <p>\n              <b>{`${index + 1})`}</b>\n              <span>{row.name}</span>\n            </p>\n\n            {state[row.value] ? (\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"20\"\n                height=\"20\"\n                viewBox=\"0 0 15 15\"\n              >\n                <path\n                  fill=\"#038d2e\"\n                  fill-rule=\"evenodd\"\n                  d=\"M0 7.5a7.5 7.5 0 1 1 15 0a7.5 7.5 0 0 1-15 0Zm7.072 3.21l4.318-5.398l-.78-.624l-3.682 4.601L4.32 7.116l-.64.768l3.392 2.827Z\"\n                  clip-rule=\"evenodd\"\n                />\n              </svg>\n            ) : (\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\"\n                height=\"24\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  fill=\"red\"\n                  d=\"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10s10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17L12 13.41L8.41 17L7 15.59L10.59 12L7 8.41L8.41 7L12 10.59L15.59 7L17 8.41L13.41 12L17 15.59z\"\n                />\n              </svg>\n            )}\n          </div>\n        ))}\n        {state.error && (\n          <p style={{ fontSize: 14, margin: 0, color: \"red\" }}>{state.error}</p>\n        )}\n      </div>\n    </ModalContent>\n    <ModalAction>\n      <PostLink className=\"btn\" target=\"_blank\" href={data.post_link}>\n        {`Goto Post`}\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path\n            fill=\"#3c7eff\"\n            d=\"M9.043 5.793L2.836 12l6.207 6.207l1.414-1.414L5.664 12l4.793-4.793l-1.414-1.414Zm5.914 12.414L21.164 12l-6.207-6.207l-1.414 1.414L18.336 12l-4.793 4.793l1.414 1.414Z\"\n          />\n        </svg>\n      </PostLink>\n      <Button\n        className=\"btn\"\n        onClick={verifyEnter}\n        disabled={state.loading}\n      >{`Verify & Enter`}</Button>\n    </ModalAction>\n  </ModalOverlay>\n);\n", "metadata": {"fork_of": "socializer.near/widget/CampaignModal@116535853"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/socializer.near/widget/CampaignModal", "fact_widget_deployments_id": "e9433adfd12ee14a52c0d6df6652e628", "inserted_timestamp": "2024-04-10T12:34:58.847Z", "modified_timestamp": "2024-04-10T12:34:58.847Z", "__row_index": 0}
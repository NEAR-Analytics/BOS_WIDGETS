{"tx_hash": "GfDzABYkXiGy4cynrkcKwysR943NndujE8ny52DqJNd9", "action_id_social": "4Vd61ubR2JnX1eXy3Srvw8hb77CDFhJhs5QLZ8iMt6T1-0-widget", "block_id": 114926336, "block_timestamp": "2024-03-18T02:14:18.346Z", "signer_id": "socializer.near", "widget_name": "Leaderboard", "source_code": "const Owner = \"socializer.near\";\nconst accountId = context.accountId;\nconst API_URL = props?.API_URL || \"http://localhost:3000\";\n\nconst Wrapper = styled.div`\n    width: 400px;\n    @media (max-width: 620px) {\n        width: 100%;\n    }\n`;\n\nconst HeadContent = styled.div`\n    gap: 20px;\n    display: flex;\n    justify-content: space-between;\n    @media (max-width: 620px) {\n        margin-top: 43px;\n        flex-direction: column;\n        \n        .form-group {\n            width: 100% !important;\n            flex-direction: row !important;\n        }\n\n        .form-select-wrapper {\n            width: 100% !important;\n        }    \n    }\n`;\n\nconst UserOptions = [\n  {\n    text: \"Users\",\n    value: \"users\",\n  },\n  {\n    text: \"Creators\",\n    value: \"creators\",\n  },\n];\n\nconst TimeOptions = [\n  {\n    text: \"Monthly\",\n    value: \"monthly\",\n  },\n  {\n    text: \"Weekly\",\n    value: \"weekly\",\n  },\n  {\n    text: \"All-Time\",\n    value: \"all\",\n  },\n];\n\nState.init({\n  menu: { value: \"users\" },\n  time: { value: \"monthly\" },\n  list: [],\n  loaded: false,\n  error: \"\",\n});\n\nconst columns = {\n  users: [\n    {\n      title: \"No\",\n      key: \"no\",\n      description: \"No\",\n      width: 5,\n    },\n    {\n      title: \"User\",\n      key: \"accountId\",\n      description: \"Campaign Id\",\n      width: 5,\n      project: true,\n    },\n    {\n      title: \"Campaigns Participated\",\n      key: \"participated\",\n      description: \"Campaigns Participated\",\n      width: 5,\n    },\n    {\n      title: \"Transactions Made\",\n      key: \"txs\",\n      description: \"Transactions Made\",\n      width: 5,\n    },\n  ],\n  creators: [\n    {\n      title: \"No\",\n      key: \"no\",\n      description: \"No\",\n      width: 5,\n    },\n    {\n      title: \"Project/Username\",\n      key: \"accountId\",\n      description: \"Campaign Id\",\n      width: 16,\n      project: true,\n    },\n    {\n      title: \"Participants\",\n      key: \"participants\",\n      description: \"Participants\",\n      width: 16,\n    },\n    {\n      title: \"Campaigns Created\",\n      key: \"created\",\n      description: \"Campaigns Created\",\n      width: 16,\n    },\n  ],\n};\n\nconst selectMenu = (data, key) => {\n  State.update({ [key]: data, loaded: false });\n};\n\nconst getListData = () => {\n  return asyncFetch(\n    API_URL +\n      `/api/campaign/leader?type=${state.menu.value}&time=${state.time.value}`\n  ).then((res) => {\n    if (res.ok) {\n      const { error, data } = res.body;\n      if (error) return State.update({ error, loaded: true });\n      State.update({\n        list: data,\n        loaded: true,\n      });\n    } else {\n      State.update({ error: res.error, loaded: true });\n    }\n  });\n};\n\nif (!state.loaded) getListData();\n\nif (!state.loaded) return <Widget src={`${Owner}/widget/preload`} />;\n\nif (state.error) return <p style={{ color: \"red\" }}>{state.error}</p>;\n\nreturn (\n  <div style={{ width: \"100%\" }}>\n    <Wrapper>\n      <HeadContent>\n        <h3>Leader Board : </h3>\n        <div className=\"d-flex flex-column gap-2 form-group\">\n          <Widget\n            props={{\n              API_URL,\n              noLabel: true,\n              options: UserOptions,\n              value: state.menu,\n              onChange: (data) => selectMenu(data, \"menu\"),\n            }}\n            src={`${Owner}/widget/Select`}\n          />\n          <Widget\n            props={{\n              API_URL,\n              noLabel: true,\n              options: TimeOptions,\n              value: state.time,\n              onChange: (data) => selectMenu(data, \"time\"),\n            }}\n            src={`${Owner}/widget/Select`}\n          />\n        </div>\n      </HeadContent>\n      <div>\n        {state.list.length !== 0 &&\n        state.menu.value &&\n        state.loaded === true ? (\n          <Widget\n            src={`${Owner}/widget/table-pagination`}\n            props={{\n              API_URL,\n              data: state.list,\n              columns: columns[state.menu.value],\n              rowsCount: 10,\n              pagination: false,\n            }}\n          />\n        ) : (\n          \"Data is not exists\"\n        )}\n      </div>\n    </Wrapper>\n  </div>\n);\n", "metadata": {"fork_of": "socializer.near/widget/Leaderboard@114924758"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/socializer.near/widget/Leaderboard", "fact_widget_deployments_id": "443aa39ff7d5b9eb024bcfa6a272c0e3", "inserted_timestamp": "2024-03-18T03:25:17.214Z", "modified_timestamp": "2024-03-18T03:25:17.214Z", "__row_index": 24}
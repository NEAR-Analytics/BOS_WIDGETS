{"tx_hash": "5C5BHRQ43p47QYPEFcU3WprKnt6GYXoK8yaGnYxYQdrz", "action_id_social": "CgfCpKkEDYhXG9p2EZ9Q6Dr9dkN1ZknLuRyaqiFDxopg-0-widget", "block_id": 105285467, "block_timestamp": "2023-11-09T09:43:12.449Z", "signer_id": "syi216.near", "widget_name": "PoR-Loan", "source_code": "const nftContract = \"proof-of-reputation.near\";\nState.init({\n  amountRequest: 0,\n  maxAmount: 1000,\n  nftsUser: null,\n});\nconst getProfile = () => {\n  State.update({ profile: Social.getr(`${context.accountId}/profile`) });\n};\nconst getClaimedQuest = () => {\n  let data = Near.view(nftContract, \"nft_tokens_for_owner\", {\n    account_id: context.accountId,\n    from_index: \"0\",\n    limit: 50,\n  });\n  State.update({ nftsUser: data });\n};\nif (context.accountId) {\n  getProfile();\n  getClaimedQuest();\n}\n\nif (state.nftsUser != null) {\n  let json = state.nftsUser.find(\n    (quest) => quest.metadata.title == \"Proof Of Reputation NFT\"\n  ).metadata.extra;\n  console.log(\"score\", json);\n\n  if (json) {\n    json = json.split(\",\")[0].split(\":\")[1];\n  }\n  State.update({ userScore: json });\n}\n\nconst handleRequestAmount = (value) => {\n  State.update({ amountRequest: value });\n};\nreturn (\n  <div class=\"m-10\">\n    {context.accountId ? (\n      <>\n        <div class=\"d-flex justify-content-between\">\n          <div class=\"d-flex flex-row gap-4 px-2\">\n            <img\n              src={`https://ipfs.near.social/ipfs/bafkreib23axs6i6qwtxmc3qrbcvbe4uegf2rhjx6qpvz7swe4mrc466q4m`}\n              style={{ height: \"50px\", width: \"50px\", \"object-fit\": \"cover\" }}\n              class=\"my-auto\"\n            />\n            <a\n              class=\"btn bg-info bg-gradient my-auto fw-semibold shadow bg-opacity-50\"\n              href=\"#/syi216.near/widget/PoR-MainScreen\"\n            >\n              Go to my quests\n            </a>\n          </div>\n          <div class=\"d-flex flex-row bg-secondary bg-opacity-25 rounded-4 py-2 px-3 shadow-sm gap-2\">\n            <img\n              src={`https://ipfs.near.social/ipfs/${state.profile.image.ipfs_cid}`}\n              style={{ height: \"40px\", width: \"40px\", \"object-fit\": \"cover\" }}\n              class=\"rounded-circle my-auto\"\n            />\n            <div class=\"d-flex flex-row gap-3\">\n              <div class=\"my-auto fw-bold\">{context.accountId}</div>\n              <div class=\"my-auto\">\n                <div class=\"fw-semibold\">Score</div>\n                <div>{state.userScore ? state.userScore : 0}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"px-2 my-4\">\n          <p class=\"h2 fw-semibold pb-2\">Apply for loan</p>\n          <div class=\"d-flex flex-column bg-secondary bg-opacity-10 rounded-2 shadow-sm p-4 gap-4 flex-wrap\">\n            <div class=\"d-flex flex-row gap-5 mx-auto\">\n              <div class=\"d-flex flex-row gap-2\">\n                <p class=\"my-auto fw-bold\">\n                  Amount to <br /> request\n                </p>\n                <div class=\"my-auto d-flex flex-row\">\n                  <p class=\"my-auto\">$</p>\n                  <input\n                    type=\"number\"\n                    value={state.amountRequest}\n                    onChange={handleRequestAmount(e.target.value)}\n                    max={state.maxAmount}\n                    min={0}\n                    placeholder=\"1000\"\n                    style={{ width: \"150px\" }}\n                  />\n                </div>\n              </div>\n              <div class=\"d-flex flex-row gap-2\">\n                <p class=\"my-auto fw-bold\">\n                  Max amount <br /> based on score\n                </p>\n                <p class=\"my-auto px-3 bg-success bg-opacity-50 rounded-3 fw-semibold\">\n                  $1000\n                </p>\n              </div>\n              <div class=\"d-flex flex-row gap-2\">\n                <p class=\"my-auto fw-bold\">\n                  Anual <br /> interest rate\n                </p>\n                <p class=\"my-auto px-3 bg-success bg-opacity-50 rounded-3 fw-semibold\">\n                  20%\n                </p>\n              </div>\n            </div>\n            <div class=\"d-flex flex-row gap-4 mx-auto\">\n              <p class=\"fw-bold\">Period to be paid</p>\n              <div>\n                <div class=\"form-check form-check-inline\">\n                  <input\n                    class=\"form-check-input\"\n                    type=\"radio\"\n                    name=\"inlineRadioOptions\"\n                    id=\"inlineRadio1\"\n                    value=\"option1\"\n                  />\n                  <label class=\"form-check-label\" for=\"inlineRadio1\">\n                    30 days\n                  </label>\n                </div>\n                <div class=\"form-check form-check-inline\">\n                  <input\n                    class=\"form-check-input\"\n                    type=\"radio\"\n                    name=\"inlineRadioOptions\"\n                    id=\"inlineRadio2\"\n                    value=\"option2\"\n                  />\n                  <label class=\"form-check-label\" for=\"inlineRadio2\">\n                    60 days\n                  </label>\n                </div>\n                <div class=\"form-check form-check-inline\">\n                  <input\n                    class=\"form-check-input\"\n                    type=\"radio\"\n                    name=\"inlineRadioOptions\"\n                    id=\"inlineRadio3\"\n                    value=\"option3\"\n                    disabled\n                  />\n                  <label class=\"form-check-label\" for=\"inlineRadio3\">\n                    90 days (disabled)\n                  </label>\n                </div>\n              </div>\n            </div>\n            <div class=\"mx-auto\">\n              <button\n                type=\"button\"\n                class=\"btn btn-primary px-5 py-2 fw-semibold border-0 shadow\"\n              >\n                Request loan\n              </button>\n            </div>\n          </div>\n        </div>\n        <div class=\"px-2 my-4\">\n          <p class=\"h2 fw-semibold pb-2\">Loans requested</p>\n          <div class=\"d-flex flex-column bg-secondary bg-opacity-10 rounded-2 shadow-sm p-4 gap-4 flex-wrap mx-auto\">\n            <table class=\"table table-hover\">\n              <thead>\n                <tr>\n                  <th scope=\"col\"></th>\n                  <th scope=\"col\">Requested</th>\n                  <th scope=\"col\">Amount to pay</th>\n                  <th scope=\"col\">Day to be paid</th>\n                  <th scope=\"col\"></th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <th scope=\"row\">USDT Loan</th>\n                  <td class=\"fw-medium\">$100 USDT</td>\n                  <td class=\"fw-medium\">$105 USDT</td>\n                  <td class=\"fw-medium\">22/11/2023</td>\n                  <td>\n                    <button type=\"button\" class=\"btn btn-info px-4 fw-semibold\">\n                      Pay debt\n                    </button>\n                  </td>\n                </tr>\n                <tr>\n                  <th scope=\"row\">USDT Loan</th>\n                  <td class=\"fw-medium\">$100 USDT</td>\n                  <td class=\"fw-medium\">$109 USDT</td>\n                  <td class=\"fw-medium\">17/11/2023</td>\n                  <td>\n                    <button type=\"button\" class=\"btn btn-info px-4 fw-semibold\">\n                      Pay debt\n                    </button>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </>\n    ) : (\n      <h1>Log in with your NEAR account</h1>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/syi216.near/widget/PoR-Loan", "fact_widget_deployments_id": "56df1e84e799d6aa852474d61e407af3", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
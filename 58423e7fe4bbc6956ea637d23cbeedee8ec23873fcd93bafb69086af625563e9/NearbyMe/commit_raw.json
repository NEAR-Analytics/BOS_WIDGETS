{"tx_hash": "86AZb5KjzBWKV5n9NPtCQ8PSS7Bvn8Az5mU9KVUsgyyi", "action_id_social": "HSsRjNKiPxaat6vtguUsSHZ5DWoXTQ9C9ntyoucuAN1K-0-widget", "block_id": 101794171, "block_timestamp": "2023-09-23T19:12:20.143Z", "signer_id": "58423e7fe4bbc6956ea637d23cbeedee8ec23873fcd93bafb69086af625563e9", "widget_name": "NearbyMe", "source_code": "// mocks & constants\nconst places = [\"Lobby\", \"Cafeteria\", \"ConfRoom1\", \"ConfRoom2\"];\nconst mockScannedAdvertisements = () => {\n  return fetch(\"https://asdf.jaeil.wiki/room/1\").body;\n};\nconst mockAttendies = () => {\n  return fetch(\"https://asdf.jaeil.wiki/room\").body;\n};\n\n// Props\nconst userAccountId = props.accountId || context.accountId;\n\n// States\nlet interval;\nconst [users, setUsers] = useState([]);\nconst [place, setPlace] = useState(places[0]);\n\nsetUsers(mockScannedAdvertisements());\n\n// methods\nconst getProfile = (accountId) => {\n  const p = Social.getr(`${accountId}/profile`);\n  const name = p?.name;\n  const image = p?.image;\n  const imageUrl =\n    image && image.ipfs_cid\n      ? `https://ipfs.near.social/ipfs/${image?.ipfs_cid}`\n      : \"https://thewiki.io/static/media/sasha_anon.6ba19561.png\";\n\n  return {\n    name,\n    imageUrl,\n  };\n};\n\n// Sub Components\nconst Theme = styled.div`\n${\n  fetch(\n    \"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\"\n  ).body\n}\n`;\n\nconst Banner = () => (\n  <div className=\"navbar bg-body-tertiary border rounded px-3 mb-3 justify-content-center\">\n    <a className=\"navbar-brand\" href=\"#\">\n      <h2>nearbyme.social</h2>\n    </a>\n  </div>\n);\n\nconst ProfileCard = ({ name, accountId, imageUrl }) => (\n  <a\n    href={`https://near.social/mob.near/widget/ProfilePage?accountId=${accountId}`}\n    style={{ textDecoration: \"none\" }}\n  >\n    <div className=\"navbar bg-body-tertiary border rounded px-3 mb-3\">\n      <div className=\"row\">\n        <div className=\"col-3 mt-4\">\n          <img\n            className=\"profileImage\"\n            src={imageUrl}\n            style={{ height: \"40px\" }}\n          />\n        </div>\n        <div className=\"col-9 pt-3\">\n          <h4>{name}</h4>\n          <p>@{accountId.slice(0, 14)}...</p>\n        </div>\n      </div>\n    </div>\n  </a>\n);\n\nconst BesideUsers = () => {\n  return (\n    <div className=\"row\">\n      {users &&\n        users.map((accountId) => {\n          const { name, imageUrl } = getProfile(accountId);\n          return (\n            <div className=\"col-6\">\n              <ProfileCard\n                name={name}\n                accountId={accountId}\n                imageUrl={imageUrl}\n              />\n            </div>\n          );\n        })}\n    </div>\n  );\n};\n\nconst Attendies = () => {\n  const users = mockAttendies();\n  return (\n    <div className=\"row\">\n      {users.map((accountId) => {\n        const { name } = getProfile(accountId);\n        return (\n          <div className=\"col-4\">\n            <div className=\"navbar bg-body-tertiary border rounded px-3 mb-3 justify-content-center\">\n              <div className=\"text-truncate\">{name}</div>\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nconst BeaconSimulator = () => {\n  return (\n    <div\n      className=\"mb-3 px-1 border\"\n      style={{ borderBottom: \"solid 1px gray\" }}\n    >\n      <div className=\"row\">\n        <div className=\"fs-3\">Beacon Simulator</div>\n        <div className=\"fs-5\">You are in: {place}</div>\n      </div>\n      <div className=\"row\">\n        {places.map((location, idx) => (\n          <div key={idx} className=\"col-3 mb-2\">\n            <div className=\"btn btn-primary w-100\">{location}</div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nconst { name, imageUrl } = getProfile(userAccountId);\n\nreturn (\n  <Theme>\n    <div className=\"container-fluid mt-3 pb-3\">\n      <BeaconSimulator />\n      <Banner />\n      <ProfileCard name={name} accountId={userAccountId} imageUrl={imageUrl} />\n      <p className=\"fs-3\">Builders nearby me</p>\n      <BesideUsers />\n      <p className=\"fs-3\">Collegium Contest Attendies</p>\n      <Attendies />\n    </div>\n  </Theme>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/58423e7fe4bbc6956ea637d23cbeedee8ec23873fcd93bafb69086af625563e9/widget/NearbyMe", "fact_widget_deployments_id": "a9850b15c0521cc9196e6cc7bdb5db21", "inserted_timestamp": "2023-09-23T21:19:39.647Z", "modified_timestamp": "2023-09-23T21:19:39.647Z", "__row_index": 2}
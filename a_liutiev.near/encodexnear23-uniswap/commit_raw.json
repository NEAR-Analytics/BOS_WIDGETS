{"tx_hash": "4SpKKQH4BB3ksnUrFyjwBS47rVECHd5vMHXPcyy6zkas", "action_id_social": "BJ5mJ5JLAd27Y4RJQRGkyWdNYc6CgyEDyzpaNdxYVmwV-0-widget", "block_id": 103104507, "block_timestamp": "2023-10-11T05:33:35.298Z", "signer_id": "a_liutiev.near", "widget_name": "encodexnear23-uniswap", "source_code": "const uniswapV2RouterContract = \"0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D\";\n\nconst tokenDecimals = 18;\n\nconst options = [\n  { name: \"APPLE\", price: 5 },\n  { name: \"BANANA\", price: 0 },\n];\n\nState.init({\n  options: options,\n  fruitSelection1: options[0],\n  fruitSelection2: options[1],\n  feeTier: 0.05,\n  showButtons: false,\n  priceLow: 0,\n  priceHigh: 0,\n  web3connectLabel: \"Connect Wallet\",\n});\n\nif (!state.theme) {\n  State.update({\n    theme: styled.div`\n        font-family: Manrope, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;\n        ${cssFont}\n        ${css}\n\n        .container {\n            display: flex;\n            justify-content: space-between; \n            align-items: center;\n            margin-bottom: 10px;\n          }\n\n          .centered-container {\n            display: flex;\n            justify-content: center; /* Centers horizontally */\n            align-items: center;     /* Centers vertically */\n            margin-top: 10px;\n            margin-bottom: 10px;\n          }\n          \n    `,\n  });\n}\n\nconst Theme = state.theme;\nconst web3connectLabel = state.web3connectLabel || \"n/a\";\n\n// FRONT END CONTROLS\nconst handleIncrement = () => {\n  State.update((prev) => ({ price: prev.price + 1 }));\n};\n\nconst handleDecrement = () => {\n  if (state.price > 0) State.update((prev) => ({ price: prev.price - 1 }));\n};\n\nconst handleMaxClick = () => {\n  console.log(\"MAX clicked!\");\n  // Add functionality for max click here\n};\n\nconst handleApprove = () => {\n  console.log(\"Approve clicked!\");\n  // Add functionality for approve here\n};\n\nconst updateOptionPrice = (name, newPrice) => {\n  const updatedOptions = state.options.map((option) => {\n    if (option.name === name) {\n      return { ...option, price: newPrice };\n    }\n    return option;\n  });\n  State.update({ options: updatedOptions });\n};\n\nconst toggleShowButtons = () => {\n  State.update({ showButtons: !state.showButtons });\n};\n\n// HELPER FUNCTIONS/STATE\nif (state.txCost === undefined) {\n  const gasEstimate = ethers.BigNumber.from(1875000);\n  const gasPrice = ethers.BigNumber.from(1500000000);\n\n  const gasCostInWei = gasEstimate.mul(gasPrice);\n  const gasCostInEth = ethers.utils.formatEther(gasCostInWei);\n\n  let responseGql = fetch(\n    \"https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2\",\n    {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        query: `{\n          bundle(id: \"1\" ) {\n            ethPrice\n          }\n        }`,\n      }),\n    }\n  );\n\n  if (!responseGql) return \"\";\n\n  const ethPriceInUsd = responseGql.body.data.bundle.ethPrice;\n\n  const txCost = Number(gasCostInEth) * Number(ethPriceInUsd);\n\n  State.update({ txCost: `$${txCost.toFixed(2)}` });\n}\n\nif (state.sender === undefined) {\n  const accounts = Ethers.send(\"eth_requestAccounts\", []);\n  if (accounts.length) {\n    State.update({ sender: accounts[0] });\n    console.log(\"set sender\", accounts[0]);\n  }\n}\n\n// getters\nconst getSender = () => {\n  return !state.sender\n    ? \"\"\n    : state.sender.substring(0, 6) +\n        \"...\" +\n        state.sender.substring(state.sender.length - 4, state.sender.length);\n};\n\nreturn (\n  <Theme>\n    <div>\n      <div className=\"container\">\n        <div></div>\n        <div>\n          <Widget\n            src=\"a_liutiev.near/widget/button_web3connect\"\n            props={{ web3connectLabel }}\n          />\n        </div>\n      </div>\n      <div>\n        <br></br>\n      </div>\n\n      <div class=\"card\">\n        <div class=\"card-header\">\n          <div className=\"container\">\n            <div>\n              <p>Pools</p>\n            </div>\n            <div>\n              <button class=\"btn btn-primary m-0 p-1\">\n                <p>New Position</p>\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div>\n          <div className=\"centered-container\">\n            <div>\n              <p>Your active V3 liquidity positions will appear here.</p>\n            </div>\n          </div>\n        </div>\n        <div class=\"card-footer\">\n          <div className=\"centered-container\">\n            <p>{getSender()}</p>\n          </div>\n        </div>\n      </div>\n\n      <div>\n        <br></br>\n      </div>\n\n      <div class=\"card\">\n        {/* First div */}\n        <div class=\"card-header p-3\">\n          <div className=\"container\">\n            <div>\n              <a href=\"#\">\u2190</a>\n              <span>Add Liquidity</span>\n            </div>\n            <div>\n              <a href=\"#\">Clear All</a>\n              <span>\n                <a href=\"#\">\u2699\ufe0f</a>\n              </span>\n            </div>\n          </div>\n        </div>\n\n        {/* Second div */}\n        <div class=\"card-body\">\n          <span>Select Pair</span>\n          <div className=\"container\">\n            <select\n              value={state.fruitSelection1.name}\n              onChange={(e) => {\n                const selectedOption = state.options.find(\n                  (option) => option.name === e.target.value\n                );\n                State.update({ fruitSelection1: selectedOption });\n              }}\n            >\n              {state.options.map((option) => (\n                <option value={option.name} key={option.name}>\n                  {option.name}\n                </option>\n              ))}\n            </select>\n\n            <select\n              value={state.fruitSelection2.name}\n              onChange={(e) => {\n                const selectedOption = state.options.find(\n                  (opt) => opt.name === e.target.value\n                );\n                State.update({ fruitSelection2: selectedOption });\n              }}\n            >\n              {state.options\n                .filter((option) => option.name === \"banana\")\n                .concat(\n                  state.options.filter((option) => option.name !== \"banana\")\n                )\n                .map((option) => (\n                  <option value={option.name} key={option.name}>\n                    {option.name}\n                  </option>\n                ))}\n            </select>\n          </div>\n          <div className=\"container\">\n            <input\n              type=\"text\"\n              value={state.feeTier}\n              placeholder=\"Fee Tier\"\n              onChange={(e) => State.update({ feeTier: e.target.value })}\n            />\n            <button onClick={toggleShowButtons}>Edit</button>\n          </div>\n          {state.showButtons && (\n            <div className=\"container\">\n              <button>0.01%</button>\n              <button>0.05%</button>\n              <button>0.3%</button>\n              <button>1%</button>\n            </div>\n          )}\n        </div>\n\n        {/* Third div */}\n        <div class=\"card-body\">\n          <span>Set Price Range</span>\n          <button>Full Range</button>\n          <button>{state.fruitSelection1.name}</button>\n          <button>{state.fruitSelection2.name}</button>\n          <div>\n            <span>Price</span>\n            <input\n              type=\"number\"\n              value={state.priceLow}\n              onChange={(e) =>\n                State.update({ priceLow: Number(e.target.value) })\n              }\n            />\n          </div>\n          <div>\n            <span>Price</span>\n            <input\n              type=\"number\"\n              value={state.priceLow}\n              onChange={(e) =>\n                State.update({ priceLow: Number(e.target.value) })\n              }\n            />\n          </div>\n          <div>\n            <span>Current Price</span>\n            <span>\n              {state.fruitSelection1.name} per {state.fruitSelection2.name}\n            </span>\n          </div>\n        </div>\n\n        {/* Fourth div */}\n        <div class=\"card-body\">\n          <span>Deposit Amounts</span>\n          <div>\n            <input type=\"text\" />\n            <span>{state.fruitSelection1.name}</span>\n            <span>Balance: 100USD</span>\n            <a href=\"#\" onClick={handleMaxClick}>\n              MAX\n            </a>\n          </div>\n          <div>\n            <input type=\"text\" />\n            <span>{state.fruitSelection2.name}</span>\n            <span>Balance: 100USD</span>\n            <a href=\"#\" onClick={handleMaxClick}>\n              MAX\n            </a>\n          </div>\n          <div>\n            <p>Estimated Transaction Cost: {state.txCost}</p>\n          </div>\n        </div>\n\n        {/* Pill button */}\n        <div class=\"card-footer\">\n          <div className=\"centered-container\">\n            <button\n              style={{ borderRadius: \"20px\", width: \"300px\" }}\n              onClick={handleApprove}\n            >\n              Approve\n            </button>\n          </div>\n        </div>\n      </div>\n      {/* Third div \n            <div>\n                <button>\n                    <p>Show closed positions</p>\n                </button>\n            </div>\n            */}\n    </div>\n    <div class=\"card m-3\">\n      <div class=\"card-header\">\n        <div className=\"centered-container\">\n          <div>\n            <p>Add Liquidity</p>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"card-body\">\n        <div className=\"container\">\n          <div>\n            {state.fruitSelection1.name + \" / \" + state.fruitSelection2.name}\n          </div>\n          <div>In Range \ud83d\udfe2</div>\n        </div>\n        <div class=\"card m-3 p-3\">\n          <div className=\"container\">\n            <div>{state.fruitSelection1.name}</div>\n            <div>{state.fruitSelection1.price}</div>\n          </div>\n          <div className=\"container\">\n            <div>{state.fruitSelection2.name}</div>\n            <div>{state.fruitSelection2.price}</div>\n          </div>\n          <br></br>\n          <div className=\"container\">\n            <div>\n              <p>Fee tier</p>\n            </div>\n            <div>{state.feeTier + \"%\"}</div>\n          </div>\n        </div>\n        <div className=\"container p-2 center\">\n          <div>\n            <p>Selected range</p>\n          </div>\n          <div>\n            <button>{state.fruitSelection1.name}</button>\n            <button>{state.fruitSelection2.name}</button>\n          </div>\n        </div>\n        <div className=\"container p-2 center\">\n          <div>\n            <p>Selected range</p>\n          </div>\n          <div>\n            <button>{state.fruitSelection1.name}</button>\n            <button>{state.fruitSelection2.name}</button>\n          </div>\n        </div>\n        <div className=\"container\">\n          <div class=\"card m-3 p-3\">\n            <div className=\"centered-container\">\n              <div>\n                <p>MIN Price</p>\n                {state.fruitSelection1.name}\n                {state.fruitSelection1.price}\n                {state.fruitSelection1.name +\n                  \" per \" +\n                  state.fruitSelection2.name}\n                <p>\n                  Your position will be 100% composed of{\" \"}\n                  {state.fruitSelection1.name} at this price\n                </p>\n              </div>\n            </div>\n          </div>\n          <div class=\"card m-3 p-3\">\n            <div className=\"centered-container\">\n              <div>\n                <p>MAX Price</p>\n                {state.fruitSelection1.name}\n                {state.fruitSelection1.price}\n                {state.fruitSelection1.name +\n                  \" per \" +\n                  state.fruitSelection2.name}\n                <p>\n                  Your position will be 100% composed of{\" \"}\n                  {state.fruitSelection1.name} at this price\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"centered-container\">\n          <div class=\"card m-3 p-3\">\n            <div>\n              <p>MAX Price</p>\n              {state.fruitSelection1.name}\n              {state.fruitSelection1.price}\n              {state.fruitSelection1.name +\n                \" per \" +\n                state.fruitSelection2.name}\n              <p>\n                Your position will be 100% composed of{\" \"}\n                {state.fruitSelection1.name} at this price\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"card-footer\">\n          <div className=\"centered-container\">\n            <button\n              style={{ borderRadius: \"20px\", width: \"300px\" }}\n              onClick={handleApprove}\n            >\n              Approve\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </Theme>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/a_liutiev.near/widget/encodexnear23-uniswap", "fact_widget_deployments_id": "867a3e658ef93ae62d219f351d4dbed2", "inserted_timestamp": "2023-10-11T07:32:40.071Z", "modified_timestamp": "2023-10-11T07:32:40.071Z", "__row_index": 10}
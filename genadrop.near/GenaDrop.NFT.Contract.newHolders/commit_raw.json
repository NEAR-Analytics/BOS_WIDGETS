{"tx_hash": "2jKDWWaAFyxpbSfvaLMvbfkJPjusEVWMV6ikE7yLJ5VQ", "action_id_social": "HMFGmTuGtDdh5chejsNp7qhkZoqrs3gF6FdmRk3fmthX-0-widget", "block_id": 97997687, "block_timestamp": "2023-08-03T18:02:24.585Z", "signer_id": "genadrop.near", "widget_name": "GenaDrop.NFT.Contract.newHolders", "source_code": "const title = props.title ?? \"GenaDrop NFT Holders\";\nconst contract = props.contract ?? \"nft.genadrop.near\";\nconst showTitle = props.showTitle ?? true;\n\nconst data = Social.keys(\"*/profile\", \"final\");\n\nif (!data) {\n  return \"Loading...\";\n}\n\nconst accounts = Object.entries(data);\nconst holderData = [];\n\nfor (let i = 0; i < accounts.length; ++i) {\n  const accountId = accounts[i][0];\n\n  const nftData = Near.view(contract, \"nft_supply_for_owner\", {\n    account_id: accountId,\n  });\n\n  if (nftData && nftData > 0) {\n    holderData.push({ accountId, nftData });\n  }\n}\nholderData.sort((a, b) => b.nftData - a.nftData);\nconst holderProfiles = holderData.map((holder, index) => (\n  <div className=\"mb-2\" key={holder.accountId}>\n    <h5 className=\"m-3\">\n      <b>Rank {index + 1}:</b> Holds {holder.nftData} NFTs\n    </h5>\n    <Widget\n      src=\"near/widget/AccountProfileCard\"\n      props={{ accountId: holder.accountId }}\n    />\n  </div>\n));\n\n// const accounts = Object.entries(data);\n// const holderData = [];\n// const nftData = Near.view({ contract }, \"nft_supply_for_owner\", {\n//   account_id: accountId,\n// }); // add to this\n\n// holderData.sort((a, b) => b.nftData - a.nftData);\n\nreturn (\n  <>\n    {showTitle && <h3 className=\"m-3\">{title}</h3>}\n    <h5 className=\"m-3\">\n      <i>{holderProfiles.length} Total (Who has BOS Profile)</i>\n    </h5>\n    <div className=\"m-3\">{holderProfiles}</div>\n  </>\n);\n", "metadata": null, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/genadrop.near/widget/GenaDrop.NFT.Contract.newHolders", "fact_widget_deployments_id": "5194e6fec285698cdcc578eb35dd7781", "inserted_timestamp": "2023-08-03T19:23:43.257Z", "modified_timestamp": "2023-08-03T19:23:43.257Z", "__row_index": 0}
{"tx_hash": "31z8yLSAFfXXNrumDFHBgbgqbFyTbpy6tYYjuphsnLU3", "action_id_social": "CUk9GtC84tTESFH7Zi81mdjdiWSkHomXgdP9PqzW5S6A-0-widget", "block_id": 89815587, "block_timestamp": "2023-04-17T20:37:28.282Z", "signer_id": "roshaan.near", "widget_name": "query-api-editor", "source_code": "const path = props.path || \"query-api-editor\";\nconst registry_contract_id =\n  props.registry_contract_id || \"registry.queryapi.near\";\nlet accountId = props.accountId || context.accountId;\n\nlet externalAppUrl = `http://localhost:3001/${path}?accountId=${accountId}`;\n\nif (props.indexerName) {\n  externalAppUrl += `&indexerName=${props.indexerName}`;\n}\n\nconst initialViewHeight = 750;\nif (!context.accountId) {\n  return \"Please sign in to use this widget.\";\n}\n\nconst registerFunctionHandler = (request, response) => {\n  const {\n    indexerName,\n    code,\n    schema,\n    blockHeight,\n    shouldFetchLatestBlockheight,\n  } = request.payload;\n\n  const gas = 200000000000000;\n\n  if (shouldFetchLatestBlockheight == true || blockHeight == null) {\n    blockHeight = Near.block(\"optimistic\").header.height;\n  }\n\n  Near.call(\n    registry_contract_id,\n    \"register_indexer_function\",\n    {\n      function_name: indexerName,\n      code,\n      schema,\n      start_block_height: blockHeight,\n    },\n    gas\n  );\n};\n\n/**\n * Request Handlers here\n */\nconst requestHandler = (request, response) => {\n  switch (request.type) {\n    case \"register-function\":\n      registerFunctionHandler(request, response);\n      break;\n    case \"default\":\n      console.log(\"default case\");\n  }\n};\n\n// NearSocialBridgeCore widget is the core that makes all the \"magic\" happens\nreturn (\n  <Widget\n    src={\"wendersonpires.near/widget/NearSocialBridgeCore\"}\n    props={{\n      externalAppUrl,\n      path,\n      initialViewHeight,\n      initialPayload,\n      requestHandler,\n    }}\n  />\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/roshaan.near/widget/query-api-editor", "fact_widget_deployments_id": "47738b9f330fbb2eb3a4515d480bad4c", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 4}
{"tx_hash": "F1cpqJPcK4X1EFiJciVBHftVTzAgkWgsbptsH6bDj8oe", "action_id_social": "3ZzKF1gZX4sGHkimjAyeG3TcgdMaASDkKDsdvnwStvnz-0-widget", "block_id": 106769796, "block_timestamp": "2023-11-29T00:06:39.873Z", "signer_id": "jehurdguez.near", "widget_name": "TestMensajes", "source_code": "const contract = \"guest-book.near\";\r\nconst total_messages = Near.view(contract, \"totalMessages\", {});\r\nconst messages = Near.view(contract, \"getMessages\", {\r\n  from_index: total - 10,\r\n}).reverse();\r\nconst Button = styled.button`\r\n  font-size: 1em;\r\n  margin: 10px 2px 0px;\r\n  padding: 0.25em 1em;\r\n  border: 2px solid;\r\n  color: rgb(66, 135, 137);\r\n  border-radius: 20px;\r\n  font-weight: 600;\r\n  position: relative;\r\n  transition: 0.3s all;\r\n  &:hover ${Button} {\r\n    color: #153763;\r\n  }\r\n`;\r\n\r\nconst H3 = styled.h3`\r\n  color: rgb(66, 135, 137);\r\n  font-weight: 600;\r\n  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);\r\n`;\r\n\r\nconst H2 = styled.h2`\r\n  color: #153763;\r\n  font-weight: 600;\r\n  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);\r\n  text-align: center;\r\n`;\r\n\r\nconsole.log(messages);\r\n\r\nState.init({\r\n  newMessage: \"\",\r\n});\r\n\r\nconst addNewMessage = () => {\r\n  if (state.newMessage.trim() == \"\") {\r\n    return;\r\n  }\r\n\r\n  Near.call(contract, \"add_message\", {\r\n    text: state.newMessage,\r\n  });\r\n};\r\n\r\nreturn (\r\n  <div class=\"p-3\">\r\n    <H2 class=\"text-center\">Libro de Visitas (BOS + NEAR)</H2>\r\n    <br />\r\n    {context.accountId ? (\r\n      <div class=\"border border-black p-3\">\r\n        <H3>Nuevo Mensaje</H3>\r\n        <div class=\"row\">\r\n          <div>\r\n            <input\r\n              placeholder=\"Message\"\r\n              onChange={(e) => State.update({ newMessage: e.target.value })}\r\n            />\r\n          </div>\r\n        </div>\r\n        <Button\r\n          class=\"btn btn-primary mt-2\"\r\n          onClick={async () => {\r\n            addNewMessage();\r\n          }}\r\n        >\r\n          Guardar\r\n        </Button>\r\n      </div>\r\n    ) : (\r\n      <p class=\"text-center py-2\">\r\n        Debes iniciar sesi\u00f3n para guardar un mensaje\r\n      </p>\r\n    )}\r\n    <br />\r\n\r\n    <div class=\"border border-black p-3\">\r\n      <H3>Listado de Mensajes</H3>\r\n      <table className=\"table table-sm\">\r\n        <thead>\r\n          <tr class=\"p-3 mb-2 bg-primary text-white text-center\">\r\n            <th>Cuenta</th>\r\n            <th>Mensaje</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {messages.map((data, key) => {\r\n            return (\r\n              <tr class=\"text-center\">\r\n                <td>{data.sender}</td>\r\n                <td>{data.text}</td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/jehurdguez.near/widget/TestMensajes", "fact_widget_deployments_id": "cfe668490146eb33e571a9d2cc15e684", "inserted_timestamp": "2023-11-29T02:04:17.420Z", "modified_timestamp": "2023-11-29T02:04:17.420Z", "__row_index": 0}
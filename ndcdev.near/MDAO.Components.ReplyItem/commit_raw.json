{"tx_hash": "EkaHtHDUHw6wRYd9jbTWc4nZVzpjKkokpML5hJeAjHnL", "action_id_social": "CUNPvnR4tr9MJ24KQshwdyJjgMg6LSQR1tpFpNCXyFSV-0-widget", "block_id": 109418921, "block_timestamp": "2024-01-02T16:47:31.995Z", "signer_id": "ndcdev.near", "widget_name": "MDAO.Components.ReplyItem", "source_code": "// Copy of old version of src/Posts/Post.jsx\nconst { item, showCreate } = props;\nconst accountId = context.accountId;\n\nconst Post = styled.div`\n  position: relative;\n\n  &::before {\n    content: \"\";\n    display: block;\n    position: absolute;\n    left: 19px;\n    top: 52px;\n    bottom: 12px;\n    width: 2px;\n    background: #eceef0;\n  }\n`;\n\nconst Header = styled.div`\n  margin-bottom: 0;\n  display: inline-flex;\n`;\n\nconst Body = styled.div`\n  padding-left: 52px;\n  padding-bottom: 5px;\n`;\n\nconst Content = styled.div`\n  img {\n    display: block;\n    max-width: 100%;\n    max-height: 80vh;\n    margin: 0 0 12px;\n  }\n`;\n\nconst Text = styled.p`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 400;\n  color: #687076;\n  white-space: nowrap;\n`;\n\nconst Actions = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: -6px -6px 6px;\n`;\n\nconst Comments = styled.div`\n  > div > div:first-child {\n    padding-top: 12px;\n  }\n`;\n\nconst [showMore, setShowMore] = useState(null);\nconst [replies, setReplies] = useState([]);\nconst [liked, setLiked] = useState(false);\nconst [showReply, setShowReply] = useState({ [item.id]: showCreate });\n\nconst comments = Social.index(\"graph\", \"v1.ndc.mdao.reply\", { order: \"desc\" });\nlet likes = Social.index(\"graph\", \"v1.ndc.mdao.like\", { order: \"desc\" });\nlikes = likes ? likes.filter((like) => like.value.parentId === item.id) : [];\nconst myLike = likes ? likes.some((like) => like.value[accountId]) : false;\nsetLiked(myLike);\n\nconst handleLike = () => {\n  Social.set({\n    index: {\n      graph: JSON.stringify({\n        key: \"v1.ndc.mdao.like\",\n        value: {\n          parentId: item.id,\n          [accountId]: !myLike,\n        },\n      }),\n    },\n  });\n};\n\nreturn (\n  <Post>\n    <Header>\n      <div className=\"row\">\n        <div className=\"col-auto\">\n          <Widget\n            src=\"near/widget/AccountProfile\"\n            props={{\n              accountId,\n              hideAccountId: true,\n            }}\n          />\n        </div>\n      </div>\n    </Header>\n\n    <Body>\n      {item.text && (\n        <Content>\n          {item.text && (\n            <Widget\n              src=\"near/widget/SocialMarkdown\"\n              props={{ text: item.text }}\n            />\n          )}\n        </Content>\n      )}\n      {item.id && (\n        <Actions>\n          <div>\n            {likes.length}\n            <i className=\"bi bi-heart\" onClick={handleLike} />\n          </div>\n          <div>\n            <i\n              className=\"bi bi-chat\"\n              onClick={() => setShowReply({ [item.id]: !showReply[item.id] })}\n            />\n          </div>\n        </Actions>\n      )}\n\n      {showReply[item.id] && (\n        <Widget\n          src=\"ndcdev.near/widget/MDAO.Components.CreateReply\"\n          props={{ id: item.id }}\n        />\n      )}\n      {comments.length > 0 && (\n        <div>\n          {comments\n            .filter((repl) => repl.value.parentId === item.id)\n            .map((item) => (\n              <Widget\n                src=\"ndcdev.near/widget/MDAO.Components.ReplyItem\"\n                props={{ item: item.value, showCreate: false }}\n              />\n            ))}\n        </div>\n      )}\n    </Body>\n  </Post>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/ndcdev.near/widget/MDAO.Components.ReplyItem", "fact_widget_deployments_id": "95012a0caeaa83a380e41b225770c67b", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 2}
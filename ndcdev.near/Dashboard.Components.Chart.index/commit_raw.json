{"tx_hash": "634XDUH3wrnEj87yRXgeSMhjrzL6CqzsN2VVQQ5FEWCn", "action_id_social": "CoV2zsMhXzgjrnAvX5Y5MoowfzKyxTUFZNKdY6X3QEYU-0-widget", "block_id": 111042978, "block_timestamp": "2024-01-22T14:47:31.267Z", "signer_id": "ndcdev.near", "widget_name": "Dashboard.Components.Chart.index", "source_code": "const { Container } = VM.require(\n  `ndcdev.near/widget/Dashboard.Components.Chart.styled`,\n);\n\nif (!Container) <Widget src=\"flashui.near/widget/Loading\" />;\n\nconst chartData = props.chartData ?? {\n  labels: props.data.labels.map(\n    (item) => new Date(item).toISOString().split(\"T\")[0],\n  ),\n  datasets: [\n    {\n      backgroundColor: gradient,\n      data: props.data.data,\n    },\n  ],\n};\n\nconst code = `\n<html>\n<head>\n<script src=\"https://unpkg.com/chart.js@4.3.0/dist/chart.umd.js\"></script>\n<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.6/iframeResizer.contentWindow.js\"></script>\n</head>\n<body>\n<canvas id=\"myChart\"></canvas>\n</body>\n<script>\n  const ctx = document.getElementById('myChart').getContext('2d');\n  var gradient = ctx.createLinearGradient(0, 0, 0, 400);\n  gradient.addColorStop(0.7, '#A39ACD');\n  gradient.addColorStop(0, '#5398DD');\n\n var formatNumber = (num)  => {\n     if (num >= 1e9) { // For billions\n         return (num % 1e9 === 0 ? (num / 1e9).toFixed(0) : (num / 1e9).toFixed(1)) + 'b';\n     }\n     if (num >= 1e6) { // For millions\n         return (num % 1e6 === 0 ? (num / 1e6).toFixed(0) : (num / 1e6).toFixed(1)) + 'm';\n     }\n     if (num >= 1e3) { // For thousands\n         return (num % 1e3 === 0 ? (num / 1e3).toFixed(0) : (num / 1e3).toFixed(1)) + 'k';\n     }\n     return num.toString(); // For numbers less than 1000\n }\n\n    function createChart(ctx, data, options) {\n        new Chart(ctx, {\n            data: {\n                  labels: data.labels,\n                  datasets: [{\n                        data: data.datasets[0].data,\n                        backgroundColor: gradient,\n                        borderWidth: 0\n                    }]      \n            },\n            type: \"bar\",\n            options: {\n            responsive: true,\n            plugins: {\n              legend: {\n                display: false\n              },\n            },\n            scales: {\n              x: {\n                grid: {\n                  display: false\n                }\n              },\n              y: {\n                beginAtZero: true,\n                ticks: {\n                  callback: function(value, index, values) {\n                             return formatNumber(value);\n                  },\n                  font: {\n                    weight: '750',\n                    size: '15px'\n                  }\n                },\n                grid: {\n                  display: false\n                }\n              }\n            }\n          }\n        });\n    }\n\n    window.addEventListener('message', function(event) {\n    }, false);\n\n    const handleMessage = (m) => {\n        const { data, options } = m;\n        \n        createChart(ctx, data, options);\n    };\n\n    window.iFrameResizer = {\n        onMessage: handleMessage\n    }\n</script>\n</html>\n`;\n\nconst args = {\n  title: props.title,\n  component: (\n    <iframe iframeResizer srcDoc={code} message={{ data: chartData }} />\n  ),\n};\nreturn (\n  <div className=\"section py-5\">\n    <Widget\n      src=\"ndcdev.near/widget/Dashboard.Components.Chart.container\"\n      props={args}\n    />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/ndcdev.near/widget/Dashboard.Components.Chart.index", "fact_widget_deployments_id": "fd3f79bfa46e4f038ccf4747a6debb1a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 4}
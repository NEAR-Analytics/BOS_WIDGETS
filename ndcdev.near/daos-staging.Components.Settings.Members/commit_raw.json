{"tx_hash": "EHWcxW7ybZmdgnHgH3KLTogqYvmoAhL2AeAjUc7hmvc6", "action_id_social": "5EiyyiiPDkEhKRrn2e9XNQKEjAGsqxtLZVwGQfYVcUXv-0-widget", "block_id": 115714422, "block_timestamp": "2024-03-29T11:20:43.464Z", "signer_id": "ndcdev.near", "widget_name": "daos-staging.Components.Settings.Members", "source_code": "let { contractName } = VM.require(`ndcdev.near/widget/daos-staging.Config`);\nif (!contractName) return <Widget src=\"flashui.near/widget/Loading\" />;\n\nconst { selectedDao } = props;\n\nconst Form = styled.div`\n  border-radius: 20px;\n  background: white;\n  padding: 3rem;\n\n  label {\n    font-size: 14px;\n    margin-bottom: 5px;\n  }\n\n  .form-control.error {\n    border: 1px solid red;\n  }\n\n  .title {\n    b {\n      font-weight: 600;\n    }\n    font-weight: 300;\n\n    a {\n      text-decoration: underline;\n    }\n  }\n\n  @media screen and (max-width: 768px) {\n    padding: 1rem;\n  }\n`;\n\nconst AutoComplete = styled.div`\n  margin: 5px 0;\n`;\n\nconst [memberText, setMemberText] = useState(\"\");\nconst [handler, setHandler] = useState(null);\nconst [mentionInput, setMentionInput] = useState(\"\");\nconst [mentionsArray, setMentionsArray] = useState([]);\nconst [showAccountAutocomplete, setShowAccountAutocomplete] = useState(false);\nconst [daoMembers, setDaoMembers] = useState([]);\n\nuseEffect(() => {\n  if (selectedDao) {\n    setDaoMembers(selectedDao.owners);\n  }\n}, [selectedDao]);\n\nfunction handleMembersChange(e) {\n  const value = e.target.value;\n\n  setMemberText(value);\n  setShowAccountAutocomplete(true);\n  setMentionInput(value);\n  setMentionsArray([value]);\n}\n\nfunction handleAutoComplete(id) {\n  setHandler(\"autocompleteSelected\");\n  setDaoMembers([...daoMembers, id]);\n  setShowAccountAutocomplete(false);\n}\n\nconst handleSave = () => {\n  Near.call(contractName, \"edit_dao_owners\", {\n    id: selectedDao.id,\n    owners: daoMembers,\n  });\n};\n\nreturn (\n  <Form className=\"d-flex flex-column gap-3\">\n    <div className=\"form-element\">\n      <div className=\"mb-4 d-flex flex-column gap-3\">\n        {daoMembers.flatMap((member) => (\n          <div className=\"d-flex justify-content-between align-items-center\">\n            <Widget\n              src=\"near/widget/AccountProfile\"\n              props={{ accountId: member }}\n            />\n            <i\n              role=\"button\"\n              className=\"bi bi-x-lg\"\n              onClick={() =>\n                setDaoMembers(daoMembers.filter((m) => m !== member))\n              }\n            />\n          </div>\n        ))}\n      </div>\n\n      <label className=\"form-label\">Add new member</label>\n      <input\n        className=\"form-control\"\n        type=\"text\"\n        value={memberText}\n        onChange={handleMembersChange}\n      />\n\n      {showAccountAutocomplete && (\n        <AutoComplete>\n          <Widget\n            src=\"devhub.near/widget/devhub.components.molecule.AccountAutocomplete\"\n            props={{\n              term: mentionInput,\n              onSelect: handleAutoComplete,\n              onClose: () => setShowAccountAutocomplete(false),\n            }}\n          />\n        </AutoComplete>\n      )}\n    </div>\n\n    <button className=\"btn btn-primary\" onClick={handleSave}>\n      <i className=\"ph ph-pencil-simple fs-5\" />\n      Save\n    </button>\n  </Form>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/ndcdev.near/widget/daos-staging.Components.Settings.Members", "fact_widget_deployments_id": "ced54d25cd848ca2824055a50f105fb5", "inserted_timestamp": "2024-03-29T12:35:00.532Z", "modified_timestamp": "2024-03-29T13:29:16.475Z", "__row_index": 0}
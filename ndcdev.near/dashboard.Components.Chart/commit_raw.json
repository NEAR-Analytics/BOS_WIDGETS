{"tx_hash": "JA98kk4PxJeR8ZnrH8UvRRdu8HfwPFsCGX37u7sk3S1X", "action_id_social": "4AJYHGxsmnixCmFXBAegFqYm32VAMEzB4GTjE9gSPqkp-0-widget", "block_id": 117463026, "block_timestamp": "2024-04-23T17:02:35.871Z", "signer_id": "ndcdev.near", "widget_name": "dashboard.Components.Chart", "source_code": "const { data, key, color } = props;\n\nconst Card = styled.div`\n  width: 100%;\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  border-radius: 14px;\n  border: 1px solid #f0efe7;\n  padding: 14px;\n  background: var(--Primary-Base-White, #fff);\n  box-shadow:\n    0px 63px 18px 0px rgba(0, 0, 0, 0),\n    0px 40px 16px 0px rgba(0, 0, 0, 0),\n    0px 23px 14px 0px rgba(0, 0, 0, 0.01),\n    0px 10px 10px 0px rgba(0, 0, 0, 0.01),\n    0px 3px 6px 0px rgba(0, 0, 0, 0.01);\n`;\n\nconst Loading = () => <Widget src=\"flashui.near/widget/Loading\" />;\n\nconst chartData = props.chartData ?? {\n  labels: data.map((item) => item.day),\n  datasets: [\n    {\n      backgroundColor: color,\n      data: data.map((item) => item[key]),\n    },\n  ],\n};\n\nconst code = `\n<html>\n<head>\n<script src=\"https://unpkg.com/chart.js@4.3.0/dist/chart.umd.js\"></script>\n<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.6/iframeResizer.contentWindow.js\"></script>\n</head>\n<body>\n<canvas id=\"myChart\"></canvas>\n</body>\n<script>\n  const ctx = document.getElementById(\"myChart\").getContext(\"2d\");\n\n  var formatNumber = (num) => {\n    if (num >= 1e9) {\n      // For billions\n      return (\n        (num % 1e9 === 0 ? (num / 1e9).toFixed(0) : (num / 1e9).toFixed(1)) + \"b\"\n      );\n    }\n    if (num >= 1e6) {\n      // For millions\n      return (\n        (num % 1e6 === 0 ? (num / 1e6).toFixed(0) : (num / 1e6).toFixed(1)) + \"m\"\n      );\n    }\n    if (num >= 1e3) {\n      // For thousands\n      return (\n        (num % 1e3 === 0 ? (num / 1e3).toFixed(0) : (num / 1e3).toFixed(1)) + \"k\"\n      );\n    }\n    return num.toString(); // For numbers less than 1000\n  };\n\n  function createChart(ctx, data, options) {\n    new Chart(ctx, {\n      data: {\n        labels: data.labels,\n        datasets: [\n          {\n            data: data.datasets[0].data,\n            backgroundColor: data.datasets[0].backgroundColor,\n            borderWidth: 0,\n          },\n        ],\n      },\n      type: \"bar\",\n      options: {\n        responsive: true,\n        plugins: {\n          legend: {\n            display: false,\n          },\n        },\n        scales: {\n          x: {\n            grid: {\n              display: false,\n            },\n          },\n          y: {\n            beginAtZero: true,\n            ticks: {\n              callback: function (value, index, values) {\n                return formatNumber(value);\n              },\n              font: {\n                weight: \"750\",\n                size: \"15px\",\n              },\n            },\n            grid: {\n              display: false,\n            },\n          },\n        },\n      },\n    });\n  }\n\n  window.addEventListener(\"message\", function (event) {}, false);\n\n  const handleMessage = (m) => {\n    const { data, options } = m;\n\n    createChart(ctx, data, options);\n  };\n\n  window.iFrameResizer = {\n    onMessage: handleMessage,\n  };\n</script>\n</html>\n`;\n\nreturn (\n  <Card>\n    <div>{props.title}</div>\n    {props.loading ? (\n      <div className=\"w-100 py-5 d-flex justify-content-center align-items-center\">\n        <Loading />\n      </div>\n    ) : chartData.datasets[0].data.length ? (\n      <iframe iframeResizer srcDoc={code} message={{ data: chartData }} />\n    ) : (\n      <div\n        className=\"w-100 py-5 d-flex justify-content-center align-items-center\"\n        style={{ fontSize: \"60px\" }}\n      >\n        n/a\n      </div>\n    )}\n  </Card>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/ndcdev.near/widget/dashboard.Components.Chart", "fact_widget_deployments_id": "1ea61c4e40ab1fb62d5900ea5060f831", "inserted_timestamp": "2024-04-23T18:43:16.795Z", "modified_timestamp": "2024-04-23T19:39:39.293Z", "__row_index": 0}
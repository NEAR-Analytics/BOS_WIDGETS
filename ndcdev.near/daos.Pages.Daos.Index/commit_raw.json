{"tx_hash": "BciUasE11dLRvfXQbcJZ8ENmDgo3LVYWmsn29pj9Kvm1", "action_id_social": "HpjVRWoC5hfqmHLsjJamgs481G3igFxpvHfXEeqXWnUH-0-widget", "block_id": 117094329, "block_timestamp": "2024-04-18T08:48:30.934Z", "signer_id": "ndcdev.near", "widget_name": "daos.Pages.Daos.Index", "source_code": "let { content, contractName } = VM.require(\n  `ndcdev.near/widget/daos.Config`,\n);\n\nconst { id } = props;\nconst accountId = context.accountId;\n\nlet isFollowed = false;\n\nconst Container = styled.div`\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  .image-container {\n    position: relative;\n    display: inline-block;\n  }\n\n  .overlay-button {\n    position: absolute;\n    top: 85%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n\n    @media screen and (max-width: 786px) {\n      top: 75%;\n      left: 85%;\n    }\n  }\n\n  a.btn {\n    border: 2px solid white;\n    background: #151718;\n    box-shadow: 0px 20px 30px 0px rgba(0, 0, 0, 0.25);\n    color: #f0f0f0;\n    font-size: 18px;\n    font-weight: bold;\n    text-align: center !important;\n\n    &:hover {\n      color: #fff;\n      text-decoration: none;\n    }\n  }\n`;\n\nconst Section = styled.div`\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: 3rem;\n  padding: 4rem;\n  background: ${(p) => (p.bgColor ? p.bgColor : \"inherit\")};\n\n  @media screen and (max-width: 786px) {\n    padding: 2rem;\n  }\n\n  &.with-circles {\n    padding: 0;\n  }\n\n  h2 {\n    font-size: 3rem;\n    font-weight: 600;\n    width: 80%;\n  }\n\n  h4 {\n    color: #1e1d22;\n    font-size: 24px;\n    font-weight: 400;\n    width: 50%;\n  }\n\n  h3 {\n    color: #222325;\n    font-size: 24px;\n    font-weight: 400;\n    line-height: normal;\n    text-transform: uppercase;\n  }\n\n  .item {\n    width: 75%;\n    .header {\n      display: flex;\n      border-radius: 10px 10px 0px 0px;\n\n      h4 {\n        margin: 10px 0 0 0;\n        width: max-content;\n      }\n    }\n\n    .icon {\n      width: 40px;\n    }\n\n    p {\n      font-size: 16px;\n      font-weight: 300;\n      margin: 0;\n    }\n\n    a {\n      color: #151718 !important;\n\n      :hover {\n        text-decoration: none;\n      }\n    }\n\n    @media screen and (max-width: 786px) {\n      width: 100%;\n    }\n\n    a.btn-primary {\n      border-radius: 10px;\n      border: 2px solid #e6cde6;\n      background: rgba(252, 248, 246, 0);\n      box-shadow: unset;\n      font-size: 18px;\n      font-weight: 400;\n      color: #151718;\n      padding: 5px 15px;\n      width: 100%;\n\n      div {\n        width: 80%;\n      }\n\n      &:hover {\n        text-decoration: none;\n      }\n\n      @media screen and (max-width: 786px) {\n        width: 100%;\n      }\n    }\n  }\n`;\n\nif (!contractName || !content)\n  return <Widget src=\"flashui.near/widget/Loading\" />;\n\nconst dao = Near.view(contractName, \"get_dao_by_handle\", { handle: id });\nconst section = content.daos[id].sections;\n\nif (accountId) {\n  const followedDaos = Near.view(contractName, \"get_follow_dao\", {\n    account_id: accountId,\n  });\n\n  if (!followedDaos) return <Widget src=\"flashui.near/widget/Loading\" />;\n\n  isFollowed = followedDaos.find((d) => d.handle === dao.handle);\n}\n\nif (!dao) return <Widget src=\"flashui.near/widget/Loading\" />;\n\nconst projects = Near.view(contractName, \"get_dao_communities\", {\n  dao_list: [dao.id],\n});\n\nconst ProjectCard = ({ project }) => (\n  <ProjectContainer src={project.logo_url}>\n    <div className=\"wrapper\">\n      <div className=\"image\" />\n    </div>\n    <span className=\"title\">{project.title}</span>\n  </ProjectContainer>\n);\n\nconst handelOnFollow = () => {\n  if (isFollowed) return;\n  if (dao.checkin_account_id) {\n    const UserFollowDao_Payload = {\n      contractName: contractName,\n      methodName: \"user_follow_dao\",\n      args: {\n        id: dao.id,\n      },\n      deposit: 0,\n    };\n\n    const CheckIn_Payload = {\n      contractName: dao.checkin_account_id,\n      methodName: \"check_in\",\n      args: {},\n      deposit: 0,\n    };\n\n    Near.call([UserFollowDao_Payload, CheckIn_Payload])\n      .then(() => {\n        console.log(\"Transactions completed\");\n      })\n      .catch((error) => {\n        console.error(\"Error in sending transactions:\", error);\n      });\n  } else {\n    Near.call(contractName, \"user_follow_dao\", { id: dao.id });\n  }\n};\n\nreturn (\n  <Container>\n    {accountId ? (\n      <div className=\"image-container\">\n        <img className=\"hero-img\" src={dao.banner_url} alt=\"Banner Image\" />\n        <a\n          className=\"overlay-button btn\"\n          style={{ cursor: isFollowed ? \"default\" : \"pointer\" }}\n          onClick={handelOnFollow}\n        >\n          {isFollowed ? \"Following\" : \"Follow\"}\n        </a>\n      </div>\n    ) : (\n      <img className=\"hero-img\" src={dao.banner_url} alt=\"Banner Image\" />\n    )}\n    <Section className=\"with-circles\">\n      <Widget\n        src={`ndcdev.near/widget/daos.Components.Dao.Info`}\n        props={{ section, dao }}\n      />\n    </Section>\n\n    {projects?.length > 0 ? (\n      <Section>\n        <Widget\n          src={`ndcdev.near/widget/daos.Components.Dao.Communities`}\n          props={{\n            title: section.projects.title,\n            projects: projects.slice(0, 5),\n          }}\n        />\n\n        <div className=\"d-flex gap-3 w-100 flex-wrap justify-content-center\">\n          <a\n            className=\"dao-btn\"\n            href={`/ndcdev.near/widget/daos.App?page=communities&dao_id=${dao.handle}`}\n          >\n            Show All {section.projects.title}\n          </a>\n        </div>\n      </Section>\n    ) : (\n      \"\"\n    )}\n\n    <Section style={{ background: \"black\" }}>\n      <Widget\n        src={`ndcdev.near/widget/daos.Components.Dao.Guidance`}\n        props={{ section: section, dao }}\n      />\n    </Section>\n    {dao.metadata.contacts && (\n      <Section className=\"d-flex flex-column gap-5\">\n        <Widget\n          src={`ndcdev.near/widget/daos.Components.Dao.OfficeHours`}\n          props={{ dao }}\n        />\n      </Section>\n    )}\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/ndcdev.near/widget/daos.Pages.Daos.Index", "fact_widget_deployments_id": "49d0213bb36134dcb3aac3f64c68b2a8", "inserted_timestamp": "2024-04-18T10:38:34.656Z", "modified_timestamp": "2024-04-18T10:38:34.656Z", "__row_index": 10}
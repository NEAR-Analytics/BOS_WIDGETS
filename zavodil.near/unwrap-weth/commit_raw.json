{"tx_hash": "D6H7zDQiZDEzMjEJyTP6NScnb9V1vscsCrKC5Sr6PZ2A", "action_id_social": "odBMPsQ4k6Z4KwF5JW58CBnQ4TCuPvDs9EqkENxKQB4-0-widget", "block_id": 97010248, "block_timestamp": "2023-07-21T18:24:41.241Z", "signer_id": "zavodil.near", "widget_name": "unwrap-weth", "source_code": "const receiver = Ethers.send(\"eth_requestAccounts\", [])[0];\n\nif (!receiver) {\n  return <Web3Connect />;\n}\n\nEthers.provider()\n  .getNetwork()\n  .then((chainIdData) => {\n    if (chainIdData.chainId === 1) {\n      State.update({ tokenId: \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\" });\n    } else if (chainIdData.chainId === 1101) {\n      State.update({ tokenId: \"0x4F9A0e7FD2Bf6067db6994CF12E4495Df938E6e9\" });\n    }\n  });\n\nif (!state.tokenId) {\n  return \"Unknown WETH contract for a selected network\";\n}\n\nconst abiUrl =\n  \"https://eth.blockscout.com/api?module=contract&action=getabi&address=0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\";\n\nconst abi = fetch(abiUrl);\n\nif (!abi.ok) {\n  return \"Loading\";\n}\n\nconst iface = new ethers.utils.Interface(abi.body.result);\n\nconst encodedBalanceData = iface.encodeFunctionData(\"balanceOf\", [receiver]);\n\nEthers.provider()\n  .call({\n    to: state.tokenId,\n    data: encodedBalanceData,\n  })\n  .then((rawBalance) => {\n    const receiverBalanceHex = iface.decodeFunctionResult(\n      \"balanceOf\",\n      rawBalance\n    );\n\n    State.update({\n      balance: Big(receiverBalanceHex).toFixed(),\n    });\n  });\n\nconst unwrap = (balance) => {\n  const wEthContract = new ethers.Contract(\n    state.tokenId,\n    abi.body.result,\n    Ethers.provider().getSigner()\n  );\n\n  wEthContract.withdraw(balance, {}).then((transactionHash) => {\n    onComplete(transactionHash);\n  });\n};\n\nif (!state.balance) {\n  return \"loading\";\n}\n\nreturn (\n  <div>\n    Your balance is {new Big(state.balance).div(Big(10).pow(18)).toFixed()} WETH\n    <hr />\n    {state.balance > 0 && (\n      <button onClick={() => unwrap(state.balance)}>UNWRAP</button>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/zavodil.near/widget/unwrap-weth", "fact_widget_deployments_id": "2c12f1759ae31660c8dd887a2a5101e2", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 2}
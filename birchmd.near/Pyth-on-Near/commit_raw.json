{"tx_hash": "21K17J5q44JMwexeqxLHyu3jne3oYhpTYbaWWPTDenyo", "action_id_social": "263NAfGcC8GCj7ocLoUM3FEK1HNQAD9mXkxt3RrgWMni-0-widget", "block_id": 100122744, "block_timestamp": "2023-09-01T02:17:11.307Z", "signer_id": "birchmd.near", "widget_name": "Pyth-on-Near", "source_code": "initState({\r\n  priceId: \"c415de8d2eba7db216527dff4b60e8f3a5311c740dadb233e13e12547e226750\",\r\n  price: null,\r\n  vaa: null,\r\n});\r\n\r\nconst setPriceId = (priceId) => {\r\n  State.update({ priceId });\r\n};\r\n\r\nconst getPrice = () => {\r\n  const priceId = state.priceId;\r\n  const response = fetch(\r\n    \"https://xc-mainnet.pyth.network/api/latest_price_feeds?binary=true&ids[]=\" +\r\n      priceId\r\n  );\r\n  const price = JSON.stringify(response.body[0].price);\r\n  const vaa = response.body[0].vaa;\r\n  console.log(JSON.stringify(response));\r\n  State.update({ price, vaa });\r\n};\r\n\r\nconst publishPrice = () => {\r\n  const response = Near.call(\r\n    \"pyth.birchmd.near\",\r\n    \"update_price_feeds\",\r\n    {\r\n      vaas: [state.vaa],\r\n      fee: \"1\",\r\n    },\r\n    300000000000000\r\n  );\r\n  console.log(JSON.stringify(response));\r\n};\r\n\r\nreturn (\r\n  <>\r\n    <select id=\"selectPair\" onChange={(e) => setPriceId(e.target.value)}>\r\n      <option value=\"c415de8d2eba7db216527dff4b60e8f3a5311c740dadb233e13e12547e226750\">\r\n        NEAR/USD\r\n      </option>\r\n      <option value=\"ff61491a931112ddf1bd8147cd1b641375f79f5825126d665480874634fd0ace\">\r\n        ETH/USD\r\n      </option>\r\n      <option value=\"c96458d393fe9deb7a7d63a0ac41e2898a67a7750dbd166673279e06c868df0a\">\r\n        ETH/BTC\r\n      </option>\r\n    </select>\r\n    <div>Price: {state.price}</div>\r\n    <div>\r\n      <button onClick={getPrice}>Refresh</button>\r\n    </div>\r\n    <div>\r\n      <button onClick={publishPrice}>Publish on-chain</button>\r\n    </div>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/birchmd.near/widget/Pyth-on-Near", "fact_widget_deployments_id": "037d1ad7543d2e3965f7ae142fdeff64", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
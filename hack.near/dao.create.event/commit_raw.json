{"tx_hash": "2DETToE7rXyQain9S92AC918vZSzNDRr9FeAg5jXyzP6", "action_id_social": "3zuW5kGdYhP5NAb4FHQUqXXk8keiWVFXBjRK8XAS6zch-0-widget", "block_id": 98529201, "block_timestamp": "2023-08-11T01:00:13.897Z", "signer_id": "hack.near", "widget_name": "dao.create.event", "source_code": "const daoId = \"liberty.sputnik-dao.near\";\n\nState.init({\n  id: \"\",\n  title: \"\",\n  start: \"\",\n});\n\nconst policy = Near.view(daoId, \"get_policy\");\n\nif (policy === null) {\n  return \"Loading...\";\n}\n\nconst deposit = policy.proposal_bond;\n\nconst event_args = JSON.stringify({\n  data: {\n    [daoId]: {\n      thing: {\n        [state.id]: JSON.stringify({\n          id: state.id,\n          title: state.title,\n          start: state.start,\n        }),\n      },\n      index: {\n        every: JSON.stringify({\n          key: \"efiz.near/type/event\",\n          value: {\n            thingId: state.id,\n            type: \"efiz.near/type/event\",\n          },\n        }),\n      },\n    },\n  },\n});\n\nconst proposal_args = Buffer.from(event_args, \"utf-8\").toString(\"base64\");\n\nconst handleProposal = () => {\n  console.log(JSON.stringify(event_args));\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"create DAO event on NEAR Social\",\n          kind: {\n            FunctionCall: {\n              receiver_id: \"social.near\",\n              actions: [\n                {\n                  method_name: \"set\",\n                  args: proposal_args,\n                  deposit: \"100000000000000000000000\",\n                  gas: \"235000000000000\",\n                },\n              ],\n            },\n          },\n        },\n      },\n      deposit: deposit,\n      gas: \"219000000000000\",\n    },\n  ]);\n};\n\nconst onChangeId = (id) => {\n  State.update({\n    id,\n  });\n};\n\nconst onChangeTitle = (title) => {\n  State.update({\n    title,\n  });\n};\n\nconst onChangeStart = (start) => {\n  State.update({\n    start,\n  });\n};\n\nreturn (\n  <>\n    <h5>Event ID</h5>\n    <input\n      type=\"text\"\n      placeholder=\"id\"\n      value={state.id}\n      onChange={(e) => onChangeId(e.target.value)}\n    ></input>\n    <br />\n    <h5>Event Title</h5>\n    <input\n      type=\"text\"\n      placeholder=\"title\"\n      value={state.title}\n      onChange={(e) => onChangeTitle(e.target.value)}\n    ></input>\n    <br />\n    <h5>Event Start</h5>\n\n    <input\n      type=\"date\"\n      placeholder=\"start\"\n      value={state.start}\n      onChange={(e) => onChangeStart(e.target.value)}\n    ></input>\n    <br />\n    <button disabled={!state.start} onClick={handleProposal}>\n      propose\n    </button>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/dao.create.event", "fact_widget_deployments_id": "77d82f560f88522d9165e26a787e8e61", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
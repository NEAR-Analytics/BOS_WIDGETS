{"tx_hash": "9ULFcNGGBiUqnuunFQHFu1XkVe1hADTN4LVkKcYakD3e", "action_id_social": "99ZRyoSqrfVq3CCiUAxeQZP8cb3BNSZNvAugbbE8TT7J-0-widget", "block_id": 96620715, "block_timestamp": "2023-07-16T16:40:14.503Z", "signer_id": "hack.near", "widget_name": "dev.proposal.comments", "source_code": "const daoId = props.daoId ?? \"multi.sputnik-dao.near\";\nconst proposal = props.proposal && JSON.parse(JSON.stringify(props.proposal));\nconst accountId = context.accountId;\n\nconst totalVoters = Object.keys(proposal?.votes || {}).length || 0;\n\nconst item = {\n  type: \"dao_proposal_comment\",\n  path: `${daoId}/proposal/main`,\n  proposal_id: proposal.id + \"-beta\",\n};\nconst comments = Social.index(\"comment\", item);\nconst totalComments = comments?.length || 0;\n\nState.init({\n  activeTab: state.activeTab ?? undefined,\n});\n\nconst TabsStyled = styled.div`\n  ul {\n    list-style: none;\n    padding: 0;\n    display: flex;\n    flex-direction: row;\n    gap: 1em;\n    margin: 0;\n  }\n  button {\n    background: #f1f1f1;\n    padding: 0.5em 1em;\n    font-size: 0.8rem;\n    font-weight: 600;\n    border-radius: 25px;\n    color: #687076;\n    transition: 200ms ease-out;\n    border: none;\n    display: flex;\n    align-items: center;\n\n    &:hover {\n      color: #11181c;\n      background: #e1e1e1;\n    }\n\n    &.active {\n      background: #11181c;\n      color: #e1e1e1;\n    }\n\n    label {\n      background: #e1e1e1;\n      color: #11181c;\n      border-radius: 50%;\n      padding: 0.25em 0.5em;\n      margin-left: 0.5em;\n      font-size: 0.7rem;\n      font-weight: 600;\n      cursor: inherit;\n      min-width: 19px;\n      height: 23px;\n    }\n\n    i {\n      color: inherit;\n      margin-right: 0.5em;\n    }\n  }\n`;\n\nconst onTabChange = (tab) => {\n  if (state.activeTab === tab) return State.update({ activeTab: undefined });\n  State.update({ activeTab: tab });\n};\n\nconst Tabs = () => {\n  return (\n    <TabsStyled>\n      <ul>\n        <li>\n          <button\n            className={\"comments\" === state.activeTab ? \"active\" : \"\"}\n            onClick={() => onTabChange(\"comments\")}\n          >\n            <i className=\"bi bi-chat-left-text\"></i>\n            comments\n            <label>{totalComments}</label>\n          </button>\n        </li>\n        {proposal && (\n          <li>\n            <button\n              className={\"voters\" === state.activeTab ? \"active\" : \"\"}\n              onClick={() => onTabChange(\"voters\")}\n            >\n              <i className=\"bi bi-people\"></i>\n              voters\n              <label>{totalVoters}</label>\n            </button>\n          </li>\n        )}\n      </ul>\n    </TabsStyled>\n  );\n};\n\nconst Wrapper = styled.div`\n  width: 100%;\n`;\n\nreturn (\n  <>\n    <Tabs />\n    <Wrapper>\n      {state.activeTab === \"comments\" && (\n        <div className=\"mt-3\">\n          <Widget\n            src=\"sking.near/widget/DAO.Proposal.Comments\"\n            props={{\n              daoId: daoId,\n              proposalId: proposal.id,\n              commentsCount: totalComments,\n            }}\n          />\n        </div>\n      )}\n      {state.activeTab === \"voters\" && proposal && (\n        <div className=\"mt-3\">\n          <Widget\n            src=\"sking.near/widget/DAO.Proposal.Voters\"\n            props={{\n              votes: proposal.votes,\n            }}\n          />\n        </div>\n      )}\n    </Wrapper>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/dev.proposal.comments", "fact_widget_deployments_id": "e3e4e37fd2e9c5fc4d7ff5a53781421d", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 3}
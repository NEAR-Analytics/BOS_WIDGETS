{"tx_hash": "8rjKhMJPTx6VM2Qy6FEJPS7s7mC4xkBFU55F2TK2s9rR", "action_id_social": "EH7Ka6Vo8gE3UbjRNU7NvfnQZz3LE9jZTpA7dZTi6fRX-0-widget", "block_id": 115625341, "block_timestamp": "2024-03-28T03:56:30.497Z", "signer_id": "hack.near", "widget_name": "list.edit", "source_code": "const creatorId = context.accountId ?? \"every.near\";\nconst listId = props.listId ?? 1;\n\nconst [list, setList] = useState(() =>\n  Near.view(\"lists.potlock.near\", \"get_list\", { list_id: listId })\n);\n\nconst isOwner = list.owner === creatorId;\n\nconst [admins, setAdmins] = useState(list.admins);\nconst [newAdmin, setNewAdmin] = useState(\"\");\nconst [name, setName] = useState(list.name);\nconst [description, setDescription] = useState(list.description);\n\nfunction addAdmin() {\n  if (newAdmin && !admins.includes(newAdmin) && isNearAddress(newAdmin)) {\n    setAdmins([...admins, newAdmin]);\n    setNewAdmin(\"\");\n  }\n}\n\nfunction removeAdmin(adminKey) {\n  setAdmins(admins.filter((admin) => admin !== adminKey));\n}\n\nfunction isNearAddress(address) {\n  if (typeof address !== \"string\") {\n    return false;\n  }\n  if (!address.endsWith(\".near\")) {\n    return false;\n  }\n  const parts = address.split(\".\");\n  if (parts.length !== 2) {\n    return false;\n  }\n  if (parts[0].length < 2 || parts[0].length > 32) {\n    return false;\n  }\n  if (!/^[a-z0-9_-]+$/i.test(parts[0])) {\n    return false;\n  }\n  return true;\n}\n\nconst createList = () => {\n  Near.call(\"lists.potlock.near\", \"create_list\", {\n    name: name,\n    description: description,\n    cover_image_url: null,\n    admins: admins,\n    default_registration_status: \"Pending\",\n    admin_only_registrations: false,\n  });\n};\n\nreturn (\n  <div className=\"m-3\">\n    <div className=\"d-flex flex-row justify-content-between\">\n      <h3>\n        <b>List Editor</b>\n      </h3>\n      <div>\n        {isOwner && (\n          <button\n            disabled={admins.length === 0}\n            onClick={createList}\n            className=\"btn btn-success me-2\"\n          >\n            <i className=\"bi bi-stars\"></i> Save\n          </button>\n        )}\n      </div>\n    </div>\n    {isOwner ? (\n      <div className=\"m-2\">\n        <h5 className=\"mb-2\">Name</h5>\n        <div className=\"mb-3\">\n          <input\n            value={name}\n            placeholder=\"title\"\n            onChange={(e) => setName(e.target.value)}\n          />\n        </div>\n        <h5 className=\"mb-2\">Description</h5>\n        <div className=\"mb-3\">\n          <input\n            value={description}\n            placeholder=\"about\"\n            onChange={(e) => setDescription(e.target.value)}\n          />\n        </div>\n        <h5 className=\"mb-2\">Admins</h5>\n        <div className=\"d-flex align-items-center mt-2\">\n          <input\n            value={newAdmin}\n            placeholder={`${creatorId}`}\n            onChange={(e) => setNewAdmin(e.target.value)}\n          />\n          <button\n            disabled={!isNearAddress(newAdmin)}\n            className=\"btn btn-primary m-1 ms-3\"\n            onClick={addAdmin}\n          >\n            <i className=\"bi bi-plus\"></i>\n          </button>\n        </div>\n        <br />\n        <div>\n          {admins.map((admin, index) => (\n            <div\n              key={index}\n              className=\"d-flex flex-row justify-content-between mb-3\"\n            >\n              <Widget\n                src=\"mob.near/widget/Profile\"\n                props={{ accountId: admin }}\n              />\n              <button\n                className=\"btn btn-danger m-1\"\n                onClick={() => removeAdmin(admin)}\n              >\n                <i className=\"bi bi-x\"></i>\n              </button>\n            </div>\n          ))}\n        </div>\n      </div>\n    ) : (\n      <div>\n        <p>\n          <i>User is not the owner of list {listId}.</i>\n        </p>\n      </div>\n    )}\n  </div>\n);\n", "metadata": {"fork_of": "devs.near/widget/group.create@102679660"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/list.edit", "fact_widget_deployments_id": "91179ab65c970e09e3f209c0ee67d4ec", "inserted_timestamp": "2024-03-28T05:29:52.212Z", "modified_timestamp": "2024-03-28T05:29:52.212Z", "__row_index": 0}
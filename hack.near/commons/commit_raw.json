{"tx_hash": "7MyRdyo8ZsJEEHJPXNX5dUiJiDsAmHs8tVrpaEioZDpx", "action_id_social": "GVwiuAQAaJKjGN5aDPsqN5Hc8g1DfYTfVNcVCiWhbk2W-0-widget", "block_id": 119208944, "block_timestamp": "2024-05-18T16:58:55.183Z", "signer_id": "hack.near", "widget_name": "commons", "source_code": "const [hideInfo, setHideInfo] = useState(false);\n\nconst accountId = props.accountId ?? context.accountId ?? \"every.near\";\nconst graphId = props.graphId ?? \"commons\";\n\nconst attestations = Social.keys(`*/graph/${graphId}/*`, \"final\", {\n  values_only: true,\n});\n\nif (!attestations) {\n  return \"\";\n}\n\nconst [matrix, setMatrix] = useState([]);\nconst [attestors, setAttestors] = useState([]);\nconst [builders, setBuilders] = useState([]);\n\nuseEffect(() => {\n  const attestorSet = new Set();\n  const builderSet = new Set();\n\n  Object.entries(attestations).forEach(([attestor, data]) => {\n    attestorSet.add(attestor);\n    Object.keys(data.graph[graphId]).forEach((builder) => {\n      builderSet.add(builder);\n    });\n  });\n\n  setAttestors(Array.from(attestorSet));\n  setBuilders(Array.from(builderSet));\n\n  const newMatrix = Array.from(builderSet).map((builder) =>\n    Array.from(attestorSet).map((attestor) => ({\n      attestorId: attestor,\n      builderId: builder,\n    }))\n  );\n\n  setMatrix(newMatrix);\n}, []);\n\nreturn (\n  <div className=\"m-2\">\n    <Widget src=\"hack.near/widget/commons.add\" />\n    <div>\n      {builders.map((a) => (\n        <div\n          key={a}\n          className=\"m-2 d-flex flex-row justify-content-between align-items-center my-2\"\n        >\n          <div\n            className=\"m-1 d-flex align-items-center\"\n            style={{\n              maxWidth: \"50%\",\n              whiteSpace: \"nowrap\",\n              overflow: \"hidden\",\n              textOverflow: \"ellipsis\",\n            }}\n          >\n            {context.accountId && (\n              <Widget src=\"hack.near/widget/attest\" props={{ accountId: a }} />\n            )}\n            <span\n              style={{\n                fontFamily: \"Courier\",\n                whiteSpace: \"nowrap\",\n                overflow: \"hidden\",\n                textOverflow: \"ellipsis\",\n              }}\n              className=\"ms-3\"\n            >\n              <Widget src=\"hack.near/widget/profile\" props={{ accountId: a }} />\n            </span>\n          </div>\n          <div>\n            <Widget src=\"hack.near/widget/profiles\" props={{ accountId: a }} />\n          </div>\n        </div>\n      ))}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/commons", "fact_widget_deployments_id": "43b4d66ded448bff16f549fe7899af0c", "inserted_timestamp": "2024-05-18T18:51:13.456Z", "modified_timestamp": "2024-05-18T18:51:13.456Z", "__row_index": 15}
{"tx_hash": "DwxCgMeNfTiQ8h5PguCw1V2gqhGCGHrHxg4zAcNU5Sva", "action_id_social": "5xDNG6yGoesBPDzHFsvpWf7mX2eLFnWTa3wtECNsszcV-0-widget", "block_id": 107099053, "block_timestamp": "2023-12-03T23:27:25.792Z", "signer_id": "hack.near", "widget_name": "every.context", "source_code": "const accountId = props.accountId ?? context.accountId ?? \"hack.near\";\nconst namespace = props.namespace ?? \"widget\";\nlet tag = props.tag ?? \"*\";\n\nconst data = Social.keys(`*/graph/context/*/*/*/tags/${tag}`, \"final\");\n\nif (!data) {\n  return \"Loading...\";\n}\n\nfunction extractThings(data) {\n  const uniqueKeys = new Set();\n  const things = [];\n\n  Object.keys(data).forEach((curatorId) => {\n    const context = data[curatorId]?.graph?.context;\n\n    if (context) {\n      Object.keys(context).forEach((creatorId) => {\n        const namespaces = context[creatorId];\n\n        if (namespaces) {\n          Object.keys(namespaces).forEach((namespace) => {\n            const thingData = namespaces[namespace];\n\n            if (thingData) {\n              Object.keys(thingData).forEach((thingId) => {\n                const key = `${creatorId}-${namespace}-${thingId}`;\n\n                if (!uniqueKeys.has(key)) {\n                  uniqueKeys.add(key); // Add the key to the set\n\n                  things.push(\n                    <div key={key} className=\"m-3 mt- card\">\n                      <div className=\"card-body m-2 p-1 row\">\n                        <div className=\"col m-1 p-2 text-truncate\">\n                          <Widget\n                            src=\"hack.near/widget/thing.block\"\n                            props={{ creatorId, namespace, thingId }}\n                          />\n                        </div>\n                        <div className=\"col m-1 p-1\">\n                          <Widget\n                            src=\"hack.near/widget/tags\"\n                            props={{ creatorId, namespace, thingId }}\n                          />\n                        </div>\n                      </div>\n                    </div>\n                  );\n                }\n              });\n            }\n          });\n        }\n      });\n    }\n  });\n\n  return things;\n}\n\nreturn (\n  <>\n    <Widget\n      src=\"hack.near/widget/tag.editor\"\n      props={{ creatorId: accountId }}\n    />\n    <hr />\n    <br />\n\n    {tag !== \"*\" ? (\n      <>\n        <h5 className=\"ms-2\">Filtered by Tag:</h5>\n\n        <h4 className=\"ms-3\">\n          <span className=\"badge rounded-pill bg-primary\">{tag}</span>\n        </h4>\n      </>\n    ) : (\n      <h5 className=\"ms-3\">All Things</h5>\n    )}\n\n    {extractThings(data)}\n\n    {tag !== \"*\" && (\n      <div className=\"mt-3 mb-5\">\n        <a\n          className=\"btn btn-outline-primary\"\n          href=\"/#/hack.near/widget/every.context\"\n        >\n          Every Tag\n        </a>\n      </div>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/every.context", "fact_widget_deployments_id": "aa733326a3389413543e540f77942bf7", "inserted_timestamp": "2023-12-04T00:51:43.280Z", "modified_timestamp": "2023-12-20T03:22:11.422Z", "__row_index": 4}
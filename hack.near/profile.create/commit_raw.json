{"tx_hash": "7s8PQRKykVceAbeeiKEQia1gzbFQ6b58b2mjzcqcV8oZ", "action_id_social": "9BCYRNpt5YQP8kNMtvpnb26Y1vDEowa2C54ijbezmaWM-0-widget", "block_id": 119166386, "block_timestamp": "2024-05-18T03:23:48.356Z", "signer_id": "hack.near", "widget_name": "profile.create", "source_code": "const accountId = props.accountId ?? context.accountId ?? \"buildcommons.near\";\n\nconst profile = props.profile ?? Social.getr(`${accountId}/profile`);\nconst fast = props.fast ?? !props.profile;\n\nconst name = profile.name;\nconst image = profile.image;\n\nState.init({ img: null });\n\nconst uploadFileUpdateState = (body) => {\n  asyncFetch(\"https://ipfs.near.social/add\", {\n    method: \"POST\",\n    headers: { Accept: \"application/json\" },\n    body,\n  }).then((res) => {\n    const cid = res.body.cid;\n    State.update({ img: { cid } });\n  });\n};\n\nconst filesOnChange = (files) => {\n  if (files) {\n    State.update({ img: { uploading: true, cid: null } });\n    uploadFileUpdateState(files[0]);\n  }\n};\n\nconst imgWrapperStyle = { height: \"3em\", width: \"3em\" };\n\nconst [profileName, setProfileName] = useState(\"\");\n\nconst data = {\n  profile: {\n    name: profileName,\n    image: {\n      ipfs_cid: state.img.cid,\n    },\n  },\n};\n\nconst handleSave = () => {\n  Social.set(data);\n};\n\nreturn (\n  <div className=\"d-flex flex-row\">\n    <div className=\"me-2 d-inline-block\">\n      {state.img || image ? (\n        <Widget\n          src=\"hack.near/widget/profile.image\"\n          props={{ image, accountId }}\n        />\n      ) : (\n        <Files\n          multiple={false}\n          accepts={[\"image/*\"]}\n          minFileSize={1}\n          clickable\n          className=\"btn btn-sm mt-2\"\n          onChange={filesOnChange}\n        >\n          {state.img?.uploading ? <></> : <i class=\"bi bi-pencil-fill\"></i>}\n        </Files>\n      )}\n    </div>\n    <div className=\"text-truncate\">\n      <div className=\"text-truncate\">\n        <span className=\"fw-bold me-1\">\n          {name ? (\n            name\n          ) : (\n            <div className=\"m-1 d-flex flex-row\">\n              <input\n                type=\"text\"\n                placeholder=\"input name\"\n                value={profileName}\n                onChange={(e) => setProfileName(e.target.value)}\n              />\n              <div>\n                <button onClick={handleSave} className=\"ms-3 mt-1 btn-sm\">\n                  Save\n                </button>\n              </div>\n            </div>\n          )}\n        </span>\n        <Widget src=\"hack.near/widget/BuilderHat\" props={{ accountId }} />\n      </div>\n      {name && (\n        <small>\n          <span className=\"text-truncate text-muted font-monospace\">\n            @{accountId}\n          </span>\n        </small>\n      )}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/profile.create", "fact_widget_deployments_id": "bb8af2d9a90ac7ae901a75020ab26e1e", "inserted_timestamp": "2024-05-18T04:50:27.621Z", "modified_timestamp": "2024-05-18T05:50:14.792Z", "__row_index": 2}
{"tx_hash": "AREHwQnaFY7e2s5LEPrdUB2QWpkVRUt2TMf2be2SvVfv", "action_id_social": "BeHH22C4oPcenmM7RRkR9bLpHjukZvdMGz1uDHCQXHyE-0-widget", "block_id": 119165767, "block_timestamp": "2024-05-18T03:12:15.339Z", "signer_id": "hack.near", "widget_name": "profile.create", "source_code": "const accountId = props.accountId ?? context.accountId ?? \"every.near\";\n\nconst profile = props.profile ?? Social.getr(`${accountId}`);\nconst commons = Social.getr(`${accountId}/graph/commons`);\n\nconst fast = props.fast ?? !props.data.profile;\n\nconst name = profile.name;\nconst image = profile.image;\n\nState.init({ img: null });\n\nconst uploadFileUpdateState = (body) => {\n  asyncFetch(\"https://ipfs.near.social/add\", {\n    method: \"POST\",\n    headers: { Accept: \"application/json\" },\n    body,\n  }).then((res) => {\n    const cid = res.body.cid;\n    State.update({ img: { cid } });\n  });\n};\n\nconst filesOnChange = (files) => {\n  if (files) {\n    State.update({ img: { uploading: true, cid: null } });\n    uploadFileUpdateState(files[0]);\n  }\n};\n\nconst imgWrapperStyle = { height: \"3em\", width: \"3em\" };\n\nconst [profileName, setProfileName] = useState(\"\");\n\nconst metadata = {\n  profile: {\n    name: profileName,\n    image: {\n      ipfs_cid: state.img.cid,\n    },\n  },\n};\n\nconst handleSave = () => {\n  Social.set(metadata);\n};\n\nreturn (\n  <>\n    {commons ? (\n      <div className=\"d-flex flex-row\">\n        <div className=\"me-2 d-inline-block\">\n          {state.img || image ? (\n            <Widget\n              src=\"hack.near/widget/profile.image\"\n              props={{ image, accountId }}\n            />\n          ) : (\n            <Files\n              multiple={false}\n              accepts={[\"image/*\"]}\n              minFileSize={1}\n              clickable\n              className=\"btn btn-sm mt-2\"\n              onChange={filesOnChange}\n            >\n              {state.img?.uploading ? <></> : <i class=\"bi bi-pencil-fill\"></i>}\n            </Files>\n          )}\n        </div>\n        <div className=\"text-truncate\">\n          <div className=\"text-truncate\">\n            <span className=\"fw-bold me-1\">\n              {name ? (\n                name\n              ) : (\n                <div className=\"m-1 d-flex flex-row\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"input name\"\n                    value={profileName}\n                    onChange={(e) => setProfileName(e.target.value)}\n                  />\n                  <div>\n                    <button onClick={handleSave} className=\"ms-3 mt-1 btn-sm\">\n                      Save\n                    </button>\n                  </div>\n                </div>\n              )}\n            </span>\n            <Widget src=\"hack.near/widget/BuilderHat\" props={{ accountId }} />\n          </div>\n          {name && (\n            <small>\n              <span className=\"text-truncate text-muted font-monospace\">\n                @{accountId}\n              </span>\n            </small>\n          )}\n        </div>\n      </div>\n    ) : (\n      <Widget src=\"hack.near/widget/attest\" props={{ accountId }} />\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/profile.create", "fact_widget_deployments_id": "21586e56d1db17146affae29e42a41e2", "inserted_timestamp": "2024-05-18T04:50:27.621Z", "modified_timestamp": "2024-05-18T04:50:27.621Z", "__row_index": 1}
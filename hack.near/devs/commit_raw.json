{"tx_hash": "CpqhoBYcNHp9WtspzZvCy4gz9W1XhTDZs8QXv7suKd8M", "action_id_social": "6s6ENsLaGfgR5MkDu4U2XTxaLosJvUaAcn76S3pRfQbU-0-widget", "block_id": 106161297, "block_timestamp": "2023-11-20T22:55:54.572Z", "signer_id": "hack.near", "widget_name": "devs", "source_code": "const data = Social.get(\"*/graph/star/**\", \"final\");\n\nconst starCountsByAccount = {};\n\n// Calculate star counts for each widget within each account\nObject.keys(data).forEach((user) => {\n  const userData = data[user];\n  const widgetData = userData?.graph?.star;\n\n  if (widgetData) {\n    Object.keys(widgetData).forEach((widgetUser) => {\n      const widgetList = widgetData[widgetUser]?.widget;\n\n      if (widgetList) {\n        Object.keys(widgetList).forEach((widgetName) => {\n          if (!starCountsByAccount[widgetUser]) {\n            starCountsByAccount[widgetUser] = {};\n          }\n\n          if (!starCountsByAccount[widgetUser][widgetName]) {\n            starCountsByAccount[widgetUser][widgetName] = 0;\n          }\n\n          // Check if the widgetName is valid before incrementing stars\n          if (\n            typeof starCountsByAccount[widgetUser][widgetName] !== \"undefined\"\n          ) {\n            starCountsByAccount[widgetUser][widgetName]++;\n          }\n        });\n      }\n    });\n  }\n});\n\n// Calculate total stars received by each account\nconst totalStarsByAccount = {};\nObject.keys(starCountsByAccount).forEach((account) => {\n  const widgets = starCountsByAccount[account];\n  const totalStars = Object.values(widgets).reduce(\n    (acc, stars) => acc + stars,\n    0\n  );\n  totalStarsByAccount[account] = totalStars;\n});\n\n// Convert the object to an array and sort it by total stars in descending order\nconst rankedAccounts = Object.entries(totalStarsByAccount)\n  .filter(([account, totalStars]) => typeof totalStars !== \"undefined\")\n  .sort((a, b) => b[1] - a[1]);\n\nreturn (\n  <div>\n    <h3>Top Builders</h3>\n    <div className=\"m-2\">\n      {rankedAccounts.map(([account, totalStars], index) => (\n        <div key={account}>\n          <h5>\n            {index + 1}. {account} ({totalStars} total stars)\n          </h5>\n          <ul className=\"m-3\">\n            {Object.entries(starCountsByAccount[account])\n              .sort((a, b) => b[1] - a[1])\n              .map(([widgetName, widgetStars]) => (\n                <li key={widgetName}>\n                  {widgetName} ({widgetStars} stars)\n                </li>\n              ))}\n          </ul>\n        </div>\n      ))}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/devs", "fact_widget_deployments_id": "9f2800574542c714245f390cae55a25a", "inserted_timestamp": "2023-11-21T00:47:52.276Z", "modified_timestamp": "2023-11-21T00:47:52.276Z", "__row_index": 0}
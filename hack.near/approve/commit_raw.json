{"tx_hash": "86pCDr4hpe9L7or5Q32FxdJkMpRNiPJHSQGTrJRRUHot", "action_id_social": "D7sQUeVsPx2vkshubDzbZtRFMV7vY1cKVKxPv8L1t1Wy-0-widget", "block_id": 100900358, "block_timestamp": "2023-09-11T17:54:50.396Z", "signer_id": "hack.near", "widget_name": "approve", "source_code": "const accountId = props.accountId ?? context.accountId;\nconst groupId = props.groupId ?? \"f8ad9d1a76259lmdpjnd74e69162a0a014\";\nconst creatorId = props.creatorId ?? \"hack.near\";\n\nif (!props.accountId && !context.accountId) {\n  return \"\";\n}\n\nconst joinEdge = Social.keys(\n  `${accountId}/graph/${groupId}/${context.accountId}`,\n  undefined,\n  {\n    values_only: true,\n  }\n);\n\nconst memberEdge = Social.keys(\n  `${creatorId}/graph/${groupId}/${context.accountId}`,\n  undefined,\n  {\n    values_only: true,\n  }\n);\n\nconst loading = joinEdge === null || memberEdge === null;\nconst join = joinEdge && Object.keys(joinEdge).length;\nconst member = memberEdge && Object.keys(memberEdge).length;\n\nconst type = join ? \"reject\" : \"approve\";\n\nconst handleApprove = () => {\n  Social.set({\n    graph: { [groupId]: { [accountId]: \"\" } },\n    index: {\n      graph: JSON.stringify({\n        key: groupId,\n        value: {\n          type,\n          accountId,\n        },\n      }),\n      notify: JSON.stringify({\n        key: accountId,\n        value: {\n          type,\n          groupId,\n          message: \"request approved\",\n        },\n      }),\n    },\n  });\n};\nreturn (\n  <>\n    {creatorId === context.accountId && (\n      <span>\n        {member ? (\n          <button\n            disabled={memberEdge}\n            className=\"btn btn-success\"\n            onClick={handleApprove}\n          >\n            Approved\n          </button>\n        ) : (\n          <button\n            disabled={!context.accountId}\n            className=\"btn btn-success\"\n            onClick={handleApprove}\n          >\n            Approve\n          </button>\n        )}\n      </span>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/approve", "fact_widget_deployments_id": "a9b90a5d8c8904b5a6dca39b2abebec0", "inserted_timestamp": "2023-09-11T19:45:08.219Z", "modified_timestamp": "2023-09-11T19:45:08.219Z", "__row_index": 1}
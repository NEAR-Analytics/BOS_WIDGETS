{"tx_hash": "CjzPw6PxZtTFTapQRVuSksGUokDuKFWoK9UHvkAp4jGw", "action_id_social": "3ECkB9y21ncMZv9nmAdhsN5Zw8xah35rpHw3H9xc1Gz5-0-widget", "block_id": 103706154, "block_timestamp": "2023-10-19T04:00:51.186Z", "signer_id": "hack.near", "widget_name": "community.groups", "source_code": "const accountId = props.accountId ?? context.accountId;\nconst daoId = props.daoId ?? \"multi.sputnik-dao.near\";\n\nconst policy = Near.view(daoId, \"get_policy\");\n\nif (policy === null) {\n  return \"\";\n}\n\nconst groups = policy.roles\n  .filter((role) => role.kind.Group)\n  .map((role) => ({\n    name: role.name,\n    members: role.kind.Group,\n  }));\n\nconst deposit = policy.proposal_bond;\n\nState.init({\n  memberId: state.memberId ?? \"\",\n  isAccount: false,\n  isMember: false,\n});\n\nconst onChangeMember = (memberId) => {\n  State.update({\n    memberId,\n  });\n};\n\nconst membership = group.members;\n\nlet string = \".near\";\n\nconst checkAccount = (memberId) => {\n  if (memberId.indexOf(string) !== -1) {\n    return State.update({ isAccount: true });\n  }\n};\n\nconst validAccount = checkAccount(state.memberId);\n\nreturn (\n  <div className=\"mb-3\">\n    <div className=\"row\">\n      <div>\n        <h3>Membership</h3>\n      </div>\n      <div className=\"mb-2\">\n        <h5 className=\"mb-1\">input account id:</h5>\n        <div className=\"mt-2\">\n          <input\n            type=\"text\"\n            placeholder=\"<example>.near\"\n            value={state.memberId}\n            onChange={(e) => onChangeMember(e.target.value)}\n          />\n        </div>\n      </div>\n      {!isMember && (\n        <div className=\"mt-2\">\n          <div className=\"mb-2 d-flex gap-2 flex-wrap\">\n            {groups.map((group, i) => (\n              <Widget\n                key={i}\n                src=\"hack.near/widget/DAO.AddMember\"\n                props={{\n                  daoId,\n                  accountId: accountId,\n                  memberId: state.memberId,\n                  roleId: group.name,\n                }}\n              />\n            ))}\n          </div>\n        </div>\n      )}\n      <div className=\"mt-2\">\n        <br />\n        <Widget src=\"hack.near/widget/DAO.Members\" props={{ daoId }} />\n      </div>\n    </div>\n  </div>\n);\n", "metadata": {}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/community.groups", "fact_widget_deployments_id": "66994b6a77ee6523703b40380a6ad4f6", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "GXSXS58QdFVsDEbKbdkQeMYvgSWCrno1qR7E2UuaFRGs", "action_id_social": "FFK5G8gtMv1Ugsa8KB67huRxFio94mvj5qGoh4YL3zUZ-0-widget", "block_id": 107488501, "block_timestamp": "2023-12-09T04:10:40.448Z", "signer_id": "hack.near", "widget_name": "quests", "source_code": "const quests = Near.view(\"test1.questverse.near\", \"quests\");\n\nif (!quests) {\n  return \"\";\n}\n\nconst tag = props.tag ?? \"*\";\n\nconst data = Social.keys(`*/graph/context/*/quest/*/tags/${tag}`, \"final\");\n\nif (!data) {\n  return \"Loading...\";\n}\n\nfunction extractThings(data) {\n  const uniqueKeys = new Set();\n  const things = [];\n\n  Object.keys(data).forEach((curatorId) => {\n    const context = data[curatorId]?.graph?.context;\n\n    if (context) {\n      Object.keys(context).forEach((creatorId) => {\n        const namespaces = context[creatorId];\n\n        if (namespaces) {\n          Object.keys(namespaces).forEach((namespace) => {\n            const thingData = namespaces[namespace];\n\n            if (thingData) {\n              Object.keys(thingData).forEach((thingId) => {\n                const key = `${creatorId}-${namespace}-${thingId}`;\n                const questId =\n                  data[\"hack.near\"]?.graph?.context?.[\"hack.near\"]?.quest?.[\n                    key\n                  ];\n\n                if (!uniqueKeys.has(key)) {\n                  uniqueKeys.add(key);\n\n                  things.push(\n                    <div key={key}>\n                      <Widget\n                        src=\"hack.near/widget/quest.card\"\n                        props={{ questId }}\n                      />\n                    </div>\n                  );\n                }\n              });\n            }\n          });\n        }\n      });\n    }\n  });\n\n  return things;\n}\n\nconst Header = styled.div`\n  background: black;\n`;\n\nconst Container = styled.div`\n  padding: 30px 0;\n  margin: 0;\n`;\n\nconst Toolbar = styled.div`\n  margin-left: 20px;\n  @media only screen and (max-width: 1061px) {\n    margin: 10px 0 0 0;\n  }\n`;\n\nreturn (\n  <>\n    <div>\n      <Header className=\"d-flex p-3 px-4 align-items-center rounded justify-content-between\">\n        <h3 className=\"mt-2\" style={{ fontFamily: \"Courier\", color: \"white\" }}>\n          <b>QuestVerse</b>\n        </h3>\n\n        {!isVerified ? (\n          <Widget\n            src=\"hack.near/widget/n.style\"\n            props={{\n              Link: {\n                text: \"Get Verified\",\n                href: \"https://i-am-human.app/\",\n              },\n            }}\n          />\n        ) : (\n          <Toolbar>\n            <Widget src=\"hack.near/widget/start\" />\n          </Toolbar>\n        )}\n      </Header>\n      <Container className=\"d-flex row justify-content-between w-100\">\n        <h2 style={{ fontFamily: \"Courier\" }}>\n          <b>Discover</b>\n        </h2>\n        <div>\n          <Widget\n            src=\"hack.near/widget/every.tag\"\n            props={{ tag, namespace: \"quest\", url: \"hack.near/widget/quests\" }}\n          />\n        </div>\n        {tag === \"*\" ? (\n          <div>\n            {quests.map((quest) => (\n              <div className=\"m-2\">\n                <Widget\n                  src=\"hack.near/widget/quest.card\"\n                  props={{ questId: quest.quest_id }}\n                />\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"m-2\">{extractThings(data)}</div>\n        )}\n      </Container>\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/quests", "fact_widget_deployments_id": "ba3447f22382fd2bc528dde3a49a0169", "inserted_timestamp": "2023-12-09T06:18:33.819Z", "modified_timestamp": "2023-12-20T03:22:11.422Z", "__row_index": 11}
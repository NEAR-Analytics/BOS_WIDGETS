{"tx_hash": "8k8a3QB3fkEHgxQg9zXB48EsPGkBLQdieVETk94KKMoq", "action_id_social": "BM6fnmkkJWjuidTujbY3dhXLsSTXSzb9dFMGewwj4pZB-0-widget", "block_id": 96592182, "block_timestamp": "2023-07-16T07:48:07.089Z", "signer_id": "hack.near", "widget_name": "dev.proposal.vote", "source_code": "const accountId = context.accountId;\nconst daoId = props.daoId ?? \"multi.sputnik-dao.near\";\nconst vote_counts = props.proposal.vote_counts ?? {\n  // yes, no, spam\n  community: [3, 0, 2],\n  council: [1, 6, 0],\n};\n\nconst userVote = props.proposal.votes[accountId];\nconst isAllowedToVote = props.isAllowedToVote ?? [true, true, true];\nconst canVote =\n  isAllowedToVote[0] &&\n  isAllowedToVote[1] &&\n  isAllowedToVote[2] &&\n  !userVote &&\n  props.proposal.status === \"In Progress\" &&\n  accountId;\nconst yesWin = props.proposal.status === \"Approved\";\nconst noWin = props.proposal.status === \"Rejected\";\n\nlet totalYesVotes = 0;\nlet totalNoVotes = 0;\nlet totalSpamVotes = 0;\nObject.keys(vote_counts).forEach((key) => {\n  totalYesVotes += vote_counts[key][0];\n  totalNoVotes += vote_counts[key][1];\n  totalSpamVotes += vote_counts[key][2];\n});\nconst totalVotes = totalYesVotes + totalNoVotes + totalSpamVotes;\n\n// Functions\n\nconst handleApprove = () => {\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"act_proposal\",\n      args: {\n        id: JSON.parse(props.proposal.id),\n        action: \"VoteApprove\",\n      },\n      gas: 200000000000000,\n    },\n  ]);\n};\n\nconst handleReject = () => {\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"act_proposal\",\n      args: {\n        id: JSON.parse(props.proposal.id),\n        action: \"VoteReject\",\n      },\n      gas: 200000000000000,\n    },\n  ]);\n};\n\nconst handleSpam = () => {\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"act_proposal\",\n      args: {\n        id: JSON.parse(props.proposal.id),\n        action: \"VoteRemove\",\n      },\n      gas: 200000000000000,\n    },\n  ]);\n};\n\nreturn (\n  <div className=\"row\">\n    <div className=\"col-5\">\n      <a\n        className=\"btn btn-success m-1 w-100\"\n        onClick={handleApprove}\n        disabled={!canVote}\n      >\n        <span>Vote Yes</span>\n      </a>\n    </div>\n    <div className=\"col-5\">\n      <a\n        className=\"btn btn-danger m-1 w-100\"\n        onClick={handleReject}\n        disabled={!canVote}\n      >\n        <span className=\"button no\">Vote No</span>\n      </a>\n    </div>\n    <div className=\"col-2\">\n      <a\n        className=\"btn btn-warning m-1 w-100\"\n        onClick={handleSpam}\n        disabled={!canVote}\n      >\n        <span className=\"button no\">Spam</span>\n      </a>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/dev.proposal.vote", "fact_widget_deployments_id": "3cfd19a15b54a2f4d71fb0145e3c9727", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 1}
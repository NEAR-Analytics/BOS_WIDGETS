{"tx_hash": "6x3fARwxAzpvtxpNRAX3nJxtqNyoLUVAhLdMhYDNALru", "action_id_social": "AzdN9gui2G21GEr6D7jBC59ppC3xy4MUzy57SGaXN4z4-0-widget", "block_id": 107709174, "block_timestamp": "2023-12-11T21:39:24.325Z", "signer_id": "hack.near", "widget_name": "quests.index", "source_code": "const quests = Near.view(\"test1.questverse.near\", \"quests\");\n\nif (!quests) {\n  return \"\";\n}\n\nconst tag = props.tag ?? \"build\";\n\nconst data = Social.keys(`*/graph/context/*/*/*/tags/${tag}`, \"final\");\n\nif (!data) {\n  return \"Loading...\";\n}\n\nfunction extractThings(data, filter) {\n  const uniqueKeys = new Set();\n  const things = [];\n\n  Object.keys(data).forEach((curatorId) => {\n    const context = data[curatorId]?.graph?.context;\n\n    if (context) {\n      const questData = context[curatorId]?.quest;\n\n      if (questData) {\n        Object.keys(questData).forEach((questId) => {\n          const tags = questData[questId]?.tags;\n\n          if (tags && (filter === \"*\" || tags[filter])) {\n            const key = `${curatorId}-${questId}`;\n\n            if (!uniqueKeys.has(key)) {\n              uniqueKeys.add(key);\n\n              // Extract specific questIds\n              if (questId === \"2\") {\n                // For questId \"2\", use it as needed\n                things.push(\n                  <div key={key}>\n                    <Widget\n                      src=\"hack.near/widget/quest.card\"\n                      props={{ questId }}\n                    />\n                    <p>Tags: {JSON.stringify(tags)}</p>\n                    <p>Quest ID: {questId}</p>\n                  </div>\n                );\n              } else if (questId === \"3\") {\n                // For questId \"3\", use it as needed\n                things.push(\n                  <div key={key}>\n                    <Widget\n                      src=\"hack.near/widget/quest.card\"\n                      props={{ questId }}\n                    />\n                    <p>Tags: {JSON.stringify(tags)}</p>\n                    <p>Quest ID: {questId}</p>\n                  </div>\n                );\n              }\n            }\n          }\n        });\n      }\n    }\n  });\n\n  return things;\n}\n\nconst Header = styled.div`\n  background: black;\n`;\n\nconst Container = styled.div`\n  padding: 30px 0;\n  margin: 0;\n`;\n\nconst Toolbar = styled.div`\n  margin-left: 20px;\n  @media only screen and (max-width: 1061px) {\n    margin: 10px 0 0 0;\n  }\n`;\n\nreturn (\n  <>\n    <div>\n      <Header className=\"d-flex p-3 px-4 align-items-center rounded justify-content-between\">\n        <h3 className=\"mt-2\" style={{ fontFamily: \"Courier\", color: \"white\" }}>\n          <b>QuestVerse</b>\n        </h3>\n\n        {!isVerified ? (\n          <Widget\n            src=\"hack.near/widget/n.style\"\n            props={{\n              Link: {\n                text: \"Get Verified\",\n                href: \"https://i-am-human.app/\",\n              },\n            }}\n          />\n        ) : (\n          <Toolbar>\n            <Widget src=\"hack.near/widget/start\" />\n          </Toolbar>\n        )}\n      </Header>\n      <p>{JSON.stringify(data)}</p>\n      <Container className=\"d-flex row justify-content-between w-100\">\n        <h2 style={{ fontFamily: \"Courier\" }}>\n          <b>Discover</b>\n        </h2>\n        <div>\n          <Widget\n            src=\"hack.near/widget/every.tag\"\n            props={{\n              tag,\n              namespace: \"quest\",\n              url: \"/hack.near/widget/quests\",\n            }}\n          />\n        </div>\n        {tag === \"*\" ? (\n          <div>\n            {quests.map((quest) => (\n              <div className=\"m-2\">\n                <Widget\n                  src=\"hack.near/widget/quest.card\"\n                  props={{\n                    questId: quest.quest_id,\n                    url: \"/hack.near/widget/quests\",\n                  }}\n                />\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"m-2\">{extractThings(data, tag)}</div>\n        )}\n      </Container>\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/quests.index", "fact_widget_deployments_id": "d8c03749fac5980958aa718d31e4bedb", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
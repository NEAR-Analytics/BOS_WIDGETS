{"tx_hash": "GQcuiV58kLfFicNhfgnzgfND76gbKGzqzhMXXZLckMwL", "action_id_social": "ESSXX71v3G7prfeUBD9y7czjHxK3aYc2HKrMgEFDSBeh-0-widget", "block_id": 115634086, "block_timestamp": "2024-03-28T06:53:02.496Z", "signer_id": "hack.near", "widget_name": "list.create", "source_code": "const creatorId = context.accountId ?? \"every.near\";\n\nState.init({\n  name,\n  description,\n  admins: [creatorId],\n  newAdmin: \"\",\n});\n\nfunction addAdmin(newAdmin) {\n  if (newAdmin && !state.admins.includes(newAdmin)) {\n    State.update({\n      admins: [...state.admins, newAdmin],\n    });\n  }\n}\n\nfunction removeAdmin(adminKey) {\n  const updatedAdmins = state.admins.filter((admin) => admin !== adminKey);\n\n  State.update({\n    admins: updatedAdmins,\n  });\n}\n\nfunction isNearAddress(address) {\n  if (typeof address !== \"string\") {\n    return false;\n  }\n  if (!address.endsWith(\".near\")) {\n    return false;\n  }\n  const parts = address.split(\".\");\n  if (parts.length !== 2) {\n    return false;\n  }\n  if (parts[0].length < 2 || parts[0].length > 32) {\n    return false;\n  }\n  if (!/^[a-z0-9_-]+$/i.test(parts[0])) {\n    return false;\n  }\n  return true;\n}\n\nconst adminId = props.adminId ?? state.newAdmin;\nconst isValid = isNearAddress(adminId);\n\nconst createList = () =>\n  Near.call(\"lists.potlock.near\", \"create_list\", {\n    name: state.name,\n    description: state.description,\n    cover_image_url: null,\n    admins: state.admins,\n    default_registration_status: \"Pending\",\n    admin_only_registrations: false,\n  });\n\nreturn (\n  <div className=\"m-2 mb-3\">\n    <div className=\"d-flex flex-row justify-content-between me-3\">\n      <h4 className=\"m-1\">\n        <b>Create Lists</b>\n      </h4>\n      <div>\n        <button\n          disabled={state.admins.length === 0}\n          onClick={createList}\n          className=\"m-1 me-3 btn btn-sm btn-success\"\n        >\n          <i class=\"bi bi-stars\"></i>\n        </button>\n      </div>\n    </div>\n    <hr />\n    <div className=\"m-3 me-4\">\n      <h5 className=\"mb-2\">Name</h5>\n      <div className=\"mb-3\">\n        <input\n          placeholder=\"title\"\n          onChange={(e) => State.update({ name: e.target.value })}\n        />\n      </div>\n      <h5 className=\"mb-2\">Description</h5>\n      <div className=\"mb-3\">\n        <input\n          placeholder=\"about\"\n          onChange={(e) => State.update({ description: e.target.value })}\n        />\n      </div>\n      <h5 className=\"mb-2\">Admins</h5>\n      <div className=\"d-flex align-items-center mt-2\">\n        <input\n          placeholder={`${creatorId}`}\n          onChange={(e) => State.update({ newAdmin: e.target.value })}\n        />\n        <button\n          disabled={!isValid}\n          className=\"btn btn-sm btn-dark m-1 ms-3\"\n          onClick={() => addAdmin(state.newAdmin)}\n        >\n          <i class=\"bi bi-plus\"></i>\n        </button>\n      </div>\n      <br />\n      <div>\n        {state.admins.map((admin, index) => (\n          <div\n            key={index}\n            className=\"d-flex flex-row justify-content-between mb-3\"\n          >\n            <Widget\n              src=\"mob.near/widget/Profile\"\n              props={{ accountId: admin }}\n            />\n            <div>\n              <button\n                className=\"btn btn-sm btn-danger m-1\"\n                onClick={() => removeAdmin(admin)}\n              >\n                <i className=\"bi bi-x\"></i>\n              </button>\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/list.create", "fact_widget_deployments_id": "4af1b2e69b3e63f289ca035ae3241069", "inserted_timestamp": "2024-03-28T08:29:43.910Z", "modified_timestamp": "2024-03-28T08:29:43.910Z", "__row_index": 0}
{"tx_hash": "8oR4FF1ezmA2GSoQJwnVrGT3q5FftkPT1Sw4yN9ukefx", "action_id_social": "GAxf7RQ9B1ENGzSNNEkvke7ZFkrHu9E3TAvZRMbs6Hgq-0-widget", "block_id": 115632258, "block_timestamp": "2024-03-28T06:17:20.288Z", "signer_id": "hack.near", "widget_name": "list.create", "source_code": "const creatorId = context.accountId ?? \"every.near\";\n\nState.init({\n  name,\n  description,\n  admins: [creatorId],\n  newAdmin: \"\",\n});\n\nfunction addAdmin(newAdmin) {\n  if (newAdmin && !state.admins.includes(newAdmin)) {\n    State.update({\n      admins: [...state.admins, newAdmin],\n    });\n  }\n}\n\nfunction removeAdmin(adminKey) {\n  const updatedAdmins = state.admins.filter((admin) => admin !== adminKey);\n\n  State.update({\n    admins: updatedAdmins,\n  });\n}\n\nfunction isNearAddress(address) {\n  if (typeof address !== \"string\") {\n    return false;\n  }\n  if (!address.endsWith(\".near\")) {\n    return false;\n  }\n  const parts = address.split(\".\");\n  if (parts.length !== 2) {\n    return false;\n  }\n  if (parts[0].length < 2 || parts[0].length > 32) {\n    return false;\n  }\n  if (!/^[a-z0-9_-]+$/i.test(parts[0])) {\n    return false;\n  }\n  return true;\n}\n\nconst adminId = props.adminId ?? state.newAdmin;\nconst isValid = isNearAddress(adminId);\n\nconst createList = () =>\n  Near.call(\"lists.potlock.near\", \"create_list\", {\n    name: state.name,\n    description: state.description,\n    cover_image_url: null,\n    admins: state.admins,\n    default_registration_status: \"Pending\",\n    admin_only_registrations: false,\n  });\n\nreturn (\n  <div className=\"m-2 mb-3\">\n    <div className=\"d-flex flex-row justify-content-between me-3\">\n      <h4 className=\"m-1\">\n        <b>List Creator</b>\n      </h4>\n      <div>\n        <button\n          disabled={state.admins.length === 0}\n          onClick={createList}\n          className=\"btn btn-sm btn-success\"\n        >\n          <i class=\"bi bi-stars\"></i> Save\n        </button>\n      </div>\n    </div>\n    <div className=\"m-2\">\n      <h5 className=\"mb-2\">Name</h5>\n      <div className=\"mb-3\">\n        <input\n          placeholder=\"title\"\n          onChange={(e) => State.update({ name: e.target.value })}\n        />\n      </div>\n      <h5 className=\"mb-2\">Description</h5>\n      <div className=\"mb-3\">\n        <input\n          placeholder=\"about\"\n          onChange={(e) => State.update({ description: e.target.value })}\n        />\n      </div>\n      <h5 className=\"mb-2\">Admins</h5>\n      <div className=\"d-flex align-items-center mt-2\">\n        <input\n          placeholder={`${creatorId}`}\n          onChange={(e) => State.update({ newAdmin: e.target.value })}\n        />\n        <button\n          disabled={!isValid}\n          className=\"btn btn-sm btn-outline-dark m-1 ms-3\"\n          onClick={() => addAdmin(state.newAdmin)}\n        >\n          <i class=\"bi bi-plus\"></i>\n        </button>\n      </div>\n      <br />\n      <div>\n        <div>\n          {state.admins.map((admin, index) => (\n            <div\n              key={index}\n              className=\"d-flex flex-row justify-content-between mb-3\"\n            >\n              <Widget\n                src=\"mob.near/widget/Profile\"\n                props={{ accountId: admin }}\n              />\n              <div>\n                <button\n                  className=\"btn btn-sm btn-outline-danger m-1\"\n                  onClick={() => removeAdmin(admin)}\n                >\n                  <i className=\"bi bi-x\"></i>\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/list.create", "fact_widget_deployments_id": "d166eb55a49c8609295def2524168c7b", "inserted_timestamp": "2024-03-28T07:28:50.057Z", "modified_timestamp": "2024-03-28T07:28:50.057Z", "__row_index": 1}
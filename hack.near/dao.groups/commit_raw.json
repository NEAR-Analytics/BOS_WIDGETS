{"tx_hash": "Ckqb94AdVd1jNeGUD9eXKo2HnWxxY6xxgqQt2xS7ciNm", "action_id_social": "5yzeonfXGMSPMxemMHu9o4m9ZUhTDS4o1MgZigbiAtfU-0-widget", "block_id": 95503042, "block_timestamp": "2023-07-02T03:44:38.584Z", "signer_id": "hack.near", "widget_name": "dao.groups", "source_code": "const accountId = props.accountId ?? context.accountId;\nconst daoId = props.daoId ?? \"multi.sputnik-dao.near\";\n\nconst policy = Near.view(daoId, \"get_policy\");\n\nif (policy === null) {\n  return \"\";\n}\n\nconst groups = policy.roles\n  .filter((role) => role.kind.Group)\n  .map((role) => ({\n    name: role.name,\n    members: role.kind.Group,\n  }));\n\nconst deposit = policy.proposal_bond;\n\nState.init({\n  memberId: state.memberId ?? \"\",\n  isAccount: false,\n  isMember: false,\n});\n\nconst onChangeMember = (memberId) => {\n  State.update({\n    memberId,\n  });\n};\n\nconst membership = group.members;\n\nlet string = \".near\";\n\nconst checkAccount = (memberId) => {\n  if (memberId.indexOf(string) !== -1) {\n    return State.update({ isAccount: true });\n  }\n};\n\nconst validAccount = checkAccount(state.memberId);\n\nreturn (\n  <div className=\"mb-3\">\n    <div className=\"row\">\n      <div>\n        <h1>membership</h1>\n      </div>\n      <div className=\"mb-2\">\n        <h3>who?</h3>\n        <h5 className=\"mb-1\">account id:</h5>\n        <div className=\"mt-2\">\n          <input\n            type=\"text\"\n            placeholder=\"<example>.near\"\n            value={state.memberId}\n            onChange={(e) => onChangeMember(e.target.value)}\n          />\n        </div>\n      </div>\n      {!isMember && (\n        <div className=\"mt-2\">\n          <h5>nominate for a role:</h5>\n          <div className=\"mb-2 d-flex gap-2 flex-wrap\">\n            {groups.map((group, i) => (\n              <Widget\n                key={i}\n                src=\"hack.near/widget/DAO.AddMember\"\n                props={{\n                  daoId: daoId,\n                  accountId: accountId,\n                  memberId: state.memberId,\n                  roleId: group.name,\n                }}\n              />\n            ))}\n          </div>\n        </div>\n      )}\n      <div className=\"mt-2\">\n        <h2 className=\"mb-2\">groups</h2>\n        <Widget src=\"hack.near/widget/DAO.Members\" props={{ daoId: daoId }} />\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/dao.groups", "fact_widget_deployments_id": "5f0afc6cf918192462fd88420237db47", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 0}
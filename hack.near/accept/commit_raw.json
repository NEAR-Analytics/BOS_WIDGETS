{"tx_hash": "2nosMr7vdqSLvGSpVQko65nuH9tKambzLNMBv8QijHmB", "action_id_social": "CMLtnCPfG1ZLZVHrWUYDXBAA9J3Lr1rTEaCuhwiJSuQV-0-widget", "block_id": 100911239, "block_timestamp": "2023-09-11T21:18:18.510Z", "signer_id": "hack.near", "widget_name": "accept", "source_code": "const accountId = props.accountId ?? context.accountId;\nconst groupId = props.groupId ?? \"526fb256e74eelmf0nw3n5909bc189c13d\";\nconst creatorId = props.creatorId ?? \"devs.near\";\n\nif (!props.accountId && !context.accountId) {\n  return \"\";\n}\n\nconst joinEdge = Social.keys(\n  `${accountId}/graph/${groupId}/${accountId}`,\n  undefined,\n  {\n    values_only: true,\n  }\n);\n\nconst memberEdge = Social.keys(\n  `${creatorId}/graph/${groupId}/${accountId}`,\n  undefined,\n  {\n    values_only: true,\n  }\n);\n\nconst loading = joinEdge === null || memberEdge === null;\nconst join = joinEdge && Object.keys(joinEdge).length;\nconst member = memberEdge && Object.keys(memberEdge).length;\n\nconst type = member ? \"accept\" : \"reject\";\n\nconst handleAccept = () => {\n  Social.set({\n    graph: { [groupId]: { [accountId]: \"\" } },\n    index: {\n      graph: JSON.stringify({\n        key: groupId,\n        value: {\n          type,\n          accountId,\n        },\n      }),\n      notify: JSON.stringify({\n        key: creatorId,\n        value: {\n          type,\n          accountId,\n          groupId,\n          message: \"request accepted\",\n        },\n      }),\n    },\n  });\n};\n\nreturn (\n  <>\n    <span>\n      {!join ? (\n        <button\n          disabled={!context.accountId}\n          className=\"btn btn-success\"\n          onClick={handleAccept}\n        >\n          Accept\n        </button>\n      ) : (\n        <button\n          disabled={joinEdge}\n          className=\"btn btn-success\"\n          onClick={handleAccept}\n        >\n          Accepted\n        </button>\n      )}\n    </span>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/accept", "fact_widget_deployments_id": "6215e64b16ac5d25ceab6d2af5d72991", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "2bvZoS122MGMee5cLGLsybBbgJ2Jc4L3BTeAEiBVzKTL", "action_id_social": "AZiyQwuqf37XTp4BSFjF6HCSSSsreoQydyQPBnf33sjd-0-widget", "block_id": 100606661, "block_timestamp": "2023-09-07T18:29:01.598Z", "signer_id": "hack.near", "widget_name": "group.editor", "source_code": "const creatorId = props.creatorId ?? \"james.near\";\nconst groupId = props.groupId ?? \"6fd36ddf4884flm20pbe91e7b208b88d16\";\n\nState.init({\n  newMember: \"\",\n});\n\nfunction init() {\n  if (groupId === props.groupId) {\n    const initMembers = Social.get(`${creatorId}/graph/${props.groupId}/**`);\n    if (initMembers) {\n      State.update({ members: initMembers });\n    }\n  } else {\n    const groupMembers = Social.get(`${creatorId}/graph/${groupId}/**`);\n    if (groupMembers) {\n      State.update({ members: groupMembers });\n    }\n  }\n}\n\ninit();\n\nfunction addMember(newMember) {\n  State.update({\n    members: { ...state.members, [newMember]: \"\" },\n  });\n}\n\nfunction removeMember(memberKey) {\n  const updatedMembers = { ...state.members };\n  delete updatedMembers[memberKey];\n\n  State.update({\n    members: updatedMembers,\n  });\n}\n\nfunction isNearAddress(address) {\n  if (typeof address !== \"string\") {\n    return false;\n  }\n  if (!address.endsWith(\".near\")) {\n    return false;\n  }\n  const parts = address.split(\".\");\n  if (parts.length !== 2) {\n    return false;\n  }\n  if (parts[0].length < 2 || parts[0].length > 32) {\n    return false;\n  }\n  if (!/^[a-z0-9_-]+$/i.test(parts[0])) {\n    return false;\n  }\n  return true;\n}\n\nconst memberId = props.memberId || state.newMember;\n\nconst isValid = isNearAddress(memberId);\n\nconst handleCreate = () => {\n  Social.set({\n    thing: {\n      [groupId]: {\n        ...state.group,\n      },\n    },\n    graph: {\n      [groupId]: {\n        ...state.members,\n      },\n    },\n  });\n};\n\nreturn (\n  <>\n    <div className=\"row\">\n      <div className=\"col-lg-6\">\n        <h5>Details</h5>\n        <>\n          <div className=\"mt-2\">\n            <Widget src=\"hack.near/widget/group.card\" props={{ groupId }} />\n          </div>\n          <div className=\"mt-3\">\n            <button className=\"btn btn-success me-2\" onClick={handleCreate}>\n              update\n            </button>\n            <button\n              className=\"btn btn-secondary me-2\"\n              href={`/hack.near/widget/group?groupId=${groupId}`}\n            >\n              view\n            </button>\n          </div>\n        </>\n        <div className=\"mb-2 mt-3\">\n          <Widget\n            src=\"near/widget/MetadataEditor\"\n            props={{\n              initialMetadata: group,\n              onChange: (group) => State.update({ group }),\n              options: {\n                name: { label: \"Name\" },\n                image: { label: \"Logo\" },\n                description: { label: \"About\" },\n                tags: {\n                  label: \"Tags\",\n                  tagsPattern: `*/${groupId}/tags/*`,\n                  placeholder: \"art, gov, edu, dev, com, nft, ai, social\",\n                },\n                linktree: {\n                  links: [\n                    {\n                      label: \"Twitter\",\n                      prefix: \"https://twitter.com/\",\n                      name: \"twitter\",\n                    },\n                    {\n                      label: \"Github\",\n                      prefix: \"https://github.com/\",\n                      name: \"github\",\n                    },\n                    {\n                      label: \"Telegram\",\n                      prefix: \"https://t.me/\",\n                      name: \"telegram\",\n                    },\n                    {\n                      label: \"Website\",\n                      prefix: \"https://\",\n                      name: \"website\",\n                    },\n                  ],\n                },\n              },\n            }}\n          />\n        </div>\n      </div>\n      <div className=\"col-lg-6\">\n        <>\n          <div>\n            <h5>Membership</h5>\n            <input\n              placeholder=\"<example>.near\"\n              onChange={(e) => State.update({ newMember: e.target.value })}\n            />\n            <div className=\"d-flex align-items-center mt-2\">\n              <button\n                className=\"btn btn-primary mt-2\"\n                onClick={() => addMember(state.newMember)}\n              >\n                add\n              </button>\n            </div>\n          </div>\n          <hr />\n          <div>\n            <h5>Profiles</h5>\n            {Object.keys(state.members).map((a) => {\n              return (\n                <div className=\"d-flex m-2 p-2 justify-content-between align-items-center\">\n                  <div className=\"d-flex align-items-center\">\n                    <Widget\n                      src=\"mob.near/widget/Profile\"\n                      props={{ accountId: a }}\n                    />\n                  </div>\n                  <button\n                    className=\"btn btn-danger m-1\"\n                    onClick={() => removeMember(a)}\n                  >\n                    remove\n                  </button>\n                </div>\n              );\n            })}\n          </div>\n        </>\n      </div>\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/group.editor", "fact_widget_deployments_id": "b1be474d8f08ae9d4f3717993492eb4e", "inserted_timestamp": "2023-09-07T20:30:00.922Z", "modified_timestamp": "2023-09-07T20:30:00.922Z", "__row_index": 2}
{"tx_hash": "2okYxaDuG3YsvqTfGGH4BSuDse3uCaqnUW2DnHuPjq86", "action_id_social": "DLYJyND1Y5DVBfHKexTgQq478MZdv1xCGUEUbiuqiA3o-0-widget", "block_id": 99553870, "block_timestamp": "2023-08-24T13:58:22.238Z", "signer_id": "hack.near", "widget_name": "NDC.WG.Create", "source_code": "const { handleClose } = props;\n\nconst daoId = props.daoId ?? \"build.sputnik-dao.near\";\n\nconst policy = Near.view(daoId, \"get_policy\");\n\nif (policy === null) {\n  return \"Loading...\";\n}\n\nconst deposit = policy.proposal_bond;\n\nlet members = Social.getr(`${context.accountId}/graph/${groupId}`, \"final\", {});\n\nif (members === null) {\n  return \"\";\n}\n\nfunction generateUID() {\n  return (\n    Math.random().toString(16).slice(2) +\n    Date.now().toString(36) +\n    Math.random().toString(16).slice(2)\n  );\n}\n\nconst groupId = props.groupId ?? generateUID();\n\nconst group_args = JSON.stringify({\n  data: {\n    [daoId]: {\n      graph: {\n        [groupId]: state.elements,\n      },\n      index: {\n        post: JSON.stringify({\n          key: \"group\",\n          value: {\n            type: \"work\",\n          },\n        }),\n      },\n    },\n  },\n});\n\nconst proposal_args = Buffer.from(group_args, \"utf-8\").toString(\"base64\");\n\nconst handleProposal = () => {\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"create group on the BOS\",\n          kind: {\n            FunctionCall: {\n              receiver_id: \"social.near\",\n              actions: [\n                {\n                  method_name: \"set\",\n                  args: proposal_args,\n                  deposit: \"100000000000000000000000\",\n                  gas: \"219000000000000\",\n                },\n              ],\n            },\n          },\n        },\n      },\n      deposit: deposit,\n      gas: \"219000000000000\",\n    },\n  ]).then(() => handleClose());\n};\n\nlet SocialContract = \"social.near\";\n\nconst widgets = {\n  styledComponents: \"hack.near/widget/NDC.StyledComponents\",\n};\n\nconst CardStyled = styled.div`\n  width: 100%;\n  height: 100%;\n  background: #f8f8f9;\n  gap: 10px;\n  padding: 25px;\n  margin: 0 auto;\n  border-radius: 10px;\n  overflow-y: scroll;\n`;\n\nconst CardForm = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: auto;\n`;\n\nconst H1 = styled.h1`\n  margin-bottom: 10px;\n  font-style: normal;\n  font-weight: 555;\n  font-size: 23px;\n`;\n\nconst Submitcontainer = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 16px;\n  @media only screen and (max-width: 480px) {\n    margin-top: 10px;\n  }\n`;\n\nconst Modal = styled.div`\n  position: fixed;\n  z-index: 1;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: rgba(0, 0, 0, 0.7);\n`;\n\nconst ComponentWrapper = styled.div`\n  display: flex;\n  width: 80%;\n  height: 80%;\n  flex-direction: column;\n  align-items: flex-start;\n  border-radius: 10px;\n  background: #fff;\n  border: 1px solid transparent;\n  margin: 140px auto auto auto;\n  @media only screen and (max-width: 480px) {\n    width: 90%;\n  }\n`;\n\nconst Hr = styled.div`\n  height: 1px;\n  margin: 15px 0;\n  width: 100%;\n  background: rgba(208, 214, 217, 0.4);\n`;\n\nconst Section = styled.div`\n  margin: 12px 0;\n`;\n\nconst handleCreate = () => {\n  const data = `{\"data\":{ \"${context.accountId}\": {\"thing\": { \"group\" ${stateAsString}} }}`;\n  const SocialArgs = JSON.parse(data);\n\n  // let CreateGroup_Payload = {\n  //   contractName: daoId,\n  //   methodName: \"add_proposal\",\n  //   args: {},\n  //   gas: 300000000000000,\n  //   deposit: 100000000000000000000000,\n  // };\n\n  let Social_Payload = {\n    contractName: SocialContract,\n    methodName: \"set\",\n    args: SocialArgs,\n    gas: 300000000000000,\n    deposit: 100000000000000000000000,\n  };\n\n  Near.call([Social_Payload, CreatGroup_Payload]).then(() => handleClose());\n};\n\nreturn (\n  <Modal>\n    <ComponentWrapper>\n      <CardStyled name=\"compose\">\n        <div className=\"d-flex flex-column\">\n          <CardForm>\n            <div className=\"d-flex justify-content-between align-items-center\">\n              <H1>Create Work Group</H1>\n              <Submitcontainer>\n                <Widget\n                  src={widgets.styledComponents}\n                  props={{\n                    Button: {\n                      text: \"Close\",\n                      onClick: handleClose,\n                    },\n                  }}\n                />\n                <Widget\n                  src={widgets.styledComponents}\n                  props={{\n                    Button: {\n                      text: \"Submit\",\n                      onClick: () => handleProposal(),\n                    },\n                  }}\n                />\n              </Submitcontainer>\n            </div>\n            <Hr />\n            <Widget\n              src=\"hack.near/widget/group.editor\"\n              props={{ creatorId: context.accountId }}\n            />\n          </CardForm>\n        </div>\n      </CardStyled>\n    </ComponentWrapper>\n  </Modal>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/NDC.WG.Create", "fact_widget_deployments_id": "d8e0d76ee303b306cb0a9d2644554cf4", "inserted_timestamp": "2023-08-24T17:25:59.274Z", "modified_timestamp": "2023-08-24T17:25:59.274Z", "__row_index": 0}
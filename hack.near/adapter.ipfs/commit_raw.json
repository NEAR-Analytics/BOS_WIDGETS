{"tx_hash": "BmnKDydH633vs1vwR5s17d8saxBFjikAkvK1wysrF1UK", "action_id_social": "BW6jxXyfypZwzYv4V9RMWhoFz8URBKGy37tg5KVCerom-0-widget", "block_id": 106064693, "block_timestamp": "2023-11-19T16:14:51.893Z", "signer_id": "hack.near", "widget_name": "adapter.ipfs", "source_code": "props.fileType ||\n  initState({\n    json: props.data ?? \"\",\n  });\n\nconst ipfsUrl = (cid) => `https://ipfs.near.social/ipfs/${cid}`;\n\nconst UploadJson = () => {\n  if (state.json.length) {\n    const body = new Blob([state.json], { type: \"application/json\" });\n    console.log(body);\n    asyncFetch(\"https://ipfs.near.social/add\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n      },\n      body,\n    }).then((res) => {\n      const cid = res.body.cid;\n      console.log(\"CID\", cid);\n      State.update({\n        file: {\n          cid,\n        },\n      });\n    });\n  } else {\n    State.update({\n      file: null,\n    });\n  }\n};\n\nconst onChangeName = (name) => {\n  State.update({\n    name,\n  });\n};\n\nfunction generateUID() {\n  return (\n    Math.random().toString(16).slice(2) +\n    Date.now().toString(36) +\n    Math.random().toString(16).slice(2)\n  );\n}\n\nconst thingId = state.name ?? generateUID();\n\nconst handleCreate = () => {\n  const hyperfile = {\n    thing: {\n      [thingId]: {\n        \"\": JSON.stringify({\n          fileformat: props.fileformat,\n          source: \"IPFS\",\n          adapter: \"hack.near/widget/adapter.ipfs\",\n          reference: {\n            cid: state.file.cid,\n          },\n        }),\n      },\n      metadata: {\n        type: props.type,\n      },\n    },\n  };\n\n  Social.set(hyperfile);\n};\n\nreturn (\n  <>\n    <textarea\n      className=\"form-control mb-3\"\n      rows={5}\n      value={state.json}\n      onChange={(e) => {\n        state.json = e.target.value;\n        State.update();\n      }}\n    />\n    <a type=\"button\" class=\"btn btn-success\" onClick={() => UploadJson()}>\n      Upload\n    </a>\n    <br />\n    {state.file && (\n      <div>\n        <br />\n        Your file:\n        <a href={ipfsUrl(state.file.cid)}>{state.file.cid}</a>\n        <br />\n        <h5 className=\"mt-3\">Name</h5>\n        <input\n          type=\"text\"\n          value={state.name}\n          onChange={(e) => onChangeName(e.target.value)}\n        />\n        <button className=\"btn btn-outline-success mt-3\" onClick={handleCreate}>\n          Create\n        </button>\n      </div>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/adapter.ipfs", "fact_widget_deployments_id": "a94f7365da6b611137ea8533c704358a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
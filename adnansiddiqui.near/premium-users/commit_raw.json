{"tx_hash": "6rM5KfAhjQqofh21LofKTvmt5xrM8BfoGzEKKCq9Ywkp", "action_id_social": "AseAS5w81ZUX8pXwTRcT2G4VsKUbX2FeQhy7BZVm7t1X-0-widget", "block_id": 116874778, "block_timestamp": "2024-04-15T04:49:02.937Z", "signer_id": "adnansiddiqui.near", "widget_name": "premium-users", "source_code": "// get account data for premium users\nconst data = Social.get(\n  \"premium.social.near/badge/premium/accounts/*\",\n  \"final\"\n);\n\nif (!data) return \"Loading\";\n\nconst now = Date.now(); // get time\nconst premiumUsers = Object.entries(data)\n  .filter((item) => item[1] >= now) // filter premnium users\n  .sort((a, b) => {\n    // short the array based on the descending order\n    if (a[1] < b[1]) return 1;\n    if (a[1] > b[1]) return -1;\n    return 0;\n  });\n\n// converts a given timestamp into a readable date string.\nconst getDate = (timestamp) => {\n  const dateObj = new Date(timestamp);\n\n  const day = dateObj.getDate();\n  const month = dateObj.toLocaleString(\"default\", { month: \"long\" });\n  const year = dateObj.getFullYear();\n\n  const nthNumber = (number) => {\n    if (number > 3 && number < 21) return \"th\";\n    switch (number % 10) {\n      case 1:\n        return \"st\";\n      case 2:\n        return \"nd\";\n      case 3:\n        return \"rd\";\n      default:\n        return \"th\";\n    }\n  };\n\n  return `${dateObj.getHours()}:${dateObj\n    .getMinutes()\n    .toString()\n    .padStart(2, \"0\")}, ${month} ${day}${nthNumber(day)}, ${year} `;\n};\n\n// render jsx\nreturn (\n  <div>\n    <h1>\n      Premium Users\n      <a href=\"/zavodil.near/widget/subscribe\" target=\"_blank\">\n        <span className=\"badge bg-secondary fs-6 align-middle\">\n          Buy premium\n        </span>\n      </a>\n    </h1>\n    <table class=\"table table-sm\">\n      <thead>\n        <tr>\n          <th scope=\"col\">#</th>\n          <th scope=\"col\">User</th>\n          <th scope=\"col\">Premium until</th>\n        </tr>\n      </thead>\n      <tbody>\n        {premiumUsers.map((item, i) => (\n          <tr>\n            <th scope=\"row\">{i + 1}</th>\n            <td>\n              <Widget\n                src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                props={{ accountId: item[0], tooltip: true }}\n              />\n            </td>\n            <td>{getDate(Number(item[1]))}</td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n    <div class=\"alert alert-primary\" role=\"alert\">\n      Use{\" \"}\n      <a href=\"https://near.social/zavodil.near/widget/premium-users\">\n        https://near.social\n      </a>{\" \"}\n      to enable premium subscriptions\n    </div>\n  </div>\n);\n", "metadata": {"description": "**Showing data of premium users from NEAR Social**\n\n```\nconst data = Social.get(\"premium.social.near/badge/premium/accounts/*\",\"final\");\nif (!data) return \"Loading\";\n```\n\n - `Social.get()` is a method that retrieves data from the supplied path. In this code, it gets account data for premium users from the \"premium.social.near\" service.\n\n\n```\nconst now = Date.now();\nconst premiumUsers = Object.entries(data)\n  .filter((item) => item[1] >= now)\n  .sort((a, b) => {\n    if (a[1] < b[1]) return 1;\n    if (a[1] > b[1]) return -1;\n    return 0;\n  });\n```\n\n - `Date.now()` provides the current timestamp in milliseconds since the Unix Epoch.\n - `Object.entries(data)` converts the \"`data`\" object into an array of its properties' arrays. Each property (user data) is represented by a [key, value] pair where key corresponds to 'User' and value is 'Premium until'.\n - Using `filter()`, it removes users who are not premium based on comparing their values with the `now` timestamp.\n - The `sort()` function sorts the `premiumUsers` array based on the descending order of the expiry timestamp.\n\n```\nconst getDate = (timestamp) => { /* Code here */ };\n```\n\n - `getDate` is a function that converts a given timestamp into a readable date string.\n\n```\nreturn ( /* JSX Code here */ );\n```\n\n - The `return` statement is outputting JSX\n\n(This component is forked from \"https://app.jutsu.ai/profile/zavodil.near\")", "image": {"ipfs_cid": "bafkreihfjwfijsedf4r75iwn77yua5ey3ufv6swgcjupqeigh2fw4wqm4a"}, "linktree": {"website": "near.social/zavodil.near/widget/premium-users"}, "name": "Premium Users", "platform": "jutsu.ai", "tags": {"app": ""}}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/adnansiddiqui.near/widget/premium-users", "fact_widget_deployments_id": "faa3bc1e852bb6de398f374604ae46d5", "inserted_timestamp": "2024-04-15T06:02:05.788Z", "modified_timestamp": "2024-04-15T06:02:05.788Z", "__row_index": 1}
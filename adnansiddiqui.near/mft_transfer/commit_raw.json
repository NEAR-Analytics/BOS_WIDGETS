{"tx_hash": "9AJm8CtYcVnADpiDe4NFTmLKo6grmcYBV8yCE6M9ry9S", "action_id_social": "BgErcKQJSmntqa9ZbQZHcFh52Qa1AuT8r8xh3L5cCsu6-0-widget", "block_id": 116050083, "block_timestamp": "2024-04-03T13:19:43.907Z", "signer_id": "adnansiddiqui.near", "widget_name": "mft_transfer", "source_code": "const accountId = context.accountId; //account ID from a context object\nconst contract = \"v2.ref-finance.near\"; // name of a smart contract\n\n// Initianlizing State\nState.init({\n  receiverId: \"\",\n  amount: \"\",\n  tokenId: \"\",\n  mft_balance: \"\",\n});\n\n// This is triggered when the user changes the `tokenId` field\nconst onTokenIdChange = ({ target: { value } }) => {\n  State.update({ tokenId: value });\n\n  if (value) {\n    Near.asyncView(\n      contract,\n      \"mft_balance_of\",\n      { account_id: accountId, token_id: `:${value}` },\n      \"final\",\n      false\n    ).then((balance) => State.update({ mft_balance: balance }));\n  } else {\n    State.update({ mft_balance: \"\" });\n  }\n};\n\n// This is triggered when the `amount` field is edited by the user\nconst onAmountChange = ({ target: { value } }) => {\n  State.update({ amount: value === \"0\" ? state.mft_balance : value });\n};\n\n//  This is triggered when the `receiverId` field is edited\nconst onInputChange = ({ target: { value } }) => {\n  State.update({ receiverId: value });\n};\n\n// This is invoked when the `Register` button is clicked.\nconst onRegBtnClick = () => {\n  if (state.tokenId) {\n    Near.call([\n      {\n        contractName: contract,\n        methodName: \"mft_register\",\n        args: {\n          account_id: state.receiverId,\n          token_id: `:${state.tokenId}`,\n        },\n        deposit: 30000000000000000000000,\n      },\n    ]);\n  } else {\n    alert(\"Please enter a token ID.\");\n  }\n};\n\n// This action happens when the `Send Tokens` button is clicked\nconst onSendBtnClick = () => {\n  const amount = state.amount || state.mft_balance;\n\n  Near.call([\n    {\n      contractName: contract,\n      methodName: \"mft_transfer\",\n      args: {\n        amount: amount,\n        receiver_id: state.receiverId,\n        token_id: `:${state.tokenId}`,\n      },\n      deposit: 1,\n    },\n  ]);\n};\n\nconst sendingForm = (\n  <>\n    <div class=\"border border-black p-3\">\n      <label>receiver_id</label>\n      <input placeholder=\"acvzii.tg\" onChange={onInputChange} />\n      <button class=\"btn btn-primary mt-2\" onClick={onRegBtnClick}>\n        Register\n      </button>\n      <button class=\"btn btn-primary mt-2\" onClick={onSendBtnClick}>\n        Send\n      </button>\n    </div>\n  </>\n);\n\n// If user is not logged in\nconst notLoggedInWarning = <p class=\"text-center py-2\"> Please login </p>;\n\n// Render\nreturn (\n  <>\n    {\n      <div class=\"container py-5\">\n        <div class=\"row justify-content-center\">\n          <div class=\"col-md-6\">\n            <h1 class=\"text-center mb-4\">Welcome, {accountId}!</h1>\n            <div class=\"card shadow\">\n              <div class=\"card-body\">\n                <p class=\"card-text\">\n                  Here you can check your LP balance and send tokens to other\n                  accounts.\n                </p>\n                <div class=\"d-flex align-items-center mb-3 balance-info\">\n                  <i class=\"fas fa-wallet fa-2x mr-3\"></i>\n                  <div>\n                    <h2 class=\"h5 mb-0\">LP Balance:</h2>\n                    <span\n                      class=\"text-muted\"\n                      data-toggle=\"tooltip\"\n                      title=\"This is the amount of Frax-USDC LP tokens you currently hold.\"\n                    >\n                      {state.mft_balance || \"0\"}\n                    </span>\n                  </div>\n                </div>\n                {context.accountId ? (\n                  <div class=\"border border-secondary rounded p-3\">\n                    <div class=\"form-group\">\n                      <label for=\"tokenId\">Token ID</label>\n                      <input\n                        id=\"tokenId\"\n                        class=\"form-control form-control-lg\"\n                        placeholder=\"Enter the token ID\"\n                        onChange={onTokenIdChange}\n                      />\n                    </div>\n                    <div class=\"form-group\">\n                      <label for=\"amount\">Amount</label>\n                      <input\n                        id=\"amount\"\n                        class=\"form-control form-control-lg\"\n                        placeholder=\"Enter the amount of tokens to send (0 for max)\"\n                        onChange={onAmountChange}\n                      />\n                    </div>\n                    <div class=\"form-group mb-4\">\n                      <label for=\"receiverId\">Receiver ID</label>\n                      <div class=\"input-group\">\n                        <input\n                          id=\"receiverId\"\n                          class=\"form-control form-control-lg\"\n                          placeholder=\"Enter the account ID of the recipient\"\n                          onChange={onInputChange}\n                        />\n                        <div class=\"input-group-append\">\n                          {state.tokenId && (\n                            <button\n                              class=\"btn btn-outline-secondary btn-lg\"\n                              onClick={onRegBtnClick}\n                            >\n                              <i class=\"fas fa-user-plus\"></i> Register\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                      <small class=\"form-text text-muted\">\n                        If the recipient hasn't registered for the LP token,\n                        they need to do so before you can send tokens to them.\n                      </small>\n                    </div>\n                    <button\n                      class=\"btn btn-primary btn-lg btn-block\"\n                      onClick={onSendBtnClick}\n                    >\n                      <i class=\"fas fa-paper-plane\"></i> Send Tokens\n                    </button>\n                  </div>\n                ) : (\n                  <div\n                    class=\"alert alert-warning text-center mb-0\"\n                    role=\"alert\"\n                  >\n                    Please log in to view your balance and send tokens.\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    }\n  </>\n);\n", "metadata": {"image": {}}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/adnansiddiqui.near/widget/mft_transfer", "fact_widget_deployments_id": "c27c1d85a0e176c137b997cb52f12567", "inserted_timestamp": "2024-04-03T14:38:26.149Z", "modified_timestamp": "2024-04-03T15:41:01.808Z", "__row_index": 7}
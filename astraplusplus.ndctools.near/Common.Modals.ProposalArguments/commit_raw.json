{"tx_hash": "5Xw5rfRFFi3zT5AAyntQ2Ymfyo148sETu85D7gEi3tq3", "action_id_social": "BKEmP5DZiYJrp32u7d7QuJ4sdkhhzCUCA92B8NWg8J1L-0-widget", "block_id": 104124928, "block_timestamp": "2023-10-24T19:43:53.988Z", "signer_id": "astraplusplus.ndctools.near", "widget_name": "Common.Modals.ProposalArguments", "source_code": "const daoId = props.daoId;\nconst proposal = props.proposal;\nconst kind = props.kind ?? proposal.kind;\nconst showCard = props.showCard ?? false;\n\nif (!kind) return \"\";\n\nconst proposal_type = typeof kind === \"string\" ? kind : Object.keys(kind)?.[0];\n\nconst Wrapper = styled.div`\n    h5 {\n        color: gray;\n        font-size: 14px;\n        margin-bottom: 0.5em;\n    }\n\n    .ndc-card h5 {\n        font-size: 1.1em;\n        color: #555;\n        margin-bottom: 0.4em;\n    }\n`;\n\nconst MarkdownContainer = styled.div`\n    position: relative;\n    width: 100%;\n    padding: 24px;\n    background-color: #f8f9fa;\n    color: #1b1b18;\n    border-radius: 14px;\n    max-height: 700px;\n    overflow-y: auto;\n    color: #333;\n    line-height: 1.6;\n    box-shadow: rgba(0, 0, 0, 0.05) 0px 0px 0px 1px;\n\n    h1 {\n        font-size: 2em;\n        color: #111;\n        border-bottom: 1px solid #ccc;\n        padding-bottom: 0.3em;\n        margin-bottom: 1em;\n    }\n\n    h2 {\n        font-size: 1.5em;\n        color: #222;\n        margin-bottom: 0.75em;\n    }\n\n    h3 {\n        font-size: 1.3em;\n        color: #333;\n        margin-bottom: 0.6em;\n    }\n\n    h4 {\n        font-size: 1.2em;\n        color: #444;\n        margin-bottom: 0.5em;\n    }\n\n    h5 {\n        font-size: 1.1em;\n        color: #555;\n        margin-bottom: 0.4em;\n    }\n\n    p {\n        font-size: 1em;\n        margin-bottom: 1em;\n    }\n\n    a {\n        color: #0645ad;\n        text-decoration: none;\n    }\n\n    a:hover {\n        text-decoration: underline;\n    }\n`;\n\nconst content = <></>;\n\nif (proposal_type === \"Vote\") {\n    content = \"\";\n}\n\nif (proposal_type === \"DismissAndBan\") {\n    content = (\n        <>\n            <div>\n                <h5>Member</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind.DismissAndBan.member,\n                        tooltip: true\n                    }}\n                />\n            </div>\n            <div>\n                <h5>House</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind.DismissAndBan.house,\n                        tooltip: true\n                    }}\n                />\n            </div>\n        </>\n    );\n}\n\nif (proposal_type === \"ApproveBudget\" || proposal_type === \"Veto\") {\n    content = (\n        <>\n            <div>\n                <h5>Proposal ID</h5>\n                <p>{kind.ApproveBudget.prop_id}</p>\n            </div>\n            <div>\n                <h5>House</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind.ApproveBudget.dao,\n                        tooltip: true\n                    }}\n                />\n            </div>\n        </>\n    );\n}\n\nif (proposal_type === \"Dismiss\") {\n    content = (\n        <>\n            <div>\n                <h5>Member</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind.Dismiss.member,\n                        tooltip: true\n                    }}\n                />\n            </div>\n            <div>\n                <h5>House</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind.Dismiss.dao,\n                        tooltip: true\n                    }}\n                />\n            </div>\n        </>\n    );\n}\n\nif (proposal_type === \"Dissolve\") {\n    content = (\n        <>\n            <div>\n                <h5>House</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind.Dissolve.dao,\n                        tooltip: true\n                    }}\n                />\n            </div>\n        </>\n    );\n}\n\nif (proposal_type === \"Transfer\")\n    content = (\n        <>\n            <div>\n                <h5>Amount</h5>\n                <Widget\n                    src=\"sking.near/widget/Common.TokenAmount\"\n                    props={{\n                        amountWithoutDecimals: kind.Transfer.amount,\n                        address: kind.Transfer.token_id\n                    }}\n                />\n            </div>\n            <div>\n                <h5>Receiver</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind.Transfer.receiver_id,\n                        tooltip: true\n                    }}\n                />\n            </div>\n        </>\n    );\n\nif (\n    proposal_type === \"RecurrentFundingRequest\" ||\n    proposal_type === \"FundingRequest\"\n)\n    content = (\n        <>\n            <div>\n                <h5>Amount</h5>\n                <Widget\n                    src=\"sking.near/widget/Common.TokenAmount\"\n                    props={{\n                        amountWithoutDecimals: kind[proposal_type],\n                        address: kind.Transfer.token_id\n                    }}\n                />\n            </div>\n        </>\n    );\n\nif (proposal_type === \"FunctionCall\") {\n    content = (\n        <>\n            {kind.FunctionCall.actions.reduce(\n                (acc, { method_name, args, deposit }) => {\n                    return acc.concat(\n                        <div\n                            className=\"d-flex flex-wrap align-items-start w-100\"\n                            style={{\n                                columnGap: \"48px\",\n                                rowGap: \"16px\"\n                            }}\n                        >\n                            <div>\n                                <h5>Smart Contract Address</h5>\n                                <p>{kind.FunctionCall.receiver_id}</p>\n                            </div>\n                            <div>\n                                <h5>Method Name</h5>\n                                <p>{method_name}</p>\n                            </div>\n                            <div>\n                                <h5>Deposit</h5>\n                                <Widget\n                                    src=\"sking.near/widget/Common.TokenAmount\"\n                                    props={{\n                                        amountWithoutDecimals: deposit,\n                                        address: \"\"\n                                    }}\n                                />\n                            </div>\n                            <div className=\"w-100\">\n                                <h5>Arguments</h5>\n                                <Markdown\n                                    // Decode the args (Base64) to String then Parse the Json then format it and display it as markdown code\n                                    text={\n                                        \"```json\\n\" +\n                                        JSON.stringify(\n                                            JSON.parse(\n                                                Buffer.from(\n                                                    args,\n                                                    \"base64\"\n                                                ).toString(\"utf8\")\n                                            ),\n                                            null,\n                                            2\n                                        ) +\n                                        \"\\n```\"\n                                    }\n                                />\n                            </div>\n                        </div>\n                    );\n                },\n                []\n            )}\n        </>\n    );\n}\n\nif (\n    proposal_type === \"AddMemberToRole\" ||\n    proposal_type === \"RemoveMemberFromRole\"\n)\n    content = (\n        <>\n            <div>\n                <h5>Member</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind[proposal_type].member_id,\n                        tooltip: true\n                    }}\n                />\n            </div>\n            <div>\n                <h5>Role</h5>\n                <p>{kind[proposal_type].role}</p>\n            </div>\n        </>\n    );\n\nif (proposal_type === \"AddBounty\")\n    content = (\n        <>\n            <div>\n                <h5>Amount</h5>\n                <Widget\n                    src=\"sking.near/widget/Common.TokenAmount\"\n                    props={{\n                        amountWithoutDecimals: kind.AddBounty.bounty.amount,\n                        address: kind.AddBounty.bounty.token\n                    }}\n                />\n            </div>\n            <div>\n                <h5>Times</h5>\n                <p>{kind.AddBounty.bounty.times}</p>\n            </div>\n            <div>\n                <h5>Deadline</h5>\n                <p>\n                    {new Date(\n                        kind.AddBounty.bounty.max_deadline\n                    ).toLocaleString()}\n                </p>\n            </div>\n            <div className=\"w-100\">\n                <h5>Bounty Description</h5>\n                <MarkdownContainer>\n                    <Markdown text={kind.AddBounty.bounty.description} />\n                </MarkdownContainer>\n            </div>\n        </>\n    );\n\nif (proposal_type === \"BountyDone\")\n    content = (\n        <>\n            <div>\n                <h5>Receiver</h5>\n                <Widget\n                    src=\"mob.near/widget/Profile.ShortInlineBlock\"\n                    props={{\n                        accountId: kind.BountyDone.receiver_id,\n                        tooltip: true\n                    }}\n                />\n            </div>\n            <div>\n                <h5>Bounty ID</h5>\n                <p>{kind.BountyDone.bounty_id}</p>\n            </div>\n        </>\n    );\n\nfunction deepSortObject(obj) {\n    if (typeof obj !== \"object\" || obj === null) {\n        // Return non-object values as is\n        return obj;\n    }\n\n    if (Array.isArray(obj)) {\n        // If the input is an array, recursively sort each element\n        return obj.map(deepSortObject).sort();\n    }\n\n    const sortedObject = {};\n    const sortedKeys = Object.keys(obj).sort((keyA, keyB) => {\n        // Compare keys in a case-insensitive manner\n        return keyA.toLowerCase().localeCompare(keyB.toLowerCase());\n    });\n\n    for (const key of sortedKeys) {\n        sortedObject[key] = deepSortObject(obj[key]);\n    }\n\n    return sortedObject;\n}\n\n// TODO: ChangePolicy component need some UI improvements to be more readable\nif (proposal_type === \"ChangePolicy\") {\n    const old_policy = Near.view(daoId, \"get_policy\");\n    if (old_policy === null) return \"\";\n    content = (\n        <>\n            <div className=\"w-100\">\n                <h5>Policy Changes</h5>\n                <div\n                    className=\"w-100\"\n                    style={{\n                        maxHeight: \"400px\",\n                        overflow: \"auto\"\n                    }}\n                >\n                    <Widget\n                        src=\"bozon.near/widget/CodeDiff\"\n                        props={{\n                            prevCode: JSON.stringify(\n                                deepSortObject(old_policy),\n                                null,\n                                2\n                            ),\n                            currentCode: JSON.stringify(\n                                deepSortObject(kind.ChangePolicy.policy),\n                                null,\n                                2\n                            )\n                        }}\n                    />\n                </div>\n            </div>\n        </>\n    );\n}\n\nreturn (\n    <Wrapper className={showCard && \"ndc-card p-4\"}>\n        <div\n            className={\n                \"d-flex flex-wrap \" +\n                (showCard ? \" align-items-start \" : \"gap-5\")\n            }\n            style={\n                showCard\n                    ? {\n                          rowGap: \"16px\",\n                          columnGap: \"48px\"\n                      }\n                    : {}\n            }\n        >\n            {content}\n        </div>\n    </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/astraplusplus.ndctools.near/widget/Common.Modals.ProposalArguments", "fact_widget_deployments_id": "48a8744fb7853a055d21804c634098a9", "inserted_timestamp": "2023-10-24T21:38:39.299Z", "modified_timestamp": "2023-10-24T21:38:39.299Z", "__row_index": 0}
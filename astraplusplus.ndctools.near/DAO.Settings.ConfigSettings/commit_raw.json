{"tx_hash": "BGiWYxnTVbhD3MhRPtGoASG6mgSwgzQbzZ1F4fGiYk2v", "action_id_social": "F5WyTYxyer9t6jRLZ8g5qQYypzuDCUTaFmQ5JaMXwYu7-0-widget", "block_id": 111601786, "block_timestamp": "2024-01-29T10:55:56.284Z", "signer_id": "astraplusplus.ndctools.near", "widget_name": "DAO.Settings.ConfigSettings", "source_code": "const { formState, daoId, hasPermission } = props;\nconst [configState, setConfigState] = useState({\n  ...formState,\n  coverImage: formState.flagCover ?? formState.coverImage,\n  profileImage: formState.flagLogo ?? formState.profileImage,\n  legalStatus: formState.legal.legalStatus,\n  legalDocument: formState.legal.legalLink\n});\nconst [selectedTab, setSelectedTab] = useState(\"Info\");\n\nconst handleProposal = () => {\n  const deposit = formState.policy.proposal_bond;\n  const gas = 200000000000000;\n  const metadata = {\n    soulBoundTokenIssuer:\n      typeof configState.soulBoundTokenIssuer === \"string\"\n        ? configState.soulBoundTokenIssuer\n        : undefined,\n    links: Array.isArray(configState.links) ? configState.links : [],\n    flagCover:\n      configState.coverImage === \"string\" ? configState.coverImage : \"\",\n    flagLogo:\n      typeof configState.profileImage === \"string\"\n        ? configState.profileImage\n        : \"\",\n    displayName: typeof configState.name === \"string\" ? configState.name : \"\",\n    legal: {\n      legalStatus:\n        typeof configState.legalStatus === \"string\"\n          ? configState.legalStatus\n          : \"\",\n      legalLink:\n        typeof configState.legalDocument === \"string\"\n          ? configState.legalDocument\n          : \"\"\n    }\n  };\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"Update config\",\n          kind: {\n            ChangeConfig: {\n              config: {\n                name: configState.name,\n                purpose: configState.purpose,\n                metadata: Buffer.from(JSON.stringify(metadata)).toString(\n                  \"base64\"\n                )\n              }\n            }\n          }\n        }\n      },\n      gas: gas,\n      deposit: deposit\n    }\n  ]);\n};\n\nconst Footer = () => {\n  return (\n    <div className=\"d-flex justify-content-end mt-4\">\n      <Widget\n        src=\"nearui.near/widget/Input.Button\"\n        props={{\n          children: (\n            <>\n              <i class=\"bi bi-check-lg\"></i> Propose changes\n            </>\n          ),\n          variant: \"info \" + (!hasPermission && \"disabled\"),\n          size: \"lg\",\n          onClick: () => handleProposal(),\n          buttonProps: {\n            type: \"submit\"\n          }\n        }}\n      />\n    </div>\n  );\n};\n\nconst tabs = {\n  Info: {\n    name: \"Info and KYC\",\n    component: (\n      <Widget\n        src={`astraplusplus.ndctools.near/widget/CreateDAO.Step1`}\n        props={{\n          formState: configState,\n          isConfigScreen: true,\n          updateParentState: (data) => setConfigState(data),\n          renderFooter: () => <></>\n        }}\n      />\n    )\n  },\n  Legal: {\n    name: \"Legal Links\",\n    component: (\n      <Widget\n        src={`astraplusplus.ndctools.near/widget/CreateDAO.Step2`}\n        props={{\n          formState: configState,\n          isConfigScreen: true,\n          updateParentState: (data) => setConfigState(data),\n          renderFooter: () => <></>\n        }}\n      />\n    )\n  },\n  Visual: {\n    name: \"Visual Changes\",\n    component: (\n      <Widget\n        src={`astraplusplus.ndctools.near/widget/CreateDAO.Step6`}\n        props={{\n          formState: configState,\n          isConfigScreen: true,\n          updateParentState: (data) => setConfigState(data),\n          renderFooter: () => <></>\n        }}\n      />\n    )\n  }\n};\n\nconst tabContent = tabs[selectedTab].component;\nreturn (\n  <div style={{ marginTop: 30 }}>\n    <Widget\n      src={`astraplusplus.ndctools.near/widget/DAO.Layout.Tabs`}\n      props={{\n        tabs: tabs,\n        tab: selectedTab,\n        update: (state) => setSelectedTab(state.tab),\n        allowHref: false\n      }}\n    />\n    <div style={{ marginTop: \"-25px\" }}>{tabContent}</div>\n    <Footer />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/astraplusplus.ndctools.near/widget/DAO.Settings.ConfigSettings", "fact_widget_deployments_id": "46d90b56993492aea08370bfaf1a28d0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
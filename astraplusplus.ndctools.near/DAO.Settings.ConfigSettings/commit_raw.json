{"tx_hash": "GKHPCeiGEMoLjMByFTauA5Sjw1Xw79NPtpWXHjkjXZER", "action_id_social": "5JYtXJDTMDxaF6D4rxS8JB3Bsdn6MNoKvHnm47Hm3Qsz-0-widget", "block_id": 114701197, "block_timestamp": "2024-03-14T15:49:14.355Z", "signer_id": "astraplusplus.ndctools.near", "widget_name": "DAO.Settings.ConfigSettings", "source_code": "const { formState, daoId, hasPermission } = props;\nconst [configState, setConfigState] = useState({\n  ...formState,\n  coverImage: formState.flagCover ?? formState.coverImage,\n  profileImage: formState.flagLogo ?? formState.profileImage,\n  legalStatus: formState.legal.legalStatus,\n  legalDocument: formState.legal.legalLink\n});\nconst [selectedTab, setSelectedTab] = useState(\"Info\");\n\nconst handleProposal = () => {\n  const deposit = formState.policy.proposal_bond;\n  const gas = 200000000000000;\n  const metadata = {\n    soulBoundTokenIssuer:\n      typeof configState.soulBoundTokenIssuer === \"string\"\n        ? configState.soulBoundTokenIssuer\n        : undefined,\n    links: Array.isArray(configState.links) ? configState.links : [],\n    flagCover:\n      typeof configState.coverImage === \"string\" ? configState.coverImage : \"\",\n    flagLogo:\n      typeof configState.profileImage === \"string\"\n        ? configState.profileImage\n        : \"\",\n    displayName: typeof configState.name === \"string\" ? configState.name : \"\",\n    legal: {\n      legalStatus:\n        typeof configState.legalStatus === \"string\"\n          ? configState.legalStatus\n          : \"\",\n      legalLink:\n        typeof configState.legalDocument === \"string\"\n          ? configState.legalDocument\n          : \"\"\n    }\n  };\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"Update config\",\n          kind: {\n            ChangeConfig: {\n              config: {\n                name: configState.name,\n                purpose: configState.purpose,\n                metadata: Buffer.from(JSON.stringify(metadata)).toString(\n                  \"base64\"\n                )\n              }\n            }\n          }\n        }\n      },\n      gas: gas,\n      deposit: deposit\n    }\n  ]);\n};\n\nconst Footer = () => {\n  return (\n    <div className=\"d-flex justify-content-end mt-4\">\n      <Widget\n        src=\"nearui.near/widget/Input.Button\"\n        props={{\n          children: (\n            <>\n              <i class=\"bi bi-check-lg\"></i> Propose changes\n            </>\n          ),\n          variant: \"info \" + (!hasPermission && \"disabled\"),\n          size: \"lg\",\n          onClick: () => handleProposal(),\n          buttonProps: {\n            type: \"submit\"\n          }\n        }}\n      />\n    </div>\n  );\n};\n\nconst tabs = {\n  Info: {\n    name: \"Info and KYC\",\n    component: (\n      <Widget\n        src={`astraplusplus.ndctools.near/widget/CreateDAO.Step1`}\n        props={{\n          formState: configState,\n          isConfigScreen: true,\n          updateParentState: (data) => setConfigState(data),\n          renderFooter: () => <></>\n        }}\n      />\n    )\n  },\n  Legal: {\n    name: \"Legal Links\",\n    component: (\n      <Widget\n        src={`astraplusplus.ndctools.near/widget/CreateDAO.Step2`}\n        props={{\n          formState: configState,\n          isConfigScreen: true,\n          updateParentState: (data) => setConfigState(data),\n          renderFooter: () => <></>\n        }}\n      />\n    )\n  },\n  Visual: {\n    name: \"Visual Changes\",\n    component: (\n      <Widget\n        src={`astraplusplus.ndctools.near/widget/CreateDAO.Step7`}\n        props={{\n          formState: configState,\n          isConfigScreen: true,\n          updateParentState: (data) => setConfigState(data),\n          renderFooter: () => <></>\n        }}\n      />\n    )\n  }\n};\n\nconst Wrapper = styled.div`\n  .custom-tag {\n    border-top-right-radius: 9999px;\n    border-bottom-right-radius: 9999px;\n    border-top-left-radius: 9999px;\n    border-bottom-left-radius: 9999px;\n    padding-inline: 1rem;\n    padding-block: 0.5rem;\n    display: flex;\n    gap: 0.5rem;\n    border-width: 1px;\n    border-style: solid;\n    font-size: 14px;\n    cursor: pointer;\n    min-width: fit-content;\n  }\n\n  .selected {\n    background-color: black;\n    color: white;\n  }\n`;\n\nconst tabContent = tabs[selectedTab].component;\nreturn (\n  <Wrapper style={{ marginTop: 30 }}>\n    <div\n      className=\"d-flex gap-3 align-items-center h-100\"\n      style={{ overflow: \"scroll\" }}\n    >\n      {Object.keys(tabs).map((i) => (\n        <div\n          onClick={() => setSelectedTab(i)}\n          className={\"custom-tag \" + (i === selectedTab ? \"selected\" : \"\")}\n        >\n          {i}\n        </div>\n      ))}\n    </div>\n    <div>{tabContent}</div>\n    <Footer />\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/astraplusplus.ndctools.near/widget/DAO.Settings.ConfigSettings", "fact_widget_deployments_id": "b11411ecd47c8667b1bfe717a6bcf4db", "inserted_timestamp": "2024-03-14T17:26:33.773Z", "modified_timestamp": "2024-03-14T17:26:33.773Z", "__row_index": 4}
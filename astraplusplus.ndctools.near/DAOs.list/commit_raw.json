{"tx_hash": "8Br2AqsPimzL5AKf9XMV6w9hDzaqjkNTvDijXxTAoxss", "action_id_social": "FUmDqpRcLqhBn9zBEtC1bENBY1JE6ajM4E9J84vbZM1t-0-widget", "block_id": 104716409, "block_timestamp": "2023-11-01T21:43:56.733Z", "signer_id": "astraplusplus.ndctools.near", "widget_name": "DAOs.list", "source_code": "const daos = props.daos;\nconst currentPage = props.page ?? 1;\nconst resPerPage = props.resPerPage ?? 6;\nconst { router } = props;\n\nconst createDAOLink = \"#/astraplusplus.ndctools.near/widget/home?tab=create-dao\";\n\nState.init({\n    currentPage: currentPage,\n    search: null,\n    isTyping: false\n});\n\nconst renderSubheader = () => (\n    <div className=\"d-flex align-items-center gap-2 mt-4\">\n        <Widget\n            key=\"search\"\n            src=\"nearui.near/widget/Input.ExperimentalText\"\n            props={{\n                placeholder: \"Search by name\",\n                type: \"search\",\n                size: \"md\",\n                icon: (\n                    <i\n                        className=\"bi bi-search\"\n                        style={{\n                            color: \"#4498E0\"\n                        }}\n                    />\n                ),\n                onChange: (v) => {\n                    State.update({\n                        search: v,\n                        isTyping: true\n                    });\n                    setTimeout(() => {\n                        State.update({\n                            isTyping: false\n                        });\n                    }, 1500);\n                },\n                value: undefined,\n                inputProps: {\n                    autoFocus: true\n                },\n                useTimeout: 600\n            }}\n        />\n        <Widget\n            src=\"astraplusplus.ndctools.near/widget/Layout.Modal\"\n            props={{\n                open: state.filtersOpen,\n                onOpenChange: (open) => {\n                    State.update({\n                        ...state,\n                        filtersOpen: open\n                    });\n                },\n                toggle: (\n                    <Widget\n                        src=\"nearui.near/widget/Input.Button\"\n                        props={{\n                            children: (\n                                <>\n                                    Filter\n                                    <i className=\"bi bi-funnel\"></i>\n                                </>\n                            ),\n                            variant: \"info outline\",\n                            size: \"md\"\n                        }}\n                    />\n                ),\n                content: <div className=\"ndc-card p-2\">WIP</div>\n            }}\n        />\n    </div>\n);\n\nconst renderEmpty = () => (\n    <div\n        className=\"d-flex flex-column justify-content-center align-content-center text-center gap-3 m-auto\"\n        style={{\n            height: \"max(50vh, 400px)\",\n            maxWidth: \"460px\"\n        }}\n    >\n        <i\n            className=\"bi bi-exclamation-circle\"\n            style={{ fontSize: \"4rem\", color: \"#4498E0\" }}\n        />\n        <p className=\"h6\">No DAO is found. Would you like to create one now?</p>\n        <Widget\n            src=\"nearui.near/widget/Input.Button\"\n            props={{\n                children: \"Create a new DAO\",\n                variant: \"info w-100\",\n                size: \"lg\",\n                href: createDAOLink\n            }}\n        />\n        <Widget\n            src=\"nearui.near/widget/Input.Button\"\n            props={{\n                children: \"Go to home\",\n                variant: \"info outline w-100\",\n                size: \"lg\",\n                href: \"#/astraplusplus.ndctools.near/widget/home\"\n            }}\n        />\n    </div>\n);\n\nconst renderLoading = () => (\n    <div>\n        <Widget src=\"nearui.near/widget/Feedback.Spinner\" />\n    </div>\n);\n\nlet filteredDAOs = [];\nlet paginatedDAOs = [];\nif (daos && !state.isTyping) {\n    filteredDAOs = daos.filter((d) => {\n        if (state.search == null) {\n            return true;\n        }\n        return d.contract_id.toLowerCase().includes(state.search.toLowerCase());\n    });\n    paginatedDAOs = filteredDAOs.slice(\n        (state.currentPage - 1) * resPerPage,\n        state.currentPage * resPerPage\n    );\n}\n\nconst renderDAOsRows = () => {\n    return (\n        <div className=\"row g-3 flex-wrap\">\n            {paginatedDAOs.map((dao) => (\n                <div\n                    key={dao.contract_id}\n                    className=\"flex-grow-1 col-12 col-md-6 col-lg-4 col-xl-3\"\n                    style={{\n                        minWidth: \"320px\"\n                    }}\n                >\n                    <Widget\n                        src=\"astraplusplus.ndctools.near/widget/DAOs.Card\"\n                        props={{\n                            daoId: dao.contract_id,\n                            router\n                        }}\n                    />\n                </div>\n            ))}\n            {paginatedDAOs.length < resPerPage &&\n                [...Array(resPerPage - paginatedDAOs.length)].map((_, i) => (\n                    <div\n                        key={`empty-${i}`}\n                        className=\"flex-grow-1 col-12 col-md-6 col-lg-4 col-xl-3\"\n                        style={{\n                            minWidth: \"320px\"\n                        }}\n                    ></div>\n                ))}\n        </div>\n    );\n};\nconst renderPagination = () => (\n    <div className=\"d-flex justify-content-center align-items-center gap-2\">\n        <Widget\n            src=\"nearui.near/widget/Navigation.Paginate\"\n            props={{\n                pageSize: resPerPage,\n                currentPage: state.currentPage,\n                totalPageCount: Math.ceil(filteredDAOs.length / resPerPage),\n                onPageChange: (page) => {\n                    State.update({\n                        currentPage: page\n                    });\n                },\n                revaluateOnRender: true\n            }}\n        />\n    </div>\n);\n\nreturn (\n    <>\n        {renderSubheader()}\n        {!state.isTyping &&\n            daos != null &&\n            (!daos || daos.length < 1 || filteredDAOs.length < 1) &&\n            renderEmpty()}\n        {(state.isTyping || daos == null) && renderLoading()}\n        {!state.isTyping && ((daos != null && daos) || daos.length > 0) && (\n            <div className=\"my-4\">{renderDAOsRows()}</div>\n        )}\n        {((daos != null && daos) ||\n            daos.length > resPerPage ||\n            filteredDAOs.length > resPerPage) &&\n            renderPagination()}\n    </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/astraplusplus.ndctools.near/widget/DAOs.list", "fact_widget_deployments_id": "aa0e1b979ec2555064cc0c09271fae9e", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 15}
{"tx_hash": "BGiWYxnTVbhD3MhRPtGoASG6mgSwgzQbzZ1F4fGiYk2v", "action_id_social": "F5WyTYxyer9t6jRLZ8g5qQYypzuDCUTaFmQ5JaMXwYu7-0-widget", "block_id": 111601786, "block_timestamp": "2024-01-29T10:55:56.284Z", "signer_id": "astraplusplus.ndctools.near", "widget_name": "DAO.Settings.PolicySettings", "source_code": "const { formState, hasPermission, daoId } = props;\n\nconst [policyState, setPolicyState] = useState(formState);\nconst [selectedTab, setSelectedTab] = useState(\"Groups\");\n\nconst handleProposal = () => {\n  const deposit = formState.policy.proposal_bond;\n  const gas = 200000000000000;\n\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"Update policy\",\n          kind: {\n            ChangePolicy: policyState\n          }\n        }\n      },\n      gas: gas,\n      deposit: deposit\n    }\n  ]);\n};\n\nconst Footer = () => {\n  return (\n    <div className=\"d-flex justify-content-end mt-4\">\n      <Widget\n        src=\"nearui.near/widget/Input.Button\"\n        props={{\n          children: (\n            <>\n              <i class=\"bi bi-check-lg\"></i> Propose changes\n            </>\n          ),\n          variant: \"info \" + (!hasPermission && \"disabled\"),\n          size: \"lg\",\n          onClick: () => handleProposal(),\n          buttonProps: {\n            type: \"submit\"\n          }\n        }}\n      />\n    </div>\n  );\n};\n\nconst tabs = {\n  Groups: {\n    name: \"Groups\",\n    component: (\n      <Widget\n        src={`astraplusplus.ndctools.near/widget/CreateDAO.Step4`}\n        props={{\n          formState: policyState,\n          updateParentState: (data) => setPolicyState(data),\n          isConfigScreen: true,\n          renderFooter: (data) => <></>\n        }}\n      />\n    )\n  },\n  Permissions: {\n    name: \"Proposal and Voting Permissions\",\n    component: (\n      <Widget\n        src={`astraplusplus.ndctools.near/widget/CreateDAO.Step5`}\n        props={{\n          formState: policyState,\n          updateParentState: (data) => setPolicyState(data),\n          renderFooter: (data) => <></>\n        }}\n      />\n    )\n  }\n};\n\nconst tabContent = tabs[selectedTab].component;\n\nreturn (\n  <div style={{ marginTop: 30 }}>\n    <Widget\n      src={`astraplusplus.ndctools.near/widget/DAO.Layout.Tabs`}\n      props={{\n        tabs: tabs,\n        tab: selectedTab,\n        update: (state) => setSelectedTab(state.tab),\n        allowHref: false\n      }}\n    />\n    <div style={{ marginTop: \"-25px\" }}>{tabContent}</div>\n    <Footer />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/astraplusplus.ndctools.near/widget/DAO.Settings.PolicySettings", "fact_widget_deployments_id": "358a8e8de1e4b128a3fd54f586ed4960", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 3}
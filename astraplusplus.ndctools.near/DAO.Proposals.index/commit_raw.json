{"tx_hash": "5Xw5rfRFFi3zT5AAyntQ2Ymfyo148sETu85D7gEi3tq3", "action_id_social": "BKEmP5DZiYJrp32u7d7QuJ4sdkhhzCUCA92B8NWg8J1L-0-widget", "block_id": 104124928, "block_timestamp": "2023-10-24T19:43:53.988Z", "signer_id": "astraplusplus.ndctools.near", "widget_name": "DAO.Proposals.index", "source_code": "const daoId = props.daoId;\nconst proposalId = props.proposalId;\nconst accountId = context.accountId ?? \"\";\n\nconst CoADaoId = props.dev\n    ? \"coa.gwg-testing.near\"\n    : \"congress-coa-v1.ndc-gwg.near\";\nconst VotingBodyDaoId = props.dev\n    ? \"voting-body-v1.gwg-testing.near\"\n    : \"\";\nconst TCDaoId = props.dev\n    ? \"tc.gwg-testing.near\"\n    : \"congress-tc-v1.ndc-gwg.near\";\nconst HoMDaoId = props.dev\n    ? \"hom.gwg-testing.near\"\n    : \"congress-hom-v1.ndc-gwg.near\";\n\nconst isCongressDaoID =\n    daoId === HoMDaoId || daoId === CoADaoId || daoId === TCDaoId;\n\nState.init({\n    isProposalModalOpen: false,\n    hideProposalBtn: false\n});\n\nif (proposalId) {\n    return (\n        <div>\n            <Widget\n                src=\"astraplusplus.ndctools.near/widget/DAO.Proposals.Card.index\"\n                props={props}\n            />\n        </div>\n    );\n}\n\nif (isCongressDaoID) {\n    const policy = Near.view(daoId, \"get_members\");\n    const isMember = policy?.members?.includes(accountId);\n    State.update({ hideProposalBtn: !isMember });\n}\n\nif (daoId === VotingBodyDaoId) {\n    const resp = useCache(\n        () =>\n            asyncFetch(\n                `https://api.pikespeak.ai/sbt/sbt-by-owner?holder=${accountId}&registry=registry.i-am-human.near`,\n                {\n                    method: \"GET\",\n                    headers: {\n                        \"Content-Type\": \"application/json\",\n                        \"x-api-key\": \"36f2b87a-7ee6-40d8-80b9-5e68e587a5b5\"\n                    }\n                }\n            ).then((res) => res.body),\n        daoId + \"-is-human-info\",\n        { subscribe: false }\n    );\n    State.update({\n        hideProposalBtn: !resp?.length > 0\n    });\n}\n\nreturn (\n    <>\n        <div style={{ width: \"98%\" }}>\n            <div className=\"d-flex justify-content-between flex-wrap mb-3 align-items-center gap-3 pb-3\">\n                <h2 className=\"my-auto\">Proposals</h2>\n                {!state.hideProposalBtn && (\n                    <Widget\n                        src=\"astraplusplus.ndctools.near/widget/Common.Layout.CardModal\"\n                        props={{\n                            title: \"Create Proposal\",\n                            onToggle: () =>\n                                State.update({\n                                    isProposalModalOpen:\n                                        !state.isProposalModalOpen\n                                }),\n                            isOpen: state.isProposalModalOpen,\n                            toggle: (\n                                <Widget\n                                    src=\"nearui.near/widget/Input.Button\"\n                                    props={{\n                                        children: (\n                                            <>\n                                                Create Proposal\n                                                <i className=\"bi bi-16 bi-plus-lg\"></i>\n                                            </>\n                                        ),\n                                        variant: \"info\"\n                                    }}\n                                />\n                            ),\n                            content: (\n                                <div\n                                    className=\"d-flex flex-column align-items-stretch\"\n                                    style={{\n                                        width: \"800px\",\n                                        maxWidth: \"100vw\"\n                                    }}\n                                >\n                                    <Widget\n                                        src={\n                                            \"astraplusplus.ndctools.near/widget/DAO.Proposal.Create\"\n                                        }\n                                        props={{\n                                            daoId: daoId,\n                                            dev: props.dev\n                                        }}\n                                    />\n                                </div>\n                            )\n                        }}\n                    />\n                )}\n            </div>\n\n            <Widget\n                src=\"astraplusplus.ndctools.near/widget/DAO.Proposals.ProposalsPikespeak\"\n                props={{ daoId: daoId, dev: props.dev }}\n            />\n        </div>\n    </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/astraplusplus.ndctools.near/widget/DAO.Proposals.index", "fact_widget_deployments_id": "2ee547443ae43683ed1e6943b5169f1f", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 18}
{"tx_hash": "D6ujGU68TyJtwamzabUiDRCiMv7NDK11yecYNTg5Stka", "action_id_social": "9XkQgQ4QznKHFrCu3BNepNtp9ikiZZx6S8rmGXFM5kme-0-widget", "block_id": 115912669, "block_timestamp": "2024-04-01T10:40:40.975Z", "signer_id": "astraplusplus.ndctools.near", "widget_name": "Common.Components.Post", "source_code": "const accountId = props.accountId;\nconst blockHeight =\n  props.blockHeight === \"now\" ? \"now\" : parseInt(props.blockHeight);\nconst subscribe = !!props.subscribe;\nconst notifyAccountId = accountId;\nconst postUrl = `https://near.org/s/p?a=${accountId}&b=${blockHeight}`;\nconst showFlagAccountFeature = props.showFlagAccountFeature;\n\nState.init({ hasBeenFlagged: false });\n\nconst edits = []; // Social.index('edit', { accountId, blockHeight }, { limit: 1, order: \"desc\", accountId })\n\nconst content =\n  props.content ??\n  JSON.parse(\n    edits.length\n      ? Social.get(`${accountId}/edit/main`, edits.blockHeight)\n      : Social.get(`${accountId}/post/main`, blockHeight)\n  );\n\nconst item = {\n  type: \"social\",\n  path: `${accountId}/post/main`,\n  blockHeight\n};\n\nconst Post = styled.div`\n  position: relative;\n\n  &::before {\n    content: \"\";\n    display: block;\n    position: absolute;\n    left: 19px;\n    top: 52px;\n    bottom: 12px;\n    width: 2px;\n    background: #eceef0;\n  }\n\n  [data-component=\"near/widget/AccountProfile\"] {\n    border-radius: 0px !important;\n  }\n`;\n\nconst Header = styled.div`\n  margin-bottom: 0;\n  display: inline-flex;\n\n  p[data-component=\"near/widget/AccountProfile\"] {\n    display: none !important;\n  }\n`;\n\nconst Body = styled.div`\n  padding-left: 52px;\n  padding-bottom: 1px;\n\n  a {\n    padding-inline: 5px;\n    padding-block: 2px;\n    border-radius: 8px;\n    border: 1px solid #e1e3fd;\n    background: #f5f6fe;\n    color: #626ad1 !important;\n    font-size: 12px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: 20px;\n  }\n\n  li a {\n    margin-right: 2px;\n  }\n\n  a[data-component=\"near/widget/AccountProfile\"] {\n    border: none;\n  }\n\n  ul {\n    line-height: 30px;\n  }\n`;\n\nconst Content = styled.div`\n  img {\n    display: block;\n    max-width: 100%;\n    max-height: 80vh;\n    margin: 0 0 12px;\n  }\n`;\n\nconst Text = styled.p`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 400;\n  color: #687076;\n  white-space: nowrap;\n`;\n\nconst Actions = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: -6px -6px 6px;\n`;\n\nconst Comments = styled.div`\n  > div > div:first-child {\n    padding-top: 12px;\n  }\n`;\n\nif (state.hasBeenFlagged) {\n  return (\n    <div className=\"alert alert-secondary\">\n      <i className=\"bi bi-flag\" /> This content has been flagged for moderation\n    </div>\n  );\n}\n\nconst profile = Social.get(`${accountId}/profile/**`, \"final\");\n\nfunction readableDate(timestamp) {\n  var a = new Date(timestamp);\n  var options = {\n    month: \"short\",\n    day: \"2-digit\",\n    year: \"numeric\",\n    hour: \"2-digit\",\n    minute: \"2-digit\"\n  };\n  return a.toLocaleString(\"en-US\", options);\n}\n\nconst res = fetch(`https://api.near.social/time?blockHeight=${blockHeight}`);\nif (!res) {\n  return \"Loading\";\n}\n\nconst timeMs = parseFloat(res.body);\n\nreturn (\n  <Post>\n    <Header>\n      <div className=\"row\">\n        <div className=\"col-auto\" style={{ paddingRight: 0 }}>\n          <Widget\n            src=\"near/widget/AccountProfile\"\n            props={{\n              accountId,\n              hideAccountId: true,\n              showFlagAccountFeature\n            }}\n          />\n        </div>\n        <div className=\"col-auto\" style={{ paddingLeft: 0 }}>\n          <h5 className=\"text-truncate mb-0\">\n            {profile.name || accountId.split(\".near\")[0]}\n          </h5>\n          <p style={{ fontSize: \"12px\" }} className=\"text-muted\">\n            Updated at {readableDate(timeMs)}\n          </p>\n        </div>\n      </div>\n    </Header>\n\n    <Body>\n      <Content>\n        {content.text && (\n          <Widget\n            src=\"near/widget/SocialMarkdown\"\n            props={{ text: content.text }}\n          />\n        )}\n\n        {content.image && (\n          <Widget\n            src=\"mob.near/widget/Image\"\n            props={{\n              image: content.image\n            }}\n          />\n        )}\n      </Content>\n\n      {blockHeight !== \"now\" && (\n        <Actions>\n          <Widget\n            src=\"near/widget/v1.LikeButton\"\n            props={{\n              item,\n              notifyAccountId\n            }}\n          />\n          <Widget\n            src=\"near/widget/CommentButton\"\n            props={{\n              item,\n              onClick: () => State.update({ showReply: !state.showReply })\n            }}\n          />\n          <Widget\n            src=\"near/widget/CopyUrlButton\"\n            props={{\n              url: postUrl\n            }}\n          />\n          <Widget\n            src=\"near/widget/ShareButton\"\n            props={{\n              postType: \"post\",\n              url: postUrl\n            }}\n          />\n          <Widget\n            src=\"near/widget/FlagButton\"\n            props={{\n              item,\n              disabled: !context.accountId || context.accountId === accountId,\n              onFlag: () => {\n                State.update({ hasBeenFlagged: true });\n              }\n            }}\n          />\n        </Actions>\n      )}\n\n      {state.showReply && (\n        <div>\n          <div className=\"mb-2\">\n            <Widget\n              src=\"near/widget/Comments.Compose\"\n              props={{\n                notifyAccountId,\n                item,\n                onComment: () => State.update({ showReply: false })\n              }}\n            />\n          </div>\n          <Comments>\n            <Widget\n              src=\"near/widget/Comments.Feed\"\n              props={{\n                item,\n                highlightComment: props.highlightComment,\n                limit: props.commentsLimit,\n                subscribe,\n                raw\n              }}\n            />\n          </Comments>\n        </div>\n      )}\n    </Body>\n  </Post>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/astraplusplus.ndctools.near/widget/Common.Components.Post", "fact_widget_deployments_id": "3b5ed2c842759a8eccec29e09fbbdfbf", "inserted_timestamp": "2024-04-01T12:33:40.493Z", "modified_timestamp": "2024-04-01T12:33:40.493Z", "__row_index": 0}
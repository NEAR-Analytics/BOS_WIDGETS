{"tx_hash": "7coQc8TkcPKFoG2KfGhLUKYozdm2YbDffjpCEMickppP", "action_id_social": "7tjT3tMMEHWgMisjHpymBB1Y7SiZTYmoPC8cAwLDZBor-0-widget", "block_id": 110800235, "block_timestamp": "2024-01-19T14:34:48.177Z", "signer_id": "create.near", "widget_name": "count.hashtags", "source_code": "const [hashtag, setHashtag] = useState(\"\");\nconst [hashtagCount, setHashtagCount] = useState(0);\nconst [loading, setLoading] = useState(false);\nconst [done, setDone] = useState(false);\n\nconst getPosts = () => {\n  const posts = Social.index(\"post\", \"main\", {});\n  return posts || [];\n};\n\nconst handleCount = () => {\n  setLoading(true);\n  let allPosts = getPosts();\n  let count = 0;\n  const formattedHashtag = `#${hashtag.trim().toLowerCase()}`;\n\n  allPosts.forEach((item) => {\n    const post = Social.get(`${item.accountId}/post/main`, item.blockHeight);\n    if (post) {\n      try {\n        const parsedPost = JSON.parse(post);\n        if (parsedPost && typeof parsedPost.text === \"string\") {\n          const postText = parsedPost.text.toLowerCase();\n          if (postText.includes(formattedHashtag)) {\n            count++;\n          }\n        }\n      } catch (error) {\n        console.error(\"ERROR:\", error);\n      }\n    }\n  });\n\n  setHashtagCount(count);\n  setLoading(false);\n  setDone(true);\n};\n\nreturn (\n  <>\n    <div className=\"m-2\">\n      <input\n        type=\"text\"\n        placeholder=\"input hashtag ~ do not include #\"\n        value={hashtag}\n        onChange={(e) => setHashtag(e.target.value)}\n      />\n      <button\n        disabled={hashtag === \"\"}\n        className=\"btn btn-primary mt-3\"\n        onClick={handleCount}\n      >\n        Count\n      </button>\n    </div>\n    {done && (\n      <h5 className=\"m-3\">\n        <b>Total:</b> {hashtagCount}\n      </h5>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/create.near/widget/count.hashtags", "fact_widget_deployments_id": "da6d8adb95f83b36e1a45f3d821773d6", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
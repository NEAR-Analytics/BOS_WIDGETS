{"tx_hash": "EWycA2WJZxZGTJZEDkRqGge9NVaEFr3N7k1phLLTC3Bj", "action_id_social": "7rJsYMPUVPFfQGjfjSMQwoeivChHDejJEpDN6mvzxvTt-0-widget", "block_id": 103002574, "block_timestamp": "2023-10-09T20:35:36.244Z", "signer_id": "chess-game.near", "widget_name": "ChessGameTab.Overview", "source_code": "const { accountId } = context;\nif (!accountId) {\n  return \"You need to login with your Near wallet first!\";\n}\nconst { selectGame } = props;\n\nconst contractId = \"app.chess-game.near\";\nconst buttonWidget = \"chess-game.near/widget/ChessGameButton\";\nconst challengeWidget = \"chess-game.near/widget/ChessGameChallenge\";\nconst aiWidget = \"chess-game.near/widget/ChessGameAi\";\n\nif (state.isRegistered) {\n  Near.asyncView(contractId, \"get_game_ids\", {\n    account_id: accountId,\n  }).then((gameIds) =>\n    State.update({\n      gameIds,\n    })\n  );\n} else {\n  State.update({\n    gameIds: [],\n  });\n}\nif (!state.gameIds) {\n  return <Widget src=\"chess-game.near/widget/ChessGameLoading\" />;\n}\n\nconst GameSelector = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: space-between;\n  gap: 1rem;\n`;\n\nconst renderGameIds = (gameIds) =>\n  gameIds.map((gameId) => {\n    const gameInfo = Near.view(contractId, \"game_info\", {\n      game_id: gameId,\n    });\n    return (\n      <Widget\n        src={buttonWidget}\n        props={{\n          onClick: selectGame(\"game\")(gameId, isFinished),\n          content: (\n            <>\n              <div>ID: {gameId[0]}</div>\n              {gameInfo && (\n                <div>\n                  VS:{\" \"}\n                  {gameInfo.black.Ai ? (\n                    <>AI ({gameInfo.black.Ai})</>\n                  ) : (\n                    <>\n                      Player\n                      {gameInfo.black.Human === accountId ? (\n                        <> ({gameInfo.white.Human})</>\n                      ) : (\n                        <> ({gameInfo.black.Human})</>\n                      )}\n                    </>\n                  )}\n                </div>\n              )}\n            </>\n          ),\n        }}\n      />\n    );\n  });\n\nreturn (\n  <>\n    {state.gameIds.length > 0 && (\n      <div>\n        <h2>Select Game:</h2>\n        <GameSelector>{renderGameIds(state.gameIds)}</GameSelector>\n      </div>\n    )}\n    <Widget src={challengeWidget} />\n    <Widget src={aiWidget} />\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/chess-game.near/widget/ChessGameTab.Overview", "fact_widget_deployments_id": "74edf90454e6344bff386c897586bc3e", "inserted_timestamp": "2023-10-09T22:33:03.917Z", "modified_timestamp": "2023-10-09T22:33:03.917Z", "__row_index": 2}
{"tx_hash": "A8mvC9psApG2gsVLRhQNg6Hm748zs39xLBkNRp5YBGvF", "action_id_social": "BXPrnCeuGth6G9hy79HRRHRdeU9CHivGyZLjUr2yQgAh-0-widget", "block_id": 104807258, "block_timestamp": "2023-11-03T02:14:40.903Z", "signer_id": "bo.near", "widget_name": "devhub.page.communities", "source_code": "const { getAllCommunitiesMetadata, createCommunity } = VM.require(\n  \"${REPL_DEVHUB}/widget/core.adapter.devhub-contract\"\n);\n\nif (!getAllCommunitiesMetadata || !createCommunity) {\n  return <p>Loading modules...</p>;\n}\n\nconst onCommunitySubmit = (inputs) =>\n  createCommunity({\n    inputs: {\n      ...inputs,\n\n      bio_markdown: [\n        \"This is a sample text about your community.\",\n        \"You can change it on the community configuration page.\",\n      ].join(\"\\n\"),\n\n      logo_url:\n        \"https://ipfs.near.social/ipfs/bafkreibysr2mkwhb4j36h2t7mqwhynqdy4vzjfygfkfg65kuspd2bawauu\",\n\n      banner_url:\n        \"https://ipfs.near.social/ipfs/bafkreic4xgorjt6ha5z4s5e3hscjqrowe5ahd7hlfc5p4hb6kdfp6prgy4\",\n    },\n  });\n\nconst [showSpawner, setShowSpawner] = useState(false);\n\nconst [searchKey, setSearchKey] = useState(\"\");\nconst [sort, setSort] = useState(\"\");\n\nconst communitiesMetadata = getAllCommunitiesMetadata();\n\nif (!communitiesMetadata) {\n  return <p>Loading...</p>;\n}\n\nconst SortedAndFiltered = (searchKey, sortBy) => {\n  let communities = (communitiesMetadata ?? []).reverse();\n\n  let filtered = [...communities];\n  if (searchKey !== \"\") {\n    filtered = communities.filter((community) =>\n      community.name.toLowerCase().includes(searchKey.toLowerCase())\n    );\n  }\n\n  let sortedCommunities = [...filtered];\n  if (sortBy !== \"\") {\n    sortedCommunities.sort((a, b) => {\n      let nameA = a.name.toLowerCase();\n      let nameB = b.name.toLowerCase();\n\n      if (nameA < nameB) {\n        return -1;\n      }\n      if (nameA > nameB) {\n        return 1;\n      }\n      return 0;\n    });\n\n    if (sortBy === \"z-a\") {\n      sortedCommunities.reverse();\n    }\n  }\n\n  return sortedCommunities;\n};\n\nconst CTA = styled.button`\n  all: unset;\n\n  color: #f4f4f4;\n\n  font-size: 16px;\n  font-style: normal;\n  font-weight: 700;\n  line-height: 20px; /* 125% */\n\n  border-radius: 4px;\n  background: #00ec97;\n\n  display: flex;\n  padding: 14px 16px;\n  align-items: center;\n  gap: 8px;\n\n  &:hover {\n    background: #04a46e;\n  }\n`;\n\nconst CardGrid = styled.div`\n  width: 100%;\n  height: 100%;\n\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 3rem;\n\n  @media screen and (max-width: 1000px) {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 2rem;\n  }\n`;\n\nconst SearchForm = styled.input`\n  display: flex;\n  padding: 14px 16px;\n  align-items: center;\n  gap: 16px;\n\n  border-radius: 4px;\n  //background: rgba(129, 129, 129, 0.15);\n\n  color: #818181;\n  font-size: 16px;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 20px; /* 125% */\n\n  border: none;\n`;\n\nconst Sort = styled.select`\n  padding: 14px 16px;\n\n  border-radius: 4px;\n  //background: rgba(129, 129, 129, 0.15);\n\n  color: #818181;\n  font-size: 16px;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 20px; /* 125% */\n\n  border: none;\n`;\n\nreturn (\n  <div className=\"w-100\">\n    <Widget\n      src={`${REPL_DEVHUB}/widget/devhub.components.island.banner`}\n      props={{\n        title: (\n          <>\n            We are building <br />\n            <span style={{ color: \"#151515\" }}>\n              a decentralized community\n            </span>{\" \"}\n            <br />\n            for NEAR Developers.\n          </>\n        ),\n        imageLink:\n          \"https://ipfs.near.social/ipfs/bafkreigtpjmgt3aphd3plbcremtvazeo7qsjvguw44m74zthyxbhj4toqe\",\n      }}\n    />\n    <div style={{ background: \"#f4f4f4\" }}>\n      <div\n        className=\"d-flex justify-content-between p-4\"\n        style={{ backgroundColor: \"\" }}\n      >\n        <div className=\"d-flex flex-column gap-3 w-100\">\n          <h1\n            className=\"m-0 fs-4\"\n            style={{ color: \"#04a46e\", fontSize: \"1.5rem\" }}\n          >\n            Communities\n          </h1>\n\n          <div className=\"d-flex flex-column-reverse flex-lg-row gap-3 justify-content-between align-items-center\">\n            <div className=\"d-flex align-items-center gap-4\">\n              <SearchForm\n                type=\"text\"\n                placeholder=\"\ud83d\udd0d Search Communities\"\n                value={searchKey}\n                onChange={(e) => setSearchKey(e.target.value)}\n              />\n              <Sort\n                class=\"form-select\"\n                onChange={(e) => setSort(e.target.value)}\n              >\n                <option selected value=\"\">\n                  Sort\n                </option>\n                <option value=\"a-z\">A-Z</option>\n                <option value=\"z-a\">Z-A</option>\n              </Sort>\n            </div>\n            {context.accountId && (\n              <div className=\"d-flex flex-column justify-content-center\">\n                <CTA onClick={() => setShowSpawner(!showSpawner)}>\n                  <i className=\"bi bi-plus-circle-fill me-1\"></i> Create\n                  Community\n                </CTA>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n      <div className=\"d-flex flex-wrap align-content-start gap-4 p-4 w-100 h-100\">\n        {showSpawner && (\n          <Widget\n            src=\"${REPL_DEVHUB}/widget/devhub.entity.community.Spawner\"\n            props={{\n              data: null,\n              onSubmit: onCommunitySubmit,\n              onCancel: () => setShowSpawner(false),\n            }}\n          />\n        )}\n        <CardGrid>\n          {searchKey === \"\" && sort === \"\"\n            ? (communitiesMetadata ?? []).reverse().map((communityMetadata) => (\n                <Widget\n                  src=\"${REPL_DEVHUB}/widget/devhub.entity.community.Card\"\n                  props={{\n                    format: \"small\",\n                    isBannerEnabled: false,\n                    metadata: communityMetadata,\n                  }}\n                />\n              ))\n            : SortedAndFiltered(searchKey, sort).map((communityMetadata) => (\n                <Widget\n                  src=\"${REPL_DEVHUB}/widget/devhub.entity.community.Card\"\n                  props={{\n                    format: \"small\",\n                    isBannerEnabled: false,\n                    metadata: communityMetadata,\n                  }}\n                />\n              ))}\n        </CardGrid>\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bo.near/widget/devhub.page.communities", "fact_widget_deployments_id": "609f766f4caa25f7c284057a52541317", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 72}
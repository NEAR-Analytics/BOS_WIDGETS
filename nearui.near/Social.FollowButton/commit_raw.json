{"tx_hash": "4E2KZLqBCHK12yaeKVrAo2rUxYXvRTRHD8374QtDn1ng", "action_id_social": "9ekQ2tKLBgZn379SCk2u4Zit4FNaUbfW1RSHgE94kban-0-widget", "block_id": 98188983, "block_timestamp": "2023-08-06T08:41:59.078Z", "signer_id": "nearui.near", "widget_name": "Social.FollowButton", "source_code": "const toBeFollowed = props.accountId ?? \"sking.near\";\n\nif (!toBeFollowed || !context.accountId || context.accountId === toBeFollowed) {\n  return \"\";\n}\n\nState.init({\n  loading: false,\n});\n\nconst followEdge = Social.keys(\n  `${context.accountId}/graph/follow/${toBeFollowed}`,\n  undefined,\n  {\n    values_only: true,\n  },\n);\n\nconst inverseEdge = Social.keys(\n  `${toBeFollowed}/graph/follow/${context.accountId}`,\n  undefined,\n  {\n    values_only: true,\n  },\n);\n\nconst loading = followEdge === null || inverseEdge === null;\nconst isFollowing = Object.keys(followEdge || {}).length > 0;\nconst isInverse = Object.keys(inverseEdge || {}).length > 0;\n\nconst type = follow ? \"unfollow\" : \"follow\";\n\nconst data = {\n  graph: { follow: { [toBeFollowed]: isFollowing ? null : \"\" } },\n  index: {\n    graph: JSON.stringify({\n      key: \"follow\",\n      value: {\n        type,\n        accountId: toBeFollowed,\n      },\n    }),\n    notify: JSON.stringify({\n      key: toBeFollowed,\n      value: {\n        type,\n      },\n    }),\n  },\n};\n\nreturn (\n  <Widget\n    src=\"nearui.near/widget/Input.Button\"\n    props={{\n      children: (\n        <>\n          {isFollowing && <i className=\"bi bi-check-lg\"></i>}\n          {isFollowing ? \"Following\" : isInverse ? \"Follow Back\" : \"Follow\"}\n        </>\n      ),\n      variant: props.variant ?? (isFollowing ? [] : [\"secondary\"]),\n      disabled: props.disabled ?? loading,\n      onClick: () => {\n        State.update({ loading: true });\n        Social.set(data, {\n          force: true,\n          onCommit: () => {\n            State.update({ loading: false });\n          },\n          onCancel: () => {\n            State.update({ loading: false });\n          },\n        });\n      },\n      ...props,\n    }}\n  />\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearui.near/widget/Social.FollowButton", "fact_widget_deployments_id": "77f258fdd269efade7ec19b7fb450254", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
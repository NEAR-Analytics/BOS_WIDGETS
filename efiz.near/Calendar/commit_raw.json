{"tx_hash": "CQpG8eYeoS2jLpa12Tmcnmmz7X43q7vvckwdT1o5xepo", "action_id_social": "38cLdenMQY9p6h82ZiuhmW5KArwL427gT6ZLjqagF4vG-0-widget", "block_id": 100161579, "block_timestamp": "2023-09-01T14:54:46.499Z", "signer_id": "efiz.near", "widget_name": "Calendar", "source_code": "// CALENDAR FROM https://github.com/fullcalendar/fullcalendar/tree/main/bundle\n// helper function to fetch all events\nconst fetchAllEvents = () => {\n  const index = Social.index(\"every\", \"every.near/type/event\");\n\n  let fetchedEvents = [];\n\n  index.map((item) => {\n    const path = `${item.accountId}/thing/${item.value.id}`;\n    const blockHeight = item.blockHeight;\n\n    const eventThing = Social.getr(path, blockHeight);\n    fetchedEvents.push(eventThing.data);\n  });\n\n  return fetchedEvents;\n};\n\nconst fetchedEvents = fetchAllEvents();\n\nif (!fetchedEvents) {\n  return <div>Loading...</div>;\n}\n\nconst formattedEvents = fetchedEvents.map((event) => {\n  return {\n    title: event.title,\n    start: new Date(`${event.start} ${event.startTime}`),\n    end: new Date(`${event.end} ${event.endTime}`),\n    url: event.link,\n    allDay: event.isAllDay === \"true\",\n    editable: false,\n    extendedProps: {\n      category: event.category,\n    },\n    description: event.description,\n  };\n});\n\nconst srcData = `\n<!DOCTYPE html>\n<html>\n  <head>\n    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet'>\n    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css' rel='stylesheet'>\n    <script src='https://cdn.jsdelivr.net/npm/fullcalendar/index.global.js'></script>\n    <script>\n\n      document.addEventListener('DOMContentLoaded', function() {\n        const calendarEl = document.getElementById('calendar')\n        const calendar = new FullCalendar.Calendar(calendarEl, {\n          titleFormat: { year: 'numeric', month: 'long', },\n          themeSystem: 'bootstrap5',\n          initialView: 'dayGridMonth',\n          editable: true,\n          firstDay: 1,\n          buttonText: {\n            month: \"Month\",\n            list: \"List\",\n          },\n          customButtons: {\n            filterBy: {\n              text: 'Filter by',\n              click: function(e) {\n                e.preventDefault();\n                window.parent.postMessage(JSON.stringify({ handler: \"filter\"}), '*');\n              }\n            },\n            addEvent: {\n              text: '',\n              click: function(e) {\n                e.preventDefault();\n                window.parent.postMessage(JSON.stringify({ handler: \"add-event\"}), '*');\n              }\n            },\n          },\n          expandRows: true,\n          headerToolbar: {\n            start: 'title prev,next dayGridMonth list', // will normally be on the left. if RTL, will be on the right\n            center: '',\n            // end: 'timeGridDay list' \n            end: 'filterBy addEvent' \n          },\n          navLinks: true,\n          events: ${JSON.stringify(formattedEvents)},\n          eventClick: function(info) {\n            info.jsEvent.preventDefault(); // don't let the browser navigate\n            // Post the event details to the parent window\n            window.parent.postMessage(JSON.stringify({ handler: \"event-click\", data: info.event }), '*');\n          },\n     \n\n          // Render the custom button with an icon\n          viewDidMount: function () {\n            var addEvent = document.querySelector('.fc-addEvent-button');\n            addEvent.innerHTML = 'Add Event <i class=\"bi bi-plus-circle-fill\" style=\"color: #05EB97; margin-left: 2px;\"></i>';\n        \n          }\n        })\n        calendar.render()\n      })\n\n      \n    </script>\n    \n  </head>\n  <body>\n    <div id='calendar'></div>\n  </body>\n</html>\n\n<style>\n  html,\n  body {\n    height: 100%;\n  }\n\n  #calendar: {\n    height:  100%;\n  }\n\n  .fc-col-header {\n    border-radius: 0px 0px 6px 6px;\n    background: rgba(237, 237, 237, 0.93);\n  }\n\n  .fc-scrollgrid-sync-inner a {\n    text-decoration: none;\n    color: #5C5F62;\n    font-size: 12px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: normal;\n  }\n\n  .fc-toolbar-chunk {\n    display: flex;\n  }\n\n  .fc .fc-button-primary {\n    background-color: white;\n    color: black;\n    border: none;\n  }\n\n  .fc .fc-button-primary:hover{ \n    transition: 300ms;\n  }\n\n  .fc-dayGridMonth-button.fc-button.fc-button-primary {\n    width: 67px;\n    height: 35px;\n    padding: 8px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 4px;\n\n    border-radius: 3px;\n\n    background: rgba(3, 177, 114, 0.20);\n    color: #03B172;\n    font-size: 16px;\n    font-style: normal;\n    font-weight: 600;\n    line-height: normal;\n  }\n\n  .fc-dayGridMonth-button.fc-button.fc-button-primary.fc-button-active {\n    border: 1px solid #03B172;\n    background-color: white;\n    color: #03B172;\n  }\n\n  .fc-list-button.fc-button.fc-button-primary {\n    display: flex;\n    width: 67px;\n    height: 35px;\n    padding: 8px;\n    justify-content: center;\n    align-items: center;\n    gap: 4px;\n\n    border-radius: 3px;\n    background: rgba(3, 177, 114, 0.20);\n\n    color: #03B172;\n    font-size: 16px;\n    font-style: normal;\n    font-weight: 600;\n    line-height: normal;\n  }\n\n  .fc-list-button.fc-button.fc-button-primary.fc-button-active {\n    border: 1px solid #03B172;\n    background-color: white;\n    color: #03B172;\n  }\n\n  .fc-header-toolbar.fc-toolbar {\n    display: flex;\n    padding: 16px;\n    justify-content: space-between;\n    align-items: center;\n    align-self: stretch;\n\n    border-radius: 6px;\n    border: 1px solid var(--Stroke, rgba(218, 220, 224, 0.60));\n    background: #FFF;\n  } \n\n  .fc .fc-toolbar.fc-header-toolbar {\n    margin-bottom: 16px;\n  }\n\n  .fc-toolbar-title {\n    font-weight: 400;\n  }\n\n  .fc-filterBy-button.fc-button.fc-button-primary {\n    border-radius: 3px;\n    background: #EEE;\n\n    display: flex;\n    height: 35px;\n    padding: 8px;\n    justify-content: center;\n    align-items: center;\n    gap: 4px;\n\n    color: #000;\n    font-size: 16px;\n    font-style: normal;\n    font-weight: 400;\n    line-height: normal;\n  }\n\n  .fc-addEvent-button.fc-button.fc-button-primary {\n    display: flex;\n    height: 35px;\n    padding: 8px 16px;\n    justify-content: center;\n    align-items: center;\n    gap: 4px;\n\n    border-radius: 3px;\n    background: #03B172;\n\n    color: #FFF;\n    font-size: 16px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: normal;\n  }\n\n  .fc table {\n    border-radius: 6px;\n  }\n\n  .fc .fc-daygrid-day-top {\n    flex-direction: row;\n  }\n\n  .fc .fc-daygrid-day-number {\n    display: flex;\n    width: 22px;\n    padding: 5px;\n    align-items: flex-start;\n    gap: 10px;\n\n    text-decoration: none;\n\n    color: #333;\n    font-size: 10px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: normal;\n  }\n\n  .fc-day-past,\n  .fc-day-other {\n    background: #F2F2F2;\n  }\n\n  .fc .fc-view-harness-active > .fc-view {\n    border-radius: 6px;\n  }\n\n  tbody, td, tfoot, th, thead, tr {\n    border-radius: 6px;\n  }\n\n  @media (width < 720px) {\n    .fc .fc-toolbar-title {\n      font-size: 1rem;\n    }\n\n    .fc-toolbar-chunk {\n      display: flex;\n      align-items: center;\n    }\n  }\n\n  @media (width < 550px) {\n    .fc-dayGridMonth-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n      width: 50px;\n      height: 30px;\n      padding: 0.5rem;\n    }\n\n    .fc-list-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n      width: 50px;\n      height: 30px;\n      padding: 0.5rem;\n    }\n\n    .fc-filterBy-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n      width: 60px;\n      height: 30px;\n      padding: 0.5rem;\n    }\n\n    .fc-addEvent-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n      width: 95px;\n      height: 30px;\n      padding: 0.5rem;\n    }\n\n    .fc-prev-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n    }\n\n    .fc-next-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n    }\n  }\n\n  @media (width < 480px) {\n    .fc-header-toolbar.fc-toolbar {\n      padding: 0.25rem;\n      text-align: center;\n    } \n\n    .fc-direction-ltr .fc-toolbar > * > :not(:first-child) {\n      margin-left: 0px;\n    }\n\n    .fc-prev-button.fc-button.fc-button-primary {\n      padding: 2px;\n    }\n\n    .fc-next-button.fc-button.fc-button-primary {\n      padding: 2px;\n    }\n\n    .fc-dayGridMonth-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n      width: 50px;\n      height: 30px;\n      padding: 0.5rem;\n    }\n\n    .fc-list-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n      width: 50px;\n      height: 30px;\n      padding: 0.5rem;\n    }\n\n    .fc-filterBy-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n      width: 60px;\n      height: 30px;\n      padding: 0.5rem;\n    }\n\n    .fc-addEvent-button.fc-button.fc-button-primary {\n      font-size: 0.75rem;\n      width: 90px;\n      height: 30px;\n      padding: 0.2rem;\n    }\n  }\n\n</style>\n`;\n\nreturn (\n  <>\n    <div className=\"container\">\n      <iframe\n        srcDoc={srcData}\n        onMessage={(data) => {\n          const dataObj = JSON.parse(data);\n          switch (dataObj.handler) {\n            case \"filter\": {\n              console.log(\"filter\");\n              if (props.handleFilter) {\n                props.handleFilter();\n              }\n              break;\n            }\n            case \"add-event\": {\n              console.log(\"add event\");\n              if (props.handleAddEvent) {\n                props.handleAddEvent();\n              }\n              break;\n            }\n            case \"event-click\": {\n              console.log(\"event click\");\n              if (props.handleEventClick) {\n                props.handleEventClick();\n              }\n              break;\n            }\n          }\n        }}\n        style={{\n          height: \"100vh\",\n          width: \"100%\",\n        }}\n      />\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/efiz.near/widget/Calendar", "fact_widget_deployments_id": "de1274297d366edb8902df3488549712", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 8}
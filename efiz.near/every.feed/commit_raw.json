{"tx_hash": "HxQhg8z23Wb4jP7VNv9D1rWPPnMN5bJPmeSGqsUsKsp7", "action_id_social": "BvdCNkTJy8H3e2p3A6sGvMjCiS7nhTY5rsZfFRvCGp2x-0-widget", "block_id": 95804789, "block_timestamp": "2023-07-06T02:23:03.010Z", "signer_id": "efiz.near", "widget_name": "every.feed", "source_code": "let accounts = undefined;\n\nState.init({\n  view: \"ALL\",\n});\n\nif (state.view === \"FOLLOWING\") {\n  const graph = Social.keys(`${context.accountId}/graph/follow/*`, \"final\");\n  if (graph !== null) {\n    accounts = Object.keys(graph[context.accountId].graph.follow || {});\n    accounts.push(context.accountId);\n  } else {\n    accounts = [];\n  }\n}\n\nconst Row = styled.div`\n    display: flex;\n    flex-direction: row;\n    gap: 4px;\n`;\n\nconst Button = styled.button``;\n\nfunction Feed({ view }) {\n  switch (view) {\n    case \"ALL\": {\n      return <Widget src=\"every.near/widget/every.post\" />;\n    }\n    case \"FOLLOWING\": {\n      // Notice how every.post loads quickly and on-demand, but every.feed.view frontloads\n      // TODO: merge\n      return (\n        <Widget\n          src=\"efiz.near/widget/every.feed.view\"\n          props={{\n            data: {\n              sources: [{ domain: \"post\", key: \"main\" }],\n              accountWhitelist: accounts,\n              typeWhitelist: [\"md\"],\n            },\n          }}\n        />\n      );\n    }\n    case \"HASHTAG\": {\n      return <Widget src=\"efiz.near/widget/every.hashtag\" />;\n    }\n  }\n}\n\nreturn (\n  <>\n    <Row>\n      <Button onClick={() => State.update({ view: \"ALL\" })}>All</Button>\n      <Button onClick={() => State.update({ view: \"FOLLOWING\" })}>\n        Following\n      </Button>\n      <Button onClick={() => State.update({ view: \"HASHTAG\" })}>Hashtag</Button>\n    </Row>\n    <Feed view={state.view} />\n  </>\n);\n", "metadata": null, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/efiz.near/widget/every.feed", "fact_widget_deployments_id": "48432101e8bbfb46120d94c81b65f28d", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
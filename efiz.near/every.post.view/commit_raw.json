{"tx_hash": "nBGrtSfMpnbWhXNrVzyXXV7Uq4U6FyKU7owSoKvyMu9", "action_id_social": "8R1q1uQJjLS6rZwEhWTmV7c5Yz55ZQRuFW3btMC5gHWQ-0-widget", "block_id": 96158446, "block_timestamp": "2023-07-10T16:34:57.363Z", "signer_id": "efiz.near", "widget_name": "every.post.view", "source_code": "function Post(props) {\n  const path = props.path;\n  const blockHeight =\n    props.blockHeight === \"now\" ? \"now\" : parseInt(props.blockHeight);\n  const subscribe = !!props.subscribe;\n  const parts = path.split(\"/\");\n  const accountId = parts[0];\n  const notifyAccountId = accountId;\n\n  const postUrl = `https://near.org#/near/widget/PostPage?accountId=${accountId}&blockHeight=${blockHeight}`;\n\n  State.init({ hasBeenFlagged: false });\n\n  const content = props.content ?? JSON.parse(Social.get(path, blockHeight));\n  const type = content.type;\n\n  const item = {\n    type: \"social\",\n    path: path,\n    blockHeight,\n  };\n\n  const Post = styled.div`\n  position: relative;\n\n  &::before {\n    content: \"\";\n    display: block;\n    position: absolute;\n    left: 19px;\n    top: 52px;\n    bottom: 12px;\n    width: 2px;\n    background: #eceef0;\n  }\n`;\n\n  const Header = styled.div`\n  margin-bottom: 0;\n  display: inline-flex;\n`;\n\n  const Body = styled.div`\n  padding-left: 52px;\n  padding-bottom: 1px;\n`;\n\n  const Content = styled.div`\n  img {\n    display: block;\n    max-width: 100%;\n    max-height: 80vh;\n    margin: 0 0 12px;\n  }\n`;\n\n  const Text = styled.p`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 400;\n  color: #687076;\n  white-space: nowrap;\n`;\n\n  const Actions = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: -6px -6px 6px;\n`;\n\n  const Comments = styled.div`\n  > div > div:first-child {\n    padding-top: 12px;\n  }\n`;\n\n  if (state.hasBeenFlagged) {\n    return (\n      <div className=\"alert alert-secondary\">\n        <i className=\"bi bi-flag\" /> This content has been flagged for\n        moderation\n      </div>\n    );\n  }\n\n  function renderContent() {\n    if (type === \"md\" || type === \"social\") {\n      return (\n        <>\n          {content.text && (\n            <Widget\n              src=\"near/widget/SocialMarkdown\"\n              props={{ text: content.text }}\n            />\n          )}\n\n          {content.image && (\n            <Widget\n              src=\"mob.near/widget/Image\"\n              props={{\n                image: content.image,\n              }}\n            />\n          )}\n        </>\n      );\n    } else {\n      // blockHeight would preserve the original post\n      // so we pass final to get latest edit\n      return (\n        <Widget\n          src=\"efiz.near/widget/Every.Thing.View\"\n          props={{ path, blockHeight: \"final\" }}\n        />\n      );\n    }\n  }\n\n  return (\n    <Post>\n      <Header>\n        <div className=\"row\">\n          <div className=\"col-auto\">\n            <Widget\n              src=\"near/widget/AccountProfile\"\n              props={{\n                accountId,\n                hideAccountId: true,\n                inlineContent: (\n                  <>\n                    <Text as=\"span\">\uff65</Text>\n                    <Text>\n                      {blockHeight === \"now\" ? (\n                        \"now\"\n                      ) : (\n                        <>\n                          <Widget\n                            src=\"mob.near/widget/TimeAgo\"\n                            props={{ blockHeight }}\n                          />{\" \"}\n                          ago\n                        </>\n                      )}\n                    </Text>\n                    {false && edits.length > 0 && (\n                      <Text as=\"span\">\uff65 Edited</Text>\n                    )}\n                  </>\n                ),\n              }}\n            />\n          </div>\n        </div>\n      </Header>\n\n      <Body>\n        <Content>{renderContent()}</Content>\n\n        {blockHeight !== \"now\" && (\n          <Actions>\n            <Widget\n              src=\"near/widget/LikeButton\"\n              props={{\n                item,\n                notifyAccountId,\n              }}\n            />\n            <Widget\n              src=\"near/widget/CommentButton\"\n              props={{\n                item,\n                onClick: () => State.update({ showReply: !state.showReply }),\n              }}\n            />\n            <Widget\n              src=\"near/widget/CopyUrlButton\"\n              props={{\n                url: postUrl,\n              }}\n            />\n            <Widget\n              src=\"near/widget/FlagButton\"\n              props={{\n                item,\n                onFlag: () => {\n                  State.update({ hasBeenFlagged: true });\n                },\n              }}\n            />\n          </Actions>\n        )}\n\n        {state.showReply && (\n          <div className=\"mb-2\">\n            <Widget\n              src=\"near/widget/Comments.Compose\"\n              props={{\n                notifyAccountId,\n                item,\n                onComment: () => State.update({ showReply: false }),\n              }}\n            />\n          </div>\n        )}\n\n        <Comments>\n          <Widget\n            src=\"near/widget/Comments.Feed\"\n            props={{\n              item,\n              highlightComment: props.highlightComment,\n              limit: props.commentsLimit,\n              subscribe,\n              raw,\n            }}\n          />\n        </Comments>\n      </Body>\n    </Post>\n  );\n}\n\nreturn { Post };\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/efiz.near/widget/every.post.view", "fact_widget_deployments_id": "6ff4d44c64ae4dba68acccfd714c9b8c", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
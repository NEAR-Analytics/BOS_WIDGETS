{"tx_hash": "Ai2SM5Di3Ks88sqjvBffggB3Y2gchqTs2h5j52C3cms5", "action_id_social": "5g8kAotHRDz7ghVsDLd8RBSidmG2LqHcd1cWYaEWTWC3-0-widget", "block_id": 97319207, "block_timestamp": "2023-07-25T18:35:17.667Z", "signer_id": "efiz.near", "widget_name": "docs.card", "source_code": "const path = props.path ?? \"mob.near/widget/WidgetSource\";\nconst [accountId, type, thingName] = path.split(\"/\");\nconst blockHeight = props.blockHeight;\nconst metadata = props.metadata ?? Social.getr(`${path}/metadata`);\n\nconst image = metadata.image;\n\nconst handleProposal = () => {};\n\nconst handleCreate = () => {};\n\nconst Card = styled.div`\n  position: relative;\n  border-radius: 12px;\n  justify-content: center;\n  background: #fff;\n  border: 1px solid #eceef0;\n  box-shadow: 0px 1px 3px rgba(16, 24, 40, 0.1),\n    0px 1px 2px rgba(16, 24, 40, 0.06);\n  overflow: hidden;\n  textOverflow: \"ellipsis\";\n  whiteSpace: \"nowrap\";\n  padding: 23px;\n`;\n\nconst StarButton = styled.div`\n  position: absolute;\n  top: 23px;\n  right: 17px;\n`;\n\nconst ForkButton = styled.div`\n  position: absolute;\n  bottom: 23px;\n  right: 19px;\n`;\n\nState.init({\n  tag: \"\",\n});\n\nfunction setTag() {\n  Social.set({\n    every: {\n      [type]: {\n        // widget, thing, type, etc\n        [accountId]: {\n          // owner/creator\n          [thingName]: {\n            // name\n            tags: {\n              [state.tag]: \"\",\n            },\n          },\n        },\n      },\n    },\n  });\n}\n\nconst tagsPattern = `*/every/${type}/${accountId}/${thingName}/tags/*`;\nconst tagsObject = Social.keys(tagsPattern, \"final\");\n\nif (tagsObject === null) {\n  return \"Loading\";\n}\n\nconst tagsCount = {};\nconst tagsAuthors = {};\n\nconst processTagsObject = (obj) => {\n  Object.entries(obj).forEach((kv) => {\n    if (kv[1] === null) {\n      const tag = kv[0];\n\n      tagsCount[tag] = (tagsCount[tag] || 0) - 1;\n    } else if (typeof kv[1] === \"object\") {\n      processTagsObject(kv[1]);\n    } else {\n      const tag = kv[0];\n      tagsCount[tag] = (tagsCount[tag] || 0) + 1;\n    }\n  });\n};\n\nconst getTags = () => {\n  processTagsObject(tagsObject);\n  const tags = Object.entries(tagsCount);\n  tags.sort((a, b) => b[1] - a[1]);\n  return tags.map((t) => {\n    return {\n      name: t[0],\n      count: t[1],\n      title: t[1] + (t[1] > 1 ? \" votes\" : \" vote\"),\n    };\n  });\n};\n\nconst publicTags = getTags();\n\nreturn (\n  <>\n    <Card>\n      <div className=\"row\">\n        <div className=\"col-8\">\n          <div className=\"m-1 mb-3 text-truncate\">\n            <Widget\n              src=\"mob.near/widget/ProfileLine\"\n              props={{ accountId, link: \"\" }}\n            />\n          </div>\n          <div className=\"m-1 position-relative\">\n            <h5 className=\"card-title mb-2\">{name}</h5>\n            <div className=\"text-truncate mb-1\">\n              <a className=\"stretched-link\" href={`#/${path}`}>\n                <i className=\"bi bi-box-arrow-up-right text-secondary me-1\" />\n                {path}\n              </a>\n            </div>\n          </div>\n          <div className=\"card-text\">\n            <a\n              href={`#/mob.near/widget/WidgetSource?src=${path}`}\n              className=\"btn btn-sm btn-outline-secondary border-0\"\n              target=\"_blank\"\n            >\n              <i className=\"bi bi-code me-1\"></i>source\n            </a>\n            <a\n              href={`#/bozon.near/widget/WidgetHistory?widgetPath=${path}`}\n              className=\"btn btn-sm btn-outline-secondary border-0\"\n              target=\"_blank\"\n            >\n              <i className=\"bi bi-clock me-1\"></i>history\n            </a>\n            <small className=\"text-nowrap text-muted m-1\">\n              <i className=\"bi bi-hourglass me-1\"></i>\n              <Widget\n                src=\"mob.near/widget/TimeAgo\"\n                props={{ keyPath: path, now: props.metadata, blockHeight }}\n              />\n            </small>\n          </div>\n        </div>\n      </div>\n      {publicTags &&\n        publicTags.map((tag) => (\n          <div>\n            <span\n              className={\"badge bg-success position-relative\"}\n              title={tag.title}\n              style={\n                tag.count > 1\n                  ? {\n                      marginRight: \"0.9em\",\n                      paddingRight: \"0.85em\",\n                    }\n                  : { marginRight: \"0.25em\" }\n              }\n            >\n              #{tag.name}\n              {tag.count > 1 && (\n                <span\n                  className={`badge translate-middle rounded-pill bg-danger position-absolute top-50 start-100`}\n                >\n                  {tag.count}\n                </span>\n              )}\n            </span>\n          </div>\n        ))}\n      <div className=\"col-3\">\n        <StarButton>\n          <a className=\"btn btn-success\" href={`#/${path}`}>\n            <i className=\"bi bi-eye-fill me-1\"></i>\n            view\n          </a>\n        </StarButton>\n        <div className=\"\">\n          <input onChange={(e) => State.update({ tag: e.target.value })} />\n          <button onClick={() => setTag()}>tag</button>\n        </div>\n        <ForkButton>\n          <a className=\"btn btn-outline-success\" href={`#/edit/${path}`}>\n            <i className=\"bi bi-git me-1\"></i>\n            {accountId === context.accountId ? \"edit\" : \"fork\"}\n          </a>\n        </ForkButton>\n      </div>\n    </Card>\n    {/**\n    <Modal isOpen={false} onClose={() => State.update({ modalIsOpen: false })}>\n      <h2>This is the Modal Content</h2>\n      <p>Feel free to add any content here!</p>\n    </Modal>\n    */}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/efiz.near/widget/docs.card", "fact_widget_deployments_id": "1e8a9ec3c84f83dbe264951e0faee584", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 22}
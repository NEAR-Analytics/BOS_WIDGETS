{"tx_hash": "AfMskgfiFiaMEzDg4kfa6cTAFC5UF1L5SqCRZ5uL4Ho2", "action_id_social": "4kzsh8jU3eDQddpPQUb7RQF9gZtHGU6qsaQEg9BJe9t4-0-widget", "block_id": 105334746, "block_timestamp": "2023-11-10T00:58:18.279Z", "signer_id": "refoundonbos.near", "widget_name": "card", "source_code": "const ownerId = \"refoundonbos.near\";\n// ToDo create deploy donate (campaign) contract - modify code accordantly\nconst donationContractId = \"donate.refoundjournalism.near\";\nconst registryContractId = \"refoundjournalism.near\";\n\nconst Card = styled.a`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  max-width: 30%;\n  min-width: 320px;\n  border-radius: 7px;\n  background: white;\n  box-shadow: 0px -2px 0px #dbdbdb inset;\n  border: 1px solid #dbdbdb;\n  &:hover {\n    text-decoration: none;\n    cursor: pointer;\n  }\n`;\n\nconst Info = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-top: 110px;\n  padding: 16px 24px;\n  gap: 16px;\n  flex: 1;\n`;\n\nconst Title = styled.div`\n  font-size: 16px;\n  font-weight: 600;\n  color: #2e2e2e;\n`;\n\nconst SubTitle = styled.div`\n  font-size: 16px;\n  font-weight: 400;\n  color: #2e2e2e;\n  word-wrap: break-word;\n`;\n\nconst Tags = styled.div`\n  display: flex;\n  gap: 8px;\n`;\n\nconst Tag = styled.span`\n  box-shadow: 0px -0.699999988079071px 0px rgba(123, 123, 123, 0.36) inset;\n  padding: 4px 8px;\n  border-radius: 4px;\n  border: 1px solid rgba(123, 123, 123, 0.36);\n  color: #2e2e2e;\n`;\n\nconst DonationsInfoContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 24px;\n  width: 100%;\n  border-top: 1px #f0f0f0 solid;\n`;\n\nconst DonationsInfoItem = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  align-items: center;\n`;\n\nconst MAX_DESCRIPTION_LENGTH = 120;\n\nconst series = props.post;\n\n// const series = Near.view(registryId, \"get_series_details\", { id: 0 });\n\n// if (!series) {\n//   return \"Loading\";\n// }\n\n//console.log(\"series\", series)\n\nconst title = (series && series.title) || \"Untitled\";\nconst description = (series && series.description) || \"\";\nlet image = series.media || \"\";\n\nconst tags = series && Object.keys(series.tags ?? {});\nconst dateTaken = series.dateTaken;\nconst location = series.location;\nconst verified = series.verified;\nconst seriesId = series.seriesId;\nconsole.log(\"media\", image);\nconst donationsForProject = Near.view(\n  donationContractId,\n  \"get_total_donations\",\n  {\n    recipient_id: id,\n  }\n);\n\nconst [totalAmount, totalDonors] = useMemo(() => {\n  if (!donationsForProject) return [null, null];\n  const donors = [];\n  let totalDonationAmount = new Big(0);\n  for (const donation of donationsForProject) {\n    if (!donors.includes(donation.donor_id)) {\n      donors.push(donation.donor_id);\n    }\n    totalDonationAmount = totalDonationAmount.plus(\n      new Big(donation.total_amount)\n    );\n  }\n  return [\n    props.nearToUsd\n      ? (props.nearToUsd * totalDonationAmount.div(1e24).toNumber()).toFixed(2)\n      : totalDonationAmount.div(1e24).toNumber().toFixed(2),\n    donors.length,\n  ];\n}, [donationsForProject]);\n\n// const PROJECT_STATUSES = [\n//   \"Submitted\",\n//   \"InReview\",\n//   \"Approved\",\n//   \"Rejected\",\n//   \"Graylisted\",\n//   \"Blacklisted\",\n// ];\n\n// const getLinks = async (str) => {\n// \ttry {\n// \t\t//const url = createGatewayUrl(cid, filePath);\n// \t\tconsole.log('get image and audio', str);\n// \t\tconst ipfsPath = str.replace(\".ipfs.w3s.link\", \"\").replace(\"https://\", \"\").split(\"/\")[0];\n// \t\tconsole.log(ipfsPath);\n\n// \t\tconst data = asyncFetch(\"https://dweb.link/api/v0/ls?arg=\" + ipfsPath)\n// \t\t\t.then((response) => {\n//         console.log('ipfs links');\n//         console.log(response.body)\n// \t\t    console.log(response.body.Objects[0].Links);\n\n//       Object.values(response.body.Objects[0].Links).forEach((item) => {\n//         console.log('item', item);\n//           if(item.Name.includes('.jpg') || item.Name.includes('.jpeg') || item.Name.includes('.png')){\n//              console.log(\"https://\" + item.Hash + \".ipfs.w3s.link/\" + item.Name);\n//             State.update({ipfsLink: \"https://\" + item.Hash + \".ipfs.w3s.link/\" + item.Name})\n//           }\n//         });\n\n//       })\n// \t\t\t.catch((err) => {\n// \t\t\t\tthrow err;\n// \t\t\t});\n\n// \t} catch (err) {\n// \t\treturn null;\n// \t}\n// };\n\n// if(state.ipfsLink == undefined || state.ipfsLink == null){\n//   getLinks(image);\n// }\n\nreturn (\n  <>\n    <Card href={`?tab=post&seriesId=${seriesId}`} key={id}>\n      <Info>\n        {image && (\n          <img\n            className={className}\n            style={style}\n            src={image}\n            alt={\"post image\"}\n          />\n        )}\n        <Title>{title}</Title>\n        <SubTitle>\n          {description.length > MAX_DESCRIPTION_LENGTH\n            ? description.slice(0, MAX_DESCRIPTION_LENGTH) + \"...\"\n            : description}\n        </SubTitle>\n        <Widget\n          src={`${ownerId}/widget/tags`}\n          props={{\n            ...props,\n            tags,\n          }}\n        />\n        <DonationsInfoItem>\n          <Title>Date Taken</Title>\n          <SubTitle>{dateTaken}</SubTitle>\n        </DonationsInfoItem>\n        <DonationsInfoItem>\n          <Title>Location</Title>\n          <SubTitle>{location}</SubTitle>\n        </DonationsInfoItem>\n      </Info>\n\n      <DonationsInfoContainer>\n        <DonationsInfoItem>\n          <Title>{totalDonors || totalDonors === 0 ? totalDonors : \"-\"}</Title>\n          <SubTitle>{totalDonors === 1 ? \"Donor\" : \"Donors\"}</SubTitle>\n        </DonationsInfoItem>\n        <DonationsInfoItem>\n          <Title>\n            {props.nearToUsd ? `$${totalAmount}` : `${totalAmount} N`}\n          </Title>\n          <SubTitle>Raised</SubTitle>\n        </DonationsInfoItem>\n      </DonationsInfoContainer>\n    </Card>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/refoundonbos.near/widget/card", "fact_widget_deployments_id": "8a7bc3360ea5248bfd0331c1c6a6ccc6", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 21}
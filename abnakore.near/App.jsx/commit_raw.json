{"tx_hash": "78oHLCw9M7Nm9JhupitbrgWmRbcDhuDgiYw8YQj8vP1m", "action_id_social": "BcPNSe4E4jfN5ubaQvG8aUi2ywburaZoBHWjGn7it36g-0-widget", "block_id": 107762618, "block_timestamp": "2023-12-12T13:21:16.257Z", "signer_id": "abnakore.near", "widget_name": "App.jsx", "source_code": "const [candidate, setCandidate] = useState(0);\nconst [candidates, setCandidates] = useState([\n  { id: 1, name: \"Foo\", votes: 3, rank: 2 },\n  { id: 2, name: \"Bar\", votes: 5, rank: 1 },\n  { id: 3, name: \"Baz\", votes: 1, rank: 4 },\n  { id: 4, name: \"sass\", votes: 2, rank: 3 },\n]);\nconst [state, setState] = useState({\n  show_message: false,\n  show_error_on_dropdown: false,\n});\n\n// Pages that will be displayed in the aside\nconst [pages, setPages] = useState([\n  { name: \"Voting Page\", link: \"/\" },\n  { name: \"Result\", link: \"/result\" },\n  { name: \"Log out\", link: \"/signin\" },\n]);\n\n// Users tht already voted\nconst [voted, setVoted] = useState([1]);\n\n// Functions\nfunction vote() {\n  if (candidate > 0) {\n    // console.log(context.accountId);\n    // console.log(voted);\n    // setCandidates([...candidates]);\n    setState({\n      ...state,\n      show_message: true,\n    });\n    setVoted((prev) => prev.concat([context.accountId]));\n  } else {\n    // Set an error on the dropdown\n    setState({\n      ...state,\n      show_error_on_dropdown: true,\n    });\n  }\n}\n\n// Update the value of the dropdown when changed\nfunction updateDropdown(e) {\n  setCandidate(e.target.value);\n  // Remove the error on the dropdown\n  setState({\n    ...state,\n    show_error_on_dropdown: false,\n  });\n}\n\nconst accountId = context.accountId;\n\nreturn accountId ? (\n  <Widget\n    src=\"abnakore.near/widget/Wrapper.jsx\"\n    props={{\n      body: (\n        <>\n          <div className=\"two-sides\">\n            {/* The Aside bar that helps in quick navigation btw pages */}\n            <Widget\n              src=\"abnakore.near/widget/Aside.jsx\"\n              props={{ objs: pages, active: \"/\" }}\n            />\n\n            <div className=\"main-body\">\n              <h1>VoteChain</h1>\n              <p\n                style={{\n                  color: \"green\",\n                  display: voted.includes(context.accountId) ? \"block\" : \"none\",\n                }}\n              >\n                You Have Succesfully Voted\n              </p>\n              <div className=\"card\">\n                <div>\n                  <select\n                    disabled={voted.includes(context.accountId) ? true : false}\n                    className={`drop-down ${\n                      state.show_error_on_dropdown ? \"error\" : \"\"\n                    }`}\n                    value={candidate}\n                    onChange={updateDropdown}\n                    name=\"candidate\"\n                    required\n                  >\n                    <option className=\"option\" value={0}>\n                      Select Candidate\n                    </option>\n                    {candidates.map((candidate) => (\n                      <option\n                        className=\"option\"\n                        key={candidate.id}\n                        value={candidate.id}\n                      >\n                        {candidate.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <button\n                  disabled={voted.includes(context.accountId) ? true : false}\n                  onClick={vote}\n                >\n                  Vote\n                </button>\n\n                <p\n                  id=\"thanks\"\n                  className={`read-the-docs ${\n                    state.show_message ? \"\" : \"hide\"\n                  }`}\n                >\n                  Thank you for voting {candidate}\n                </p>\n              </div>\n              <p className=\"read-the-docs\">\n                <Link to=\"/register\">Register</Link>\n                .....\n                <Link to=\"/signin\">Sign In</Link>\n              </p>\n            </div>\n          </div>\n        </>\n      ),\n    }}\n  />\n) : (\n  window.location.href(\n    \"https://near.org/sandbox#/abnakore.near/widget/SignIn.jsx\"\n  )\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/abnakore.near/widget/App.jsx", "fact_widget_deployments_id": "c3efa42f554eb198234705d4cdcf1ebe", "inserted_timestamp": "2023-12-12T15:22:39.780Z", "modified_timestamp": "2023-12-20T03:22:11.422Z", "__row_index": 7}
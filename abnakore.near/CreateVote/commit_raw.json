{"tx_hash": "62nfQfx9oef2Zsg9mEYULYn2prHc8B97qiC3xNjkQMfJ", "action_id_social": "GcB5ZUJDWPYh8ByxXsggcbMxZUWbLW8AY7kebXCeKsZJ-0-widget", "block_id": 108949452, "block_timestamp": "2023-12-27T19:07:51.241Z", "signer_id": "abnakore.near", "widget_name": "CreateVote", "source_code": "// Get accountId\nconst accountId = context.accountId;\n\n// New Vote\nconst [newVote, setNewVote] = useState({\n  name: \"\",\n  desc: \"\",\n  role: \"\",\n  creator: \"\",\n  openDate: \"\",\n  closeDate: \"\",\n  opened: true,\n  passcode: null,\n  candidates: [],\n  parties: [],\n});\n\n// Parties\nconst [parties, setParties] = useState([]);\n\n// New Party\nconst [newParty, setNewParty] = useState({\n  name: \"\",\n  acronym: \"\",\n});\n\n// candidates\nconst [candidates, setCandidates] = useState([[]]);\n\n// New Candidate\nconst [newCandidate, setNewCandidate] = useState({\n  name: \"\",\n  party: \"\",\n  role: \"\",\n  votes: 0,\n});\n\n// Add the new party to the table\nfunction AddParty() {\n  // Check if the data given is valid\n  console.log(parties);\n\n  if (newParty.name !== \"\" && newParty.acronym !== \"\") {\n    // check for no similar name or acronym\n    if (JSON.stringify(parties) !== JSON.stringify([])) {\n      const filtered = parties.filter((party) => {\n        console.log(party);\n        return (\n          party.name.toLowerCase() === newParty.name.toLowerCase() ||\n          party.acronym.toLowerCase() === newParty.acronym.toLowerCase()\n        );\n      });\n      if (filtered.length > 0) {\n        return;\n      }\n    }\n\n    // Check for three letters of the acronym\n    if (newParty.acronym.length <= 4 && newParty.acronym.length > 0) {\n      setParties((prev) =>\n        prev.concat([{ ...newParty, acronym: newParty.acronym.toUpperCase() }])\n      );\n      setNewParty({ name: \"\", acronym: \"\" });\n    }\n  }\n}\n\n// Add the new party to the table\nfunction AddCandidate() {\n  // Check if the data given is valid\n  console.log(candidates);\n\n  if (newCandidate.name !== \"\" && newCandidate.party !== \"\") {\n    // check for no similar name or acronym\n    if (JSON.stringify(parties) !== JSON.stringify([])) {\n      const filtered = parties.filter((party) => {\n        console.log(party);\n        return (\n          party.name.toLowerCase() === newParty.name.toLowerCase() ||\n          party.acronym.toLowerCase() === newParty.acronym.toLowerCase()\n        );\n      });\n      if (filtered.length > 0) {\n        return;\n      }\n    }\n\n    // Check for three letters of the acronym\n    if (newParty.acronym.length <= 4 && newParty.acronym.length > 0) {\n      setParties((prev) =>\n        prev.concat([{ ...newParty, acronym: newParty.acronym.toUpperCase() }])\n      );\n      setNewParty({ name: \"\", acronym: \"\" });\n    }\n  }\n}\n\n// Update the value of the dropdown\nfunction updateDropDown(e) {\n  console.log(e.target.value);\n  setTest(e.target.value);\n  setNewCandidate((prev) => ({ ...prev, party: e.target.value }));\n}\n\n// for test\nconst [test, setTest] = useState(\"E\");\n\nconst secText = styled.h5`\n    text-align: center;\n`;\n\nreturn (\n  <>\n    {accountId ? (\n      <Widget\n        src=\"abnakore.near/widget/Wrapper\"\n        props={{\n          body: (\n            <div className=\"main-body\">\n              <div className=\"body-contents\">\n                <h1>Create</h1>\n                <div className=\"form\">\n                  <Widget\n                    src=\"abnakore.near/widget/Input.jsx\"\n                    props={{\n                      type: \"text\",\n                      placeholder: \"Name / Title\",\n                      required: true,\n                      item: \"name\",\n                      items: newVote,\n                      setItem: setNewVote,\n                    }}\n                  />\n\n                  <Widget\n                    src=\"abnakore.near/widget/Input.jsx\"\n                    props={{\n                      type: \"text\",\n                      placeholder: \"Description\",\n                      required: true,\n                      kind: \"textarea\",\n                      item: \"desc\",\n                      items: newVote,\n                      setItem: setNewVote,\n                    }}\n                  />\n                  <hr />\n\n                  <secText>Parties Section</secText>\n                  <Widget\n                    src=\"abnakore.near/widget/Table\"\n                    props={{\n                      headings: [\"S/N\", \"Party Name\", \"Acronym\"],\n                      data: parties.map((p, i) =>\n                        [i + 1].concat(Object.values(p))\n                      ),\n                    }}\n                  />\n                  <div className=\"form\">\n                    <secText>Add Party</secText>\n                    <div className=\"flex\">\n                      <Widget\n                        src=\"abnakore.near/widget/Input.jsx\"\n                        props={{\n                          type: \"text\",\n                          placeholder: \"Party Name\",\n                          required: true,\n                          item: \"name\",\n                          items: newParty,\n                          setItem: setNewParty,\n                        }}\n                      />\n                      <Widget\n                        src=\"abnakore.near/widget/Input.jsx\"\n                        props={{\n                          type: \"text\",\n                          placeholder: \"Acronym\",\n                          required: true,\n                          item: \"acronym\",\n                          items: newParty,\n                          setItem: setNewParty,\n                        }}\n                      />\n                    </div>\n                    <button onClick={AddParty}>Add</button>\n                  </div>\n                  <hr />\n\n                  <secText>Candidates Section</secText>\n                  {/* newCandidate.party */}\n                  <Widget\n                    src=\"abnakore.near/widget/Table\"\n                    props={{\n                      headings: [\"S/N\", \"Candidate's Name\", \"Party\"],\n                      data: candidates.map((p, i) =>\n                        [i + 1].concat(Object.values(p))\n                      ),\n                    }}\n                  />\n                  <div className=\"form\">\n                    <secText>Add Candidate</secText>\n                    <div className=\"flex\">\n                      <Widget\n                        src=\"abnakore.near/widget/Input.jsx\"\n                        props={{\n                          type: \"text\",\n                          placeholder: \"Candidate's Name\",\n                          required: true,\n                          item: \"name\",\n                          items: newCandidate,\n                          setItem: setNewCandidate,\n                        }}\n                      />\n                      <select\n                        className=\"drop-down\"\n                        value={newCandidate.party}\n                        onChange={updateDropDown}\n                        name=\"party\"\n                        required\n                      >\n                        <option className=\"option\" value=\"\">\n                          Select Party\n                        </option>\n                        <option className=\"option\" value=\"1\">\n                          1\n                        </option>\n                        {parties.map((party) => (\n                          <option\n                            className=\"option\"\n                            key={party.acronym}\n                            value={party.acronym}\n                          >\n                            {party.name}\n                          </option>\n                        ))}\n                      </select>\n\n                      <Widget\n                        src=\"abnakore.near/widget/Input.jsx\"\n                        props={{\n                          type: \"text\",\n                          placeholder: \"party\",\n                          required: true,\n                          item: \"party\",\n                          items: newCandidate,\n                          setItem: setNewCandidate,\n                        }}\n                      />\n                    </div>\n                    <button>Add</button>\n                  </div>\n\n                  <Widget\n                    src=\"abnakore.near/widget/Input.jsx\"\n                    props={{\n                      type: \"password\",\n                      placeholder: \"Passcode\",\n                      required: false,\n                      item: \"party\",\n                      items: newCandidate,\n                      setItem: setNewCandidate,\n                    }}\n                  />\n                  <Widget\n                    src=\"abnakore.near/widget/Input.jsx\"\n                    props={{\n                      type: \"text\",\n                      placeholder: \"Role\",\n                      required: true,\n                      item: \"party\",\n                      items: newCandidate,\n                      setItem: setNewCandidate,\n                    }}\n                  />\n                  <Widget\n                    src=\"abnakore.near/widget/Input.jsx\"\n                    props={{\n                      type: \"date\",\n                      placeholder: \"Open on\",\n                      required: false,\n                      item: \"party\",\n                      items: newCandidate,\n                      setItem: setNewCandidate,\n                    }}\n                  />\n                  <Widget\n                    src=\"abnakore.near/widget/Input.jsx\"\n                    props={{\n                      type: \"date\",\n                      placeholder: \"Close on\",\n                      required: false,\n                      item: \"party\",\n                      items: newCandidate,\n                      setItem: setNewCandidate,\n                    }}\n                  />\n                  <button>Submit</button>\n                </div>\n              </div>\n            </div>\n          ),\n        }}\n      />\n    ) : (\n      <Widget src=\"abnakore.near/widget/SignIn.jsx\" props={props} />\n    )}\n  </>\n);\n\n// // Get accountId\n// const accountId = context.accountId;\n\n// return (\n//   <>\n//     {accountId ? (\n//       <Widget\n//         src=\"abnakore.near/widget/Wrapper\"\n//         props={{\n//           body: (\n//             <div className=\"main-body\">\n//               <div className=\"body-contents\">\n//                 <h1>____</h1>\n//               </div>\n//             </div>\n//           ),\n//         }}\n//       />\n//     ) : (\n//       <Widget src=\"abnakore.near/widget/SignIn.jsx\" props={props} />\n//     )}\n//   </>\n// );\n", "metadata": {"fork_of": "abnakore.near/widget/CreateVote@108742089"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/abnakore.near/widget/CreateVote", "fact_widget_deployments_id": "2c37825194254b2709dc56c3f812ba08", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 6}
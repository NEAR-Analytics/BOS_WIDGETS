{"tx_hash": "9Q65Bk55ezxefg3Fiu78CxqBf1TNju6XJtCGzmedMqv8", "action_id_social": "6h6uWvWC3HYr4Z9nGF3oAFoCNMkWWJvKs1jr54M7UecL-0-widget", "block_id": 110746206, "block_timestamp": "2024-01-18T22:47:11.385Z", "signer_id": "abnakore.near", "widget_name": "AdminHome", "source_code": "// Get the user's accountId\nconst accountId = context.accountId;\n\n// Declaring variables\n// !!!\nconst voteId = props.vote && props.vote;\n// const voteId = 0;\n\n// All the votes\nconst [allVotes, setAllVotes] = useState([]);\nconst [voteToRender, setVoteToRender] = useState([]);\n\n// Get all the votes\nconst votesData = Social.get(`abnakore.near/votes`);\nuseEffect(() => {\n  if (votesData === undefined) {\n    // Set the votes to an empty list if there is no votes\n    setAllVotes([]);\n  } else {\n    setAllVotes(JSON.parse(votesData));\n  }\n  setVoteToRender(allVotes[voteId]);\n}, [votesData === null]);\n\n// Set the vote to be rendered\nuseEffect(() => {\n  setVoteToRender(allVotes[voteId]);\n}, [allVotes]);\n\n// Pages that can be reached via the aside tab\nconst [pages, setPages] = useState([\n  {\n    name: \"Voting Page\",\n    link: `https://near.org/abnakore.near/widget/App.jsx?vote=${voteToRender.id}`,\n  },\n  {\n    name: \"Result\",\n    link: `https://near.org/abnakore.near/widget/Result.jsx?vote=${voteToRender.id}`,\n  },\n]);\n\n// Add admin pages if the user is the creator of the vote\nuseEffect(() => {\n  if (voteToRender.creator === accountId) {\n    setPages([\n      {\n        name: \"Voting Page\",\n        link: `https://near.org/abnakore.near/widget/App.jsx?vote=${voteToRender.id}`,\n      },\n      {\n        name: \"Result\",\n        link: `https://near.org/abnakore.near/widget/Result.jsx?vote=${voteToRender.id}`,\n      },\n      {\n        name: \"Admin Home\",\n        link: `https://near.org/abnakore.near/widget/AdminHome?vote=${voteToRender.id}`,\n      },\n      {\n        name: \"Manage Candidates\",\n        link: `https://near.org/abnakore.near/widget/ManageCandidates?vote=${voteToRender.id}`,\n      },\n      {\n        name: \"Mange Parties\",\n        link: `https://near.org/abnakore.near/widget/ManageParties?vote=${voteToRender.id}`,\n      },\n    ]);\n  } else {\n    setPages([\n      {\n        name: \"Voting Page\",\n        link: `https://near.org/abnakore.near/widget/App.jsx?vote=${voteToRender.id}`,\n      },\n      {\n        name: \"Result\",\n        link: `https://near.org/abnakore.near/widget/Result.jsx?vote=${voteToRender.id}`,\n      },\n    ]);\n  }\n}, [voteToRender.creator === accountId]);\n\n// List of parties and their curresponding number of votes\nconst [parties, setParties] = useState([\n  { id: 1, name: \"Foo\", acronym: \"FOO\" },\n  { id: 2, name: \"Bar\", acronym: \"BAR\" },\n  { id: 3, name: \"Baz\", acronym: \"BAZ\" },\n  { id: 4, name: \"sass\", acronym: \"SAS\" },\n]);\n\n// List of candidates and their curresponding number of votes\nconst [candidates, setCandidates] = useState([\n  {\n    id: 1,\n    name: \"Foo\",\n    party: \"APD\",\n    email: \"example@gmail.com\",\n    role: \"President\",\n    votes: 3,\n    rank: 2,\n  },\n  {\n    id: 2,\n    name: \"Bar\",\n    party: \"YMB\",\n    email: \"example@gmail.com\",\n    role: \"President\",\n    votes: 5,\n    rank: 1,\n  },\n  {\n    id: 3,\n    name: \"Baz\",\n    party: \"AAN\",\n    email: \"example@gmail.com\",\n    role: \"President\",\n    votes: 1,\n    rank: 4,\n  },\n  {\n    id: 4,\n    name: \"sass\",\n    party: \"AKA\",\n    email: \"example@gmail.com\",\n    role: \"President\",\n    votes: 2,\n    rank: 3,\n  },\n]);\n\nreturn (\n  <>\n    {accountId ? (\n      <Widget\n        src=\"abnakore.near/widget/Wrapper\"\n        props={{\n          body: (\n            <div className=\"main-body\">\n              {voteToRender ? (\n                <div className=\"two-sides\">\n                  <Widget\n                    src=\"abnakore.near/widget/Aside\"\n                    props={{ objs: pages, active: \"/admin\" }}\n                  />\n                  <div className=\"body-contents\">\n                    <h1>Admin Home</h1>\n                    <h4>Candidates Details</h4>\n                    <Widget\n                      src=\"abnakore.near/widget/Table\"\n                      props={{\n                        headings: [\n                          \"S/N\",\n                          \"Candidate's Name\",\n                          \"Party\",\n                          \"Role\",\n                          \"Number of votes\",\n                        ],\n                        data: Object.values(\n                          voteToRender.candidates\n                            .sort((a, b) => a.votes - b.votes)\n                            .map((c, i) => [i + 1].concat(Object.values(c)))\n                        ),\n                      }}\n                    />\n\n                    <a\n                      href={`https://near.org/abnakore.near/widget/ManageCandidates?vote=${voteToRender.id}`}\n                    >\n                      <button>Add Candidate</button>\n                    </a>\n                    <hr />\n                    <h4>Parties Details</h4>\n                    <Widget\n                      src=\"abnakore.near/widget/Table\"\n                      props={{\n                        headings: [\"S/N\", \"Party Name\", \"Acronym\"],\n                        data: Object.values(\n                          voteToRender.parties.map((c, i) =>\n                            [i + 1].concat(Object.values(c))\n                          )\n                        ),\n                      }}\n                    />\n\n                    <a\n                      href={`https://near.org/abnakore.near/widget/ManageParties?vote=${voteToRender.id}`}\n                    >\n                      <button>Add Party</button>\n                    </a>\n                    <hr />\n                  </div>\n                </div>\n              ) : (\n                <div className=\"body-contents\">\n                  <h1>Vote Doesn't exist</h1>\n                </div>\n              )}\n            </div>\n          ),\n        }}\n      />\n    ) : (\n      <Widget src=\"abnakore.near/widget/SignIn.jsx\" />\n    )}\n  </>\n);\n", "metadata": {"fork_of": "abnakore.near/widget/AdminHome@110656160"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/abnakore.near/widget/AdminHome", "fact_widget_deployments_id": "074d9fa967a97f383d196cad0b05eeff", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 3}
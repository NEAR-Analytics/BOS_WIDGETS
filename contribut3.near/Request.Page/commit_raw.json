{"tx_hash": "DN9ZtNwhYmXoiKMBCt98otBMu3zCmkMJ8tG4BeQp5LAd", "action_id_social": "4yECXNwZceU4YNiPnPvpHgVGRz3V61pfXd6QxyoGPmhX-0-widget", "block_id": 97453989, "block_timestamp": "2023-07-27T12:51:29.467Z", "signer_id": "contribut3.near", "widget_name": "Request.Page", "source_code": "const ownerId = \"contribut3.near\";\nconst accountId = props.accountId ?? context.accountId;\nconst cid = props.cid;\n\nconst availableContent = [\"overview\", \"invitations\", \"proposals\"];\n\nconst getContent = (content) => {\n  if (!content || !availableContent.includes(content)) {\n    return \"overview\";\n  }\n\n  return content;\n};\n\nState.init({\n  request: null,\n  requestIsFetched: false,\n  isAdmin: false,\n  isAdminIsFetched: false,\n});\n\nif (!state.requestIsFetched) {\n  Near.asyncView(\n    ownerId,\n    \"get_request\",\n    { account_id: accountId, cid },\n    \"final\",\n    false\n  ).then((request) => State.update({ request, requestIsFetched: true }));\n}\n\nif (!state.isAdminIsFetched) {\n  if (!context.accountId) {\n    State.update({ isAdmin: false, isAdminIsFetched: true });\n  } else {\n    Near.asyncView(\n      ownerId,\n      \"check_is_project_admin\",\n      { project_id: accountId, account_id: context.accountId },\n      \"final\",\n      false\n    ).then((isAdmin) => State.update({ isAdmin, isAdminIsFetched: true }));\n  }\n}\n\nif (!state.requestIsFetched || !state.isAdminIsFetched) {\n  return <>Loading...</>;\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 1em;\n  width: 100%;\n`;\n\nconst HeaderDetails = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 100%;\n`;\n\nconst ContentContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 100%;\n`;\n\nconst MainContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 100%;\n  padding-top: 0.25em;\n`;\n\nconst circledPlus = (\n  <svg\n    width=\"18\"\n    height=\"18\"\n    viewBox=\"0 0 18 18\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <g clip-path=\"url(#clip0_1624_38049)\">\n      <path\n        d=\"M9 6V12M6 9H12M16.5 9C16.5 13.1421 13.1421 16.5 9 16.5C4.85786 16.5 1.5 13.1421 1.5 9C1.5 4.85786 4.85786 1.5 9 1.5C13.1421 1.5 16.5 4.85786 16.5 9Z\"\n        stroke=\"currentColor\"\n        stroke-width=\"1.66667\"\n        stroke-linecap=\"round\"\n        stroke-linejoin=\"round\"\n      />\n    </g>\n    <defs>\n      <clipPath id=\"clip0_1624_38049\">\n        <rect width=\"18\" height=\"18\" fill=\"white\" />\n      </clipPath>\n    </defs>\n  </svg>\n);\n\nconst personPlus = (\n  <svg\n    width=\"18\"\n    height=\"16\"\n    viewBox=\"0 0 18 16\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      d=\"M12 3.5L14.25 1.25M14.25 1.25L16.5 3.5M14.25 1.25V5.75M12 14.75V13.85C12 12.5899 12 11.9598 11.7548 11.4785C11.539 11.0552 11.1948 10.711 10.7715 10.4952C10.2902 10.25 9.66012 10.25 8.4 10.25H5.1C3.83988 10.25 3.20982 10.25 2.72852 10.4952C2.30516 10.711 1.96095 11.0552 1.74524 11.4785C1.5 11.9598 1.5 12.5899 1.5 13.85V14.75M9.375 4.625C9.375 6.07475 8.19975 7.25 6.75 7.25C5.30025 7.25 4.125 6.07475 4.125 4.625C4.125 3.17525 5.30025 2 6.75 2C8.19975 2 9.375 3.17525 9.375 4.625Z\"\n      stroke=\"#006ADC\"\n      stroke-width=\"1.66667\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n  </svg>\n);\n\nconst plus = (\n  <svg\n    width=\"18\"\n    height=\"18\"\n    viewBox=\"0 0 18 18\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      d=\"M9 3.75V14.25M3.75 9H14.25\"\n      stroke=\"#006ADC\"\n      stroke-width=\"1.66667\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n  </svg>\n);\n\nconst CTARow = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 0.75em;\n  margin-top: 1em;\n  flex-wrap: wrap;\n`;\n\nconst Heading = styled.div`\n  padding-bottom: 0.5em;\n  font-style: normal;\n  font-weight: 700;\n  font-size: 1.125em;\n  line-height: 1.5em;\n  color: #000;\n  width: 100%;\n`;\n\nconst contentMap = {\n  overview: \"About\",\n  invitations: \"Invitations\",\n  proposals: \"ProposalList\",\n}[getContent(props.content)];\n\nconst content = (\n  <Widget\n    src={`${ownerId}/widget/Request.${contentMap}`}\n    props={{\n      accountId,\n      cid,\n      isAdmin: state.isAdmin,\n    }}\n  />\n);\n\nconst Separator = styled(\"Separator.Root\")`\n  height: 1px;\n  width: 100%;\n  background: #eceef0;\n`;\n\nconst Button = styled.button`\n  display: flex;\n  height: 2.5rem;\n  padding: 0.5rem 1rem;\n  justify-content: center;\n  align-items: center;\n  gap: 0.5rem;\n  border-radius: 3.125rem;\n  border: 1px solid var(--ui-elements-light, #eceef0);\n  background: var(--background-light, #fafafa);\n  color: var(--error-error-default, #f44738);\n  text-align: center;\n  font-family: \"Mona Sans\";\n  font-size: 0.875rem;\n  font-style: normal;\n  font-weight: 600;\n  line-height: 142%; /* 1.2425rem */\n`;\n\nreturn (\n  <Container>\n    <Header>\n      <HeaderDetails>\n        <Widget\n          src={`${ownerId}/widget/Request.HeaderDetails`}\n          props={{ accountId, cid, isAdmin: state.isAdmin }}\n        />\n        <CTARow>\n          {state.isAdmin ? (\n            <>\n              <Widget\n                src={`${ownerId}/widget/Request.EditSideWindow`}\n                props={{ accountId, cid }}\n              />\n              <Button\n                onClick={() => {\n                  Near.call(ownerId, \"edit_request\", {\n                    cid: props.cid,\n                    request: {\n                      ...state.request,\n                      open: false,\n                    },\n                  });\n                }}\n              >\n                Close request\n              </Button>\n            </>\n          ) : (\n            <Widget\n              src={`${ownerId}/widget/Request.ProposeSideWindow`}\n              props={{ accountId, cid }}\n            />\n          )}\n          <Widget\n            src={`${ownerId}/widget/Buttons.Grey`}\n            props={{\n              onClick: () => {\n                clipboard.writeText(\n                  `https://near.org/${ownerId}/widget/Index?tab=request&accountId=${accountId}&cid=${cid}`\n                );\n              },\n              text: (\n                <>\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    width=\"18\"\n                    height=\"18\"\n                    viewBox=\"0 0 18 18\"\n                    fill=\"none\"\n                  >\n                    <path\n                      d=\"M15.5935 9.45565C15.7766 9.29872 15.8682 9.22025 15.9017 9.12687C15.9311 9.04492 15.9311 8.95527 15.9017 8.87332C15.8682 8.77995 15.7766 8.70148 15.5935 8.54454L9.24047 3.09908C8.9253 2.82893 8.76772 2.69385 8.6343 2.69055C8.51835 2.68767 8.40759 2.73861 8.33432 2.82852C8.25 2.93197 8.25 3.13952 8.25 3.55463V6.77607C6.64899 7.05616 5.1837 7.86741 4.09478 9.0855C2.90762 10.4135 2.25093 12.1321 2.25 13.9133V14.3723C3.03701 13.4242 4.01963 12.6575 5.13057 12.1245C6.11002 11.6547 7.16881 11.3763 8.25 11.303V14.4456C8.25 14.8607 8.25 15.0682 8.33432 15.1717C8.40759 15.2616 8.51835 15.3125 8.6343 15.3096C8.76772 15.3063 8.9253 15.1713 9.24047 14.9011L15.5935 9.45565Z\"\n                      stroke=\"currentColor\"\n                      stroke-width=\"1.66667\"\n                      stroke-linecap=\"round\"\n                      stroke-linejoin=\"round\"\n                    />\n                  </svg>\n                  Share\n                </>\n              ),\n            }}\n          />\n        </CTARow>\n      </HeaderDetails>\n    </Header>\n    <ContentContainer>\n      <MainContent>\n        {state.isAdmin ? (\n          <Widget\n            src={`${ownerId}/widget/TabSelector`}\n            props={{\n              tab: \"request\",\n              content: getContent(props.content),\n              search: props.search,\n              update: props.update,\n              accountId: props.accountId,\n              cid,\n              buttons: [\n                {\n                  id: \"overview\",\n                  text: \"Overview\",\n                },\n                {\n                  id: \"invitations\",\n                  text: \"Invitations\",\n                },\n                {\n                  id: \"proposals\",\n                  text: \"Proposals\",\n                },\n              ],\n            }}\n          />\n        ) : (\n          <Separator />\n        )}\n        {content}\n      </MainContent>\n    </ContentContainer>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/Request.Page", "fact_widget_deployments_id": "0d11712329aae40632acf9fb995da1f2", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
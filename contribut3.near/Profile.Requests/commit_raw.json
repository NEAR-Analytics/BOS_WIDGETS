{"tx_hash": "GQrXCqNiWkEvEtd4GuhYnmBCx4FQzxsbuUwUWkZCfQk5", "action_id_social": "4657UwnctVpx9XdMYa7RmTr2rinobbZAQzwxDgHvjezd-0-widget", "block_id": 100964391, "block_timestamp": "2023-09-12T14:16:02.614Z", "signer_id": "contribut3.near", "widget_name": "Profile.Requests", "source_code": "const ownerId = \"contribut3.near\";\nconst apiUrl = \"https://api-staging-fur7.onrender.com\";\n\nconst Button = styled.button`\n  display: flex;\n  height: 2.5rem;\n  padding: 0.5rem 1rem;\n  justify-content: center;\n  align-items: center;\n  gap: 0.5rem;\n  border-radius: 3.125rem;\n  border: 1px solid var(--ui-elements-light, #eceef0);\n  background: var(--background-light, #fafafa);\n  color: var(--text-text-primary, #101828);\n  text-align: center;\n  font-family: Inter;\n  font-size: 0.875rem;\n  font-style: normal;\n  font-weight: 600;\n  line-height: 142%; /* 1.2425rem */\n  letter-spacing: 0.00875rem;\n\n  &.green {\n    border-radius: 3.125rem;\n    border: 1px solid var(--primary-primary-default, #00ec97);\n    background: var(--primary-primary-default, #00ec97);\n  }\n`;\n\nconst Centered = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  gap: 0.75rem;\n  height: 100%;\n  width: 100%;\n\n  & > h5 {\n    color: var(--ui-elements-dark, #11181c);\n    text-align: center;\n    font-family: Inter;\n    font-size: 1rem;\n    font-style: normal;\n    font-weight: 600;\n    line-height: 140%; /* 1.4rem */\n  }\n\n  & > p {\n    color: var(--ui-elements-gray, #7e868c);\n    text-align: center;\n    font-family: \"Mona Sans\";\n    font-size: 0.875rem;\n    font-style: normal;\n    font-weight: 400;\n    line-height: 140%; /* 1.225rem */\n  }\n`;\n\nState.init({\n  requests: [],\n  requestsIsFetched: false,\n});\n\nif (!state.requestsIsFetched) {\n  asyncFetch(`${apiUrl}/transactions/all`).then(({ body: txs }) => {\n    Near.asyncView(\n      ownerId,\n      \"get_project_requests\",\n      { account_id: context.accountId },\n      \"final\",\n      false,\n    ).then((requests) => {\n      txs = txs.filter(\n        ({ method_name, args }) =>\n          method_name === \"add_request\" &&\n          args.request.project_id === context.accountId,\n      );\n\n      const requestsWithTxs = requests.map(([project_id, cid]) => {\n        const tx = txs.find((tx) => {\n          const start = \"EVENT_JSON:\";\n          const logData = JSON.parse(tx.log.substring(start.length)).data;\n\n          return (\n            logData.cid === cid &&\n            tx.method_name === \"add_request\" &&\n            tx.args.request.project_id === project_id\n          );\n        });\n\n        return [project_id, cid, tx];\n      });\n      State.update({ requests: requestsWithTxs, requestsIsFetched: true });\n    });\n  });\n}\n\nreturn (\n  <Centered>\n    {!state.requestsIsFetched ? (\n      \"Loading...\"\n    ) : state.requests.length === 0 ? (\n      <>\n        <h5>You haven't created any requests yet</h5>\n        <p>\n          Requests are a way to express your project needs and find an expert to\n          help you\n        </p>\n        <Button className=\"green\">\n          <svg\n            width=\"19\"\n            height=\"18\"\n            viewBox=\"0 0 19 18\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M9.5 3.75V14.25M4.25 9H14.75\"\n              stroke=\"currentColor\"\n              stroke-width=\"1.66667\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n            />\n          </svg>\n          Create a request\n        </Button>\n      </>\n    ) : (\n      state.requests.map((request) => request.toString())\n    )}\n  </Centered>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/Profile.Requests", "fact_widget_deployments_id": "0ff2b9527c1a5c249b19fc54e567d457", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
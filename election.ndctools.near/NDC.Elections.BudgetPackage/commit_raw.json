{"tx_hash": "Fu5eARD1p3rtfQCSgNbh3ogMVoXwAgi47QKpwjKiVBkB", "action_id_social": "ULPeMevsEgCzM6q3f9anFZXQnb2JSwjJcFsoguJzHEV-0-widget", "block_id": 99175156, "block_timestamp": "2023-08-19T15:37:41.322Z", "signer_id": "election.ndctools.near", "widget_name": "NDC.Elections.BudgetPackage", "source_code": "const {\n  id,\n  typ,\n  seats,\n  electionContract,\n  registryContract,\n  isIAmHuman,\n  myVotes,\n} = props;\n\nconst widgets = {\n  styledComponents: \"nomination.ndctools.near/widget/NDC.StyledComponents\",\n  verifyHuman: \"nomination.ndctools.near/widget/NDC.VerifyHuman\",\n};\n\nconst H4 = styled.h4`\n  margin-bottom: 0;\n`;\n\nconst H3 = styled.h3`\n  margin-bottom: 0;\n`;\n\nconst Container = styled.div`\n  position: relative:\n  font-family: Avenir;\n  font-size: 16px;\n`;\n\nconst Info = styled.i`\n  font-size: 12px;\n  margin: 0 !important;\n`;\n\nconst CandidatesContainer = styled.div`\n  overflow-y: scroll;\n  max-height: 490px;\n  width: 100%;\n`;\n\nconst StickyContainer = styled.div`\n  position: \"fixed\",\n  left: 0;\n  bottom: 0;\n  height: 60px;\n  width: 100%;\n`;\n\nconst Icon = styled.i`\n  font-size: 14px;\n`;\n\nconst CastVotesSection = styled.div`\n  background: #fdfeff;\n  box-shadow: 0px 0px 30px rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n\n  @media (max-width: 400px) {\n    flex-direction: column;\n  }\n\n  .wrapper {\n    @media (max-width: 400px) {\n      width: 100%;\n    }\n  }\n\n  button {\n    @media (max-width: 400px) {\n      width: 100%;\n    }\n  }\n\n  h3,\n  h4 {\n    margin: 0 3px;\n  }\n\n  h3 {\n    font-weight: 900;\n  }\n\n  .text-secondary {\n    margin: 0 10px;\n  }\n\n  &.not-verified {\n    h4 {\n      font-size: 16px;\n      margin: 0 0 5px 0;\n      font-weight: 600;\n    }\n\n    h5 {\n      margin: 0;\n      font-size: 12px;\n    }\n  }\n`;\n\nconst Section = styled.div`\n  gap: 8px;\n  margin-bottom: 10px;\n`;\n\nconst ActionSection = styled.div`\n  @media (max-width: 400px) {\n    width: 100%;\n  }\n`;\n\nconst currentUser = context.accountId;\nconst alreadyVotedForHouse = () => myVotes.some((voter) => voter.house === typ);\nconst myVotesForHouse = () => myVotes.filter((vote) => vote.house === typ);\n\nconst handleVote = (value) =>\n  Near.call(\n    electionContract,\n    \"vote\",\n    { prop_id: id },\n    \"70000000000000\",\n    2000000000000000000000\n  );\n\nState.init({\n  availableVotes: seats - myVotesForHouse().length,\n});\n\nconst CastVotes = () => (\n  <CastVotesSection className=\"d-flex align-items-center justify-content-between gap-3\">\n    <div className=\"wrapper\">\n      <div className=\"d-flex align-items-end\">\n        <H3>{alreadyVotedForHouse() ? 0 : state.availableVotes}</H3>\n        <span>/</span>\n        <H4>{seats}</H4>\n        <span className=\"text-secondary\">votes left</span>\n      </div>\n      <Info className=\"text-secondary\">\n        <i class=\"bi bi-info-circle\"></i>\n        {alreadyVotedForHouse() && (\n          <span>You're already accepted budget package</span>\n        )}\n      </Info>\n    </div>\n    <ActionSection className=\"d-flex gap-2\">\n      <Widget\n        src={widgets.styledComponents}\n        props={{\n          Button: {\n            className: \"primary dark justify-content-center\",\n            icon: <i className=\"bi bi-thumb-up\" />,\n            onClick: () => handleVote(true),\n          },\n        }}\n      />\n      <Widget\n        src={widgets.styledComponents}\n        props={{\n          Button: {\n            className: \"danger dark justify-content-center\",\n            icon: <i className=\"bi bi-thumb-down\" />,\n            onClick: () => handleVote(false),\n          },\n        }}\n      />\n    </ActionSection>\n  </CastVotesSection>\n);\n\nreturn (\n  <Container>\n    <h1>Budget Package</h1>\n    <CandidatesContainer>\n      <object\n        data=\"https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf\"\n        type=\"application/pdf\"\n        width=\"100%\"\n        height=\"100%\"\n        aria-labelledby=\"PDF document\"\n      >\n        <p>\n          Your browser does not support PDFs.\n          <a href=\"https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf\">\n            Download the PDF\n          </a>\n        </p>\n      </object>\n    </CandidatesContainer>\n\n    <div>\n      {isIAmHuman ? (\n        <CastVotes />\n      ) : (\n        <Widget\n          src={widgets.verifyHuman}\n          props={{\n            title: \"Want to vote?\",\n            description: \"Click on Verify as a Human to proceed.\",\n          }}\n        />\n      )}\n    </div>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/election.ndctools.near/widget/NDC.Elections.BudgetPackage", "fact_widget_deployments_id": "cc154acc2e96dbc057beec5b662ee17f", "inserted_timestamp": "2023-08-19T17:31:45.101Z", "modified_timestamp": "2023-08-19T17:31:45.101Z", "__row_index": 2}
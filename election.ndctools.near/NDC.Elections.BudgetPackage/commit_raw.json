{"tx_hash": "Bes3qbJn8XwvH38nGghLHscYfMPZ8wCxaLaq1HiSt2T4", "action_id_social": "A5x1Jp9gEdbTfh3f6fEs5iuu1CAPEunjzzu5KQgrr8Hn-0-widget", "block_id": 99847452, "block_timestamp": "2023-08-28T11:02:15.748Z", "signer_id": "election.ndctools.near", "widget_name": "NDC.Elections.BudgetPackage", "source_code": "const {\n  id,\n  typ,\n  seats,\n  electionContract,\n  registryContract,\n  isIAmHuman,\n  myVotes,\n} = props;\n\nconst widgets = {\n  styledComponents: \"nomination.ndctools.near/widget/NDC.StyledComponents\",\n  verifyHuman: \"nomination.ndctools.near/widget/NDC.VerifyHuman\",\n};\n\nconst H4 = styled.h4`\n  margin-bottom: 0;\n`;\n\nconst H3 = styled.h3`\n  margin-bottom: 0;\n`;\n\nconst Container = styled.div`\n  position: relative:\n  font-family: Avenir;\n  font-size: 16px;\n`;\n\nconst Info = styled.i`\n  font-size: 12px;\n  margin: 0 !important;\n`;\n\nconst CandidatesContainer = styled.div`\n  overflow-y: scroll;\n  max-height: 490px;\n  width: 100%;\n`;\n\nconst StickyContainer = styled.div`\n  position: \"fixed\",\n  left: 0;\n  bottom: 0;\n  height: 60px;\n  width: 100%;\n`;\n\nconst Icon = styled.i`\n  font-size: 14px;\n`;\n\nconst CastVotesSection = styled.div`\n  background: #fdfeff;\n  box-shadow: 0px 0px 30px rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n\n  @media (max-width: 400px) {\n    flex-direction: column;\n  }\n\n  .wrapper {\n    @media (max-width: 400px) {\n      width: 100%;\n    }\n  }\n\n  button {\n    @media (max-width: 400px) {\n      width: 100%;\n    }\n  }\n\n  h3,\n  h4 {\n    margin: 0 3px;\n  }\n\n  h3 {\n    font-weight: 900;\n  }\n\n  .text-secondary {\n    margin: 0 10px;\n  }\n\n  &.not-verified {\n    h4 {\n      font-size: 16px;\n      margin: 0 0 5px 0;\n      font-weight: 600;\n    }\n\n    h5 {\n      margin: 0;\n      font-size: 12px;\n    }\n  }\n`;\n\nconst Section = styled.div`\n  gap: 8px;\n  margin-bottom: 10px;\n`;\n\nconst ActionSection = styled.div`\n  @media (max-width: 400px) {\n    width: 100%;\n  }\n`;\n\nconst currentUser = context.accountId;\nconst alreadyVotedForHouse = () => myVotes.some((voter) => voter.house === typ);\nconst myVotesForHouse = () => myVotes.filter((vote) => vote.house === typ);\n\nconst handleVote = (value) =>\n  Near.call(electionContract, \"vote\", { prop_id: id, vote: [value] });\n\nState.init({\n  availableVotes: seats - myVotesForHouse().length,\n});\n\nconst CastVotes = () => (\n  <CastVotesSection className=\"d-flex align-items-center justify-content-between gap-3\">\n    <div className=\"wrapper\">\n      <div className=\"d-flex align-items-end\">\n        <H3>{alreadyVotedForHouse() ? 0 : state.availableVotes}</H3>\n        <span>/</span>\n        <H4>{seats}</H4>\n        <span className=\"text-secondary\">votes left</span>\n      </div>\n      <Info className=\"text-secondary\">\n        <i class=\"bi bi-info-circle\"></i>\n        {alreadyVotedForHouse() && (\n          <span>You're already accepted budget package</span>\n        )}\n      </Info>\n    </div>\n    <ActionSection className=\"d-flex gap-2\">\n      <Widget\n        src={widgets.styledComponents}\n        props={{\n          Button: {\n            text: \"Yes\",\n            className: \"primary success justify-content-center\",\n            icon: <i className=\"bi bi-hand-thumbs-up\" />,\n            onClick: () => handleVote(\"yes\"),\n          },\n        }}\n      />\n      <Widget\n        src={widgets.styledComponents}\n        props={{\n          Button: {\n            text: \"No\",\n            className: \"primary danger justify-content-center\",\n            icon: <i className=\"bi bi-hand-thumbs-down\" />,\n            onClick: () => handleVote(\"no\"),\n          },\n        }}\n      />\n      <Widget\n        src={widgets.styledComponents}\n        props={{\n          Button: {\n            text: \"Abstain\",\n            className: \"primary justify-content-center\",\n            icon: <i className=\"bi bi-x-lg\" />,\n            onClick: () => handleVote(\"abstain\"),\n          },\n        }}\n      />\n    </ActionSection>\n  </CastVotesSection>\n);\n\nconst Text = styled.p`\n  font-size: 10px;\n  line-height: 16px;\n  text-align: justify;\n`;\n\nconst Content = () => (\n  <div>\n    <iframe\n      sandbox=\"allow-same-origin allow-forms allow-scripts\"\n      width=\"468\"\n      height=\"60\"\n      src=\"https://bafkreidwdxocdkfsv6srynw7ipnogfuw76fzncmxd5jv7furbsn5cp4bz4.ipfs.nftstorage.link\"\n    ></iframe>\n  </div>\n);\n\nreturn (\n  <Container>\n    <h1>Budget Package</h1>\n    <CandidatesContainer>\n      <Content />\n      <a href=\"https://bafkreidwdxocdkfsv6srynw7ipnogfuw76fzncmxd5jv7furbsn5cp4bz4.ipfs.nftstorage.link/\">\n        View Budget Package\n        <i className=\"ml-2 bi bi-box-arrow-up-right\" />\n      </a>\n    </CandidatesContainer>\n\n    <div>\n      {isIAmHuman ? (\n        <CastVotes />\n      ) : (\n        <Widget\n          src={widgets.verifyHuman}\n          props={{\n            title: \"Want to vote?\",\n            description: \"Click on Verify as a Human to proceed.\",\n          }}\n        />\n      )}\n    </div>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/election.ndctools.near/widget/NDC.Elections.BudgetPackage", "fact_widget_deployments_id": "75795958cb39b1fab5246d94ccd7e140", "inserted_timestamp": "2023-08-28T12:51:24.865Z", "modified_timestamp": "2023-08-28T12:51:24.865Z", "__row_index": 48}
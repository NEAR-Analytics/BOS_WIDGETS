{"tx_hash": "FEBDpeNQwbqycfxyRkfTxkevmThyFi5uyzUBFR78EJ5k", "action_id_social": "8TaqkeYMAGCJtJvKkd4itKN2UoGMjgMibKWwZNiAjHRp-0-widget", "block_id": 91727954, "block_timestamp": "2023-05-13T02:40:58.827Z", "signer_id": "ae03d71382e8621650adfb5706ca430676d9756893b08c1efeae37c92024ef1a", "widget_name": "ref-market-supply-supply-near", "source_code": "const accountId = context.accountId;\nconst BURROW_CONTRACT = \"contract.main.burrow.near\";\nif (!accountId) {\n  return <Widget src=\"juaner.near/widget/ref_account-signin\" />;\n}\nconst storageBurrow = Near.view(BURROW_CONTRACT, \"storage_balance_of\", {\n  account_id: accountId,\n});\nconst expandToken = (value, decimals) => {\n  return new Big(value).mul(new Big(10).pow(decimals));\n};\nconst handleDepositNear = (amount, cfButtonStatus) => {\n  const amountDecimal = expandToken(amount, 24).toFixed();\n  const transactions = [\n    [\n      {\n        contractName: \"wrap.near\",\n        methodName: \"near_deposit\",\n        deposit: amountDecimal,\n        gas: expandToken(300, 12),\n      },\n      {\n        contractName: \"wrap.near\",\n        methodName: \"ft_transfer_call\",\n        deposit: new Big(\"1\").toFixed(),\n        gas: expandToken(300, 12),\n        args: {\n          receiver_id: BURROW_CONTRACT,\n          amount: amountDecimal,\n          msg: cfButtonStatus\n            ? `{\"Execute\":{\"actions\":[{\"IncreaseCollateral\":{\"token_id\":\"wrap.near\",\"max_amount\":\"${amountDecimal}\"}}]}}`\n            : \"\",\n        },\n      },\n    ],\n  ];\n  if (storageBurrow?.available === \"0\" || !storageBurrow?.available) {\n    transactions.unshift({\n      contractName: BURROW_CONTRACT,\n      methodName: \"storage_deposit\",\n      deposit: expandToken(0.25, 24).toFixed(),\n      gas: expandToken(140, 12),\n    });\n  }\n  Near.call(transactions);\n};\nif (typeof props.onLoad === \"function\") {\n  props.onLoad({\n    handleDepositNear,\n  });\n}\nreturn <div></div>;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/ae03d71382e8621650adfb5706ca430676d9756893b08c1efeae37c92024ef1a/widget/ref-market-supply-supply-near", "fact_widget_deployments_id": "ff1b16745f88b627496a1148be158ca6", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 0}
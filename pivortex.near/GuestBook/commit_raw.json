{"tx_hash": "HTzGYKv1hLv1RrS5n4CvpauAvX659451tHN2ik9qYmhT", "action_id_social": "DkbJ6mcD2ooSC1MAn8XCEDKPyRbqh4KfiY6V2tq85hye-0-widget", "block_id": 112559173, "block_timestamp": "2024-02-10T20:03:14.567Z", "signer_id": "pivortex.near", "widget_name": "GuestBook", "source_code": "const Guestbook = (props) => {\n  const [accountId, setAccountId] = useState(\n    props.accountId || context.accountId\n  );\n  const [status, setStatus] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const contractId = \"guestbook.workshopcamp.near\";\n\n  useEffect(() => {\n    getMessages();\n  }, []); // Run only once on component mount\n\n  const getMessages = () => {\n    const messages = Near.view(contractId, \"get_messages\", null);\n    setMessages(messages);\n  };\n\n  const postMessage = () => {\n    if (!accountId) return;\n\n    if (status === \"\") return;\n\n    Near.call(contractId, \"add_message\", {\n      text: status,\n    });\n\n    getMessages();\n    setStatus(\"\"); // Clear the status after posting the message\n  };\n\n  return (\n    <div>\n      <div className=\"hero min-h-screen bg-primary\">\n        <div className=\"hero-content text-center\">\n          <div className=\"max-w-md\">\n            <h1 className=\"text-5xl font-bold text-base-content\">\n              BOS workshop\n            </h1>\n            <p className=\"mb-4 text-base-content\">\n              Welcome to the GuestBook, add your message for everyone to see!\n            </p>\n            <p className=\"mb-4 text-base-content\">\n              You are logged in as <b>{accountId}</b>\n            </p>\n            <div className=\"my-2\">\n              <textarea\n                placeholder=\"Your status\"\n                className=\"textarea textarea-bordered textarea-lg w-full max-w-xs\"\n                value={status}\n                onChange={({ target: { value } }) => setStatus(value)}\n              ></textarea>\n            </div>\n            <button className=\"btn btn-primary mb-4\" onClick={postMessage}>\n              Add a message\n            </button>\n\n            <div className=\"my-4\">\n              {messages.map((status, index) => (\n                <div key={index} className=\"card bg-base-100 shadow-xl mb-4\">\n                  <div className=\"card-body\">\n                    <h2 className=\"card-title text-base-content\">\n                      {status.text}\n                    </h2>\n                    <p className=\"text-left text-base-content\">\n                      {status.sender}\n                    </p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n", "metadata": {"fork_of": "pivortex.near/widget/GuestBook@112559154"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/pivortex.near/widget/GuestBook", "fact_widget_deployments_id": "34eb54a538497b80fbe82003fe412253", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 9}
{"tx_hash": "EW8n2iUjHwWFJhk595RWEKDwXuMt3h31FQkoRuYxMSkZ", "action_id_social": "7N32YBHK9qJMy2b7jkoawaCrJsUgs9h4zrU84HTm1z1Z-0-widget", "block_id": 104119376, "block_timestamp": "2023-10-24T17:58:04.554Z", "signer_id": "devhub.efiz.near", "widget_name": "devhub.page.community.configuration", "source_code": "const { Tile } =\n  VM.require(\"${REPL_DEVHUB}/widget/devhub.components.molecule.Tile\") ||\n  (() => <></>);\n\nconst {\n  permissions,\n  handle,\n  community,\n  setCommunityAddons,\n  deleteCommunity,\n  updateCommunity,\n} = props;\n\nconst [communityData, setCommunityData] = useState(community);\nconst [selectedAddon, setSelectedAddon] = useState(null);\nconst [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n\nconst sectionSubmit = (sectionData) => {\n  console.log(sectionData);\n  const updatedCommunityData = {\n    ...Object.entries(sectionData).reduce(\n      (update, [propertyKey, propertyValue]) => ({\n        ...update,\n\n        [propertyKey]:\n          typeof propertyValue !== \"string\" || (propertyValue?.length ?? 0) > 0\n            ? propertyValue ?? null\n            : null,\n      }),\n\n      communityData\n    ),\n  };\n  setCommunityData(updatedCommunityData);\n  setHasUnsavedChanges(true);\n};\n\nconst hasConfigurePermissions = permissions.can_configure;\nconst hasDeletePermissions = permissions.can_delete;\n\nreturn (\n  <div\n    className=\"d-flex flex-column align-items-center gap-4 w-100 p-4\"\n    style={{ maxWidth: 960 }}\n  >\n    <Tile>\n      <Widget\n        src={\n          \"${REPL_DEVHUB}/widget/devhub.entity.community.configuration.BrandingConfigurator\"\n        }\n        props={{\n          onSubmit: sectionSubmit,\n          data: communityData,\n          hasConfigurePermissions,\n          link: `/${REPL_DEVHUB}/widget/app?page=community&handle=${handle}`,\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3\"}>\n      <Widget\n        src={\n          \"${REPL_DEVHUB}/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"Community Information\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"${REPL_DEVHUB}/widget/devhub.entity.community.configuration.InformationConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3\"}>\n      <Widget\n        src={\n          \"${REPL_DEVHUB}/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"About\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"${REPL_DEVHUB}/widget/devhub.entity.community.configuration.AboutConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3\"}>\n      <Widget\n        src={\n          \"${REPL_DEVHUB}/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"Access Control\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"${REPL_DEVHUB}/widget/devhub.entity.community.configuration.AccessControlConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    {hasConfigurePermissions && (\n      <Tile className={\"p-3\"}>\n        <Widget\n          src={\n            \"${REPL_DEVHUB}/widget/devhub.entity.community.configuration.Addons\"\n          }\n          props={{\n            data: communityData.addons || [],\n            onSubmit: (v) => setCommunityAddons({ handle, addons: v }),\n          }}\n        />\n      </Tile>\n    )}\n    {hasDeletePermissions && (\n      <div\n        className=\"d-flex justify-content-center gap-4 p-4 w-100\"\n        style={{ maxWidth: 896 }}\n      >\n        <Widget\n          src={\"${REPL_DEVHUB}/widget/devhub.components.molecule.Button\"}\n          props={{\n            classNames: { root: \"btn-lg btn-outline-danger border-none\" },\n            label: \"Delete community\",\n            onClick: () => deleteCommunity({ handle }),\n          }}\n        />\n      </div>\n    )}\n    {hasConfigurePermissions && hasUnsavedChanges && (\n      <div\n        className=\"position-fixed end-0 bottom-0 bg-transparent pe-4 pb-4\"\n        style={{ borderTopLeftRadius: \"100%\" }}\n      >\n        <Widget\n          src={\"${REPL_DEVHUB}/widget/devhub.components.molecule.Button\"}\n          props={{\n            classNames: { root: \"btn-lg btn-success\" },\n            icon: { type: \"svg_icon\", variant: \"floppy_drive\" },\n            label: \"Save\",\n            onClick: () =>\n              updateCommunity({ handle, community: communityData }), // TODO : Track changes in State\n          }}\n        />\n      </div>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/devhub.efiz.near/widget/devhub.page.community.configuration", "fact_widget_deployments_id": "0ad267b2c87f9c24f6c146053edff9e0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 15}
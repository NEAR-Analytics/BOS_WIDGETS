{"tx_hash": "W6MULED6w3h3a4LdMF64JcGvFveKCbZMDQu6n3CgdeR", "action_id_social": "6qKYu9eNy1oAPQLxRmPDXdNm5JXxBRYTEF5jH9z6pudA-0-widget", "block_id": 104119311, "block_timestamp": "2023-10-24T17:56:51.324Z", "signer_id": "devhub.efiz.near", "widget_name": "devhub.page.community.configuration", "source_code": "const { Tile } =\n  VM.require(\"devhub.efiz.near/widget/devhub.components.molecule.Tile\") ||\n  (() => <></>);\n\nconst {\n  permissions,\n  handle,\n  community,\n  setCommunityAddons,\n  deleteCommunity,\n  updateCommunity,\n} = props;\n\nconst [communityData, setCommunityData] = useState(community);\nconst [selectedAddon, setSelectedAddon] = useState(null);\nconst [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n\nconst sectionSubmit = (sectionData) => {\n  console.log(sectionData);\n  const updatedCommunityData = {\n    ...Object.entries(sectionData).reduce(\n      (update, [propertyKey, propertyValue]) => ({\n        ...update,\n\n        [propertyKey]:\n          typeof propertyValue !== \"string\" || (propertyValue?.length ?? 0) > 0\n            ? propertyValue ?? null\n            : null,\n      }),\n\n      communityData\n    ),\n  };\n  setCommunityData(updatedCommunityData);\n  setHasUnsavedChanges(true);\n};\n\nconst hasConfigurePermissions = permissions.can_configure;\nconst hasDeletePermissions = permissions.can_delete;\n\nreturn (\n  <div\n    className=\"d-flex flex-column align-items-center gap-4 w-100 p-4\"\n    style={{ maxWidth: 960 }}\n  >\n    <Tile>\n      <Widget\n        src={\n          \"devhub.efiz.near/widget/devhub.entity.community.configuration.BrandingConfigurator\"\n        }\n        props={{\n          onSubmit: sectionSubmit,\n          data: communityData,\n          hasConfigurePermissions,\n          link: `/devhub.efiz.near/widget/app?page=community&handle=${handle}`,\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3\"}>\n      <Widget\n        src={\n          \"devhub.efiz.near/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"Community Information\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"devhub.efiz.near/widget/devhub.entity.community.configuration.InformationConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3\"}>\n      <Widget\n        src={\n          \"devhub.efiz.near/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"About\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"devhub.efiz.near/widget/devhub.entity.community.configuration.AboutConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    <Tile className={\"p-3\"}>\n      <Widget\n        src={\n          \"devhub.efiz.near/widget/devhub.entity.community.configuration.ConfigurationSection\"\n        }\n        props={{\n          title: \"Access Control\",\n          hasConfigurePermissions,\n          Configurator: (p) => (\n            <Widget\n              src={\n                \"devhub.efiz.near/widget/devhub.entity.community.configuration.AccessControlConfigurator\"\n              }\n              props={{\n                data: communityData,\n                onSubmit: sectionSubmit,\n                ...p,\n              }}\n            />\n          ),\n        }}\n      />\n    </Tile>\n    {hasConfigurePermissions && (\n      <Tile className={\"p-3\"}>\n        <Widget\n          src={\n            \"devhub.efiz.near/widget/devhub.entity.community.configuration.Addons\"\n          }\n          props={{\n            data: communityData.addons || [],\n            onSubmit: (v) => setCommunityAddons({ handle, addons: v }),\n          }}\n        />\n      </Tile>\n    )}\n    {hasDeletePermissions && (\n      <div\n        className=\"d-flex justify-content-center gap-4 p-4 w-100\"\n        style={{ maxWidth: 896 }}\n      >\n        <Widget\n          src={\"devhub.efiz.near/widget/devhub.components.molecule.Button\"}\n          props={{\n            classNames: { root: \"btn-lg btn-outline-danger border-none\" },\n            label: \"Delete community\",\n            onClick: () => deleteCommunity({ handle }),\n          }}\n        />\n      </div>\n    )}\n    {hasConfigurePermissions && hasUnsavedChanges && (\n      <div\n        className=\"position-fixed end-0 bottom-0 bg-transparent pe-4 pb-4\"\n        style={{ borderTopLeftRadius: \"100%\" }}\n      >\n        <Widget\n          src={\"devhub.efiz.near/widget/devhub.components.molecule.Button\"}\n          props={{\n            classNames: { root: \"btn-lg btn-success\" },\n            icon: { type: \"svg_icon\", variant: \"floppy_drive\" },\n            label: \"Save\",\n            onClick: () =>\n              updateCommunity({ handle, community: communityData }), // TODO : Track changes in State\n          }}\n        />\n      </div>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/devhub.efiz.near/widget/devhub.page.community.configuration", "fact_widget_deployments_id": "a1c0500a52959977043729d99cad685f", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 14}
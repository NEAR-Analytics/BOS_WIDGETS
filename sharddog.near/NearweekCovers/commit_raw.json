{"tx_hash": "2xwYmfdcJeerNHw3FQVm5wmPzjpEG4A3GpnuWbfPiT7U", "action_id_social": "H97KjHshpxNi4gHjTaWX937RSRDcs7RVqtiFAWeksSXd-0-widget", "block_id": 100685543, "block_timestamp": "2023-09-08T20:19:27.048Z", "signer_id": "sharddog.near", "widget_name": "NearweekCovers", "source_code": "State.init({\n  tokens: [],\n});\n\nconst accountId = props.accountId ?? context.accountId;\n\nconst styles = {\n  gridItem: {\n    position: \"relative\",\n    textAlign: \"center\",\n    boxShadow: \"0 10px 15px rgba(0, 0, 0, 0.2)\",\n    border: \"1px solid #ccc\",\n    overflow: \"hidden\",\n    margin: \"10px\",\n    backgroundColor: \"#fff\"\n  },\n  shelf: {\n    content: '\"\"',\n    position: \"absolute\",\n    bottom: \"-15px\",\n    left: \"10%\",\n    width: \"80%\",\n    height: \"10px\",\n    backgroundColor: \"#aaa\",\n    boxShadow: \"0 10px 15px rgba(0, 0, 0, 0.2)\",\n    zIndex: -1,\n  },\n  hoverEffect: {\n    transform: \"rotate(-2deg) translateY(-10px)\",\n    transition: \"transform 0.3s ease\",\n  },\n};\n\nfunction fetchTokens() {\n  asyncFetch(\"https://graph.mintbase.xyz/mainnet\", {\n    method: \"POST\",\n    headers: {\n      \"mb-api-key\": \"omni-site\",\n      \"Content-Type\": \"application/json\",\n      \"x-hasura-role\": \"anonymous\",\n    },\n    body: JSON.stringify({\n      query: `\n     query MyQuery {\n  mb_views_nft_tokens(\n    where: {nft_contract_id: {_eq: \"mint.sharddog.near\"}, owner: {_eq: \"${accountId}\"}, reference: {_eq: \"https://nftstorage.link/ipfs/bafkreia7y3fwfr3bwafvggjrztkjjq25crgxpbpgc4vfejcvez4yfshazi\"}},\n    order_by: { token_id: asc }\n  ) {\n    title\n    owner\n    minted_timestamp\n    media\n    extra\n    description\n  }\n    }\n        `,\n    }),\n  }).then((res) => {\n    console.log(res);\n    if (res.ok) {\n      let tokens = res.body.data.mb_views_nft_tokens;\n\n      // Modify each token to include the parsed link\n      tokens = tokens.map((token) => {\n        const link = JSON.parse(token.extra).link;\n        const releaseDate = JSON.parse(token.extra).date;\n        return {\n          ...token,\n          link: link,\n          releaseDate: releaseDate,\n        };\n      });\n\n      console.log(tokens);\n      State.update({\n        tokens: tokens,\n      });\n    }\n  });\n}\n\nfetchTokens();\n\nconst Grid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(344px, 0.1fr));\n\n  @media (hover: none) {\n    grid-template-columns: repeat(auto-fill, minmax(344px, 0.1fr));\n  }\n`;\n\nconst wsize = \"300px\";\nconst hsize = \"420px\";\n\nconst loader = (\n  <div className=\"loader\" key={\"loader\"}>\n    <span\n      className=\"spinner-grow spinner-grow-sm me-1\"\n      role=\"status\"\n      aria-hidden=\"true\"\n    />\n    Loading ...\n  </div>\n);\n\nreturn (\n  <>\n    <span style={{ textAlign: \"left\" }}>\n      <h2>My NEARWEEK Covers</h2>\n    </span>\n    <span style={{ textAlign: \"left\" }}>\n      <i>Powered by ShardDog</i>\n    </span>\n    <br />\n    <div style={styles.gridContainer}>\n      <Grid>\n        {state.tokens?.map((it) => {\n          return (\n            <>\n              <div\n                style={styles.gridItem}\n                onMouseOver={() => styles.hoverEffect}\n              >\n                <Widget\n                  src=\"sharddog.near/widget/Image.Minted\"\n                  title={it.owner}\n                  props={{\n                    title: it.owner,\n                    timestamp: it.minted_timestamp,\n                    image: {\n                      url: it.media,\n                    },\n                    style: {\n                      width: wsize,\n                      height: hsize,\n                      objectFit: \"cover\",\n                      minWidth: wsize,\n                      minHeight: hsize,\n                      maxWidth: wsize,\n                      maxHeight: hsize,\n                    },\n                  }}\n                />\n                <h4>{it.title}</h4>\n                <p>Released: {it.releaseDate}</p>\n                <p>\n                  <a href={it.link} target=\"_blank\">\n                    READ ISSUE\n                  </a>\n                </p>\n              </div>\n            </>\n          );\n        })}\n      </Grid>\n    </div>\n  </>\n);\n", "metadata": null, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/sharddog.near/widget/NearweekCovers", "fact_widget_deployments_id": "0f58fb598aebb66c4ba2a5a1baab141d", "inserted_timestamp": "2023-09-08T22:22:56.787Z", "modified_timestamp": "2023-09-08T22:22:56.787Z", "__row_index": 2}
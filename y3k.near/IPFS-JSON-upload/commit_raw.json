{"tx_hash": "6svLFbU5JExXnUcFKSembYKHy1NqGbgbxuCZNXxKeTMT", "action_id_social": "DxUDX2UAiDyMcNZCg7EkeYgSdv29v9zEUY9i4wVUy7Ec-0-widget", "block_id": 106886376, "block_timestamp": "2023-11-30T20:10:57.565Z", "signer_id": "y3k.near", "widget_name": "IPFS-JSON-upload", "source_code": "props.fileType ||\n  initState({\n    json: `{\"your JSON file\": \"here\"}`,\n  });\n\nconst ipfsUrl = (cid) => `https://ipfs.near.social/ipfs/${cid}`;\n\nfunction sanitizeJsonString(str) {\n  return str\n    .replace(/\\\\/g, \"\\\\\\\\\") // Escape backslashes\n    .replace(/\"/g, '\\\\\"') // Escape double quotes\n    .replace(/'/g, \"\\\\'\") // Escape apostrophes\n    .replace(/\\n/g, \"\\\\n\") // Replace newlines with \\n\n    .replace(/\\r/g, \"\\\\r\") // Replace carriage returns with \\r\n    .replace(/\\t/g, \"\\\\t\"); // Replace tabs with \\t\n}\n\nconst UploadJson = () => {\n  if (state.json.length) {\n    const sanitizedJson = sanitizeJsonString(state.json);\n\n    const body = new Blob([sanitizedJson], { type: \"application/json\" });\n    console.log(body);\n    asyncFetch(\"https://ipfs.near.social/add\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n      },\n      body,\n    }).then((res) => {\n      const cid = res.body.cid;\n      console.log(\"CID\", cid);\n      State.update({\n        file: {\n          cid,\n        },\n      });\n    });\n  } else {\n    State.update({\n      file: null,\n    });\n  }\n};\n\nreturn (\n  <>\n    <textarea\n      class=\"form-control mb-2\"\n      rows={5}\n      value={state.json}\n      onChange={(e) => {\n        state.json = e.target.value;\n        State.update();\n      }}\n    />\n    <a type=\"button\" class=\"btn btn-primary\" onClick={() => UploadJson()}>\n      Upload to Near Social IPFS\n    </a>\n\n    {state.file && (\n      <div>\n        Your file:\n        <a href={ipfsUrl(state.file.cid)}>{state.file.cid}</a>\n      </div>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/y3k.near/widget/IPFS-JSON-upload", "fact_widget_deployments_id": "445e05952a98bed323aab5ed381bc66b", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 2}
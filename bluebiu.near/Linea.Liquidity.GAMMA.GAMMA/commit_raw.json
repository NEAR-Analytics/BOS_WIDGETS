{"tx_hash": "41P4NzKfHDvkssuUVYdscgkLyK8NBfy8b6B4dWs956ng", "action_id_social": "EWuthYT8HHeHwcvbd1J4TZ2LYrjanSq7NWnMDctnM6C8-0-widget", "block_id": 101600580, "block_timestamp": "2023-09-21T04:44:05.306Z", "signer_id": "bluebiu.near", "widget_name": "Linea.Liquidity.GAMMA.GAMMA", "source_code": "State.init({\n  activePair: defaultPair,\n  isPoolFetching: false,\n  isUserPositionsFetching: false,\n  chainId: \"\",\n});\n\nconst MAINNET_CHAIN_ID = 59144;\n\nconst chainIdToSwitch = `0x${MAINNET_CHAIN_ID.toString(16)}`;\n\nconst ALL_DATA_URL = \"https://wire2.gamma.xyz/lynex/linea/hypervisors/allData\";\n\nconst USER_DATA_BASE = \"https://wire2.gamma.xyz/lynex/linea/user/\";\n\nconst CHAIN_CONFIG = {\n  chainId: chainIdToSwitch,\n  chainName: \"Linea\",\n  nativeCurrency: {\n    name: \"Linea\",\n    symbol: \"ETH\",\n    decimals: 18,\n  },\n  rpcUrls: [\"https://rpc.linea.build\"],\n  blockExplorerUrls: [\"https://lineascan.build/\"],\n};\n\nconst tableSrc = \"bluebiu.near/widget/Linea.Liquidity.GAMMA.gamma-table\";\n\nconst vaultSrc = \"bluebiu.near/widget/Linea.Liquidity.GAMMA.gamma-vault\";\n\nconst addresses = {\n  USDC: \"0x176211869ca2b568f2a7d4ee941e073a821ee1ff\",\n  WETH: \"0xe5d7c2a44ffddf6b295a15c148167daaaf5cf34f\",\n  BUSD: \"0x7d43aabc515c356145049227cee54b608342c0ad\",\n  USDT: \"0xa219439258ca9da29e9cc4ce5596924745e12b93\",\n  MATIC: \"0x265b25e22bcd7f10a5bd6e6410f10537cc7567e8\",\n  WBTC: \"0x3aab2285ddcddad8edf438c1bab47e1a9d05a9b4\",\n\n  \"N USDC-WETH-0\": \"0x0b15a5e3ca0d4b492c3b476d0f807535f9b72079\",\n  \"S BUSD-USDT-0\": \"0x32e27ff479454e32868ff67ee9f06bafdc1e908f\",\n  \"N BUSD-WETH-0\": \"0x6e9d701fb6478ed5972a37886c2ba6c82a4cbb4c\",\n  \"N MATIC-WETH-0\": \"0x8421c6102ee8a147facc01977df3b159f7921d54\",\n  \"N WBTC-WETH-0\": \"0x8a9570ec97534277ade6e46d100939fbce4968f0\",\n  \"S USDC-BUSD-0\": \"0xd6cc4a33da7557a629e819c68fb805ddb225f517\",\n  \"N USDT-WETH-0\": \"0xf3b1125c8505f038503e002e61a78253610d4f60\",\n};\n\nconst pairs = [\n  {\n    id: \"N USDC-WETH-0\",\n    strategy: \"Dynamic\",\n    strategy2: \"Narrow\",\n    token0: \"USDC\",\n    token1: \"WETH\",\n    decimals0: 6,\n    decimals1: 18,\n  },\n  {\n    id: \"S BUSD-USDT-0\",\n    strategy: \"Dynamic\",\n    strategy2: \"Stable\",\n    token0: \"BUSD\",\n    token1: \"USDT\",\n    decimals0: 18,\n    decimals1: 6,\n  },\n  {\n    id: \"N BUSD-WETH-0\",\n    strategy: \"Dynamic\",\n    strategy2: \"Narrow\",\n    token0: \"BUSD\",\n    token1: \"WETH\",\n    decimals0: 18,\n    decimals1: 18,\n  },\n  {\n    id: \"N MATIC-WETH-0\",\n    strategy: \"Dynamic\",\n    strategy2: \"Narrow\",\n    token0: \"MATIC\",\n    token1: \"WETH\",\n    decimals0: 18,\n    decimals1: 18,\n  },\n  {\n    id: \"N WBTC-WETH-0\",\n    strategy: \"Dynamic\",\n    strategy2: \"Narrow\",\n    token0: \"WBTC\",\n    token1: \"WETH\",\n    decimals0: 8,\n    decimals1: 18,\n  },\n  {\n    id: \"S USDC-BUSD-0\",\n    strategy: \"Dynamic\",\n    strategy2: \"Stable\",\n    token0: \"USDC\",\n    token1: \"BUSD\",\n    decimals0: 6,\n    decimals1: 18,\n  },\n  {\n    id: \"N USDT-WETH-0\",\n    strategy: \"Dynamic\",\n    strategy2: \"Narrow\",\n    token0: \"USDT\",\n    token1: \"WETH\",\n    decimals0: 6,\n    decimals1: 18,\n  },\n];\n\nconst proxyAddress = \"0xFc13Ebe7FEB9595D70195E9168aA7F3acE153621\";\n\nconst defaultPair = {\n  id: \"N USDC-WETH-0\",\n  strategy: \"Dynamic\",\n  strategy2: \"Narrow\",\n  token0: \"USDC\",\n  token1: \"WETH\",\n  decimals0: 6,\n  decimals1: 18,\n};\nconst sender = Ethers.send(\"eth_requestAccounts\", [])[0];\nconst ContainerLogin = styled.div`\n  display: flex;\n  max-width: 500px;\n\n  flex-direction: column;\n  margin: 80px auto auto auto;\n\n  .web3-connect {\n    width: 480px;\n    height: 60px;\n    border-radius: 10px;\n    background-color: #fff;\n    color: #0f1126;\n    font-size: 18px;\n    font-weight: 500;\n    border: none;\n    margin-top: 20px;\n  }\n\n  @media (max-width: 736px) {\n    max-width: 100%;\n    .web3-connect {\n      width: 100%;\n\n      font-size: 16px;\n      height: 40px;\n    }\n  }\n`;\n\nconst TitleText = styled.div`\n  font-size: 20px;\n  font-weight: 700;\n  margin-bottom: 32px;\n  color: #ffffff;\n  @media (max-width: 900px) {\n    display: none;\n  }\n`;\n\nif (!sender)\n  return (\n    <>\n      <TitleText>Liquidity Manage</TitleText>\n      <ContainerLogin\n        style={{\n          display: \"flex\",\n          maxWidth: \"500px\",\n          flexDirection: \"column\",\n          margin: \"80px auto auto auto\",\n        }}\n      >\n        <img src=\"https://ipfs.near.social/ipfs/bafkreibmhq4fseqpcbywiq4hfojghxvhj47mjsri2trggt7d5h5od4y6kq\"></img>\n\n        <Web3Connect\n          className=\"web3-connect\"\n          connectLabel=\"Connect ETH wallet\"\n        />\n      </ContainerLogin>\n    </>\n  );\n\nEthers.provider()\n  .getNetwork()\n  .then((data) => {\n    State.update({\n      chainId: data.chainId,\n    });\n  });\n\nconst switchChain = () => {\n  Ethers.send(\"wallet_addEthereumChain\", [CHAIN_CONFIG]);\n};\n\nconst SwitchWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  font-family: \"Inter\";\n  max-width: 500px;\n  color: #fff;\n  margin: auto;\n  text-align: center;\n  border-radius: 12px;\n  padding: 16px 0;\n  align-items: center;\n  gap: 12px;\n  margin-top: 80px;\n  button {\n    background: #8247e5;\n    border: none;\n    &:hover {\n      background: #8257f5;\n    }\n  }\n\n  @media (max-width: 736px) {\n    max-width: 100%;\n    img {\n      width: 100%;\n    }\n  }\n`;\n\nif (state.chainId !== MAINNET_CHAIN_ID) {\n  return (\n    <>\n      <TitleText>Liquidity Manage</TitleText>\n      <SwitchWrapper>\n        <img src=\"https://ipfs.near.social/ipfs/bafkreibmhq4fseqpcbywiq4hfojghxvhj47mjsri2trggt7d5h5od4y6kq\"></img>\n        <h4>Please switch to {CHAIN_CONFIG.chainName} </h4>\n        <button onClick={switchChain}>\n          Switch to {CHAIN_CONFIG.chainName}\n        </button>\n        <p>**Please refresh once after switch chain**</p>\n      </SwitchWrapper>\n    </>\n  );\n}\nconst fetchPoolsData = () => {\n  State.update({\n    isPoolFetching: true,\n  });\n  asyncFetch(ALL_DATA_URL).then((res) => {\n    if (!res.ok) return;\n\n    State.update({\n      poolsData: res.body,\n      isPoolFetching: false,\n    });\n  });\n};\n\nconst fetchUserData = () => {\n  State.update({\n    isUserPositionsFetching: true,\n  });\n  asyncFetch(USER_DATA_BASE + `${sender}`).then((res) => {\n    if (!res.ok) return;\n\n    State.update({\n      userPositions: res.body[sender],\n      isUserPositionsFetching: false,\n    });\n  });\n};\n\nif (state.poolsData === undefined) {\n  fetchPoolsData();\n}\n\nif (sender && state.userPositions === undefined) {\n  fetchUserData();\n}\n\nconst refetch = () => {\n  fetchPoolsData();\n  fetchUserData();\n  console.log(\"refetching\");\n};\n\nconst postRefetch = () => {\n  setTimeout(() => refetch(), 45_000);\n};\n\nconst Wrapper = styled.div`\n  display: flex;\n  align-items: start;\n  gap: 24px;\n\n  @media (max-width: 736px) {\n    flex-direction: column-reverse;\n  }\n`;\nconst VStack = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  .tableTitle {\n    font-size: 18px;\n    color: #7c7f96;\n    font-weight: 500;\n    padding-left: 16px;\n    margin-bottom: 5px;\n\n    @media (max-width: 736px) {\n      display: none;\n    }\n  }\n`;\nconst Button = styled.button`\n  background: #1d1e1f;\n  border-radius: 4px;\n  border: none;\n  max-width: 640px;\n  width: 100%;\n  color: #fff;\n  padding: 8px 0;\n  font-weight: 600;\n  font-size: 14px;\n  position: relative;\n  min-height: 37px;\n  &:hover {\n    background: #2b2a2b;\n  }\n  &:disabled {\n    background: #333;\n    color: #ccc;\n  }\n`;\n\nconst handlePairClick = (pair) => {\n  State.update({\n    activePair: pair,\n  });\n};\n\nconst {\n  activePair,\n  poolsData,\n  userPositions,\n  isPoolFetching,\n  isUserPositionsFetching,\n} = state;\n\nreturn (\n  <VStack>\n    <div className=\"tableTitle\">Active Liquidity</div>\n    <Wrapper>\n      <Widget\n        src={tableSrc}\n        props={{\n          handlePairClick,\n          poolsData,\n          userPositions,\n          addresses,\n          pairs,\n          proxyAddress,\n          defaultPair,\n        }}\n      />\n\n      <div\n        className=\"\"\n        style={{\n          display: \"flex\",\n          flexDirection: \"column\",\n        }}\n      >\n        <Widget\n          src={vaultSrc}\n          props={{\n            ...props,\n            pair: activePair,\n            refetch: postRefetch,\n            can_add_action: state.add_action,\n            poolsData,\n            addresses,\n            pairs,\n            proxyAddress,\n            defaultPair,\n            handlePairClick,\n          }}\n        />\n\n        <div\n          style={{\n            width: \"350px\",\n            paddingTop: \"20px\",\n          }}\n        >\n          <Widget\n            src=\"guessme.near/widget/ZKEVMWarmUp.add-to-quest-card\"\n            props={{\n              add: state.add_action,\n              onChangeAdd: (value) => {\n                State.update({\n                  add_action: value,\n                });\n              },\n            }}\n          />\n        </div>\n      </div>\n    </Wrapper>\n  </VStack>\n);\n", "metadata": {"image": {"ipfs_cid": "bafkreial4i3eb5uuxkhecn7nwos76km3qvb7jzxmups57rkxizr5i7dyaa"}, "name": "Gamma", "tags": {"liquidity-manager": ""}}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/Linea.Liquidity.GAMMA.GAMMA", "fact_widget_deployments_id": "11c41f912d9fe855a1df9359f1bb9b94", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
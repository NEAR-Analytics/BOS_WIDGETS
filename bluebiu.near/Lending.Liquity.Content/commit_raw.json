{"tx_hash": "C6YuvWfR728LASPRJmXugKVjqpjrbk3oc4S5VFkppJ71", "action_id_social": "HQoowuBmNXv8u3ambuv2D7PBgxG7ZrkrLWGPSDQRAnLV-0-widget", "block_id": 120073682, "block_timestamp": "2024-05-30T15:49:50.933Z", "signer_id": "bluebiu.near", "widget_name": "Lending.Liquity.Content", "source_code": "const StyledContainer = styled.div`\n  padding-top: 18px;\n`;\n\nconst {\n  dexConfig,\n  wethAddress,\n  multicallAddress,\n  chainIdNotSupport,\n  multicall,\n  prices,\n  account,\n  addAction,\n  toast,\n  chainId,\n  nativeCurrency,\n  tab,\n} = props;\n\nconst { markets, VesselManagerOperations } = dexConfig;\n\nState.init({\n  newMarkets: \"\",\n  tvl: \"\",\n  deposits: \"\",\n  tokenBal: \"\",\n});\n\nconst IS_ETHOS_DAPP = dexConfig.name === \"Ethos Finance\" ? true : false;\nconst IS_PREON_DAPP = dexConfig.name === \"Preon Finance\" ? true : false;\nconst IS_GRAVITA_DAPP = dexConfig.name === \"Gravita Protocol\" ? true : false;\nconst IS_LYVE_DAPP = dexConfig.name === \"Lyve\" ? true : false;\n\nuseEffect(() => {\n  State.update({\n    loading: !chainIdNotSupport,\n  });\n}, [chainIdNotSupport]);\n\nuseEffect(() => {\n  if (!state.newMarkets) return;\n  const _marketsArray = Object.values(state.newMarkets);\n  const totalDebt = _marketsArray.reduce((total, item) => {\n    return Big(total || 0)\n      .plus(item.vesselDebt || 0)\n      .toFixed(2);\n  }, 0);\n  const totalCollateral = _marketsArray.reduce((total, item) => {\n    return Big(total || 0)\n      .plus(\n        Big(item.vesselDeposit || 0).times(\n          prices[item.underlyingToken.symbol] || 1\n        )\n      )\n      .toFixed(2);\n  }, 0);\n\n  State.update({\n    totalDebt,\n    totalCollateral,\n  });\n}, [state.newMarkets]);\n\nreturn (\n  <StyledContainer>\n    {tab === \"market\" && (\n      <Widget\n        src=\"bluebiu.near/widget/Lending.Liquity.Markets\"\n        props={{\n          ...props,\n          IS_ETHOS_DAPP,\n          IS_PREON_DAPP,\n          IS_GRAVITA_DAPP,\n          IS_LYVE_DAPP,\n          dexConfig: {\n            ...dexConfig,\n            markets: state.newMarkets,\n          },\n          tokenBal: state.tokenBal,\n          deposits: state.deposits,\n          totalDebt: state.totalDebt,\n          totalCollateral: state.totalCollateral,\n          onSuccess: () => {\n            State.update({\n              loading: true,\n            });\n          },\n        }}\n      />\n    )}\n    {tab === \"yours\" && (\n      <Widget\n        src=\"bluebiu.near/widget/Lending.Liquity.Yours\"\n        props={{\n          ...props,\n          tvl: state.tvl,\n          deposits: state.deposits,\n          tokenBal: state.tokenBal,\n          dexConfig: {\n            ...dexConfig,\n            markets: state.newMarkets,\n          },\n          IS_ETHOS_DAPP,\n          IS_PREON_DAPP,\n          IS_GRAVITA_DAPP,\n          IS_LYVE_DAPP,\n          onSuccess: () => {\n            // fresh balance..\n            State.update({\n              loading: true,\n            });\n          },\n        }}\n      />\n    )}\n    <Widget\n      src={dexConfig.data}\n      props={{\n        update: state.loading,\n        ...props,\n        IS_ETHOS_DAPP,\n        IS_PREON_DAPP,\n        IS_GRAVITA_DAPP,\n        IS_LYVE_DAPP,\n        onLoad: (data) => {\n          console.log(\"ONLOAD--\", data);\n          State.update({\n            loading: false,\n            timestamp: Date.now(),\n            ...data,\n          });\n        },\n      }}\n    />\n  </StyledContainer>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/Lending.Liquity.Content", "fact_widget_deployments_id": "239cd3f95250ba364d032a213643fdd9", "inserted_timestamp": "2024-05-30T17:45:16.932Z", "modified_timestamp": "2024-05-30T17:45:16.932Z", "__row_index": 1}
{"tx_hash": "Ec7NG2GWwbgyJirAMH5QkWUkk4YKsEpALeX2b2zFtxar", "action_id_social": "2WYBjQzqD8gXpBqqHHfYXQvXbyu2GLHu4qn7ZchLH914-0-widget", "block_id": 111764544, "block_timestamp": "2024-01-31T10:23:22.518Z", "signer_id": "bluebiu.near", "widget_name": "Lending.LiquityYours", "source_code": "const Yours = styled.div`\n  display: flex;\n  gap: 20px;\n`;\nconst YoursTableWrapper = styled.div`\n  background-color: rgba(53, 55, 73, 0.2);\n  border-radius: 6px;\n  width: 50%;\n`;\nconst Title = styled.div`\n  padding: 20px;\n  border-bottom: 1px solid #292c42;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\nconst Label = styled.div`\n  font-size: 14px;\n  font-weight: 400;\n  color: #7c7f96;\n  &.yours-table-title {\n    color: var(--yours-table-title);\n  }\n`;\nconst Value = styled.div`\n  font-size: 18px;\n  font-weight: 700;\n  margin-top: 4px;\n  color: #fff;\n  &.supply-color {\n    color: var(--supply-color);\n  }\n  &.borrow-color {\n    color: var(--borrow-color);\n  }\n`;\nconst Right = styled.div`\n  text-align: right;\n`;\n\nconst { dexConfig, account, multicall, multicallAddress } = props;\nconst { StabilityPool, borrowTokenAddress } = dexConfig;\n\nState.init({\n  tvl: \"\",\n  deposits: \"\",\n  tokenBal: \"\",\n});\n\nfunction getDeposit() {\n  const contract = new ethers.Contract(\n    StabilityPool,\n    [\n      {\n        inputs: [{ internalType: \"address\", name: \"\", type: \"address\" }],\n        name: \"deposits\",\n        outputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n        stateMutability: \"view\",\n        type: \"function\",\n      },\n    ],\n    Ethers.provider()\n  );\n  contract\n    .deposits(account)\n    .then((res) => {\n      State.update({\n        deposits: ethers.utils.formatUnits(res),\n      });\n    })\n    .catch((err) => {\n      console.log(\"getDeposit_error\", err);\n    });\n}\n\nfunction getInfo() {\n  const calls = [\n    { address: borrowTokenAddress, name: \"balanceOf\", params: [StabilityPool] },\n    { address: borrowTokenAddress, name: \"balanceOf\", params: [account] },\n  ];\n  multicall({\n    abi: [\n      {\n        constant: true,\n        inputs: [\n          {\n            name: \"_owner\",\n            type: \"address\",\n          },\n        ],\n        name: \"balanceOf\",\n        outputs: [\n          {\n            name: \"balance\",\n            type: \"uint256\",\n          },\n        ],\n        payable: false,\n        stateMutability: \"view\",\n        type: \"function\",\n      },\n    ],\n    calls,\n    options: {},\n    multicallAddress,\n    provider: Ethers.provider(),\n  })\n    .then((res) => {\n      const [[tvlAmount], [tokenBalAmount]] = res;\n      console.log(\n        \"get_borrow_token_res\",\n        tvlAmount.toString(),\n        tokenBalAmount.toString()\n      );\n      State.update({\n        tvl: Big(ethers.utils.formatUnits(tvlAmount)).toFixed(2),\n        tokenBal: Big(ethers.utils.formatUnits(tokenBalAmount)).toFixed(2),\n      });\n    })\n    .catch((err) => {\n      console.log(\"multicall_borrow_error:\", err);\n    });\n}\n\nuseEffect(() => {\n  getDeposit();\n  getInfo();\n}, []);\n\nreturn (\n  <>\n    {/* <Yours>\n      <YoursTableWrapper>\n        <Title>\n          <div>\n            <Label className=\"yours-table-title\">You Deposit</Label>\n            <Value className=\"supply-color\">\n              <Widget\n                src=\"bluebiu.near/widget/Avalanche.Lending.Total\"\n                props={{\n                  total: state.userTotalSupplyUsd,\n                  digit: 2,\n                  unit: \"$\",\n                }}\n              />\n            </Value>\n          </div>\n          <Right>\n            <Label>Net APY</Label>\n            <Value>{currentDapp === \"All\" ? \"-\" : state.netApy}%</Value>\n          </Right>\n        </Title>\n        <Widget\n          src=\"bluebiu.near/widget/Avalanche.Lending.DepositTable\"\n          props={{\n            data: state.supplies || [],\n            onButtonClick: props.onButtonClick,\n          }}\n        />\n      </YoursTableWrapper>\n      <YoursTableWrapper>\n        <Title>\n          <div>\n            <Label className=\"yours-table-title\">Borrow</Label>\n            <Value className=\"borrow-color\">\n              <Widget\n                src=\"bluebiu.near/widget/Avalanche.Lending.Total\"\n                props={{\n                  total: state.userTotalBorrowUsd,\n                  digit: 2,\n                  unit: \"$\",\n                }}\n              />\n            </Value>\n          </div>\n          <Right>\n            <Label>Your Borrow Limit</Label>\n            <Value>{state.userBorrowLimit}%</Value>\n          </Right>\n        </Title>\n        <Widget\n          src=\"bluebiu.near/widget/Avalanche.Lending.BorrowTable\"\n          props={{\n            data: state.borrows || [],\n            onButtonClick: props.onButtonClick,\n          }}\n        />\n      </YoursTableWrapper>\n    </Yours> */}\n    <Widget\n      src=\"bluebiu.near/widget/Lending.LiquityPools\"\n      props={{\n        ...props,\n        markets: state.markets,\n        tvl: state.tvl,\n        deposits: state.deposits,\n        tokenBal: state.tokenBal,\n        onSuccess: () => {\n          State.update({\n            loading: true,\n          });\n        },\n      }}\n    />\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/Lending.LiquityYours", "fact_widget_deployments_id": "e37541d5aad9532ab028c04c621d1301", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
{"tx_hash": "8XUT1MtVvUynjXN51CW6cuei2Cc793tUJrZMoLDPcTFh", "action_id_social": "G6AtXVWrmPZp57FmejLHXsKPKgfkMZrsWTDhaS6kb2pc-0-widget", "block_id": 99479952, "block_timestamp": "2023-08-23T14:45:03.312Z", "signer_id": "bluebiu.near", "widget_name": "Mantle.getBalance", "source_code": "const { address, onLoad, isNative } = props;\nif (!address) return \"\";\n\nconst Erc20Abi = [\n  {\n    constant: true,\n    inputs: [\n      {\n        name: \"_owner\",\n        type: \"address\",\n      },\n    ],\n    name: \"balanceOf\",\n    outputs: [\n      {\n        name: \"balance\",\n        type: \"uint256\",\n      },\n    ],\n    payable: false,\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    constant: true,\n    inputs: [\n      {\n        name: \"_owner\",\n        type: \"address\",\n      },\n      {\n        name: \"_spender\",\n        type: \"address\",\n      },\n    ],\n    name: \"allowance\",\n    outputs: [\n      {\n        name: \"\",\n        type: \"uint256\",\n      },\n    ],\n    payable: false,\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    constant: false,\n    inputs: [\n      {\n        name: \"_spender\",\n        type: \"address\",\n      },\n      {\n        name: \"_value\",\n        type: \"uint256\",\n      },\n    ],\n    name: \"approve\",\n    outputs: [\n      {\n        name: \"\",\n        type: \"bool\",\n      },\n    ],\n    payable: false,\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n];\n\nconst sender = Ethers.send(\"eth_requestAccounts\", [])[0];\nif (!sender) return \"\";\nif (!Erc20Abi) return \"\";\n\nconst getErc20Balance = () => {\n  const Interface = new ethers.utils.Interface(Erc20Abi);\n  return Ethers.provider()\n    .call({\n      to: address,\n      data: Interface.encodeFunctionData(\"balanceOf\", [sender]),\n    })\n    .then((rawBalance) => {\n      const receiverBalanceHex = Interface.decodeFunctionResult(\n        \"balanceOf\",\n        rawBalance\n      );\n      onLoad?.({ balance: receiverBalanceHex.toString(), loaded: true });\n    });\n};\n\nconst getNativeBalance = () => {\n  const provider = Ethers.provider();\n  provider.getBalance(sender).then((rawBalance) => {\n    props?.onLoad({\n      balance: rawBalance.toString(),\n      loaded: true,\n    });\n  });\n};\n\nif (isNative) {\n  getNativeBalance();\n} else {\n  getErc20Balance();\n}\n\nreturn <div></div>;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/Mantle.getBalance", "fact_widget_deployments_id": "aa68c521e67fffbf99d5880665de9d51", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
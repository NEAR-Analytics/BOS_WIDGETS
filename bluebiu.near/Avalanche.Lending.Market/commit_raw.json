{"tx_hash": "4qbPXES2cE7Ja2TdqVz5TUDrWB6SZTi7FnVF3fdzES5z", "action_id_social": "44J2pQn9KaD4eta5mF83GeYsK3fbFx4JLoiMYAAZ7Kov-0-widget", "block_id": 102380511, "block_timestamp": "2023-10-01T14:57:28.319Z", "signer_id": "bluebiu.near", "widget_name": "Avalanche.Lending.Market", "source_code": "const Market = styled.div`\n  width: 100%;\n`;\nconst MarketTableHeader = styled.div`\n  display: flex;\n  align-items: center;\n  font-size: 14px;\n  font-weight: 500;\n  gap: 4px;\n  padding-left: 20px;\n`;\nconst Item = styled.div`\n  display: flex;\n  height: 38px;\n  gap: 6px;\n  align-items: center;\n  justify-content: center;\n  color: #fff;\n  flex-grow: 1;\n  &.td {\n    height: 52px;\n  }\n  &.asset {\n    width: 20%;\n    color: #7c7f96;\n    justify-content: left;\n    flex-grow: 0;\n  }\n  &.w_50 {\n    width: 50%;\n  }\n  &.w_33 {\n    width: 33.33333333%;\n  }\n`;\nconst MergeItems = styled.div`\n  display: flex;\n  align-items: center;\n  border-radius: 6px;\n  &.supply {\n    width: 32%;\n  }\n  &.header-supply {\n    background-color: var(--supply-bg-color);\n  }\n  &.body-supply {\n    cursor: pointer;\n    &:hover {\n      background-color: var(--supply-bg-color);\n    }\n  }\n  &.borrow {\n    width: 48%;\n  }\n  &.header-borrow {\n    background-color: var(--borrow-bg-color);\n  }\n  &.body-borrow {\n    cursor: pointer;\n    &:hover {\n      background-color: var(--borrow-bg-color);\n    }\n  }\n`;\nconst ArrowIconWrapper = styled.div`\n  opacity: 0.3;\n  cursor: pointer;\n  transform: rotate(90deg);\n  &.active {\n    opacity: 1;\n  }\n`;\nconst Row = styled.div`\n  margin-top: 4px;\n  display: flex;\n  align-items: center;\n  font-size: 14px;\n  font-weight: 500;\n  gap: 4px;\n  background-color: rgba(53, 55, 73, 0.2);\n  border-radius: 6px;\n  padding-left: 20px;\n`;\n\nState.init({\n  sortKey: \"supplyApy\",\n});\n\nconst { currentDapp, markets, dapps, onButtonClick } = props;\n\nconst formatData = (sortKey) => {\n  const marketsToList = Object.values(markets);\n  const data = marketsToList\n    .filter((market) => currentDapp === \"All\" || market.dapp === currentDapp)\n    .map((market) => {\n      const dapp = dapps[market.dapp];\n      return {\n        icon: market.icon,\n        symbol: market.underlyingToken.symbol,\n        dappIcon: dapp.dappIcon,\n        dappName: dapp.dappName,\n        totalSupply: Big(market.totalSupply)\n          .mul(market.underlyingPrice)\n          .toString(),\n        supplyApy: market.supplyApy,\n        totalBorrows: Big(market.totalBorrows)\n          .mul(market.underlyingPrice)\n          .toString(),\n        borrowApy: market.borrowApy,\n        liquidity: Big(market.liquidity).mul(market.underlyingPrice).toString(),\n        address: market.address,\n      };\n    });\n  data.sort((a, b) => parseInt(b[sortKey]) - parseInt(a[sortKey]));\n  State.update({ data });\n};\n\nconst prevMarketTimestamp = Storage.privateGet(\"prevMarketTimestampMarket\");\n\nif (prevMarketTimestamp !== props.timestamp) {\n  if (markets) {\n    formatData(state.sortKey);\n    Storage.privateSet(\"prevMarketTimestampMarket\", props.timestamp);\n  }\n}\n\nreturn (\n  <Market>\n    <MarketTableHeader>\n      <Item className=\"asset\">Asset</Item>\n      <MergeItems className=\"supply header-supply\">\n        <Item className=\"w_50\">Deposit</Item>\n        <Item className=\"w_50\">\n          Deposit APY\n          <ArrowIconWrapper\n            className={state.sortKey === \"supplyApy\" && \"active\"}\n            onClick={() => {\n              State.update({\n                sortKey: \"supplyApy\",\n              });\n              formateData(\"supplyApy\");\n            }}\n          >\n            <Widget\n              src=\"bluebiu.near/widget/0vix.LendingArrowIcon\"\n              props={{ color: \"#fff\" }}\n            />\n          </ArrowIconWrapper>\n        </Item>\n      </MergeItems>\n      <MergeItems className=\"borrow header-borrow\">\n        <Item className=\"w_33\">Borrowed</Item>\n        <Item className=\"w_33\">\n          Borrow APY\n          <ArrowIconWrapper\n            className={state.sortKey === \"borrowApy\" && \"active\"}\n            onClick={() => {\n              State.update({\n                sortKey: \"borrowApy\",\n              });\n              formateData(\"borrowApy\");\n            }}\n          >\n            <Widget\n              src=\"bluebiu.near/widget/0vix.LendingArrowIcon\"\n              props={{ color: \"#fff\" }}\n            />\n          </ArrowIconWrapper>\n        </Item>\n        <Item className=\"w_33\">\n          Market Size\n          <ArrowIconWrapper\n            className={state.sortKey === \"liquidity\" && \"active\"}\n            onClick={() => {\n              State.update({\n                sortKey: \"liquidity\",\n              });\n              formateData(\"liquidity\");\n            }}\n          >\n            <Widget\n              src=\"bluebiu.near/widget/0vix.LendingArrowIcon\"\n              props={{ color: \"#fff\" }}\n            />\n          </ArrowIconWrapper>\n        </Item>\n      </MergeItems>\n    </MarketTableHeader>\n    {(state.data || []).map((market) => (\n      <Row key={market.address}>\n        <Item className=\"td asset\">\n          <Widget\n            src=\"bluebiu.near/widget/Avalanche.Lending.Asset\"\n            props={{\n              icon: market.icon,\n              symbol: market.symbol,\n              dappIcon: market.dappIcon,\n              dappName: market.dappName,\n            }}\n          />\n        </Item>\n        <MergeItems\n          className=\"supply body-supply\"\n          onClick={() => {\n            onButtonClick(market.address, \"Deposit\");\n          }}\n        >\n          <Item className=\"td w_50\">\n            $\n            <Widget\n              src=\"bluebiu.near/widget/Avalanche.Lending.Total\"\n              props={{\n                total: market.totalSupply,\n                digit: 2,\n              }}\n            />\n          </Item>\n          <Item className=\"td w_50\">{market.supplyApy}</Item>\n        </MergeItems>\n        <MergeItems\n          className=\"borrow body-borrow\"\n          onClick={() => {\n            onButtonClick(market.address, \"Borrow\");\n          }}\n        >\n          <Item className=\"td w_33\">\n            $\n            <Widget\n              src=\"bluebiu.near/widget/Avalanche.Lending.Total\"\n              props={{\n                total: market.totalBorrows,\n                digit: 2,\n              }}\n            />\n          </Item>\n          <Item className=\"td w_33\">{market.borrowApy}</Item>\n          <Item className=\"td w_33\">\n            $\n            <Widget\n              src=\"bluebiu.near/widget/Avalanche.Lending.Total\"\n              props={{\n                total: market.liquidity,\n                digit: 2,\n              }}\n            />\n          </Item>\n        </MergeItems>\n      </Row>\n    ))}\n  </Market>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/Avalanche.Lending.Market", "fact_widget_deployments_id": "2ba24587d99658a8ce42b4f6307ad249", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 4}
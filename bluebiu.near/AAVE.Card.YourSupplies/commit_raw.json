{"tx_hash": "51qAdFb5wNTYX2EXtUTxZ3H9Kxh471Gp8PGw4ssVmwct", "action_id_social": "8yynRP1DjQE9vrd7K6qCdPBeikwVMASgAALdBRVWYtcw-0-widget", "block_id": 117682867, "block_timestamp": "2024-04-26T18:34:52.027Z", "signer_id": "bluebiu.near", "widget_name": "AAVE.Card.YourSupplies", "source_code": "const {\n  formatNumber,\n  config,\n  chainId,\n  yourSupplies,\n  yourTotalBorrow,\n  yourTotalCollateral,\n  onActionSuccess,\n  showWithdrawModal,\n  setShowWithdrawModal,\n  healthFactor,\n  withdrawETHGas,\n  withdrawERC20Gas,\n  formatHealthFactor,\n  calcHealthFactor,\n  account,\n  addAction,\n  dexConfig,\n  threshold,\n  prices,\n  theme,\n  onRefresh,\n} = props;\n\nState.init({\n  data: undefined,\n  showCollateralModal,\n});\n\nconst CenterItem = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\nconst WithdrawButton = ({ data }) => {\n  return (\n    <Widget\n      src={`${config.ownerId}/widget/AAVE.PrimaryButton`}\n      props={{\n        config,\n        theme,\n        // width: 148,\n        children: \"Withdraw\",\n        onClick: () => {\n          State.update({ data });\n          setShowWithdrawModal(true);\n        },\n      }}\n    />\n  );\n};\nconst renderCollateral = (record) => {\n  return (\n    <Widget\n      src=\"bluebiu.near/widget/Avalanche.Lending.Switch\"\n      props={{\n        theme,\n        onChange: () => {\n          console.log(\"--------\", record);\n\n          State.update({\n            data: record,\n            showCollateralModal: true,\n            flag: record.isCollateraled ? false : true,\n          });\n        },\n        active: record.isCollateraled ? true : false,\n      }}\n    />\n  );\n};\nreturn (\n  <>\n    {!yourSupplies || yourSupplies.length === 0 ? (\n      <Widget\n        src={`${config.ownerId}/widget/AAVE.Card.CardEmpty`}\n        props={{\n          config,\n          children: \"Nothing supplied yet\",\n        }}\n      />\n    ) : (\n      <>\n        <Widget\n          src={`${config.ownerId}/widget/AAVE.Card.CardsTable`}\n          props={{\n            config,\n            headers: [\"Asset\", \"Balance\", \"APY\", \"Collateral\", \"\"],\n            data: yourSupplies.map((row) => {\n              return [\n                <Widget\n                  src={`${config.ownerId}/widget/AAVE.Card.TokenWrapper`}\n                  props={{\n                    children: [\n                      <img width={64} height={64} src={row?.icon} />,\n                      <CenterItem>\n                        <div className=\"token-title\">{row.symbol}</div>\n                        {/* <div className=\"token-chain\">{row.name}</div> */}\n                      </CenterItem>,\n                    ],\n                  }}\n                />,\n                <div>\n                  <div>{Number(row.underlyingBalance).toFixed(7)}</div>\n                  <div>{formatNumber(row.underlyingBalanceUSD, 2)}</div>\n                </div>,\n\n                <div>\n                  <div>{`${(Number(row.supplyAPY) * 100).toFixed(2)} %`}</div>\n\n                  <div>\n                    {dexConfig.rewardToken && row.supplyRewardApy\n                      ? `${(Number(row.supplyRewardApy) * 100).toFixed(2)} %`\n                      : \"\"}\n                  </div>\n                </div>,\n                renderCollateral(row),\n\n                <WithdrawButton data={row} />,\n              ];\n            }),\n          }}\n        />\n      </>\n    )}\n    {showWithdrawModal && (\n      <Widget\n        src={`${config.ownerId}/widget/AAVE.Modal.WithdrawModal`}\n        props={{\n          config,\n          theme,\n          chainId,\n          data: {\n            ...state.data,\n            healthFactor,\n          },\n          dexConfig,\n          onActionSuccess,\n          withdrawETHGas,\n          withdrawERC20Gas,\n          formatHealthFactor,\n          calcHealthFactor,\n          account,\n          prices,\n          yourTotalBorrow,\n          yourTotalCollateral,\n          threshold,\n          addAction,\n          onRequestClose: () => setShowWithdrawModal(false),\n        }}\n      />\n    )}\n    {state.showCollateralModal && (\n      <Widget\n        src={`${config.ownerId}/widget/AAVE.Modal.CollateralModal`}\n        props={{\n          flag: state.flag,\n          config,\n          theme,\n          chainId,\n          data: {\n            ...state.data,\n            healthFactor,\n          },\n          onActionSuccess,\n          formatHealthFactor,\n          calcHealthFactor,\n          yourTotalBorrow,\n          account,\n          onRequestClose: () => {\n            State.update({\n              showCollateralModal: false,\n            });\n            onRefresh?.();\n          },\n        }}\n      />\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/AAVE.Card.YourSupplies", "fact_widget_deployments_id": "3536709a5e8ad29384a0e811789d48af", "inserted_timestamp": "2024-04-26T19:40:29.167Z", "modified_timestamp": "2024-04-26T20:40:37.200Z", "__row_index": 11}
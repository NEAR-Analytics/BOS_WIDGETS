{"tx_hash": "FoyakR9JS4dm92ZWPgssuxcpktFcHApPuxzmngs91Utb", "action_id_social": "DzFp7hKt4Aj5z5coEaxD4vTF4rMVNXfyaQN69nYc4rrb-0-widget", "block_id": 99921764, "block_timestamp": "2023-08-29T10:39:35.097Z", "signer_id": "bluebiu.near", "widget_name": "RainbowBridge.transfer", "source_code": "const {\n  token,\n  config,\n  sender,\n  loadTransder,\n  amountIn,\n  forceReload,\n  sourceBridge,\n  callBack,\n} = props;\n\nconst qs = `${token.ethereum_address}-${token.near_address}-${sourceBridge}-${amountIn}-${forceReload}`;\n\nif (qs !== state.cacheQs) {\n  State.update({\n    cacheQs: qs,\n  });\n} else {\n  return \"\";\n}\n\nconst expandToken = (value, decimals) => {\n  return new Big(value).mul(new Big(10).pow(decimals));\n};\n\nconst lockerAbi = [\n  {\n    inputs: [\n      {\n        internalType: \"bytes\",\n        name: \"nearTokenFactory\",\n        type: \"bytes\",\n      },\n      {\n        internalType: \"contract INearProver\",\n        name: \"prover\",\n        type: \"address\",\n      },\n      {\n        internalType: \"uint64\",\n        name: \"minBlockAcceptanceHeight\",\n        type: \"uint64\",\n      },\n      {\n        internalType: \"address\",\n        name: \"_admin\",\n        type: \"address\",\n      },\n      {\n        internalType: \"uint256\",\n        name: \"pausedFlags\",\n        type: \"uint256\",\n      },\n    ],\n    stateMutability: \"nonpayable\",\n    type: \"constructor\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        indexed: true,\n        internalType: \"address\",\n        name: \"token\",\n        type: \"address\",\n      },\n      {\n        indexed: true,\n        internalType: \"address\",\n        name: \"sender\",\n        type: \"address\",\n      },\n      {\n        indexed: false,\n        internalType: \"uint256\",\n        name: \"amount\",\n        type: \"uint256\",\n      },\n      {\n        indexed: false,\n        internalType: \"string\",\n        name: \"accountId\",\n        type: \"string\",\n      },\n    ],\n    name: \"Locked\",\n    type: \"event\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        indexed: false,\n        internalType: \"uint128\",\n        name: \"amount\",\n        type: \"uint128\",\n      },\n      {\n        indexed: false,\n        internalType: \"address\",\n        name: \"recipient\",\n        type: \"address\",\n      },\n    ],\n    name: \"Unlocked\",\n    type: \"event\",\n  },\n  {\n    inputs: [],\n    name: \"admin\",\n    outputs: [\n      {\n        internalType: \"address\",\n        name: \"\",\n        type: \"address\",\n      },\n    ],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"address\",\n        name: \"target\",\n        type: \"address\",\n      },\n      {\n        internalType: \"bytes\",\n        name: \"data\",\n        type: \"bytes\",\n      },\n    ],\n    name: \"adminDelegatecall\",\n    outputs: [\n      {\n        internalType: \"bytes\",\n        name: \"\",\n        type: \"bytes\",\n      },\n    ],\n    stateMutability: \"payable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"uint256\",\n        name: \"flags\",\n        type: \"uint256\",\n      },\n    ],\n    name: \"adminPause\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"adminReceiveEth\",\n    outputs: [],\n    stateMutability: \"payable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"address payable\",\n        name: \"destination\",\n        type: \"address\",\n      },\n      {\n        internalType: \"uint256\",\n        name: \"amount\",\n        type: \"uint256\",\n      },\n    ],\n    name: \"adminSendEth\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"uint256\",\n        name: \"key\",\n        type: \"uint256\",\n      },\n      {\n        internalType: \"uint256\",\n        name: \"value\",\n        type: \"uint256\",\n      },\n    ],\n    name: \"adminSstore\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"contract IERC20\",\n        name: \"token\",\n        type: \"address\",\n      },\n      {\n        internalType: \"address\",\n        name: \"destination\",\n        type: \"address\",\n      },\n      {\n        internalType: \"uint256\",\n        name: \"amount\",\n        type: \"uint256\",\n      },\n    ],\n    name: \"adminTransfer\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"address\",\n        name: \"ethToken\",\n        type: \"address\",\n      },\n      {\n        internalType: \"uint256\",\n        name: \"amount\",\n        type: \"uint256\",\n      },\n      {\n        internalType: \"string\",\n        name: \"accountId\",\n        type: \"string\",\n      },\n    ],\n    name: \"lockToken\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"minBlockAcceptanceHeight_\",\n    outputs: [\n      {\n        internalType: \"uint64\",\n        name: \"\",\n        type: \"uint64\",\n      },\n    ],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"nearTokenFactory_\",\n    outputs: [\n      {\n        internalType: \"bytes\",\n        name: \"\",\n        type: \"bytes\",\n      },\n    ],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"paused\",\n    outputs: [\n      {\n        internalType: \"uint256\",\n        name: \"\",\n        type: \"uint256\",\n      },\n    ],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"prover_\",\n    outputs: [\n      {\n        internalType: \"contract INearProver\",\n        name: \"\",\n        type: \"address\",\n      },\n    ],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"address\",\n        name: \"_from\",\n        type: \"address\",\n      },\n      {\n        internalType: \"uint256\",\n        name: \"_value\",\n        type: \"uint256\",\n      },\n      {\n        internalType: \"bytes\",\n        name: \"_data\",\n        type: \"bytes\",\n      },\n    ],\n    name: \"tokenFallback\",\n    outputs: [],\n    stateMutability: \"pure\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"bytes\",\n        name: \"proofData\",\n        type: \"bytes\",\n      },\n      {\n        internalType: \"uint64\",\n        name: \"proofBlockHeight\",\n        type: \"uint64\",\n      },\n    ],\n    name: \"unlockToken\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"bytes32\",\n        name: \"\",\n        type: \"bytes32\",\n      },\n    ],\n    name: \"usedProofs_\",\n    outputs: [\n      {\n        internalType: \"bool\",\n        name: \"\",\n        type: \"bool\",\n      },\n    ],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n];\nconst signer = Ethers.provider().getSigner();\n\nconst eNearAbi = [\n  {\n    inputs: [\n      { internalType: \"string\", name: \"_tokenName\", type: \"string\" },\n      { internalType: \"string\", name: \"_tokenSymbol\", type: \"string\" },\n      { internalType: \"bytes\", name: \"_nearConnector\", type: \"bytes\" },\n      {\n        internalType: \"contract INearProver\",\n        name: \"_prover\",\n        type: \"address\",\n      },\n      {\n        internalType: \"uint64\",\n        name: \"_minBlockAcceptanceHeight\",\n        type: \"uint64\",\n      },\n      { internalType: \"address\", name: \"_admin\", type: \"address\" },\n      { internalType: \"uint256\", name: \"_pausedFlags\", type: \"uint256\" },\n    ],\n    stateMutability: \"nonpayable\",\n    type: \"constructor\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        indexed: true,\n        internalType: \"address\",\n        name: \"owner\",\n        type: \"address\",\n      },\n      {\n        indexed: true,\n        internalType: \"address\",\n        name: \"spender\",\n        type: \"address\",\n      },\n      {\n        indexed: false,\n        internalType: \"uint256\",\n        name: \"value\",\n        type: \"uint256\",\n      },\n    ],\n    name: \"Approval\",\n    type: \"event\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        indexed: true,\n        internalType: \"bytes32\",\n        name: \"_receiptId\",\n        type: \"bytes32\",\n      },\n    ],\n    name: \"ConsumedProof\",\n    type: \"event\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        indexed: false,\n        internalType: \"uint128\",\n        name: \"amount\",\n        type: \"uint128\",\n      },\n      {\n        indexed: true,\n        internalType: \"address\",\n        name: \"recipient\",\n        type: \"address\",\n      },\n    ],\n    name: \"NearToEthTransferFinalised\",\n    type: \"event\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      { indexed: true, internalType: \"address\", name: \"from\", type: \"address\" },\n      { indexed: true, internalType: \"address\", name: \"to\", type: \"address\" },\n      {\n        indexed: false,\n        internalType: \"uint256\",\n        name: \"value\",\n        type: \"uint256\",\n      },\n    ],\n    name: \"Transfer\",\n    type: \"event\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        indexed: true,\n        internalType: \"address\",\n        name: \"sender\",\n        type: \"address\",\n      },\n      {\n        indexed: false,\n        internalType: \"uint256\",\n        name: \"amount\",\n        type: \"uint256\",\n      },\n      {\n        indexed: false,\n        internalType: \"string\",\n        name: \"accountId\",\n        type: \"string\",\n      },\n    ],\n    name: \"TransferToNearInitiated\",\n    type: \"event\",\n  },\n  {\n    inputs: [],\n    name: \"admin\",\n    outputs: [{ internalType: \"address\", name: \"\", type: \"address\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address\", name: \"target\", type: \"address\" },\n      { internalType: \"bytes\", name: \"data\", type: \"bytes\" },\n    ],\n    name: \"adminDelegatecall\",\n    outputs: [{ internalType: \"bytes\", name: \"\", type: \"bytes\" }],\n    stateMutability: \"payable\",\n    type: \"function\",\n  },\n  {\n    inputs: [{ internalType: \"uint256\", name: \"flags\", type: \"uint256\" }],\n    name: \"adminPause\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"adminReceiveEth\",\n    outputs: [],\n    stateMutability: \"payable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address payable\", name: \"destination\", type: \"address\" },\n      { internalType: \"uint256\", name: \"amount\", type: \"uint256\" },\n    ],\n    name: \"adminSendEth\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"uint256\", name: \"key\", type: \"uint256\" },\n      { internalType: \"uint256\", name: \"value\", type: \"uint256\" },\n    ],\n    name: \"adminSstore\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address\", name: \"owner\", type: \"address\" },\n      { internalType: \"address\", name: \"spender\", type: \"address\" },\n    ],\n    name: \"allowance\",\n    outputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address\", name: \"spender\", type: \"address\" },\n      { internalType: \"uint256\", name: \"amount\", type: \"uint256\" },\n    ],\n    name: \"approve\",\n    outputs: [{ internalType: \"bool\", name: \"\", type: \"bool\" }],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [{ internalType: \"address\", name: \"account\", type: \"address\" }],\n    name: \"balanceOf\",\n    outputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"decimals\",\n    outputs: [{ internalType: \"uint8\", name: \"\", type: \"uint8\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address\", name: \"spender\", type: \"address\" },\n      { internalType: \"uint256\", name: \"subtractedValue\", type: \"uint256\" },\n    ],\n    name: \"decreaseAllowance\",\n    outputs: [{ internalType: \"bool\", name: \"\", type: \"bool\" }],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"bytes\", name: \"proofData\", type: \"bytes\" },\n      { internalType: \"uint64\", name: \"proofBlockHeight\", type: \"uint64\" },\n    ],\n    name: \"finaliseNearToEthTransfer\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address\", name: \"spender\", type: \"address\" },\n      { internalType: \"uint256\", name: \"addedValue\", type: \"uint256\" },\n    ],\n    name: \"increaseAllowance\",\n    outputs: [{ internalType: \"bool\", name: \"\", type: \"bool\" }],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"minBlockAcceptanceHeight\",\n    outputs: [{ internalType: \"uint64\", name: \"\", type: \"uint64\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"name\",\n    outputs: [{ internalType: \"string\", name: \"\", type: \"string\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"nearConnector\",\n    outputs: [{ internalType: \"bytes\", name: \"\", type: \"bytes\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"paused\",\n    outputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"prover\",\n    outputs: [\n      { internalType: \"contract INearProver\", name: \"\", type: \"address\" },\n    ],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"symbol\",\n    outputs: [{ internalType: \"string\", name: \"\", type: \"string\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"totalSupply\",\n    outputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address\", name: \"recipient\", type: \"address\" },\n      { internalType: \"uint256\", name: \"amount\", type: \"uint256\" },\n    ],\n    name: \"transfer\",\n    outputs: [{ internalType: \"bool\", name: \"\", type: \"bool\" }],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address\", name: \"sender\", type: \"address\" },\n      { internalType: \"address\", name: \"recipient\", type: \"address\" },\n      { internalType: \"uint256\", name: \"amount\", type: \"uint256\" },\n    ],\n    name: \"transferFrom\",\n    outputs: [{ internalType: \"bool\", name: \"\", type: \"bool\" }],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"uint256\", name: \"_amount\", type: \"uint256\" },\n      {\n        internalType: \"string\",\n        name: \"_nearReceiverAccountId\",\n        type: \"string\",\n      },\n    ],\n    name: \"transferToNear\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [{ internalType: \"bytes32\", name: \"\", type: \"bytes32\" }],\n    name: \"usedProofs\",\n    outputs: [{ internalType: \"bool\", name: \"\", type: \"bool\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n];\n\nconst custodianAbi = [\n  {\n    inputs: [\n      { internalType: \"bytes\", name: \"nearEvm\", type: \"bytes\" },\n      { internalType: \"contract INearProver\", name: \"prover\", type: \"address\" },\n      {\n        internalType: \"uint64\",\n        name: \"minBlockAcceptanceHeight\",\n        type: \"uint64\",\n      },\n      { internalType: \"address\", name: \"_admin\", type: \"address\" },\n      { internalType: \"uint256\", name: \"pausedFlags\", type: \"uint256\" },\n    ],\n    stateMutability: \"nonpayable\",\n    type: \"constructor\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        indexed: true,\n        internalType: \"address\",\n        name: \"sender\",\n        type: \"address\",\n      },\n      {\n        indexed: false,\n        internalType: \"string\",\n        name: \"recipient\",\n        type: \"string\",\n      },\n      {\n        indexed: false,\n        internalType: \"uint256\",\n        name: \"amount\",\n        type: \"uint256\",\n      },\n      { indexed: false, internalType: \"uint256\", name: \"fee\", type: \"uint256\" },\n    ],\n    name: \"Deposited\",\n    type: \"event\",\n  },\n  {\n    anonymous: false,\n    inputs: [\n      {\n        indexed: true,\n        internalType: \"address\",\n        name: \"recipient\",\n        type: \"address\",\n      },\n      {\n        indexed: false,\n        internalType: \"uint128\",\n        name: \"amount\",\n        type: \"uint128\",\n      },\n    ],\n    name: \"Withdrawn\",\n    type: \"event\",\n  },\n  {\n    inputs: [],\n    name: \"admin\",\n    outputs: [{ internalType: \"address\", name: \"\", type: \"address\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address\", name: \"target\", type: \"address\" },\n      { internalType: \"bytes\", name: \"data\", type: \"bytes\" },\n    ],\n    name: \"adminDelegatecall\",\n    outputs: [{ internalType: \"bytes\", name: \"\", type: \"bytes\" }],\n    stateMutability: \"payable\",\n    type: \"function\",\n  },\n  {\n    inputs: [{ internalType: \"uint256\", name: \"flags\", type: \"uint256\" }],\n    name: \"adminPause\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"adminReceiveEth\",\n    outputs: [],\n    stateMutability: \"payable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"address payable\", name: \"destination\", type: \"address\" },\n      { internalType: \"uint256\", name: \"amount\", type: \"uint256\" },\n    ],\n    name: \"adminSendEth\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"uint256\", name: \"key\", type: \"uint256\" },\n      { internalType: \"uint256\", name: \"value\", type: \"uint256\" },\n    ],\n    name: \"adminSstore\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"uint256\", name: \"key\", type: \"uint256\" },\n      { internalType: \"uint256\", name: \"value\", type: \"uint256\" },\n      { internalType: \"uint256\", name: \"mask\", type: \"uint256\" },\n    ],\n    name: \"adminSstoreWithMask\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"string\", name: \"ethRecipientOnNear\", type: \"string\" },\n      { internalType: \"uint256\", name: \"fee\", type: \"uint256\" },\n    ],\n    name: \"depositToEVM\",\n    outputs: [],\n    stateMutability: \"payable\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      {\n        internalType: \"string\",\n        name: \"nearRecipientAccountId\",\n        type: \"string\",\n      },\n      { internalType: \"uint256\", name: \"fee\", type: \"uint256\" },\n    ],\n    name: \"depositToNear\",\n    outputs: [],\n    stateMutability: \"payable\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"minBlockAcceptanceHeight_\",\n    outputs: [{ internalType: \"uint64\", name: \"\", type: \"uint64\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"nearProofProducerAccount_\",\n    outputs: [{ internalType: \"bytes\", name: \"\", type: \"bytes\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"paused\",\n    outputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [],\n    name: \"prover_\",\n    outputs: [\n      { internalType: \"contract INearProver\", name: \"\", type: \"address\" },\n    ],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [{ internalType: \"bytes32\", name: \"\", type: \"bytes32\" }],\n    name: \"usedEvents_\",\n    outputs: [{ internalType: \"bool\", name: \"\", type: \"bool\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    inputs: [\n      { internalType: \"bytes\", name: \"proofData\", type: \"bytes\" },\n      { internalType: \"uint64\", name: \"proofBlockHeight\", type: \"uint64\" },\n    ],\n    name: \"withdraw\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\",\n  },\n];\n\nconst ethLockerContract = new ethers.Contract(\n  config.ethLockerAddress,\n  lockerAbi,\n  signer\n);\n\nconst eNearContract = new ethers.Contract(\n  config.enearAddress,\n  eNearAbi,\n  signer\n);\n\nconst etherCustodianContract = new ethers.Contract(\n  config.etherCustodianAddress,\n  custodianAbi,\n  signer\n);\n\nconst queryString = `${token.ethereum_address}-${token.near_address}-${isApprovedOut}-${forceReload}-${amountIn}`;\n\nif (queryString !== state.cacheString) {\n  State.update({\n    cacheString: queryString,\n  });\n} else {\n  return \"\";\n}\n\n// near to eth\nconst sendNearToEthereum = () => {\n  const recipient = sender.replace(\"0x\", \"\");\n  const tx = [\n    {\n      contractName: \"e-near.near\",\n      methodName: \"migrate_to_ethereum\",\n      gas: \"300\" + \"0\".repeat(12),\n      deposit: expandToken(amountIn, token.decimals).toFixed(),\n      args: {\n        eth_recipient: recipient,\n      },\n    },\n  ];\n\n  Near.call(tx);\n};\n\n// near to near\nconst sendNearToNear = () => {\n  return eNearContract\n    .transferToNear(expandToken(amountIn, token.decimals).toFixed(), accountId)\n    .then((res) => {\n      callBack && callBack();\n    });\n};\n\nconst sendEthToNear = () => {\n  return etherCustodianContract\n    .depositToNear(accountId, 0, {\n      value: expandToken(amountIn, token.decimals).toFixed(),\n    })\n    .then(() => {\n      callBack && callBack();\n    });\n};\n\nconst sendEthToEthereum = () => {\n  const recipient_id = ethers.utils.arrayify(ethers.utils.getAddress(sender));\n  const amount = expandToken(amountIn, token.decimals).toFixed();\n\n  const args = {\n    recipient_id,\n    amount,\n  };\n\n  const bufferArgs = Buffer.from(JSON.stringify(args));\n\n  const tx = [\n    {\n      contractName: \"aurora\",\n      methodName: \"withdraw\",\n      args: bufferArgs,\n      deposit: 1,\n      gas: \"300\" + \"0\".repeat(12),\n    },\n  ];\n\n  Near.call(tx);\n};\n\n// nep141 to eth\nconst sendNep141toEth = () => {\n  const tx = [\n    {\n      contractName: token.near_address,\n      methodName: \"withdraw\",\n      gas: \"300\" + \"0\".repeat(12),\n\n      deposit: 1,\n      args: {\n        amount: expandToken(amountIn, token.decimals).toFixed(),\n        recipient: sender.replace(\"0x\", \"\"),\n      },\n    },\n  ];\n\n  Near.call(tx);\n};\n\n// erc20 to near\nconst sendERC20toNear = () => {\n  ethLockerContract\n    .lockToken(\n      token.ethereum_address,\n      expandToken(amountIn, token.decimals).toFixed(),\n      accountId\n    )\n    .then(() => {\n      callBack && callBack();\n    });\n};\n\nloadTransder({\n  transfer: sendEthToEthereum,\n});\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/RainbowBridge.transfer", "fact_widget_deployments_id": "fdeb534c79e8a74cb3a5b3126fe35726", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
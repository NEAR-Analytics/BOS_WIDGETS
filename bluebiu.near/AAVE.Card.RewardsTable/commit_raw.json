{"tx_hash": "AiQccPFDhqEVzzeUozr5PzHYewABW6bbYwSJAj3ndg2p", "action_id_social": "3shRoqGtu8cs1msW8Q74Dz96HVAaAQvVdpBAH5UNc6XL-0-widget", "block_id": 116669552, "block_timestamp": "2024-04-12T07:57:48.100Z", "signer_id": "bluebiu.near", "widget_name": "AAVE.Card.RewardsTable", "source_code": "const RewardsTable = styled.div`\n  background-color: rgba(53, 55, 73, 0.2);\n  margin-top: 20px;\n  border-radius: 6px;\n`;\nconst Title = styled.div`\n  padding: 10px 20px;\n  font-size: 16px;\n  font-weight: 400;\n  color: #fff;\n`;\n\nconst NoReward = styled.div`\n  margin: 0 auto;\n  padding-bottom: 28px;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  justify-content: center;\n  gap: 12px;\n`;\n\nState.init({\n  loading: false,\n  dapp: null,\n  record: null,\n  curIndex: -1,\n});\n\nconst {\n  data,\n  dapps,\n  toast,\n  account,\n  onSuccess,\n  markets,\n  rewardAddress,\n  formatNumber,\n  config,\n  prices,\n  theme,\n} = props;\n\nconst TokenAsset = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 5px;\n`;\nconst TokenIcon = styled.img`\n  width: 28px;\n`;\nconst TokenAmount = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n`;\n\nconst columns = [\n  {\n    type: \"name\",\n    width: \"30%\",\n    name: \"Reward Asset\",\n  },\n  {\n    type: \"total\",\n    key: \"unclaimed\",\n    width: \"25%\",\n    name: \"Rewards\",\n  },\n  { type: \"button\", width: \"20%\" },\n];\n\nfunction formatValue(value, digits) {\n  if (Number(value) === 0) return \"0\";\n  return Big(value || 0).lt(0.01)\n    ? \"< 0.01\"\n    : `${Number(value).toFixed(digits || 2)}`;\n}\nconst seamTokens = [\"OG Points\", \"SEAM\", \"esSEAM\"];\n\nfunction renderUSD(symbol, amount) {\n  if (symbol === \"earlyZERO\") {\n    return formatNumber(Big(0.00025055).times(Big(amount)).toFixed());\n  }\n  // seamless\n  if (seamTokens.includes(symbol)) {\n    return formatNumber(\n      Big(prices[\"SEAM\"] || 0)\n        .times(Big(amount))\n        .toFixed()\n    );\n  }\n  if (!prices[symbol]) return null;\n\n  return formatNumber(Big(prices[symbol]).times(Big(amount)).toFixed());\n}\n\nreturn (\n  <>\n    <RewardsTable>\n      <Title>Your Earns</Title>\n\n      {data && data.length && data.find((item) => item.unclaimed) ? (\n        <Widget\n          src={`${config.ownerId}/widget/AAVE.Card.CardsTable`}\n          props={{\n            config,\n            headers: [\"Reward Asset\", \"Rewards\", \"\"],\n            data: data.map((row, index) => {\n              return [\n                <TokenAsset>\n                  {row.icon ? <TokenIcon src={row.icon} /> : null}\n                  {`${row.symbol}`}\n                </TokenAsset>,\n                <TokenAmount>\n                  <span>\n                    {row.unclaimed ? formatValue(row.unclaimed) : \"-\"}\n                  </span>\n                  <span>{renderUSD(row.symbol, row.unclaimed)}</span>\n                </TokenAmount>,\n\n                <Widget\n                  src={`${config.ownerId}/widget/AAVE.PrimaryButton`}\n                  props={{\n                    config,\n                    theme,\n                    disabled: !Number(row.unclaimed),\n                    width: 80,\n                    loading: state.loading && index === state.curIndex,\n                    children: \"Claim\",\n                    onClick: (record) => {\n                      const toastId = toast?.loading({\n                        title: `Claiming rewards...`,\n                      });\n                      State.update({\n                        dapp: dapps,\n                        loading: true,\n                        toastId,\n                        curIndex: index,\n                      });\n                    },\n                  }}\n                />,\n              ];\n            }),\n          }}\n        />\n      ) : (\n        <NoReward>\n          <div>You don't have unclaimed rewards</div>\n          <div\n            style={{\n              fontSize: \"18px\",\n            }}\n          >\n            $0.00\n          </div>\n        </NoReward>\n      )}\n    </RewardsTable>\n    {state.loading && state.dapp && (\n      <Widget\n        src={dapps.handlerClaim}\n        props={{\n          markets,\n          rewardAddress,\n          loading: state.loading,\n          account,\n          onSuccess: (res) => {\n            toast?.dismiss(state.toastId);\n            State.update({ loading: false, curIndex: -1 });\n            toast?.success({ title: \"Claimed successfully!\" });\n            onSuccess?.();\n          },\n          onError: (err) => {\n            toast?.dismiss(state.toastId);\n            State.update({ loading: false, curIndex: -1 });\n            toast?.fail({\n              title: err?.message?.includes(\"user rejected transaction\")\n                ? \"User rejected transaction\"\n                : `Claimed faily!`,\n              chainId,\n            });\n          },\n        }}\n      />\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/AAVE.Card.RewardsTable", "fact_widget_deployments_id": "03fcac802f1cf99c793f520180e60b78", "inserted_timestamp": "2024-04-12T10:36:03.279Z", "modified_timestamp": "2024-04-12T10:36:03.279Z", "__row_index": 2}
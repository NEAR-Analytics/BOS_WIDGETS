{"tx_hash": "Evgv8ZfvY3EHTmdQjXaogwcadzpjMx2REhaVuuzeL1TC", "action_id_social": "DtXDjRjUAesKUKwTVUuS8PzjzHU9mUG2n6XwfiRckREY-0-widget", "block_id": 107352924, "block_timestamp": "2023-12-07T10:38:33.022Z", "signer_id": "bluebiu.near", "widget_name": "0vix.Lending", "source_code": "const CHAIN_ID = 1101;\nconst CHAIN_NAME = \"Polygon zkEVM\";\nconst CONNECT_PROPS = {\n  imgProps: {\n    src: \"https://ipfs.near.social/ipfs/bafkreifi7o6vdby32twf7hcunoc3sbnb34qlbkpu64tiru4qhjx27i77m4\",\n    style: {\n      width: \"252px\",\n      height: \"220px\",\n      marginTop: \"60px\",\n    },\n  },\n  noAccountTips: \"0vix Lending\",\n  wrongNetworkTips: \"To proceed, kindly switch to Polygon zkEVM Chain.\",\n  chainId: CHAIN_ID,\n  chainName: CHAIN_NAME,\n};\nconst account = Ethers.send(\"eth_requestAccounts\", [])[0];\nif (!account) {\n  return (\n    <Widget\n      src=\"bluebiu.near/widget/0vix.LendingConntect\"\n      props={{\n        ...CONNECT_PROPS,\n        isWrongNetwork: false,\n      }}\n    />\n  );\n}\nState.init({\n  chainId: -1,\n  type: props.tab === \"borrow\" ? 1 : 0, // 0 for supply, 1 for borrow\n  showDialog: false,\n  tableButtonClickData: null,\n  updateData: true,\n});\nEthers.provider()\n  .getNetwork()\n  .then(({ chainId }) => {\n    State.update({ chainId });\n  })\n  .catch(() => {});\n\nif (state.chainId !== CHAIN_ID) {\n  return (\n    <Widget\n      src=\"bluebiu.near/widget/0vix.LendingConntect\"\n      props={{\n        ...CONNECT_PROPS,\n        isWrongNetwork: true,\n      }}\n    />\n  );\n}\nconst MULTICALL_ADDRESS = \"0x7f593DEdebE173CA12954164dc3db56131FCA0F7\";\nconst UNITROLLER_ADDRESS = \"0x6EA32f626e3A5c41547235ebBdf861526e11f482\";\nconst ORACLE_ADDRESS = \"0xBC81104207C160cFE48585cC8D753aD2c7031FF7\";\nconst MARKETS = {\n  \"0x8903Dc1f4736D2FcB90C1497AebBABA133DaAC76\": {\n    underlyingToken: {\n      address: \"0xa2036f0538221a77A3937F1379699f44945018d0\",\n      decimals: 18,\n      symbol: \"MATIC\",\n    },\n    decimals: 8,\n    symbol: \"oMATIC\",\n    address: \"0x8903Dc1f4736D2FcB90C1497AebBABA133DaAC76\",\n    logo: \"https://app.0vix.com/static/media/MATIC-logo.a9a2a3e9.svg\",\n    geckoId: \"matic-network\",\n  },\n  \"0x68d9baA40394dA2e2c1ca05d30BF33F52823ee7B\": {\n    underlyingToken: {\n      address: \"0xA8CE8aee21bC2A48a5EF670afCc9274C7bbbC035\",\n      decimals: 6,\n      symbol: \"USDC\",\n    },\n    decimals: 8,\n    symbol: \"oUSDC\",\n    address: \"0x68d9baA40394dA2e2c1ca05d30BF33F52823ee7B\",\n    logo: \"https://app.0vix.com/static/media/USDC-logo.817a96c8.svg\",\n    geckoId: \"usd-coin\",\n  },\n  \"0xad41C77d99E282267C1492cdEFe528D7d5044253\": {\n    underlyingToken: {\n      address: \"0x1E4a5963aBFD975d8c9021ce480b42188849D41d\",\n      decimals: 6,\n      symbol: \"USDT\",\n    },\n    decimals: 8,\n    symbol: \"oUSDT\",\n    address: \"0xad41C77d99E282267C1492cdEFe528D7d5044253\",\n    logo: \"https://app.0vix.com/static/media/USDT-logo.fcda5855.svg\",\n    geckoId: \"tether\",\n  },\n  \"0xee1727f5074E747716637e1776B7F7C7133f16b1\": {\n    underlyingToken: {\n      address: \"native\",\n      decimals: 18,\n      symbol: \"ETH\",\n    },\n    decimals: 8,\n    symbol: \"oETH\",\n    address: \"0xee1727f5074E747716637e1776B7F7C7133f16b1\",\n    logo: \"https://app.0vix.com/static/media/ETH-logo.0aebd865.svg\",\n    geckoId: \"ethereum\",\n  },\n  \"0xbC59506A5Ce024B892776d4F7dd450B0FB3584A2\": {\n    underlyingToken: {\n      address: \"0x4F9A0e7FD2Bf6067db6994CF12E4495Df938E6e9\",\n      decimals: 18,\n      symbol: \"WETH\",\n    },\n    decimals: 8,\n    symbol: \"oWETH\",\n    address: \"0xbC59506A5Ce024B892776d4F7dd450B0FB3584A2\",\n    logo: \"https://app.0vix.com/static/media/weth-logo.68e99309.png\",\n    geckoId: \"ethereum\",\n  },\n  \"0x503deabad9641c5B4015041eEb0F1263E415715D\": {\n    underlyingToken: {\n      address: \"0xEA034fb02eB1808C2cc3adbC15f447B93CbE08e1\",\n      decimals: 8,\n      symbol: \"WBTC\",\n    },\n    decimals: 8,\n    symbol: \"oWBTC\",\n    address: \"0x503deabad9641c5B4015041eEb0F1263E415715D\",\n    logo: \"https://app.0vix.com/static/media/WBTC-logo.01924833.svg\",\n    geckoId: \"bitcoin\",\n  },\n};\n\nconst Container = styled.div`\n  width: 100%;\n  max-width: 858px;\n  margin: 0 auto;\n  position: relative;\n  height: 100%;\n`;\nconst Spacer = styled.div`\n  height: 10px;\n`;\n\nconst handleTableButtonClick = (address, actionText) => {\n  const record = state.data?.markets.find(\n    (market) => market.address === address\n  );\n  State.update({\n    tableButtonClickData: {\n      record,\n      actionText,\n    },\n    showDialog: true,\n  });\n};\nreturn (\n  <>\n    {state.updateData && (\n      <Widget src=\"bluebiu.near/widget/0vix.LendingSpinner\" />\n    )}\n    <Container\n      style={{\n        overflow: state.updateData || state.showDialog ? \"hidden\" : \"auto\",\n      }}\n    >\n      {state.updateData && (\n        <Widget\n          src=\"bluebiu.near/widget/0vix.LendingData\"\n          props={{\n            markets: MARKETS,\n            multicallAddress: MULTICALL_ADDRESS,\n            unitrollerAddress: UNITROLLER_ADDRESS,\n            oracleAddress: ORACLE_ADDRESS,\n            update: state.updateData,\n            account,\n            onLoad: (data) => {\n              console.log(\"update data\", data);\n              State.update({\n                data,\n                updateData: false,\n                totalSupplyUsd: data.totalSupplyUsd,\n                totalBorrowUsd: data.totalBorrowUsd,\n              });\n            },\n          }}\n        />\n      )}\n      {/* Total */}\n      <Widget\n        src=\"bluebiu.near/widget/0vix.LendingTotal\"\n        props={{\n          totalSupply: state.totalSupplyUsd || 0,\n          totalBorrow: state.totalBorrowUsd || 0,\n        }}\n      />\n      {/* User Dash Panel */}\n      <Widget\n        src=\"bluebiu.near/widget/0vix.LendingDashPanel\"\n        props={{\n          userSupply: state.data?.userTotalSupplyUsd,\n          userBorrow: state.data?.userTotalBorrowUsd,\n          accountLiquidity: state.data?.accountLiquidity,\n          healthFactor: state.data?.healthFactor,\n        }}\n      />\n      <Widget\n        src=\"bluebiu.near/widget/0vix.LendingSwitcher\"\n        props={{\n          onChange: (type) => {\n            State.update({ type });\n          },\n          type: state.type,\n        }}\n      />\n      {state.type === 0 && (\n        <>\n          <Widget\n            src=\"bluebiu.near/widget/0vix.LendingSupplyingTable\"\n            props={{\n              assets: state.data?.markets || [],\n              onTableButtonClick: handleTableButtonClick,\n            }}\n          />\n          <Spacer />\n          <Widget\n            src=\"bluebiu.near/widget/0vix.LendingSupplyMarketsTable\"\n            props={{\n              assets: state.data?.markets || [],\n              onTableButtonClick: handleTableButtonClick,\n            }}\n          />\n        </>\n      )}\n      {state.type === 1 && (\n        <>\n          <Widget\n            src=\"bluebiu.near/widget/0vix.LendingBorrowingTable\"\n            props={{\n              assets: state.data?.markets || [],\n              onTableButtonClick: handleTableButtonClick,\n            }}\n          />\n          <Spacer />\n          <Widget\n            src=\"bluebiu.near/widget/0vix.LendingBorrowMarketsTable\"\n            props={{\n              assets: state.data?.markets || [],\n              onTableButtonClick: handleTableButtonClick,\n            }}\n          />\n        </>\n      )}\n      {!state.updateData && (\n        <Widget src=\"bluebiu.near/widget/0vix.LendingQuest\" />\n      )}\n    </Container>\n    <Widget\n      src=\"bluebiu.near/widget/0vix.LendingDialog\"\n      props={{\n        display: state.showDialog,\n        data: state.tableButtonClickData,\n        unitrollerAddress: UNITROLLER_ADDRESS,\n        accountLiquidity: state.data?.accountLiquidity,\n        userTotalBorrowUsd: state.data?.userTotalBorrowUsd,\n        onClose: () => {\n          State.update({\n            showDialog: false,\n          });\n        },\n        onSuccess: () => {\n          State.update({\n            updateData: true,\n          });\n        },\n        onMessage: (params) => {\n          State.update({\n            message: params,\n          });\n        },\n      }}\n    />\n    {state.message?.open && (\n      <Widget\n        src=\"bluebiu.near/widget/0vix.LendingMessage\"\n        props={{\n          status: state.message.status,\n          text: state.message.text,\n          onClose: () => {\n            State.update({\n              message: { open: false },\n            });\n          },\n        }}\n      />\n    )}\n  </>\n);\n", "metadata": {"image": {"ipfs_cid": "bafkreigyodedyhiqmstq3g5edcqw25yyari4y3rcbsnqtxldb2zb2vpah4"}, "name": "0vix", "tags": {"lending": ""}}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/0vix.Lending", "fact_widget_deployments_id": "b7f26aa7f83cab62ec89aa6056807fc2", "inserted_timestamp": "2023-12-07T12:36:07.105Z", "modified_timestamp": "2023-12-20T03:22:11.422Z", "__row_index": 8}
{"tx_hash": "D5M5rjZRK8XBzvsW93J5hvbcPkkK6nBsJG4GZZQUqgpk", "action_id_social": "DarCQB1zuQRru5NP7Q8m4fWWGQbTEJ8k1GYp7tMXvsXU-0-widget", "block_id": 117289984, "block_timestamp": "2024-04-21T05:23:38.817Z", "signer_id": "bluebiu.near", "widget_name": "Scroll.BridgeXY.HandlerSwap", "source_code": "const {\n  amount,\n  account,\n  currency,\n  routerAddress,\n  routerEthAddress,\n  target,\n  loading,\n  onSuccess,\n  onError,\n  quote,\n} = props;\n\n\nconst BASE_API = 'https://open-api.xy.finance/v1'\nfunction buildSwap() {\n  return asyncFetch(`${BASE_API}/swap?srcChainId=${quote.srcChainId}&fromTokenAddress=${quote.fromTokenAddress}&amount=${quote.fromTokenAmount}&destChainId=${quote.destChainId}&toTokenAddress=${quote.toTokenAddress}&slippage=1&referrer=0x93A193597E08351D84eb115E4644C77578D665E3&receiveAddress=${account}`).then(res => {\n    const { body } = res\n    console.log('swap: ', body)\n    if (body.tx) {\n      return body.tx\n    }\n  })\n}\n\nif (!loading) return \"\";\n\nconst signer = Ethers.provider().getSigner()\nbuildSwap().then(params => {\n  console.log('params:', params)\n  if (params) {\n    \n    signer.sendTransaction({\n      ...params,\n      value: params.value.toString()\n      // gasLimit: 11111192000\n    })\n      .then((tx) => {\n        console.log(tx)\n        tx.wait()\n          .then((res) => {\n            onSuccess(res);\n          })\n          .catch((err) => {\n            onError(tx);\n          });\n      })\n      .catch((err) => {\n        console.log(err)\n        onError(err);\n      });\n  } else {\n    onError(\"Swap Failed\")\n  }\n})\n\n// const _amount = new Big(amount).mul(Math.pow(10, 18)).toString()\n// const lastNum = _amount.slice(0, _amount.length - quote.vc.length) + quote.vc;\n// const signer = Ethers.provider().getSigner()\n// const params = {\n//     from: account,\n//     to: quote.endpoint,\n//     value: lastNum,\n// }\n// signer.sendTransaction(params)\n// .then((tx) => {\n//     console.log(tx)\n//     tx.wait()\n//       .then((res) => {\n//         onSuccess(res);\n//       })\n//       .catch((err) => {\n//         onError(tx);\n//       });\n//   })\n//   .catch((err) => {\n//     onError(err);\n//   });\n\n\nreturn \"\";", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/Scroll.BridgeXY.HandlerSwap", "fact_widget_deployments_id": "b75c67a24f933d81740573bd199a1096", "inserted_timestamp": "2024-04-21T06:32:05.609Z", "modified_timestamp": "2024-04-21T06:32:05.609Z", "__row_index": 3}
{"tx_hash": "DaXA7bTh82XZbXRNxPX4EJNrZ5grETemsRAtHKcQMZje", "action_id_social": "F92dpLjGEwv4iCGnnxUSA6TFD8RNoLwifAr4AoXFFjfX-0-widget", "block_id": 117484431, "block_timestamp": "2024-04-24T00:11:07.919Z", "signer_id": "bluebiu.near", "widget_name": "Swap.Data.AmountOut", "source_code": "const {\n  updater,\n  wethAddress,\n  inputCurrency,\n  outputCurrency,\n  inputCurrencyAmount,\n  onLoad,\n  slippage,\n  account,\n  prices,\n  name,\n} = props;\n\nuseEffect(() => {\n  if (!updater) return;\n\n  if (\n    (!inputCurrency.address && !inputCurrency.isNative) ||\n    (!outputCurrency.address && !outputCurrency.isNative) ||\n    !inputCurrencyAmount\n  ) {\n    return;\n  }\n\n  const wrapType =\n    inputCurrency.isNative && outputCurrency.address === wethAddress\n      ? 1\n      : inputCurrency.address === wethAddress && outputCurrency.isNative\n      ? 2\n      : 0;\n\n  if (wrapType) {\n    onLoad({\n      inputCurrency,\n      inputCurrencyAmount,\n      outputCurrency,\n      outputCurrencyAmount: inputCurrencyAmount,\n      noPair: false,\n    });\n    return;\n  }\n  asyncFetch(\"/dapdap/quoter\", {\n    method: \"post\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      params: JSON.stringify({\n        template: name,\n        inputCurrency,\n        outputCurrency,\n        inputAmount: inputCurrencyAmount,\n        slippage,\n        account,\n      }),\n    }),\n  })\n    .then((res) => {\n      const data = res.body?.data;\n      if (!data) throw Error;\n      let priceImpact = null;\n\n      if (\n        prices &&\n        prices[inputCurrency.symbol] &&\n        prices[outputCurrency.symbol]\n      ) {\n        const poolPrice = Big(prices[inputCurrency.symbol] || 1).div(\n          prices[outputCurrency.symbol] || 1\n        );\n        const amountoutPrice = Big(data.outputCurrencyAmount).div(\n          inputCurrencyAmount\n        );\n\n        priceImpact = poolPrice\n          .minus(amountoutPrice)\n          .div(poolPrice)\n          .mul(100)\n          .toString();\n      }\n      onLoad({\n        inputCurrency,\n        inputCurrencyAmount,\n        outputCurrency,\n        priceImpact,\n        gas: data.txn.gasLimit,\n        ...data,\n        unsignedTx: data.txn,\n      });\n    })\n    .catch((err) => {\n      onLoad({\n        inputCurrency,\n        inputCurrencyAmount,\n        outputCurrency,\n        outputCurrencyAmount: \"\",\n        noPair: true,\n      });\n    });\n}, [updater]);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bluebiu.near/widget/Swap.Data.AmountOut", "fact_widget_deployments_id": "ac665b89a61a401b2b18d93aa0ba4b09", "inserted_timestamp": "2024-04-24T02:07:16.154Z", "modified_timestamp": "2024-04-24T02:55:30.503Z", "__row_index": 0}
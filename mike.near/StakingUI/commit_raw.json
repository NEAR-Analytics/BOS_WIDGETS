{"tx_hash": "558VSQ1P4wnuroAQqcCa2WuQgd1ZZ7dnxs4nLqjgbTnQ", "action_id_social": "AaueSyb1La2TCo6W5LbW9qATeNjTZkB4zrb9itivQVc2-0-widget", "block_id": 112278228, "block_timestamp": "2024-02-07T03:08:45.177Z", "signer_id": "mike.near", "widget_name": "StakingUI", "source_code": "const ProgressBar = VM.require(\"mike.near/widget/ProgressBar\");\n\nconst yoctoZeroes = \"000000000000000000000000\";\n\nconst [stakingAmount, setStakingAmount] = useState(\"6\");\nconst [unstakingWithdrawlAmount, setUnstakingWithdrawlAmount] = useState(\"19\");\nconst StakeUnstakeWithdraw = ({ validator, method, amount }) => {\n  // console.log('aloha top of stakeunstakewithdraw amount', amount);\n  // const [stakingAmount, setStakingAmount] = useState(amount);\n\n  const openAnotherModal = ({ validator, method, amount }) => {\n    console.log(\"aloha top of openAnotherModal amount\", amount);\n    // Let's explicitly have these in a switch so no one tries any funny business with methods\n    switch (method) {\n      case \"stake\":\n        Near.call(\n          validator,\n          \"deposit_and_stake\",\n          { amount: stakingAmount },\n          null,\n          amount\n        );\n        break;\n      case \"unstake\":\n        Near.call(validator, \"unstake\", {\n          amount: unstakingWithdrawlAmount + yoctoZeroes,\n        });\n        break;\n      case \"withdraw\":\n        // Near.call(validator, \"withdraw\", { amount });\n        Near.call(validator, \"withdraw\", {\n          amount: unstakingWithdrawlAmount + yoctoZeroes,\n        });\n        break;\n    }\n  };\n\n  const handleCancel = () => {\n    // eventually add fade-out effect\n    setShowStakingModal(false);\n  };\n  const handleUnstake = (amount) => {\n    console.log(\"Unstaking\u2026\", amount);\n    openAnotherModal({ validator, method, amount });\n  };\n  const handleStake = (amount) => {\n    console.log(\"Staking\u2026\", amount);\n    openAnotherModal({ validator, method, amount });\n  };\n  const handleWithdraw = () => {\n    console.log(\"Withdrawing\u2026\", unstakingWithdrawlAmount);\n    openAnotherModal({ validator, method, amount: unstakingWithdrawlAmount });\n  };\n\n  const containerStyle = {\n    boxShadow: \"0 3px 6px rgba(0, 0, 0, 0.6)\",\n    border: \"3px solid #f2f1e9\",\n    backgroundColor: \"rgba(0, 0, 0, .7)\",\n    background:\n      \"radial-gradient(circle at center, rgba(255, 255, 255, 0.7), rgba(0, 0, 0, 0.7) 100%), radial-gradient(circle at 10% 90%, rgba(200, 200, 255, 0.8), transparent 60%),radial-gradient(circle at 50% 50%, rgba(151, 151, 255, 0.7), transparent 50%)\",\n    padding: \"20px\",\n    width: \"100%\",\n    margin: \"0 auto\",\n    borderRadius: \"13px\",\n    overflow: \"auto\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    transition: \"opacity 0.3s ease-out\",\n  };\n\n  const titleStyle = {\n    textAlign: \"center\",\n    color: \"#f2f1e9\",\n    fontWeight: \"bold\",\n    marginBottom: \"6px\",\n    textShadow: `\n        -1px -1px 0 #000,\n        1px -1px 0 #000,\n        -1px 1px 0 #000,\n        1px 1px 0 #000`,\n    letterSpacing: \"1px\",\n  };\n\n  return (\n    <div style={containerStyle}>\n      <h2 style={titleStyle}>{method} NEAR</h2>\n      <input\n        // defaultValue={stakingAmount}\n        value={stakingAmount}\n        onChange={(e) => setStakingAmount(e.target.value)}\n        style={{\n          padding: \"13px\",\n          width: \"80%\",\n          margin: \"13px auto\",\n          display: \"block\",\n        }}\n      />\n      <button\n        onClick={(e) => {\n          console.log(\"aloha method\", method);\n          if (method === \"unstake\") {\n            handleUnstake(`${stakingAmount}${yoctoZeroes}`);\n          } else if (method === \"stake\") {\n            // Assuming you have a function handleStake for the \"stake\" action\n            handleStake(`${stakingAmount}${yoctoZeroes}`);\n          } else if (method === \"withdraw\") {\n            // handleWithdraw(`${stakingAmount}${yoctoZeroes}`);\n            handleWithdraw();\n          }\n        }}\n        style={{ padding: \"13px\", margin: \"13px auto\", display: \"block\" }}\n      >\n        {/* Assuming you want to dynamically change the button text as well */}\n        <span\n          style={{\n            textTransform: \"capitalize\",\n          }}\n        >\n          {method}\n        </span>\n      </button>\n      <button\n        onClick={handleCancel}\n        style={{ padding: \"13px\", margin: \"13px auto\", display: \"block\" }}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n};\n\n// Interesting, this seems to need to be above the StakeUnstakeWithdrawModal declaration\nconst walletUnstake = ({ validator, amount }) => {\n  setStakingModalData({ validator, method: \"unstake\", amount });\n  setShowStakingModal(true);\n};\nconst walletWithdraw = ({ validator, amount }) => {\n  console.log(\"aloha walletWithdraw amount\", amount);\n  // setStakingModalData({ validator, method: \"withdraw\", amount });\n  setStakingModalData({ validator, method: \"withdraw\" });\n  setShowStakingModal(true);\n};\nconst walletStake = ({ validator, amount }) => {\n  console.log(\"aloha stake validator\", validator);\n  setStakingModalData({ validator, method: \"stake\", amount });\n  setShowStakingModal(true);\n};\n\nconst { mainnetValidators } = VM.require(\n  \"mike.near/widget/StakingUI.getValidators\"\n);\n\n// State initialization\nconst [progressVal, setProgressVal] = useState(0);\n// 219 validators, sending at least two messages, sometimes a third.\n// this sane starting place helps so the progress bar doesn't jump around\nconst [progressMax, setProgressMax] = useState(442);\nconst [started, setStarted] = useState(false);\nconst [showProgressBar, setShowProgressBar] = useState(true);\nconst [validatorStakingDetails, setValidatorStakingDetails] = useState([]);\nconst [isLoading, setIsLoading] = useState(true);\nconst [showStakingModal, setShowStakingModal] = useState(false);\nconst [stakingModalData, setStakingModalData] = useState(false);\n\nconst YOCTO_DIGITS = 24;\n\n// Modified from near-js utils\nfunction formatNearAmount(balance) {\n  balance = balance.toString();\n\n  // Pad the balance if it's shorter than YOCTO_DIGITS\n  if (balance.length <= YOCTO_DIGITS) {\n    balance = balance.padStart(YOCTO_DIGITS + 1, \"0\");\n  }\n\n  const wholeStr = balance.substring(0, balance.length - YOCTO_DIGITS) || \"0\";\n  let fractionStr = balance\n    .substring(balance.length - YOCTO_DIGITS)\n    .padEnd(YOCTO_DIGITS, \"0\");\n\n  fractionStr = fractionStr.substring(0, 3);\n  const fullNumber = `${wholeStr}.${fractionStr}`;\n\n  return fullNumber;\n}\n\nfunction cleanupAmount(amt) {\n  // Remove commas by splitting on them and joining the parts back together\n  return amt.split(\",\").join(\"\").trim();\n}\n\nfunction trimLeadingZeroes(str) {\n  // Find the first non-zero character\n  let firstNonZeroIndex = 0;\n  while (firstNonZeroIndex < str.length && str[firstNonZeroIndex] === \"0\") {\n    firstNonZeroIndex++;\n  }\n\n  // Return the substring from the first non-zero character or '0' if all characters were zeroes\n  return firstNonZeroIndex === str.length\n    ? \"0\"\n    : str.substring(firstNonZeroIndex);\n}\n\n// Modified from near-js utils\nfunction parseNearAmount(amt) {\n  if (!amt) {\n    return null;\n  }\n\n  amt = cleanupAmount(amt);\n  const split = amt.split(\".\");\n  const wholePart = split[0];\n  const fracPart = split[1] || \"\";\n\n  // Check for valid format\n  if (split.length > 2 || fracPart.length > YOCTO_DIGITS) {\n    throw new Error(`Cannot parse '${amt}' as NEAR amount`);\n  }\n\n  // Combine the whole part and the fractional part padded to NEAR_NOMINATION_EXP length\n  return trimLeadingZeroes(wholePart + fracPart.padEnd(YOCTO_DIGITS, \"0\"));\n}\n\n// below is useful, just loud\n// const himike = formatNearAmount(\"60606060606060606\")\n// console.log('aloha himike', himike)\n// const himike2 = parseNearAmount(\"666\")\n// console.log('aloha himike2', himike2)\n\nfunction createValidatorQueries(validators) {\n  let accountId = context.accountId;\n\n  if (!!!accountId) return;\n  // Take into account the component loading, honestly\n  let progressCounter = 20;\n\n  const updateProgress = ({ amount }) => {\n    if (!amount) amount = 1;\n    progressCounter = progressCounter + amount;\n    if (progressCounter % 20 == 0 && progressCounter > progressVal) {\n      setProgressVal(progressCounter);\n    }\n  };\n\n  const isPositiveNumber = (str) => {\n    return !!str && !isNaN(str) && parseFloat(str) > 0;\n  };\n\n  const wrappedPromises = validators.map((validatorAddress) => {\n    // fetching staked and unstaked balances\n    const stakedBalancePromise = Near.asyncView(\n      validatorAddress,\n      \"get_account_staked_balance\",\n      { account_id: accountId },\n      \"final\"\n    );\n    const unstakedBalancePromise = Near.asyncView(\n      validatorAddress,\n      \"get_account_unstaked_balance\",\n      { account_id: accountId },\n      \"final\"\n    );\n\n    updateProgress(stakedBalancePromise.length + unstakedBalancePromise.length);\n\n    return Promise.all([stakedBalancePromise, unstakedBalancePromise])\n      .then(([stakedBalance, unstakedBalance]) => {\n        // weird hack seeing that 1 yoctonear seems to say it can be unstaked\n        // seems like a contract / near-js bug\n        unstakedBalance = unstakedBalance === \"1\" ? \"0\" : unstakedBalance;\n\n        const isHighlight =\n          isPositiveNumber(unstakedBalance) || isPositiveNumber(stakedBalance);\n        if (isPositiveNumber(unstakedBalance)) {\n          // If unstaked balance is positive, check if it's available, adding another Promise\n          return Near.asyncView(\n            validatorAddress,\n            \"is_account_unstaked_balance_available\",\n            { account_id: accountId },\n            \"final\"\n          ).then((isAvailable) => {\n            updateProgress();\n            return {\n              validatorAddress,\n              stakedBalance,\n              unstakedBalance,\n              isHighlight,\n              isUnstakedBalanceAvailable: isAvailable,\n            };\n          });\n        } else {\n          // If not, just return the balances\n          updateProgress();\n          return {\n            validatorAddress,\n            stakedBalance,\n            unstakedBalance,\n            isHighlight,\n            isUnstakedBalanceAvailable: null,\n          };\n        }\n      })\n      .catch((err) => {\n        console.error(\n          \"Error fetching balances for \",\n          validatorAddress,\n          \": \",\n          err\n        );\n        updateProgress();\n        return null;\n      });\n  });\n\n  updateProgress(wrappedPromises.length);\n  Promise.all(wrappedPromises)\n    .then((results) => {\n      const detailedStakingInfo = results.filter((info) => {\n        return info !== null;\n      });\n      setValidatorStakingDetails(detailedStakingInfo);\n      // intentionally not setting IsLoading here, the UI needs to finish\n    })\n    .catch((err) => {\n      console.error(\"Error with promise all: \", err);\n      setIsLoading(false);\n    });\n}\n\n// It seems like using VM.require and useEffect is odd, so I am using a normal function here\nconst start = () => {\n  // if it hasn't loaded the external widget yet, return\n  if (!!!mainnetValidators) {\n    // console.log(\"aloha start, mainnetValidators not ready\");\n    return;\n  } else {\n    // console.log(\"aloha start, mainnetValidators TOTALLY ready\");\n    setStarted(true);\n  }\n  // kick off the useEffect below\n};\n\nstart();\n\nuseEffect(() => {\n  // We need this check here again\n  if (!!!mainnetValidators) return;\n\n  mainnetValidators.getAddresses().then((vals) => {\n    setProgressMax(vals.length * 2);\n    createValidatorQueries(vals);\n  });\n}, [started]);\n\nuseEffect(async () => {\n  if (progressVal >= progressMax) {\n    // Compare these two approaches by commenting them out, it's interesting.\n\n    // setIsLoading(false);\n    const timer = setTimeout(() => setIsLoading(false), 300);\n    return () => clearTimeout(timer);\n  }\n}, [progressVal, progressMax]);\n\nconst LoadingModal = () => {\n  // This helps with the flash of red if it hasn't loaded yet\n  if (!!!ProgressBar) {\n    return <></>;\n  } else {\n    if (!!!context.accountId) {\n      console.log(\"context.accountId not ready\");\n      return;\n    }\n\n    return (\n      <div\n        style={{\n          position: \"fixed\",\n          top: \"50%\",\n          left: \"50%\",\n          transform: \"translate(-50%, -150%)\",\n          padding: \"6px\",\n          width: \"19%\",\n          height: \"13%\",\n          backgroundColor: \"rgba(0, 0, 0, 0.2)\",\n          backdropFilter: \"blur(6px)\",\n          display: isLoading ? \"flex\" : \"none\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          borderRadius: \"300px\", // Optional: for rounded corners\n          transition: \"opacity 0.2s ease-out, background-color 0.2s ease\",\n          opacity: isLoading ? 1 : 0,\n          zIndex: 999,\n          background: `linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgba(0, 0, 0, 0.2) 100%)`,\n          boxShadow: \"0 8px 32px 0 rgba(31, 38, 135, 0.37)\",\n        }}\n      >\n        <ProgressBar key={progressVal} value={progressVal} max={progressMax} />\n      </div>\n    );\n  }\n};\n\n// debug by commenting this badboy out to see it\nconst stakingModalDisplayStyles = {\n  display: showStakingModal ? \"flex\" : \"none\",\n  opacity: showStakingModal ? 1 : 0,\n};\n\nconst StakeUnstakeWithdrawModal = () => {\n  if (!StakeUnstakeWithdraw) {\n    return <></>;\n  } else {\n    const handleOutsideClick = (e) => {\n      setShowStakingModal(false);\n    };\n\n    const outerDivStyle = {\n      position: \"fixed\",\n      top: \"6%\",\n      left: 0,\n      width: \"100%\",\n      backgroundImage:\n        \"radial-gradient(ellipse, rgba(0, 0, 0, 0.3) 66%, transparent 80%)\",\n      display: \"flex\",\n      justifyContent: \"center\",\n      zIndex: 998,\n      cursor: \"pointer\",\n      ...stakingModalDisplayStyles,\n    };\n\n    const innerDivStyle = {\n      cursor: \"auto\",\n      position: \"relative\",\n      width: \"37%\",\n      height: \"auto\",\n      overflowY: \"hidden\",\n      padding: \"1%\",\n      background:\n        \"radial-gradient(ellipse, rgba(151, 151, 255, .8) 19%, rgba(0, 0, 0, 0.8) 100%)\",\n      borderRadius: \"13px\",\n      boxShadow:\n        \"0 0 15px rgba(255, 255, 255, 0.6), 0 0 20px rgba(255, 255, 255, 0.4), 0 0 25px rgba(255, 255, 255, 0.3), 0 0 30px rgba(255, 255, 255, 0.2), 0 0 35px rgba(255, 255, 255, 0.1), 0 0 40px rgba(255, 255, 255, 0.05)\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"center\",\n    };\n\n    return (\n      <div style={outerDivStyle} onClick={handleOutsideClick}>\n        <div style={innerDivStyle} onClick={(e) => e.stopPropagation()}>\n          <StakeUnstakeWithdraw\n            validator={stakingModalData.validator}\n            method={stakingModalData.method}\n            amount={stakingModalData.amount}\n          />\n        </div>\n      </div>\n    );\n  }\n};\n\nconst highlightedRows = useMemo(\n  () => validatorStakingDetails.filter((row) => row.isHighlight),\n  [validatorStakingDetails]\n);\nconst rangedRows = useMemo(\n  () => validatorStakingDetails.filter((row) => !row.isHighlight),\n  [validatorStakingDetails]\n);\n\nif (!!!context.accountId) {\n  return (\n    <div>\n      <p>Please login</p>\n    </div>\n  );\n} else {\n  return (\n    <div\n      style={{\n        position: relative,\n        width: \"100%\",\n        filter: \"contrast(166%)\",\n      }}\n    >\n      <div\n        style={{\n          fontFamily: \"'Lucida Console', Monaco, monospace\",\n          padding: \"13px 16px\",\n          maxWidth: \"900px\",\n          margin: \"0 auto\",\n          background: `radial-gradient(circle at top right, slategray, transparent 80%), \n                         radial-gradient(circle at center, darkslategray, transparent 83%)`,\n          backgroundImage:\n            'url(\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiPjxkZWZzPjxmaWx0ZXIgaWQ9InNsYXRlTm9pc2UiIHg9Ii01MCUiIHk9Ii01MCUiIHdpZHRoPSIyMDAlIiBoZWlnaHQ9IjIwMCUiPjxmZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIxLjkiIG51bU9jdGF2ZXM9IjYiIHJlc3VsdD0ibm9pc2UiLz48ZmVHYXVzc2lhbkJsdXIgaW49Im5vaXNlIiBzdGREZXZpYXRpb249IjIiIHJlc3VsdD0iYmx1cnJlZE5vaXNlIi8+PGZlQ29tcG9uZW50VHJhbnNmZXIgaW49InNsYXRlTm9pc2UiPjxmZUZ1bmNSIHR5cGU9ImxpbmVhciIgc2xvcGU9IjAuOSIgaW50ZXJjZXB0PSIwLjA1Ii8+PGZlRnVuY0cgdHlwZT0ibGluZWFyIiBzbG9wZT0iMC45IiBpbnRlcmNlcHQ9IjAuMDUiLz48ZmVGdW5jQiB0eXBlPSJsaW5lYXIiIHNsb3BlPSIwLjk1IiBpbnRlcmNlcHQ9IjAuMSIvPjwvZmVDb21wb25lbnRUcmFuc2Zlcj48L2ZpbHRlcj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI3NsYXRlTm9pc2UpIiBmaWxsPSJkYXJrZ3JheSIgLz48L3N2Zz4=\")',\n          backgroundBlendMode: \"hard-light\",\n          borderRadius: \"16px 16px 0 0\",\n          filter: \"saturate(6) grayscale(6%)\",\n        }}\n      >\n        <LoadingModal />\n        <StakeUnstakeWithdrawModal />\n        <h1\n          style={{\n            textAlign: \"center\",\n            color: \"#f2f1e9\",\n            textShadow: `-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,3px 3px 3px #000`,\n            letterSpacing: \"6px\",\n            textTransform: \"uppercase\",\n          }}\n        >\n          Staking\n        </h1>\n        <div>\n          <div>\n            <div\n              style={{\n                background:\n                  \"radial-gradient(circle at top left, rgba(0, 0, 0, 0.6) 30%, rgba(0, 0, 0, 0.2) 70%)\",\n                filter: \"drop-shadow(3px 3px 3px rgba(255, 255, 255, 0.6)\",\n                backdropFilter: \"contrast(0.1)\",\n                padding: \"10px\",\n                margin: \"auto\",\n                marginBottom: \"13px\",\n                color: \"#fff\",\n                borderRadius: \"6px\",\n              }}\n            >\n              <h3>Active</h3>\n              <div\n                className=\"faux-table\"\n                style={{\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  margin: \"6px 0\",\n                  borderRadius: \"6px\",\n                  boxShadow: \"0 0 1px 0 #f2f1e9\",\n                }}\n              >\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                  }}\n                >\n                  <div\n                    className=\"faux-table-header\"\n                    style={{\n                      display: \"flex\",\n                      borderRadius: \"6px 6px 0 0\",\n                      background: \"#000\",\n                      color: \"#f2f1e9\",\n                      textTransform: \"uppercase\",\n                      padding: \"9px\",\n                      fontSize: \"1.3em\",\n                    }}\n                  >\n                    <div style={{ flex: 2, padding: \"0 10px\" }}>Validator</div>\n                    <div style={{ flex: 2, padding: \"0 10px\" }}>Staked</div>\n                    <div style={{ flex: 2, padding: \"0 10px\" }}>Unstaked</div>\n                  </div>\n                  <div\n                    style={{\n                      height: \"6px\",\n                      background:\n                        \"linear-gradient(to right, #00ec97, #fff, #00ec97)\",\n                      filter: \"saturate(13%)\",\n                    }}\n                  />\n                </div>\n                {highlightedRows.map((detail) => (\n                  <div\n                    key={detail.validatorAddress}\n                    className=\"faux-table-row\"\n                    style={{\n                      display: \"flex\",\n                      background: \"#111\",\n                      color: \"#fff\",\n                      borderBottom: \"1px solid rgba(250, 250, 250, 0.3)\",\n                      padding: \"10px\",\n                      alignItems: \"center\",\n                    }}\n                  >\n                    <div\n                      style={{\n                        flex: 2,\n                        padding: \"0 10px\",\n                        overflow: \"hidden\",\n                        whiteSpace: \"nowrap\",\n                        textOverflow: \"ellipsis\",\n                      }}\n                    >\n                      {detail.validatorAddress}\n                    </div>\n                    <div\n                      style={{\n                        flex: 2,\n                        padding: \"0 10px\",\n                        display: \"flex\",\n                        alignItems: \"center\",\n                      }}\n                    >\n                      <span>{formatNearAmount(detail.stakedBalance)}</span>\n                      <button\n                        style={{\n                          marginLeft: \"10px\",\n                          background:\n                            \"linear-gradient(to right, #9797ff 6%, rgba(151, 151, 255, 0.6) 100%, #17d9d4 100%)\",\n                        }}\n                        onClick={() =>\n                          walletStake({\n                            validator: detail.validatorAddress,\n                            amount: \"0\",\n                          })\n                        }\n                      >\n                        Stake\n                      </button>\n                    </div>\n                    <div\n                      style={{\n                        display: \"flex\",\n                        flex: 2,\n                        padding: \"0 10px\",\n                        alignItems: \"center\",\n                      }}\n                    >\n                      <div\n                        style={{\n                          flex: 1,\n                          overflow: \"hidden\",\n                          whiteSpace: \"nowrap\",\n                          textOverflow: \"ellipsis\",\n                        }}\n                      >\n                        {formatNearAmount(detail.unstakedBalance) === \"0.000\"\n                          ? \"\u2014\"\n                          : formatNearAmount(detail.unstakedBalance)}\n                      </div>\n                      <div\n                        style={{\n                          display: \"flex\",\n                          flexDirection: \"column\",\n                          justifyContent: \"start\",\n                          paddingLeft: \"10px\",\n                        }}\n                      >\n                        <button\n                          onClick={() =>\n                            walletUnstake({\n                              validator: detail.validatorAddress,\n                              amount: detail.stakedBalance,\n                            })\n                          }\n                          style={{\n                            marginBottom: \"10px\",\n                            background:\n                              \"linear-gradient(to right, #9797ff 6%, rgba(151, 151, 255, 0.6) 100%, #17d9d4 100%)\",\n                          }}\n                        >\n                          Unstake\n                        </button>\n                        {detail.isUnstakedBalanceAvailable && (\n                          <button\n                            style={{\n                              background:\n                                \"linear-gradient(to right, #9797ff 6%, rgba(151, 151, 255, 0.6) 100%, #17d9d4 100%)\",\n                            }}\n                            onClick={() =>\n                              walletWithdraw({\n                                validator: detail.validatorAddress,\n                                amount: detail.unstakedBalance,\n                                // amount: \"19\", // this likely needs to be another RPC call here\n                              })\n                            }\n                          >\n                            Withdraw\n                          </button>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            <div\n              style={{\n                background:\n                  \"radial-gradient(circle at top left, rgba(0, 0, 0, 0.6) 19%, rgba(0, 0, 0, 0.1) 100%)\",\n                filter: \"drop-shadow(3px 3px 3px rgba(255, 255, 255, 0.6)\",\n                backdropFilter: \"contrast(0.6)\",\n                padding: \"10px\",\n                margin: \"auto\",\n                maxWidth: \"85%\",\n                color: \"#fff\",\n                borderRadius: \"6px\",\n              }}\n            >\n              <h3>Others</h3>\n              <div\n                className=\"faux-table\"\n                style={{\n                  display: \"flex\",\n                  flexDirection: \"column\",\n                  margin: \"6px 0\",\n                  borderRadius: \"6px\",\n                  boxShadow: \"0 0 1px 0 #f2f1e9\",\n                }}\n              >\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                  }}\n                >\n                  <div\n                    className=\"faux-table-header\"\n                    style={{\n                      display: \"flex\",\n                      borderRadius: \"6px 6px 0 0\",\n                      background: \"#000\",\n                      color: \"#f2f1e9\",\n                      textTransform: \"uppercase\",\n                      padding: \"10px\",\n                      fontSize: \"1.3em\",\n                    }}\n                  >\n                    <div style={{ flex: 3, padding: \"0 10px\" }}>Validator</div>\n                  </div>\n                  <div\n                    style={{\n                      height: \"6px\",\n                      background:\n                        \"linear-gradient(to right, #ff7966, #fff, #ff7966)\",\n                      filter: \"saturate(13%)\",\n                    }}\n                  />\n                </div>\n                <div\n                  className={\"white-scrollbar\"}\n                  style={{\n                    maxHeight: \"90vh\",\n                    overflow: \"auto\",\n                  }}\n                >\n                  {rangedRows.map((detail) => (\n                    <div\n                      key={detail.validatorAddress}\n                      className=\"faux-table-row\"\n                      style={{\n                        display: \"flex\",\n                        background: \"#111\",\n                        color: \"#fff\",\n                        borderBottom: \"1px solid rgba(250, 250, 250, 0.3)\",\n                        padding: \"10px\",\n                        alignItems: \"center\",\n                        overflow: \"hidden\",\n                      }}\n                    >\n                      <div\n                        style={{\n                          flex: 3,\n                          padding: \"0 10px\",\n                          overflow: \"hidden\",\n                          whiteSpace: \"nowrap\",\n                          textOverflow: \"ellipsis\",\n                          marginRight: \"10px\",\n                        }}\n                      >\n                        {detail.validatorAddress}\n                      </div>\n                      <div style={{ flex: 1, padding: \"0 10px\" }}>\n                        <button\n                          style={{\n                            marginLeft: \"10px\",\n                            background:\n                              \"linear-gradient(to right, #9797ff 6%, rgba(151, 151, 255, 0.6) 100%, #17d9d4 100%)\",\n                          }}\n                        >\n                          Stake\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mike.near/widget/StakingUI", "fact_widget_deployments_id": "50c62c5a7670e7270d2bf9a2eee11a99", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 27}
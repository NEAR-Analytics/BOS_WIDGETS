{"tx_hash": "4zUctvHNd3XNU4VKNuyubfmz7HTpWErwA8QSWu64fr9k", "action_id_social": "CWWY6iq5oqF4dkoG1VQph5rFpTxQP7ZM7JDPgb8ju2RU-0-widget", "block_id": 111730538, "block_timestamp": "2024-01-31T00:31:51.622Z", "signer_id": "mike.near", "widget_name": "StakingUI.getValidators", "source_code": "const getUniqueValidatorAddresses = (validators1, validators2) => {\n  const allValidators = [...validators1, ...validators2];\n  const uniqueIds = new Set(allValidators.map((v) => v.account_id));\n  return Array.from(uniqueIds);\n};\n\nconst mainnetValidators = {\n  // uniqueAccountIds = [],\n\n  getAddresses: async (customRPCEndpoint) => {\n    customRPCEndpoint = customRPCEndpoint || \"https://rpc.mainnet.near.org\";\n    let uniqueAccountIds = fetch(\"https://rpc.mainnet.near.org\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        jsonrpc: \"2.0\",\n        method: \"validators\",\n        params: [null],\n        id: \"mainnet-vals\",\n      }),\n    }).then((data) => {\n      console.log(\"aloha data\", data);\n      const { current_validators, next_validators } = data.body.result;\n      // for regular fetch, no asyncFetch\n      // const { current_validators, next_validators } = data.result;\n\n      console.log(\"current_validators\", current_validators);\n      console.log(\"next_validators\", next_validators);\n\n      const uniqueAccountIds = getUniqueValidatorAddresses(\n        current_validators,\n        next_validators\n      );\n      return uniqueAccountIds;\n    });\n    // return uniqueAccountIds;\n    // return new Promise((resolve, reject) => {\n    //   try {\n    //     let uniqueAccountIds = asyncFetch(\"https://rpc.mainnet.near.org\", {\n    //       method: \"POST\",\n    //       headers: {\n    //         \"Content-Type\": \"application/json\",\n    //       },\n    //       body: JSON.stringify({\n    //         jsonrpc: \"2.0\",\n    //         method: \"validators\",\n    //         params: [null],\n    //         id: \"mainnet-vals\",\n    //       }),\n    //     });\n    //     // .then((data) => {\n    //     //   console.log(\"aloha data\", data);\n    //     //   const { current_validators, next_validators } = data.body.result;\n    //     //   // for regular fetch, no asyncFetch\n    //     //   // const { current_validators, next_validators } = data.result;\n\n    //     //   console.log(\"current_validators\", current_validators);\n    //     //   console.log(\"next_validators\", next_validators);\n\n    //     //   const uniqueAccountIds = getUniqueValidatorAddresses(\n    //     //     current_validators,\n    //     //     next_validators\n    //     //   );\n    //     //   console.log(\"uniqueAccountIds\", uniqueAccountIds);\n\n    //     //   // Update state or perform other actions with uniqueAccountIds\n    //     //   // State.update({\n    //     //   // allValidatorAddresses: uniqueAccountIds\n    //     //   // });\n    //     // });\n    //     return resolve(uniqueAccountIds);\n    //   } catch {\n    //     console.error(\n    //       `Could not get list of mainnet validators from ${customRPCEndpoint}`\n    //     );\n    //     return reject();\n    //   }\n    // });\n  },\n};\n\nreturn { allMainnetValidators, mainnetValidators };\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mike.near/widget/StakingUI.getValidators", "fact_widget_deployments_id": "2eac65f296a04cc4e16ca994f2b6b98a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 9}
{"tx_hash": "2iZmrXb4hSkBo9Qy3UvtkQacKSmn8d1AdvEmpLyRsBbu", "action_id_social": "3oYWXdNdogPc4jWZU76ac9DYm1bWqgVqMThYwLx5jMZs-0-widget", "block_id": 112537495, "block_timestamp": "2024-02-10T12:34:16.762Z", "signer_id": "lord1.near", "widget_name": "table-pagination", "source_code": "if (!props.data || !props.columns) {\n  return \"column and data props are required.\";\n}\n\nconst data = props.data || [];\nconst columns = props.columns;\nconst withoutSearchBar = props.withoutSearchBar;\nState.init({\n  currentPage: 1,\n  searchValue: \"\",\n  sort: null, // { name: \"asc\", key: \"star\" } //asc -desc\n});\nconst rowsCount = props.rowsCount || 5;\nconst totalPages = Math.ceil(data.length / rowsCount);\n\nconst themeColor = props.themeColor;\nconst handleSearch = (event) => {\n  const value = event.target.value;\n  State.update({ searchValue: value });\n};\nconst handlePagination = () => {\n  if (!rowsCount) return { table: sortedDate(data) };\n  const currentPage = state.currentPage;\n  const totalPages = Math.ceil(data.length / rowsCount);\n  const currentTableData = sortedDate(data)\n    .filter((row) =>\n      Object.values(row).some((value) =>\n        value.toString().includes(state.searchValue)\n      )\n    )\n    .slice((currentPage - 1) * rowsCount, rowsCount * currentPage);\n  const buttons = Array(totalPages).fill(0);\n  buttons[currentPage - 1] = 1;\n  return { buttons, table: currentTableData };\n};\nconst Table = styled.table`\n  --bs-table-color: ${themeColor?.table_pagination?.table_color};\n  --bs-table-bg: ${themeColor?.table_pagination?.table_bg};\n  --bs-table-border-color: ${themeColor?.table_pagination?.table_border_color};\n  --bs-table-accent-bg: ${themeColor?.table_pagination?.table_accent_bg};\n  --bs-table-striped-color: ${themeColor?.table_pagination?.table_striped_color};\n  --bs-table-striped-bg: ${themeColor?.table_pagination?.table_striped_bg};\n  --bs-table-hover-color: ${themeColor?.table_pagination?.table_hover_color};\n  --bs-table-hover-bg:${themeColor?.table_pagination?.table_hover_bg};\n  --bs-table-hover-bg:${themeColor?.table_pagination?.columntextcolor};\n  --bs-table-hover-bg:${themeColor?.table_pagination?.input_bg};\n\n\n`;\nconst sortedDate = (data) => {\n  if (!state.sort) return data;\n  const sorted = data.sort((a, b) => {\n    if (state.sort.name === \"asc\") {\n      return typeof a[state.sort.key] === \"number\"\n        ? b[state.sort.key] ?? 0 - a[state.sort.key] ?? 0\n        : (b[state.sort.key] ?? \"\").localeCompare(a[state.sort.key] ?? \"\");\n    }\n    return typeof a[state.sort.key] === \"number\"\n      ? a[state.sort.key] ?? 0 - b[state.sort.key] ?? 0\n      : (a[state.sort.key] ?? \"\").localeCompare(b[state.sort.key] ?? \"\");\n  });\n  return sorted;\n};\nconst handleSort = (key) => {\n  if (state.sort && state.sort.key === key) {\n    if (state.sort.name === \"asc\") {\n      State.update({ sort: { name: \"desc\", key } });\n    } else {\n      State.update({ sort: null });\n    }\n  } else {\n    State.update({ sort: { name: \"asc\", key } });\n  }\n};\n\nconst onHandelId = (id) => {\n  let customId = \"\";\n  if (id.length > 20) {\n    customId += id.substring(0, 3);\n    customId += \"...\";\n    customId += id.substring(id.length - 3);\n    return customId;\n  } else {\n    return id;\n  }\n};\nconst formatNumber = (num) => {\n  if (num >= 1000000000) {\n    return (num / 1000000000).toFixed(2).replace(/\\.0$/, \"\") + \" b\";\n  }\n  if (num >= 1000000) {\n    return (num / 1000000).toFixed(2).replace(/\\.0$/, \"\") + \" m\";\n  }\n  if (num >= 1000) {\n    return (num / 1000).toFixed(2).replace(/\\.0$/, \"\") + \" k\";\n  }\n\n  if (num < 0 && num > 0.0001) {\n    return (Math.round(num * 1000) / 1000).toFixed(3) + \"\";\n  }\n\n  return num;\n};\n\nconst triangleState = (key) => {\n  if (!state.sort) return;\n  return (\n    state.sort.key === key &&\n    (state.sort.name === \"asc\" ? (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        style={{ transform: \"rotate(180deg)\" }}\n        width=\"8\"\n        height=\"8\"\n        viewBox=\"0 0 24 24\"\n      >\n        <path d=\"M23.677 18.52c.914 1.523-.183 3.472-1.967 3.472h-19.414c-1.784 0-2.881-1.949-1.967-3.472l9.709-16.18c.891-1.483 3.041-1.48 3.93 0l9.709 16.18z\" />\n      </svg>\n    ) : (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"8\"\n        height=\"8\"\n        viewBox=\"0 0 24 24\"\n      >\n        <path d=\"M23.677 18.52c.914 1.523-.183 3.472-1.967 3.472h-19.414c-1.784 0-2.881-1.949-1.967-3.472l9.709-16.18c.891-1.483 3.041-1.48 3.93 0l9.709 16.18z\" />\n      </svg>\n    ))\n  );\n};\n\nconst buttonsIcons = (\n  <ul\n    className=\"pagination pagination-sm gap-2 mb-0 \"\n    style={{ height: 56, padding: 12 }}\n  >\n    <li className=\"page-item\">\n      <button\n        onClick={() => {\n          State.update({ currentPage: 1 });\n        }}\n        className=\"page-link btn\"\n        style={{\n          width: 42,\n          height: 32,\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          borderRadius: 8,\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          borderColor: themeColor?.table_pagination?.btn_border ?? \"#000\",\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          backgroundColor: btn\n            ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\n            : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\n        }}\n      >\n        <span\n          style={{ fontSize: \"0.6rem\" }}\n          className=\"w-25 d-inline-block fw-light\"\n        >\n          1\n        </span>\n        <svg\n          width=\"17\"\n          height=\"16\"\n          viewBox=\"0 0 17 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M10.3292 12L11.2692 11.06L8.21589 8L11.2692 4.94L10.3292 4L6.32923 8L10.3292 12Z\"\n            fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\n          />\n        </svg>\n        <svg\n          width=\"17\"\n          height=\"16\"\n          viewBox=\"0 0 17 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M10.3292 12L11.2692 11.06L8.21589 8L11.2692 4.94L10.3292 4L6.32923 8L10.3292 12Z\"\n            fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\n          />\n        </svg>\n      </button>\n    </li>\n    <li className=\"page-item\">\n      <button\n        onClick={() => {\n          const page = state.currentPage - 1;\n          if (page > 0) State.update({ currentPage: page });\n        }}\n        className=\"page-link btn\"\n        style={{\n          width: 32,\n          height: 32,\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          borderRadius: 8,\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          borderColor: themeColor?.table_pagination?.btn_border ?? \"#000\",\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          backgroundColor: btn\n            ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\n            : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\n        }}\n      >\n        <svg\n          width=\"17\"\n          height=\"16\"\n          viewBox=\"0 0 17 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M10.3292 12L11.2692 11.06L8.21589 8L11.2692 4.94L10.3292 4L6.32923 8L10.3292 12Z\"\n            fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\n          />\n        </svg>\n      </button>\n    </li>\n    <li className=\"page-item\">\n      <button\n        onClick={() => {\n          const page = state.currentPage;\n          if (handlePagination().buttons.length >= page)\n            State.update({ currentPage: page });\n        }}\n        className=\"page-link btn\"\n        style={{\n          width: 32,\n          height: 32,\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          borderRadius: 8,\n          borderColor: themeColor?.table_pagination?.btn_border ?? \"#000\",\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          backgroundColor: btn\n            ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\n            : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\n        }}\n      >\n        {state.currentPage}\n      </button>\n    </li>\n    <li className=\"page-item\">\n      <button\n        onClick={() => {\n          const page = state.currentPage + 1;\n          if (handlePagination().buttons.length >= page)\n            State.update({ currentPage: page });\n        }}\n        className=\"page-link btn\"\n        style={{\n          width: 32,\n          height: 32,\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          borderRadius: 8,\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          borderColor: themeColor?.table_pagination?.btn_border ?? \"#000\",\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          backgroundColor: btn\n            ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\n            : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\n        }}\n      >\n        <svg\n          width=\"17\"\n          height=\"16\"\n          viewBox=\"0 0 17 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M6.20923 4L5.26923 4.94L8.32256 8L5.26923 11.06L6.20923 12L10.2092 8L6.20923 4Z\"\n            fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\n          />\n        </svg>\n      </button>\n    </li>\n\n    <li className=\"page-item\">\n      <button\n        onClick={() => {\n          State.update({ currentPage: totalPages });\n        }}\n        className=\"page-link btn\"\n        style={{\n          width: 42,\n          height: 32,\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          borderRadius: 8,\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          borderColor: themeColor?.table_pagination?.btn_border ?? \"#000\",\n          color: themeColor?.table_pagination?.btn_color ?? \"#000\",\n          backgroundColor: btn\n            ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\n            : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\n        }}\n      >\n        <svg\n          width=\"17\"\n          height=\"16\"\n          viewBox=\"0 0 17 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M6.20923 4L5.26923 4.94L8.32256 8L5.26923 11.06L6.20923 12L10.2092 8L6.20923 4Z\"\n            fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\n          />\n        </svg>\n        <svg\n          width=\"17\"\n          height=\"16\"\n          viewBox=\"0 0 17 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M6.20923 4L5.26923 4.94L8.32256 8L5.26923 11.06L6.20923 12L10.2092 8L6.20923 4Z\"\n            fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\n          />\n        </svg>\n\n        <span\n          style={{ fontSize: \"0.6rem\" }}\n          className=\"w-25 d-inline-block fw-light\"\n        >\n          {totalPages}\n        </span>\n      </button>\n    </li>\n  </ul>\n);\nreturn (\n  <div className=\"table-responsive pb-2\">\n    <div\n      style={{\n        backgroundColor: themeColor?.table_pagination?.table_bg,\n      }}\n    >\n      <Table\n        className={`table table-hover table-striped table-borderless ${props.className}`}\n      >\n        <thead>\n          <tr>\n            {columns.map((th) => (\n              <th\n                onClick={() => handleSort(th.key)}\n                key={th.title}\n                className=\"col-1\"\n                style={{\n                  fontSize: 12,\n                  width: `${th.width}%`,\n                  verticalAlign: \"middle\",\n                }}\n                scope=\"col\"\n              >\n                <div className=\"d-flex align-items-center pointer gap-2\">\n                  {th.description ? (\n                    <OverlayTrigger\n                      placement={th.position || \"top\"}\n                      overlay={<Tooltip>{th.description}</Tooltip>}\n                    >\n                      <span>{th.title}</span>\n                    </OverlayTrigger>\n                  ) : (\n                    <span>{th.title}</span>\n                  )}\n                  {triangleState(th.key)}\n                </div>\n              </th>\n            ))}\n          </tr>\n        </thead>\n\n        <tbody>\n          {data.length > 0 &&\n            handlePagination()\n              .table.filter((row) =>\n                Object.values(row).some((value) =>\n                  value.toString().includes(state.searchValue)\n                )\n              )\n              .map((row, i) => {\n                return (\n                  <tr key={row.key}>\n                    {columns.map((td) => {\n                      const key = td.key ? row[td.key] : i + 1;\n                      return (\n                        <td\n                          style={{\n                            color:\n                              td.colors ||\n                              themeColor?.table_pagination?.columntextcolor,\n                            fontSize: 14,\n                            textAlign: td.align,\n                            verticalAlign: \"middle\",\n                          }}\n                        >\n                          {td.profile ? (\n                            <div\n                              style={{\n                                display: \"flex\",\n                                gap: 10,\n                                alignItems: \"center\",\n                              }}\n                            >\n                              <Link\n                                href={`/mob.near/widget/ProfilePage?accountId=${key}`}\n                              >\n                                <Widget\n                                  src=\"mob.near/widget/ProfileImage\"\n                                  props={{ accountId: key }}\n                                  style={{\n                                    width: 40,\n                                    height: 40,\n                                    borderRadius: 50,\n                                  }}\n                                />\n                              </Link>\n                            </div>\n                          ) : td.link ? (\n                            <a\n                              className=\"d-inline-block\"\n                              target=\"_blank\"\n                              href={`${td.beforehref}${key}${td.afterhref}`}\n                              style={{\n                                \"text-decoration\": \"none\",\n                              }}\n                            >\n                              {td.hyperlink === \"yes\" ? (\n                                `${onHandelId(key)}`\n                              ) : (\n                                <svg\n                                  width=\"20\"\n                                  height=\"20\"\n                                  viewBox=\"0 0 20 20\"\n                                  fill=\"none\"\n                                  xmlns=\"http://www.w3.org/2000/svg\"\n                                >\n                                  <path\n                                    d=\"M12.9167 5.25001L12.9167 1.75001M12.9167 1.75001H9.41674M12.9167 1.75001L7.66675 7M6.50008 1.75H5.21675C4.23666 1.75 3.74661 1.75 3.37226 1.94074C3.04298 2.10852 2.77527 2.37623 2.60749 2.70552C2.41675 3.07986 2.41675 3.56991 2.41675 4.55V9.45C2.41675 10.4301 2.41675 10.9201 2.60749 11.2945C2.77527 11.6238 3.04298 11.8915 3.37226 12.0593C3.74661 12.25 4.23666 12.25 5.21675 12.25H10.1167C11.0968 12.25 11.5869 12.25 11.9612 12.0593C12.2905 11.8915 12.5582 11.6238 12.726 11.2945C12.9167 10.9201 12.9167 10.4301 12.9167 9.45V8.16667\"\n                                    stroke=\"#806ce1\"\n                                    stroke-width=\"2.5\"\n                                    stroke-linecap=\"round\"\n                                    stroke-linejoin=\"round\"\n                                  />\n                                </svg>\n                              )}\n                            </a>\n                          ) : td.explain ? (\n                            <OverlayTrigger\n                              placement={\"top\"}\n                              overlay={<Tooltip>{key}</Tooltip>}\n                            >\n                              <svg\n                                width=\"20\"\n                                height=\"20\"\n                                viewBox=\"0 0 31 32\"\n                                fill=\"none\"\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                              >\n                                <path\n                                  d=\"M18.0833 13.4167L27.125 4.375M27.125 4.375H19.375M27.125 4.375V12.125M12.9167 18.5833L3.875 27.625M3.875 27.625H11.625M3.875 27.625L3.875 19.875\"\n                                  stroke=\"#806ce1\"\n                                  stroke-width=\"2.5\"\n                                  stroke-linecap=\"round\"\n                                  stroke-linejoin=\"round\"\n                                />\n                              </svg>\n                            </OverlayTrigger>\n                          ) : td.round ? (\n                            formatNumber(key)\n                          ) : td.short ? (\n                            onHandelId(key)\n                          ) : td.pic ? (\n                            <img\n                              style={{\n                                marginBottom: \"1rem\",\n                                borderRadius: \"15%\",\n                              }}\n                              height=\"40\"\n                              width=\"40\"\n                              layout=\"intrinsic\"\n                              src={key}\n                            />\n                          ) : td.progress ? (\n                            <td className=\"align-middle \">\n                              <Widget\n                                src=\"lord1.near/widget/progress-bar\"\n                                props={{\n                                  inside: key.split(\"-\")[0],\n                                  total: key.split(\"-\")[1],\n                                  currTheme: \"#806ce1\",\n                                  widgetBarWidth: td.width,\n                                  backgroundcolor: \"#d2cafa\",\n                                  gradiantcolorleft: \"#806ce1\",\n                                  gradiantcolorright: \"#EA1179\",\n                                  visibilitydivision: \"visible\",\n                                  visibilitypercent: td.percent,\n                                }}\n                              />\n                            </td>\n                          ) : (\n                            key\n                          )}\n                        </td>\n                      );\n                    })}\n                  </tr>\n                );\n              })}\n        </tbody>\n      </Table>\n      {!withoutSearchBar && (\n        <div className=\"row p-0 m-0\">\n          <input\n            className=\"col col-sm-4\"\n            type=\"text\"\n            placeholder=\"Search...\"\n            color={themeColor?.table_pagination?.btn_color}\n            onChange={handleSearch}\n            style={{\n              height: \"30px\",\n              borderRadius: \"50px\",\n              \"margin-left\": \"2px\",\n              \"margin-top\": \"2px\",\n              \"margin-buttom\": \"2px\",\n              backgroundColor: themeColor?.table_pagination?.input_bg,\n              color: themeColor?.table_pagination?.btn_color,\n              border: `0.5px solid ${\n                themeColor?.table_pagination?.btn_border ?? \"#000\"\n              }`,\n            }}\n          />\n        </div>\n      )}\n    </div>\n\n    {!rowsCount || totalPages === 1 ? (\n      \"\"\n    ) : (\n      <div\n        className=\"d-flex justify-content-center\"\n        style={{\n          backgroundColor: themeColor?.table_pagination?.table_bg,\n        }}\n      >\n        <div>{buttonsIcons}</div>\n      </div>\n    )}\n  </div>\n);\n\n// const props = {\n//   data: [],\n//   columns: [\n//     { title: \"id\" }, //if key does not provided , rows will be ascending numbers\n//     { title: \"title\", key: \"key in data\" ,description:\"here is a\",position:\"top/right/buttom/left\",\n//      link: \"yes\",\n//     hyperlink :\"yes\"\n//      beforehref: \"https://near.social/mob.near/widget/ProfilePage?accountId=\",\n//      afterhref: \"\",\n//      colors: \"green\" ,\n//      \"explain\":\"yes\",\n//      \"profile\":\"yes\" ,\n//      \"short\":yes,\n//      \"progress\": \"yes\",\n//      \"width\": \"100%\",\n//      \"percent\": \"hidden\" or visible},\n\n//   ],\n//    withoutSearchBar : true,\n//   rowsCount: 2, // if zero or null , the whole table will be render\n//   className: \"table-bordered\",\n//   themeColor: {\n//     table_pagination: {\n//       table_bg: \"rgb(25,33,50)\",\n//       table_color: \"rgb(255,255,255)\",\n//       table_border_color: \"\",\n//       table_accent_bg: \"\",\n//       table_striped_color: \"rgb(255,255,255)\",\n//       table_striped_bg: \"\",\n//       table_hover_color: \"rgb(255,255,255)\",\n//       table_hover_bg: \"\",\n//       btn_border: \"#fff\",\n//       btn_bg: \"rgba(49, 62, 89,0.5)\",\n//       btn_bg_active: \"rgb(25,33,50)\",\n//       btn_color: \"#fff\",\n//       columntextcolor: \"\"\n//     },\n//   },\n// };\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/lord1.near/widget/table-pagination", "fact_widget_deployments_id": "af0b3a800c257dff451dc6c00d1d1ca1", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 38}
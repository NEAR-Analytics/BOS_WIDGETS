{"tx_hash": "54Ah8VbMWaVzEwwf4RSpEPZtL2ChrUFBeSXbz1b3Aj6D", "action_id_social": "7rv7SV32DnojQUPYJDb1kcJRDgiJVmGhi1kS4fPB8QcE-0-widget", "block_id": 107928870, "block_timestamp": "2023-12-14T14:03:40.479Z", "signer_id": "lord1.near", "widget_name": "table-pagination", "source_code": "if (!props.data || !props.columns) {\r\n  return \"column and data props are required.\";\r\n}\r\n\r\nconst data = props.data || [];\r\nconst columns = props.columns;\r\n\r\nState.init({ currentPage: 1, searchValue: \"\" });\r\nconst rowsCount = props.rowsCount || 5;\r\nconst themeColor = props.themeColor;\r\nconst handleSearch = (event) => {\r\n  const value = event.target.value;\r\n  State.update({ searchValue: value });\r\n};\r\nconst handlePagination = () => {\r\n  if (!rowsCount) return { table: data };\r\n  const currentPage = state.currentPage;\r\n  const totalPages = Math.ceil(data.length / rowsCount);\r\n  const currentTableData = data\r\n    .filter((row) =>\r\n      Object.values(row).some((value) =>\r\n        value.toString().includes(state.searchValue)\r\n      )\r\n    )\r\n    .slice((currentPage - 1) * rowsCount, rowsCount * currentPage);\r\n  const buttons = Array(totalPages).fill(0);\r\n  buttons[currentPage - 1] = 1;\r\n  return { buttons, table: currentTableData };\r\n};\r\nconst Table = styled.table`\r\n  --bs-table-color: ${themeColor?.table_pagination?.table_color};\r\n  --bs-table-bg: ${themeColor?.table_pagination?.table_bg};\r\n  --bs-table-border-color: ${themeColor?.table_pagination?.table_border_color};\r\n  --bs-table-accent-bg: ${themeColor?.table_pagination?.table_accent_bg};\r\n  --bs-table-striped-color: ${themeColor?.table_pagination?.table_striped_color};\r\n  --bs-table-striped-bg: ${themeColor?.table_pagination?.table_striped_bg};\r\n  --bs-table-hover-color: ${themeColor?.table_pagination?.table_hover_color};\r\n  --bs-table-hover-bg:${themeColor?.table_pagination?.table_hover_bg};\r\n  --bs-table-hover-bg:${themeColor?.table_pagination?.columntextcolor};\r\n  --bs-table-hover-bg:${themeColor?.table_pagination?.input_bg};\r\n\r\n\r\n`;\r\n\r\nconst onHandelId = (id) => {\r\n  let customId = \"\";\r\n  if (id.length > 20) {\r\n    customId += id.substring(0, 3);\r\n    customId += \"...\";\r\n    customId += id.substring(id.length - 3);\r\n    return customId;\r\n  } else {\r\n    return id;\r\n  }\r\n};\r\nconst formatNumber = (num) => {\r\n  if (num >= 1000000000) {\r\n    return (num / 1000000000).toFixed(1).replace(/\\.0$/, \"\") + \"b\";\r\n  }\r\n  if (num >= 1000000) {\r\n    return (num / 1000000).toFixed(1).replace(/\\.0$/, \"\") + \"m\";\r\n  }\r\n  if (num >= 1000) {\r\n    return (num / 1000).toFixed(1).replace(/\\.0$/, \"\") + \"k\";\r\n  }\r\n  if (num < 1 && num > 0) {\r\n    return (num * 1000).toFixed(1).replace(/\\.0$/, \"\") + \"m\";\r\n  }\r\n  if (num < 1 && num > 0) {\r\n    return (num * 1000000).toFixed(1).replace(/\\.0$/, \"\") + \"* 10^-6\";\r\n  }\r\n  return num;\r\n};\r\nreturn (\r\n  <div className=\"table-responsive\">\r\n    <div\r\n      style={{\r\n        backgroundColor: themeColor?.table_pagination?.table_bg,\r\n      }}\r\n    >\r\n      <Table\r\n        className={`table table-hover table-striped table-borderless ${props.className}`}\r\n      >\r\n        <thead>\r\n          <tr>\r\n            {columns.map((th) => (\r\n              <th\r\n                key={th.title}\r\n                className=\"col-1\"\r\n                style={{\r\n                  fontSize: 12,\r\n                  width: `${th.width}%`,\r\n                  verticalAlign: \"middle\",\r\n                }}\r\n                scope=\"col\"\r\n              >\r\n                <div>\r\n                  {th.description ? (\r\n                    <OverlayTrigger\r\n                      placement={th.position || \"top\"}\r\n                      overlay={<Tooltip>{th.description}</Tooltip>}\r\n                    >\r\n                      <span>{th.title}</span>\r\n                    </OverlayTrigger>\r\n                  ) : (\r\n                    <span>{th.title}</span>\r\n                  )}\r\n                </div>\r\n              </th>\r\n            ))}\r\n          </tr>\r\n        </thead>\r\n\r\n        <tbody>\r\n          {data.length > 0 &&\r\n            handlePagination()\r\n              .table.filter((row) =>\r\n                Object.values(row).some((value) =>\r\n                  value.toString().includes(state.searchValue)\r\n                )\r\n              )\r\n              .map((row, i) => {\r\n                return (\r\n                  <tr key={row.key}>\r\n                    {columns.map((td) => {\r\n                      const key = td.key ? row[td.key] : i + 1;\r\n                      return (\r\n                        <td\r\n                          style={{\r\n                            color:\r\n                              td.colors ||\r\n                              themeColor?.table_pagination?.columntextcolor,\r\n                            fontSize: 12,\r\n                            textAlign: td.align,\r\n                            verticalAlign: \"middle\",\r\n                          }}\r\n                        >\r\n                          {td.profile ? (\r\n                            <div\r\n                              style={{\r\n                                display: \"flex\",\r\n                                gap: 10,\r\n                                alignItems: \"center\",\r\n                              }}\r\n                            >\r\n                              <Link\r\n                                href={`/mob.near/widget/ProfilePage?accountId=${key}`}\r\n                              >\r\n                                <Widget\r\n                                  src=\"mob.near/widget/ProfileImage\"\r\n                                  props={{ accountId: key }}\r\n                                  style={{\r\n                                    width: 40,\r\n                                    height: 40,\r\n                                    borderRadius: 50,\r\n                                  }}\r\n                                />\r\n                              </Link>\r\n                            </div>\r\n                          ) : td.link ? (\r\n                            <a\r\n                              className=\"d-inline-block\"\r\n                              target=\"_blank\"\r\n                              href={`${td.beforehref}${key}${td.afterhref}`}\r\n                              style={{\r\n                                \"text-decoration\": \"none\",\r\n                              }}\r\n                            >\r\n                              {td.hyperlink === \"yes\" ? (\r\n                                `${onHandelId(key)}`\r\n                              ) : (\r\n                                <svg\r\n                                  width=\"20\"\r\n                                  height=\"20\"\r\n                                  viewBox=\"0 0 20 20\"\r\n                                  fill=\"none\"\r\n                                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                                >\r\n                                  <path\r\n                                    d=\"M12.9167 5.25001L12.9167 1.75001M12.9167 1.75001H9.41674M12.9167 1.75001L7.66675 7M6.50008 1.75H5.21675C4.23666 1.75 3.74661 1.75 3.37226 1.94074C3.04298 2.10852 2.77527 2.37623 2.60749 2.70552C2.41675 3.07986 2.41675 3.56991 2.41675 4.55V9.45C2.41675 10.4301 2.41675 10.9201 2.60749 11.2945C2.77527 11.6238 3.04298 11.8915 3.37226 12.0593C3.74661 12.25 4.23666 12.25 5.21675 12.25H10.1167C11.0968 12.25 11.5869 12.25 11.9612 12.0593C12.2905 11.8915 12.5582 11.6238 12.726 11.2945C12.9167 10.9201 12.9167 10.4301 12.9167 9.45V8.16667\"\r\n                                    stroke=\"#806ce1\"\r\n                                    stroke-width=\"2.5\"\r\n                                    stroke-linecap=\"round\"\r\n                                    stroke-linejoin=\"round\"\r\n                                  />\r\n                                </svg>\r\n                              )}\r\n                            </a>\r\n                          ) : td.explain ? (\r\n                            <OverlayTrigger\r\n                              placement={\"top\"}\r\n                              overlay={<Tooltip>{key}</Tooltip>}\r\n                            >\r\n                              <svg\r\n                                width=\"20\"\r\n                                height=\"20\"\r\n                                viewBox=\"0 0 31 32\"\r\n                                fill=\"none\"\r\n                                xmlns=\"http://www.w3.org/2000/svg\"\r\n                              >\r\n                                <path\r\n                                  d=\"M18.0833 13.4167L27.125 4.375M27.125 4.375H19.375M27.125 4.375V12.125M12.9167 18.5833L3.875 27.625M3.875 27.625H11.625M3.875 27.625L3.875 19.875\"\r\n                                  stroke=\"#806ce1\"\r\n                                  stroke-width=\"2.5\"\r\n                                  stroke-linecap=\"round\"\r\n                                  stroke-linejoin=\"round\"\r\n                                />\r\n                              </svg>\r\n                            </OverlayTrigger>\r\n                          ) : td.round ? (\r\n                            formatNumber(key)\r\n                          ) : td.short ? (\r\n                            onHandelId(key)\r\n                          ) : td.pic ? (\r\n                            <img\r\n                              style={{\r\n                                marginBottom: \"1rem\",\r\n                                borderRadius: \"15%\",\r\n                              }}\r\n                              height=\"40\"\r\n                              width=\"40\"\r\n                              layout=\"intrinsic\"\r\n                              src={key}\r\n                            />\r\n                          ) : td.progress ? (\r\n                            <td className=\"align-middle \">\r\n                              <Widget\r\n                                src=\"lord1.near/widget/progress-bar\"\r\n                                props={{\r\n                                  inside: key.split(\"-\")[0],\r\n                                  total: key.split(\"-\")[1],\r\n                                  currTheme: \"#806ce1\",\r\n                                  widgetBarWidth: td.width,\r\n                                  backgroundcolor: \"#d2cafa\",\r\n                                  gradiantcolorleft: \"#806ce1\",\r\n                                  gradiantcolorright: \"#EA1179\",\r\n                                  visibilitydivision: \"visible\",\r\n                                  visibilitypercent: td.percent,\r\n                                }}\r\n                              />\r\n                            </td>\r\n                          ) : (\r\n                            key\r\n                          )}\r\n                        </td>\r\n                      );\r\n                    })}\r\n                  </tr>\r\n                );\r\n              })}\r\n        </tbody>\r\n      </Table>{\" \"}\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Search...\"\r\n        color={themeColor?.table_pagination?.btn_color}\r\n        onChange={handleSearch}\r\n        style={{\r\n          width: \"20%\",\r\n          height: \"30px\",\r\n          borderRadius: \"50px\",\r\n          \"margin-left\": \"2px\",\r\n          \"margin-top\": \"2px\",\r\n          \"margin-buttom\": \"2px\",\r\n          backgroundColor: themeColor?.table_pagination?.input_bg,\r\n          color: themeColor?.table_pagination?.btn_color,\r\n          border: `0.5px solid ${\r\n            themeColor?.table_pagination?.btn_border ?? \"#000\"\r\n          }`,\r\n        }}\r\n      />\r\n    </div>\r\n\r\n    {!rowsCount ? (\r\n      \"\"\r\n    ) : (\r\n      <div\r\n        className=\"d-flex justify-content-center\"\r\n        style={{\r\n          backgroundColor: themeColor?.table_pagination?.table_bg,\r\n        }}\r\n      >\r\n        <div>\r\n          <ul\r\n            className=\"pagination pagination-sm gap-2 mb-0 \"\r\n            style={{ height: 56, padding: 12 }}\r\n          >\r\n            <li className=\"page-item\">\r\n              <button\r\n                onClick={() => {\r\n                  State.update({ currentPage: 1 });\r\n                }}\r\n                className=\"page-link btn\"\r\n                style={{\r\n                  width: 32,\r\n                  height: 32,\r\n                  display: \"flex\",\r\n                  justifyContent: \"center\",\r\n                  alignItems: \"center\",\r\n                  borderRadius: 8,\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  borderColor:\r\n                    themeColor?.table_pagination?.btn_border ?? \"#000\",\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  backgroundColor: btn\r\n                    ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\r\n                    : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\r\n                }}\r\n              >\r\n                <svg\r\n                  width=\"17\"\r\n                  height=\"16\"\r\n                  viewBox=\"0 0 17 16\"\r\n                  fill=\"none\"\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                >\r\n                  <path\r\n                    d=\"M10.3292 12L11.2692 11.06L8.21589 8L11.2692 4.94L10.3292 4L6.32923 8L10.3292 12Z\"\r\n                    fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\r\n                  />\r\n                </svg>\r\n                <svg\r\n                  width=\"17\"\r\n                  height=\"16\"\r\n                  viewBox=\"0 0 17 16\"\r\n                  fill=\"none\"\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                >\r\n                  <path\r\n                    d=\"M10.3292 12L11.2692 11.06L8.21589 8L11.2692 4.94L10.3292 4L6.32923 8L10.3292 12Z\"\r\n                    fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\r\n                  />\r\n                </svg>\r\n              </button>\r\n            </li>\r\n            <li className=\"page-item\">\r\n              <button\r\n                onClick={() => {\r\n                  const page = state.currentPage - 1;\r\n                  if (page > 0) State.update({ currentPage: page });\r\n                }}\r\n                className=\"page-link btn\"\r\n                style={{\r\n                  width: 32,\r\n                  height: 32,\r\n                  display: \"flex\",\r\n                  justifyContent: \"center\",\r\n                  alignItems: \"center\",\r\n                  borderRadius: 8,\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  borderColor:\r\n                    themeColor?.table_pagination?.btn_border ?? \"#000\",\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  backgroundColor: btn\r\n                    ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\r\n                    : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\r\n                }}\r\n              >\r\n                <svg\r\n                  width=\"17\"\r\n                  height=\"16\"\r\n                  viewBox=\"0 0 17 16\"\r\n                  fill=\"none\"\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                >\r\n                  <path\r\n                    d=\"M10.3292 12L11.2692 11.06L8.21589 8L11.2692 4.94L10.3292 4L6.32923 8L10.3292 12Z\"\r\n                    fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\r\n                  />\r\n                </svg>\r\n              </button>\r\n            </li>\r\n            <li className=\"page-item\">\r\n              <button\r\n                onClick={() => {\r\n                  const page = state.currentPage;\r\n                  if (handlePagination().buttons.length >= page)\r\n                    State.update({ currentPage: page });\r\n                }}\r\n                className=\"page-link btn\"\r\n                style={{\r\n                  width: 32,\r\n                  height: 32,\r\n                  display: \"flex\",\r\n                  justifyContent: \"center\",\r\n                  alignItems: \"center\",\r\n                  borderRadius: 8,\r\n                  borderColor:\r\n                    themeColor?.table_pagination?.btn_border ?? \"#000\",\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  backgroundColor: btn\r\n                    ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\r\n                    : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\r\n                }}\r\n              >\r\n                {state.currentPage}\r\n              </button>\r\n            </li>\r\n            <li className=\"page-item\">\r\n              <button\r\n                onClick={() => {\r\n                  const page = state.currentPage + 1;\r\n                  if (handlePagination().buttons.length >= page)\r\n                    State.update({ currentPage: page });\r\n                }}\r\n                className=\"page-link btn\"\r\n                style={{\r\n                  width: 32,\r\n                  height: 32,\r\n                  display: \"flex\",\r\n                  justifyContent: \"center\",\r\n                  alignItems: \"center\",\r\n                  borderRadius: 8,\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  borderColor:\r\n                    themeColor?.table_pagination?.btn_border ?? \"#000\",\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  backgroundColor: btn\r\n                    ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\r\n                    : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\r\n                }}\r\n              >\r\n                <svg\r\n                  width=\"17\"\r\n                  height=\"16\"\r\n                  viewBox=\"0 0 17 16\"\r\n                  fill=\"none\"\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                >\r\n                  <path\r\n                    d=\"M6.20923 4L5.26923 4.94L8.32256 8L5.26923 11.06L6.20923 12L10.2092 8L6.20923 4Z\"\r\n                    fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\r\n                  />\r\n                </svg>\r\n              </button>\r\n            </li>\r\n\r\n            <li className=\"page-item\">\r\n              <button\r\n                onClick={() => {\r\n                  const totalPages = Math.ceil(data.length / rowsCount);\r\n                  State.update({ currentPage: totalPages });\r\n                }}\r\n                className=\"page-link btn\"\r\n                style={{\r\n                  width: 32,\r\n                  height: 32,\r\n                  display: \"flex\",\r\n                  justifyContent: \"center\",\r\n                  alignItems: \"center\",\r\n                  borderRadius: 8,\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  borderColor:\r\n                    themeColor?.table_pagination?.btn_border ?? \"#000\",\r\n                  color: themeColor?.table_pagination?.btn_color ?? \"#000\",\r\n                  backgroundColor: btn\r\n                    ? themeColor?.table_pagination?.btn_bg_active ?? \"gray\"\r\n                    : themeColor?.table_pagination?.btn_bg ?? \"transparent\",\r\n                }}\r\n              >\r\n                <svg\r\n                  width=\"17\"\r\n                  height=\"16\"\r\n                  viewBox=\"0 0 17 16\"\r\n                  fill=\"none\"\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                >\r\n                  <path\r\n                    d=\"M6.20923 4L5.26923 4.94L8.32256 8L5.26923 11.06L6.20923 12L10.2092 8L6.20923 4Z\"\r\n                    fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\r\n                  />\r\n                </svg>\r\n                <svg\r\n                  width=\"17\"\r\n                  height=\"16\"\r\n                  viewBox=\"0 0 17 16\"\r\n                  fill=\"none\"\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                >\r\n                  <path\r\n                    d=\"M6.20923 4L5.26923 4.94L8.32256 8L5.26923 11.06L6.20923 12L10.2092 8L6.20923 4Z\"\r\n                    fill={themeColor?.table_pagination?.btn_color ?? \"#000\"}\r\n                  />\r\n                </svg>\r\n              </button>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    )}\r\n  </div>\r\n);\r\n\r\n// const props = {\r\n//   data: [],\r\n//   columns: [\r\n//     { title: \"id\" }, //if key does not provided , rows will be ascending numbers\r\n//     { title: \"title\", key: \"key in data\" ,description:\"here is a\",position:\"top/right/buttom/left\",\r\n//      link: \"yes\",\r\n//     hyperlink :\"yes\"\r\n//      beforehref: \"https://near.social/mob.near/widget/ProfilePage?accountId=\",\r\n//      afterhref: \"\",\r\n//      colors: \"green\" ,\r\n//      \"explain\":\"yes\",\r\n//      \"profile\":\"yes\" ,\r\n//      \"short\":yes,\r\n//      \"progress\": \"yes\",\r\n//      \"width\": \"100%\",\r\n//      \"percent\": \"hidden\" or visible},\r\n\r\n//   ],\r\n//   rowsCount: 2, // if zero or null , the whole table will be render\r\n//   className: \"table-bordered\",\r\n//   themeColor: {\r\n//     table_pagination: {\r\n//       table_bg: \"rgb(25,33,50)\",\r\n//       table_color: \"rgb(255,255,255)\",\r\n//       table_border_color: \"\",\r\n//       table_accent_bg: \"\",\r\n//       table_striped_color: \"rgb(255,255,255)\",\r\n//       table_striped_bg: \"\",\r\n//       table_hover_color: \"rgb(255,255,255)\",\r\n//       table_hover_bg: \"\",\r\n//       btn_border: \"#fff\",\r\n//       btn_bg: \"rgba(49, 62, 89,0.5)\",\r\n//       btn_bg_active: \"rgb(25,33,50)\",\r\n//       btn_color: \"#fff\",\r\n//       columntextcolor: \"\"\r\n//     },\r\n//   },\r\n// };\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/lord1.near/widget/table-pagination", "fact_widget_deployments_id": "838f3922df319cc9fa4df6c38626268d", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 34}
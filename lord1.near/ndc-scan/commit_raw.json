{"tx_hash": "4oDmdoUDYtQAVSpmqC4DZVz6qaB9quGQUxdE2h3XqcLe", "action_id_social": "bTsntMad8WSwMRKhjVz62QDLwrLh2BE1bRXhcCiaoBD-0-widget", "block_id": 101499371, "block_timestamp": "2023-09-19T20:24:18.236Z", "signer_id": "lord1.near", "widget_name": "ndc-scan", "source_code": "const themeColor = props.themeColor;\r\n// const themeColor = props.themeColor;\r\nconst generaltheme = {\r\n  height: \"110px\",\r\n  align: \"center\",\r\n  description: \"Tracking the activity in NDC process.\",\r\n  brand: \"NDC Scan\",\r\n  fontsize: \"100\",\r\n  fontweight: \"25px\",\r\n  afterbrand: \"\ud83c\udfe6\",\r\n  afterbrandcolor: themeColor?.dynamic_header?.afterbrandcolor || \"#789efb\",\r\n  fontbrand: \" Arial, sans-serif\",\r\n  color1brand: themeColor?.dynamic_header?.color1brand || \"#000\",\r\n  color2brand: themeColor?.dynamic_header?.color2brand || \"#806ce1\",\r\n  colordescription: themeColor?.dynamic_header?.colordescription || \"#806ce1\",\r\n  fontsubtitle: \" Arial, sans-serif\",\r\n  background:\r\n    themeColor?.dynamic_header?.background ||\r\n    \"radial-gradient(circle, rgba(210,202,250,1) 0%, rgba(230,230,231,0.01) 0%, rgba(235,238,255,1) 100%, rgba(235,231,253,1) 100%, rgba(255,241,241,1) 100%, rgba(46,52,90,1) 100%);\",\r\n};\r\n\r\nconst queryHashes = [{ id: 1, hash: \"d299495a-d02b-4646-b56f-d75276333483\" }];\r\n\r\nState.init({\r\n  filter: \"\",\r\n  data: [],\r\n  filteredData: [],\r\n  isLoading: true,\r\n  error: [],\r\n});\r\n\r\nconst Input = styled.input`\r\ncolor:${themeColor?.search_sbt?.input_text_color};\r\nbackground-color:${themeColor?.search_sbt?.input_bg};\r\nborder: 1px solid ${themeColor?.search_sbt?.input_border};\r\n&:focus{\r\n  background-color:${themeColor?.search_sbt?.input_bg};\r\n  color:${themeColor?.search_sbt?.input_text_color};\r\nborder: 1px solid ${themeColor?.search_sbt?.input_border};\r\n};\r\n&:hover{\r\n  background-color:${themeColor?.search_sbt?.input_bg_hover}\r\n};\r\n\r\n`;\r\nconst Button = styled.button`\r\n    color: ${themeColor?.search_sbt?.search_btn_text};\r\n    font-size: 16px;\r\n    padding: 0.5rem 1rem;\r\n    font-weight: 400;\r\n    background-color: ${themeColor?.search_sbt?.search_btn_bg};\r\n    &:hover {background-color: ${themeColor?.search_sbt?.search_btn_bg_hover}};\r\n    border: 1px solid ${themeColor?.search_sbt?.search_btn_bg};\r\n    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.02);\r\n    min-height: calc(1.5em + 1rem + 2px);\r\n    border-radius: 40px;\r\n    line-height: 29px;\r\n    letter-spacing: 0.01em;\r\n`;\r\nconst handleData = () => {\r\n  const data = {};\r\n  const errors = [];\r\n  queryHashes.forEach(({ hash, id }) => {\r\n    const result = fetchData(hash);\r\n    if (result.error) errors.push(`hash${id} : ${result.error}`);\r\n    data[`hash${id}`] = {\r\n      ...result,\r\n      id,\r\n    };\r\n  });\r\n\r\n  if (Object.values(data).every((d) => !d.isLoading)) {\r\n    State.update({\r\n      data: data,\r\n      filteredData: data.hash1.data,\r\n      error: [...state.error, ...errors],\r\n      isLoading: false,\r\n    });\r\n  }\r\n};\r\nconst inputHandler = ({ target }) => {\r\n  const filter = target.value.toLowerCase().trim();\r\n  State.update({ filter: filter });\r\n};\r\n\r\nconst filterData = () => {\r\n  if (!state.filter.length) {\r\n    State.update({ error: [...state.error, \"please insert an address\"] });\r\n    return;\r\n  }\r\n  if (state.data === state.filter) {\r\n    State.update({ error: [...state.error, \"please insert a new address\"] });\r\n    return;\r\n  }\r\n\r\n  const filteredData = state.data.hash1?.data?.filter((row) =>\r\n    Object.values(row)\r\n      .join()\r\n      .toLocaleLowerCase()\r\n      .includes(state.filter.toLocaleLowerCase())\r\n  );\r\n  State.update({ filteredData: filteredData || [] });\r\n};\r\nconst fetchData = (hash) => {\r\n  const data = fetch(\r\n    `https://api.flipsidecrypto.com/api/v2/queries/${hash}/data/latest`,\r\n    {\r\n      subscribe: true,\r\n      method: \"GET\",\r\n      headers: {\r\n        Accept: \"*/*\",\r\n      },\r\n    }\r\n  );\r\n  const result = {\r\n    data: (data && data.body) || null,\r\n    error: (data && !data.ok && (data.status || data.error)) || null,\r\n    isLoading: !data && !error,\r\n  };\r\n  return result;\r\n};\r\n\r\nif (state.isLoading) {\r\n  handleData();\r\n}\r\n\r\nif (state.error.length > 0) {\r\n  function hide() {\r\n    const errors = state.error;\r\n    errors.shift();\r\n    if (errors.length > 0) setTimeout(hide, 2500);\r\n    State.update({ error: errors });\r\n  }\r\n  setTimeout(hide, 2500);\r\n}\r\n\r\nreturn (\r\n  <div\r\n    style={{ backgroundColor: themeColor.page_bg }}\r\n    className=\"container-fluid py-2\"\r\n  >\r\n    <div className=\"pl-2\">\r\n      <div\r\n        style={{ background: themeColor?.sbt_area?.section_bg }}\r\n        className=\"shadow-sm rounded-2 overflow-auto\"\r\n      >\r\n        <Widget src=\"lord1.near/widget/header-dynamic\" props={generaltheme} />\r\n\r\n        <div className=\"search w-100 pl-4 py-4\">\r\n          <div className=\"row\">\r\n            <div className=\"col-8 \">\r\n              <Input\r\n                onBlur={inputHandler}\r\n                defaultValue={state.filter}\r\n                type=\"input\"\r\n                className=\"form-control form-control-lg rounded-4\"\r\n                id=\"address\"\r\n                placeholder=\"address/hash/time/function ...\"\r\n              />\r\n            </div>\r\n            <div className=\"col-4 col-lg-auto\">\r\n              <Button\r\n                disabled={state.isLoading}\r\n                onClick={filterData}\r\n                className=\"btn-lg\"\r\n                type=\"button\"\r\n                style={{ \"margin-left\": \"1%\" }}\r\n              >\r\n                {state.isLoading ? (\r\n                  <div className=\"text-center px-4\">\r\n                    <div\r\n                      className=\"spinner-border spinner-border-sm\"\r\n                      role=\"status\"\r\n                    >\r\n                      <span className=\"visually-hidden\">Loading...</span>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  \"search\"\r\n                )}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"w-100 p-2\" style={{ \"border-radius\": \"100px\" }}>\r\n          <Widget\r\n            src=\"lord1.near/widget/table-pagination\"\r\n            props={{\r\n              themeColor: { table_pagination: themeColor.table_pagination },\r\n              data: state.filteredData,\r\n              columns: [\r\n                { title: \"Number\", key: \"rank\", colors: \"#806ce1\" },\r\n                {\r\n                  title: \"Status\",\r\n                  key: \"status\",\r\n                },\r\n                { title: \"Timestamp\", key: \"time\" },\r\n                {\r\n                  title: \"Signer\",\r\n                  key: \"SINGER\",\r\n                  link: \"yes\",\r\n                  beforehref:\r\n                    \"https://near.social/mob.near/widget/ProfilePage?accountId=\",\r\n                  hyperlink: \"yes\",\r\n                },\r\n                { title: \"Function \", key: \"function\" },\r\n                {\r\n                  title: \"Target\",\r\n                  key: \"target\",\r\n                  link: \"yes\",\r\n                  beforehref:\r\n                    \"https://near.social/mob.near/widget/ProfilePage?accountId=\",\r\n                  hyperlink: \"yes\",\r\n                },\r\n                { title: \"Fee(Near)\", key: \"fee\" },\r\n\r\n                {\r\n                  title: \"Hash\",\r\n                  key: \"trxs\",\r\n                  link: \"yes\",\r\n                  beforehref: \"https://nearblocks.io/txns/\",\r\n                  afterhref: \"\",\r\n                },\r\n              ],\r\n              rowsCount: 20,\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div className=\"toast-container position-fixed bottom-0 end-0 p-3\">\r\n        {state.error.length > 0 &&\r\n          state.error.map((er) => (\r\n            <div\r\n              className=\"toast show align-items-center text-bg-danger border-0\"\r\n              role=\"alert\"\r\n              aria-live=\"assertive\"\r\n              aria-atomic=\"true\"\r\n            >\r\n              <div className=\"d-flex\">\r\n                <div className=\"toast-body\">{er}</div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\n// const props = {\r\n//   themeColor: {\r\n//     dynamic_header: {\r\n//       afterbrandcolor: \"#789efb\",\r\n//       color1brand: \"#000\",\r\n//       color2brand: \"#806ce1\",\r\n//       colordescription: \"#806ce1\",\r\n//       background:\r\n//         \"radial-gradient(circle, rgba(210,202,250,1) 0%, rgba(230,230,231,0.01) 0%, rgba(235,238,255,1) 100%, rgba(235,231,253,1) 100%, rgba(255,241,241,1) 100%, rgba(46,52,90,1) 100%);\",\r\n//     },\r\n//     tab_sbt: {\r\n//       backgroundColor: \"rgb(49,62,89)\",\r\n//       textColor: \"#fff\",\r\n//       headerColor: \"#806ce1\",\r\n//       numberColor: \"#fff\",\r\n//     },\r\n//     sbt_area: {\r\n//       section_bg: \"rgba(25,33,80)\",\r\n//       card_bg: \"rgb(49, 62, 89)\",\r\n//       card_title_color: \"#806ce1\",\r\n//     },\r\n//   },\r\n// };\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/lord1.near/widget/ndc-scan", "fact_widget_deployments_id": "2d72c172302dcd4a161c88a890a22885", "inserted_timestamp": "2023-09-19T22:25:31.020Z", "modified_timestamp": "2023-09-19T22:25:31.020Z", "__row_index": 0}
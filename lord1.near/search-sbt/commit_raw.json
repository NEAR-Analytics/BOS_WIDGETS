{"tx_hash": "9hDMeyUpaUyLL5sKfj56dfEzmvJ7CQvtTLbhPV8PBsbY", "action_id_social": "7wxQ4UX3EKL82se82PiQZAeDCXRsyxGRhKhqgbFpLsyF-0-widget", "block_id": 99553722, "block_timestamp": "2023-08-24T13:55:27.172Z", "signer_id": "lord1.near", "widget_name": "search-sbt", "source_code": "const generaltheme = {\r\n  height: \"110px\",\r\n  align: \"center\",\r\n  description: \"Explore the status of your SBTS on Near ecosystem.\",\r\n  brand: \"Im Human Explorer \ud83d\udc4b\",\r\n  fontsize: \"100\",\r\n  fontweight: \"25px\",\r\n  afterbrand: \"\",\r\n  afterbrandcolor: \"#789efb\",\r\n  fontbrand: \" Arial, sans-serif\",\r\n  color1brand: \"#000\",\r\n  color2brand: \"#806ce1\",\r\n  colordescription: \"#806ce1\",\r\n  fontsubtitle: \" Arial, sans-serif\",\r\n  background:\r\n    \"radial-gradient(circle, rgba(210,202,250,1) 0%, rgba(230,230,231,0.01) 0%, rgba(235,238,255,1) 100%, rgba(235,231,253,1) 100%, rgba(255,241,241,1) 100%, rgba(46,52,90,1) 100%);\",\r\n};\r\nconst props = {\r\n  theme: \"light\",\r\n};\r\nconst theme = props.theme || \"light\";\r\nlet themeColors = null;\r\nif (theme === \"light\") {\r\n  themeColors = {\r\n    page_bg: \"rgb(241,242,245)\",\r\n    search_btn_bg: \"rgb(210, 202, 250)\",\r\n    search_btn_bg_hover: \"rgb(188 175 251)\",\r\n    search_btn_text: \"rgb(25,33,50)\",\r\n    input_bg: \"rgb(255, 255, 255)\",\r\n    input_bg_hover: \"rgb(209 ,213 ,225)\",\r\n    input_text: \"\",\r\n    input_border: \"rgb(209 ,213 ,225)\",\r\n    table_bg: \"transparent\",\r\n    table_color: \"rgb(25,33,50)\",\r\n    table_border_color: \"\",\r\n    table_accent_bg: \"\",\r\n    table_striped_color: \"rgb(25,33,50)\",\r\n    table_striped_bg: \"\",\r\n    table_hover_color: \"rgb(25,33,50)\",\r\n    table_hover_bg: \"\",\r\n  };\r\n} else {\r\n  themeColors = {\r\n    page_bg: \"rgb(25,33,50)\",\r\n    search_btn_bg: \"rgb(49,62,89)\",\r\n    search_btn_bg_hover: \"rgba(49,62,89,0.8)\",\r\n    search_btn_text: \"rgb(255,255,255)\",\r\n    input_bg: \"rgb(49,62,89)\",\r\n    input_bg_hover: \"rgba(49,62,89,0.8)\",\r\n    input_text: \"rgb(255,255,255)\",\r\n    input_border: \"rgba(49,62,89,0.8)\",\r\n    table_bg: \"transparent\",\r\n    table_color: \"rgb(255,255,255)\",\r\n    table_border_color: \"\",\r\n    table_accent_bg: \"\",\r\n    table_striped_color: \"rgb(255,255,255)\",\r\n    table_striped_bg: \"\",\r\n    table_hover_color: \"rgb(255,255,255)\",\r\n    table_hover_bg: \"\",\r\n  };\r\n}\r\nconst queryHashes = [{ id: 1, hash: \"cbcc0950-c11a-46c5-9e86-72eb9cc9566f\" }];\r\n\r\nState.init({\r\n  singer: \"\",\r\n  data: null,\r\n  filteredData: [],\r\n  isLoading: false,\r\n  error: [],\r\n});\r\n\r\nconst inputHandler = ({ target }) => {\r\n  const singer = target.value.toLowerCase().trim();\r\n  State.update({ singer: singer });\r\n};\r\nconst onHandelDate = (inputDate) => {\r\n  let date = new Date(inputDate);\r\n  let monthNames = [\r\n    \"Jan\",\r\n    \"Feb\",\r\n    \"Mar\",\r\n    \"Apr\",\r\n    \"May\",\r\n    \"Jun\",\r\n    \"Jul\",\r\n    \"Aug\",\r\n    \"Sep\",\r\n    \"Oct\",\r\n    \"Nov\",\r\n    \"Dec\",\r\n  ];\r\n  let day = date.getDate();\r\n  let month = monthNames[date.getMonth()];\r\n  let year = date.getFullYear();\r\n  let createdAt;\r\n  createdAt = day + \" \" + month + \" \" + year;\r\n  return createdAt;\r\n};\r\n\r\nconst handleData = () => {\r\n  if (!state.singer.length) {\r\n    State.update({ error: [...state.error, \"please insert an address\"] });\r\n    return;\r\n  }\r\n  if (state.data === state.singer) {\r\n    State.update({ error: [...state.error, \"please insert a new address\"] });\r\n    return;\r\n  }\r\n  const result = fetchData(queryHashes[0].hash);\r\n  if (result.isLoading) {\r\n    State.update({ isLoading: true, filterData: [] });\r\n  }\r\n  if (result.error) {\r\n    const errors = state.error;\r\n    errors.push(`error message is : \"${result.error}\"`);\r\n    State.update({ error: errors, isLoading: false });\r\n  }\r\n  if (result.data) {\r\n    const filteredData = filterData(result.data);\r\n\r\n    State.update({ data: state.singer, filteredData, isLoading: false });\r\n  }\r\n};\r\n\r\nconst filterData = (data) => {\r\n  return data.filter((row) => row.SINGER === state.singer);\r\n};\r\n\r\nconst fetchData = (hash) => {\r\n  const data = fetch(\r\n    `https://api.flipsidecrypto.com/api/v2/queries/${hash}/data/latest`,\r\n    {\r\n      subscribe: true,\r\n      method: \"GET\",\r\n      headers: {\r\n        Accept: \"*/*\",\r\n      },\r\n    }\r\n  );\r\n  const result = {\r\n    data: (data && data.body) || null,\r\n    error: (data && !data.ok && (data.status || data.error)) || null,\r\n    isLoading: !data && !error,\r\n  };\r\n  return result;\r\n};\r\nif (state.isLoading) {\r\n  handleData();\r\n}\r\n\r\nif (state.error.length > 0) {\r\n  function hide() {\r\n    const errors = state.error;\r\n    errors.shift();\r\n    if (errors.length > 0) setTimeout(hide, 2500);\r\n    State.update({ error: errors });\r\n  }\r\n  setTimeout(hide, 2500);\r\n}\r\n\r\nconst Input = styled.input`\r\ncolor:${themeColors.input_text};\r\nbackground-color:${themeColors.input_bg};\r\nborder: 1px solid ${themeColors.input_border};\r\n&:focus{\r\n  background-color:${themeColors.input_bg};\r\n  color:${themeColors.input_text};\r\nborder: 1px solid ${themeColors.input_border};\r\n};\r\n&:hover{\r\n  background-color:${themeColors.input_bg_hover}\r\n};\r\n\r\n`;\r\nconst Button = styled.button`\r\n    color: ${themeColors.search_btn_text};\r\n    font-size: 16px;\r\n    padding: 0.5rem 1rem;\r\n    font-weight: 400;\r\n    background-color: ${themeColors.search_btn_bg};\r\n    &:hover {background-color: ${themeColors.search_btn_bg_hover}};\r\n    border: 1px solid ${themeColors.search_btn_bg};\r\n    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.02);\r\n    min-height: calc(1.5em + 1rem + 2px);\r\n    border-radius: 40px;\r\n    line-height: 29px;\r\n    letter-spacing: 0.01em;\r\n`;\r\nconst Table = styled.table`\r\n  --bs-table-color: ${themeColors.table_color};\r\n  --bs-table-bg: ${themeColors.table_bg};\r\n  --bs-table-border-color: '';\r\n  --bs-table-accent-bg: #ca232300;\r\n  --bs-table-striped-color: ${themeColors.table_striped_color};\r\n  --bs-table-striped-bg: rgba(0,0,0,.05);\r\n  --bs-table-active-color: \"\";\r\n  --bs-table-active-bg: rgba(0,0,0,.1);\r\n  --bs-table-hover-color: ${themeColors.table_hover_color};\r\n  --bs-table-hover-bg:\"\"\r\n`;\r\nreturn (\r\n  <div\r\n    style={{ backgroundColor: themeColors.page_bg }}\r\n    className=\"container-fluid py-2 rounded-4\"\r\n  >\r\n    <div className=\"shadow-sm  rounded-4\" style={{ background: \"#ebe7fd\" }}>\r\n      <Widget src=\"lord1.near/widget/header-dynamic\" props={generaltheme} />\r\n      <div className=\"toast-container position-fixed bottom-0 end-0 p-3\">\r\n        {state.error.length > 0 &&\r\n          state.error.map((er) => (\r\n            <div\r\n              className=\"toast show align-items-center text-bg-danger border-0\"\r\n              role=\"alert\"\r\n              aria-live=\"assertive\"\r\n              aria-atomic=\"true\"\r\n            >\r\n              <div className=\"d-flex\">\r\n                <div className=\"toast-body\">{er}</div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n      </div>\r\n    </div>\r\n\r\n    <div className=\"search py-4\">\r\n      <div className=\"row\">\r\n        <div className=\"col-8 \">\r\n          <Input\r\n            onBlur={inputHandler}\r\n            defaultValue={state.singer}\r\n            type=\"input\"\r\n            className=\"form-control form-control-lg rounded-4\"\r\n            id=\"address\"\r\n            placeholder=\"jlw.near\"\r\n          />\r\n        </div>\r\n        <div className=\"col-4 col-lg-auto\">\r\n          <Button\r\n            disabled={state.isLoading}\r\n            onClick={handleData}\r\n            className=\"btn-lg\"\r\n            type=\"button\"\r\n          >\r\n            {state.isLoading ? (\r\n              <div className=\"text-center px-4\">\r\n                <div className=\"spinner-border spinner-border-sm\" role=\"status\">\r\n                  <span className=\"visually-hidden\">Loading...</span>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              \"search\"\r\n            )}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div className={`shadow-sm rounded h-100 `}>\r\n      {!state.isLoading && state.data && (\r\n        <div\r\n          style={{ backgroundColor: themeColors.table_bg }}\r\n          className=\"table-responsive\"\r\n        >\r\n          <Table\r\n            style={{}}\r\n            className=\"table table-hover table-striped table-borderless \"\r\n          >\r\n            <thead>\r\n              <tr>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  User\r\n                </th>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  SBT\r\n                </th>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  Class\r\n                </th>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  Token Id\r\n                </th>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  Issuer\r\n                </th>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  Issue date\r\n                </th>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  Expire date\r\n                </th>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  Date to deadline\r\n                </th>\r\n                <th className=\"col-1 align-middle\" scope=\"col\">\r\n                  Tx Link\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {state.filteredData.length === 0 && (\r\n                <tr>\r\n                  <td className=\"text-center p-4\" colspan=\"10\">\r\n                    No same signer\r\n                  </td>\r\n                </tr>\r\n              )}\r\n              {state.filteredData.length >= 1 &&\r\n                state.filteredData.map((row) => {\r\n                  return (\r\n                    <tr key={row.TX_HASH}>\r\n                      <td className=\"align-middle \">\r\n                        <Link\r\n                          href={`/mob.near/widget/ProfilePage?accountId=${row.SINGER}`}\r\n                        >\r\n                          <Widget\r\n                            src=\"mob.near/widget/ProfileImage\"\r\n                            props={{ accountId: row.SINGER }}\r\n                          />\r\n                        </Link>\r\n                      </td>\r\n                      <td className=\"align-middle\" style={{ color: \"#806ce1\" }}>\r\n                        {row.SBT_CLASS}\r\n                      </td>\r\n                      <td className=\"align-middle\">{row.CLASS}</td>\r\n                      <td className=\"align-middle\" style={{ color: \"#EA1179\" }}>\r\n                        {row.TOKEN_ID}\r\n                      </td>\r\n                      <td className=\"align-middle\" style={{ color: \"#806ce1\" }}>\r\n                        {row.SIGNER_ID}\r\n                      </td>\r\n                      <td className=\"align-middle\" style={{ color: \"#806ce1\" }}>\r\n                        {onHandelDate(row.ISSUED_AT)}\r\n                      </td>\r\n                      <td\r\n                        className=\"align-middle \"\r\n                        style={{ color: \"#806ce1\" }}\r\n                      >\r\n                        {onHandelDate(row.EXPIRES_AT)}\r\n                      </td>\r\n                      <td className=\"align-middle \">\r\n                        <Widget\r\n                          src=\"lord1.near/widget/progress-bar\"\r\n                          props={{\r\n                            inside: `${row.DURATION}` - `${row.TO_DEADLINE}`,\r\n                            total: `${row.DURATION}`,\r\n                            currTheme: \"#806ce1\",\r\n                            widgetBarWidth: \"100\",\r\n                            backgroundcolor: \"#d2cafa\",\r\n                            gradiantcolorleft: \"#806ce1\",\r\n                            gradiantcolorright: \"#EA1179\",\r\n                            visibilitydivision: \"visible\",\r\n                            visibilitypercent: \"hidden\",\r\n                          }}\r\n                        />\r\n                      </td>\r\n                      <td className=\"align-middle text-center\">\r\n                        <a\r\n                          className=\"d-inline-block\"\r\n                          href={`https://nearblocks.io/txns/${row.TX_HASH}`}\r\n                          target=\"_blank\"\r\n                        >\r\n                          <svg\r\n                            width=\"20\"\r\n                            height=\"20\"\r\n                            viewBox=\"0 0 20 20\"\r\n                            fill=\"none\"\r\n                            xmlns=\"http://www.w3.org/2000/svg\"\r\n                          >\r\n                            <path\r\n                              d=\"M12.9167 5.25001L12.9167 1.75001M12.9167 1.75001H9.41674M12.9167 1.75001L7.66675 7M6.50008 1.75H5.21675C4.23666 1.75 3.74661 1.75 3.37226 1.94074C3.04298 2.10852 2.77527 2.37623 2.60749 2.70552C2.41675 3.07986 2.41675 3.56991 2.41675 4.55V9.45C2.41675 10.4301 2.41675 10.9201 2.60749 11.2945C2.77527 11.6238 3.04298 11.8915 3.37226 12.0593C3.74661 12.25 4.23666 12.25 5.21675 12.25H10.1167C11.0968 12.25 11.5869 12.25 11.9612 12.0593C12.2905 11.8915 12.5582 11.6238 12.726 11.2945C12.9167 10.9201 12.9167 10.4301 12.9167 9.45V8.16667\"\r\n                              stroke=\"#806ce1\"\r\n                              stroke-width=\"2.5\"\r\n                              stroke-linecap=\"round\"\r\n                              stroke-linejoin=\"round\"\r\n                            />\r\n                          </svg>\r\n                        </a>\r\n                      </td>\r\n                    </tr>\r\n                  );\r\n                })}\r\n            </tbody>\r\n          </Table>\r\n        </div>\r\n      )}\r\n    </div>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/lord1.near/widget/search-sbt", "fact_widget_deployments_id": "39ffef838fd91d0ce6734e5db89fd08d", "inserted_timestamp": "2023-08-24T17:23:09.845Z", "modified_timestamp": "2023-08-24T17:23:09.845Z", "__row_index": 0}
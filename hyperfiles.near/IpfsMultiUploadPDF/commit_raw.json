{"tx_hash": "92MtVjZwHgf6bWztNYhPwCsJxrdpi46uKtD6VD7DkY25", "action_id_social": "2zFiawhK4PU5JkTS2Wq6g62F6tk5avSg5oJbdr7RbrDt-0-widget", "block_id": 117327329, "block_timestamp": "2024-04-21T18:30:07.623Z", "signer_id": "hyperfiles.near", "widget_name": "IpfsMultiUploadPDF", "source_code": "const fileAccept = props.fileAccept || \"application/pdf\";\nconst fileIcon = props.fileIcon || \"bi-file-earmark-pdf\";\nconst buttonText = props.buttonText || \"Upload pdf files\";\n\n// if (!props.update) return \"Update function is required\";\n\ninitState({\n  uploading: false,\n  files: [],\n});\n\nconst ipfsUrl = (cid) => `https://ipfs.near.social/ipfs/${cid}`;\n\nconst filesOnChange = (files) => {\n  State.update({\n    uploading: true,\n    files: [],\n  });\n  if (files?.length > 0) {\n    files.map((file, index) => {\n      const body = file;\n      asyncFetch(\"https://ipfs.near.social/add\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n        },\n        body,\n      }).then((res) => {\n        const cid = res.body.cid;\n        State.update({\n          files: [...state.files, { index, name: file.name, cid }],\n        });\n      });\n    });\n    State.update({ uploading: false });\n    props.update(state.files);\n  } else {\n    State.update({\n      uploading: false,\n      files: null,\n    });\n  }\n};\n\nconst onClickDelete = (index) => {\n  const filesUpdated = state.files.filter((file) => file.index !== index);\n  State.update({ files: filesUpdated });\n};\n\nconst filesUploaded = () => {\n  if (state.files.length > 0) {\n    return state.files.map((file) => (\n      <div class=\"d-flex flex-row gap-2 align-items-center\">\n        <button\n          class=\"btn btn-danger rounded-0\"\n          type=\"button\"\n          data-toggle=\"tooltip\"\n          data-placement=\"top\"\n          title=\"Delete\"\n          onClick={() => onClickDelete(file.index)}\n        >\n          <i class=\"bi bi-trash\" />\n        </button>\n        <i class={`bi fs-3 ${fileIcon}`} />\n        <p>{file.name}</p>\n      </div>\n    ));\n  }\n  return <></>;\n};\n\nreturn (\n  <div className=\"d-inline-block\">\n    {filesUploaded()}\n    <Files\n      multiple={true}\n      accepts={[fileAccept]}\n      minFileSize={1}\n      clickable\n      className=\"btn btn-outline-primary\"\n      onChange={filesOnChange}\n    >\n      {state.uploading\n        ? \"Uploading\"\n        : state.files.length > 0\n        ? \"Replace All\"\n        : buttonText}\n    </Files>\n    <div>\n      Raw State:\n      <pre>{JSON.stringify(state)}</pre>\n    </div>\n  </div>\n);\n", "metadata": {"fork_of": "hyperfiles.near/widget/IpfsMultiUploadPDF@117212899"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/hyperfiles.near/widget/IpfsMultiUploadPDF", "fact_widget_deployments_id": "f6ca991464731d0d98f85aec1cd785c1", "inserted_timestamp": "2024-04-21T19:32:54.290Z", "modified_timestamp": "2024-04-21T20:34:42.774Z", "__row_index": 0}
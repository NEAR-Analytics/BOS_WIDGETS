{"tx_hash": "7VqhHNMQGFZcLTHuUhQT2HWNRAQY7YPmPWQS4y468JpK", "action_id_social": "2Qioj51UuvUWwXoqTcy7Uporpvq1Vexit4ph6kr1sUTi-0-widget", "block_id": 117692095, "block_timestamp": "2024-04-26T21:35:54.152Z", "signer_id": "hyperfiles.near", "widget_name": "query.search", "source_code": "const queries = props.predefinedQueries || [\n  //{ name: \"Widget Builders\", query: \"*/widget/*\" },\n  //{ name: \"Feature Builders\", query: \"*/widget/*/metadata/tags/app\" },\n  { name: \"Hyperfiles\", query: \"*/hyperfile/*\" },\n  { name: \"Attestations\", query: \"*/attestation/*\" },\n  { name: \"Schemas\", query: \"*/schema/*\" },\n  { name: \"Types\", query: \"*/type/*\" },\n  { name: \"Jobs\", query: \"*/job/*\" },\n  //{ name: \"Feature Builders\", query: \"*/widget/*/metadata/tags/app\" },\n];\n\nconst [inputPath, setInputPath] = useState(\"\");\nconst defaultPath = props.defaultPath;\nconst onUpdateSearchResult = props.onUpdateSearchResult || \"/hyperfile\";\nconst debug = props.debug || false;\nif (!onUpdateSearchResult)\n  return \"Must provide a callback function over props.onUpdateSearchResult\";\n\nState.init({\n  path: defaultPath,\n  accounts: [],\n});\n\nconst onChangePath = (path) => {\n  const value = Social.get(path, \"final\");\n  const accounts = Object.keys(value);\n  onUpdateSearchResult(accounts);\n  State.update({ path: path, accounts: accounts });\n  setInputPath(path);\n  console.log(\"Failed to fetch data:\", error);\n};\n\nconst handleSubmit = () => {\n  onPathChange(inputPath); // This callback updates the parent component's state\n};\n\n// Integrate mob.near/widget/ComponentSearch to show results for queried objects\n// Format results with starred components = mob.near/widget/Applications\n// const allComponents = [];\n\nconst allPeople = [];\n\nfor (let i = 0; i < state.accounts.length; ++i) {\n  const accountId = state.accounts[i];\n\n  allPeople.push(\n    <a\n      href={`#/mob.near/widget/ProfilePage?accountId=${accountId}`}\n      className=\"text-decoration-none\"\n      key={`people_${i}`}\n    >\n      <Widget\n        src=\"mob.near/widget/ProfileImage\"\n        props={{\n          accountId,\n          tooltip: true,\n          className: \"d-inline-block overflow-hidden\",\n        }}\n      />\n    </a>\n  );\n}\n\nreturn (\n  <div>\n    <div class=\"mb-2\">\n      <input\n        type=\"text\"\n        value={state.path}\n        onChange={(e) => onChangePath(e.target.value)}\n        placeholder={\"*/widget/*/metadata/tags/app\"}\n      />\n      <button onClick={handleSubmit}>Update Path</button>\n    </div>\n    <div class=\"d-flex flex-wrap flex-row mb-2\">\n      <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"Generated queries\">\n        {queries &&\n          queries.length &&\n          queries.map((q, i) => {\n            return (\n              <button\n                type=\"button\"\n                key={`query_${i}`}\n                class=\"btn btn-primary btn-sm mr-2\"\n                onClick={() => {\n                  onChangePath(q.query);\n                }}\n              >\n                {q.name}\n              </button>\n            );\n          })}\n      </div>\n      <div>{debug && allPeople}</div>\n    </div>\n  </div>\n);\n", "metadata": {"fork_of": "hyperfiles.near/widget/query.search@117327220"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/hyperfiles.near/widget/query.search", "fact_widget_deployments_id": "2723b3c7b45657add26ef44b605fe5be", "inserted_timestamp": "2024-04-26T23:42:43.400Z", "modified_timestamp": "2024-04-26T23:42:43.400Z", "__row_index": 0}
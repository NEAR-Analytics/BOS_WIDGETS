{"tx_hash": "4bBeTu8QskgXJVtmZPhkrrx5AvTs73roemkbAsqAN4sY", "action_id_social": "DosjGLgZdkuSzVb9ybPuU94PjQa5hDRpsyEQo5BXQWxd-0-widget", "block_id": 100681515, "block_timestamp": "2023-09-08T19:02:17.152Z", "signer_id": "harrydhillon.near", "widget_name": "Keypom.Tickets.AddTicketModal", "source_code": "State.init({ selected: 20 });\nconst Label = styled.p`\nfont-size: 16px;\n translate: 3px 8px;\nfont-style: normal;\nfont-weight: 500;\n`;\n\nconst NearAmountBackground = styled.button`\n  color:${(props) => (props.selected ? \"#00A7E4\" : \"#475569\")};\n  padding: 5px 20px;\n  margin-right:10px;\n  border-radius:10px;\n  background-color:  ${(props) => (props.selected ? \"#EFFAFD\" : \"#F8FAFC\")};\n  border:${(props) => (props.selected ? \"2px solid #00A7E4 \" : \"0px\")};\n`;\n\nconst IconButton = styled.button`\n  background-color:transparent;\n  border-width:0px;\n  position:absolute;\n  right:0px;\n`;\n\nconst nearAmount = [20, 50, 100, 200];\n\nconst nearLabel = (amount, selected) => (\n  <NearAmountBackground\n    onClick={() => {\n      State.update({ selected: amount });\n    }}\n    selected={selected}\n  >\n    {amount}\n  </NearAmountBackground>\n);\n\nconst showFormError = (key, label) =>\n  state.error[key] ? (\n    <p style={{ fontSize: 14, color: \"red\", marginTop: -3 }}>\n      {label} is required\n    </p>\n  ) : (\n    <></>\n  );\n\nconst executeValidation = () => {\n  const allErrors = {};\n  if (!state.ticketName) {\n    allErrors.ticketName = true;\n  }\n  if (!state.description) {\n    allErrors.description = true;\n  }\n  if (!state.passValid) {\n    allErrors.passValid = true;\n  }\n  if (!state.image) {\n    allErrors.image = true;\n  }\n  if (!state.from) {\n    allErrors.from = true;\n  }\n  if (!state.to) {\n    allErrors.to = true;\n  }\n  if (state.selected === \"Custom Amount\") {\n    if (!state.nearAmountForTicket) {\n      allErrors.nearAmountForTicket = true;\n    }\n  }\n  State.update({ error: allErrors });\n  return allErrors;\n};\n\nconst TopLevelContainerDiv = styled.div`\n    -ms-overflow-style: none; \n    scrollbar-width: none;\n    ::-webkit-scrollbar { \n        display: none;  /* Safari and Chrome */\n    }\n    overflow-x:hidden;\n    overflow-y:auto;\n    max-height: 80vh;\n    position: relative;\n`;\n\nconst AddTicketModal = (\n  <TopLevelContainerDiv>\n    <IconButton title=\"Cancel\" onClick={props.onClose}>\n      X\n    </IconButton>\n    <Widget\n      props={{\n        label: \"Ticket Name*\",\n        inputProps: {\n          placeholder: \"Day Pass\",\n          required: true,\n          value: state.ticketName,\n          onChange: (e) => State.update({ ticketName: e.target.value }),\n        },\n        labelProps: {\n          style: {\n            fontWeight: \"500\",\n          },\n        },\n      }}\n      src=\"harrydhillon.near/widget/Keypom.Components.Input\"\n    />\n    {showFormError(\"ticketName\", \"Ticket Name\")}\n    <p style={{ fontWeight: \"500\", marginBottom: -10 }}>Description*</p>\n    <Widget\n      props={{\n        label:\n          \"Let attendees know what this ticket has to offer, and how it differs from other tickets.\",\n        inputProps: {\n          placeholder: \"Add a description\",\n          required: true,\n          value: state.description,\n          style: {\n            minHeight: \"130px\",\n          },\n          onChange: (e) => State.update({ description: e.target.value }),\n        },\n        isTextArea: true,\n        labelProps: {\n          style: {\n            fontWeight: \"400\",\n            fontSize: 14,\n            color: \"gray\",\n          },\n        },\n      }}\n      src=\"harrydhillon.near/widget/Keypom.Components.Input\"\n    />\n    {showFormError(\"description\", \"Description\")}\n    <Label style={{ marginLeft: -5, fontWeight: \"500\" }}>\n      Ticket sales valid through*\n    </Label>\n    <div style={{ marginTop: -10 }}>\n      <Widget\n        src=\"harrydhillon.near/widget/Keypom.Components.Input\"\n        props={{\n          label: \"From\",\n          labelProps: {\n            style: {\n              fontWeight: \"500\",\n            },\n          },\n          inputProps: {\n            placeholder: \"Select a date range\",\n            value: state.from,\n            type: \"date\",\n            onChange: (e) => State.update({ from: e.target.value }),\n          },\n        }}\n      />\n      {showFormError(\"from\", \"From\")}\n    </div>\n    <Widget\n      src=\"harrydhillon.near/widget/Keypom.Components.Input\"\n      props={{\n        label: \"To\",\n        labelProps: {\n          style: {\n            fontWeight: \"500\",\n          },\n        },\n        inputProps: {\n          placeholder: \"Select a date range\",\n          value: state.to,\n          type: \"date\",\n          onChange: (e) => State.update({ to: e.target.value }),\n        },\n      }}\n    />\n    {showFormError(\"to\", \"To\")}\n    <Widget\n      src=\"harrydhillon.near/widget/Keypom.Components.Input\"\n      props={{\n        label: \"Pass valid through*\",\n        labelProps: {\n          style: {\n            fontWeight: \"500\",\n          },\n        },\n        inputProps: {\n          placeholder: \"Select a date range\",\n          value: state.passValid,\n          type: \"date\",\n          onChange: (e) => State.update({ passValid: e.target.value }),\n        },\n      }}\n    />\n    {showFormError(\"passValid\", \"Pass valid through\")}\n    <p style={{ fontWeight: \"500\", marginBottom: -10 }}>Number of Tickets*</p>\n    <Widget\n      props={{\n        label: \"If blank, party can host infinite number of guests.\",\n        inputProps: {\n          placeholder: \"Number of tickets\",\n          required: true,\n          type: \"number\",\n          value: state.numberOfTickets,\n          onChange: (e) => State.update({ numberOfTickets: e.target.value }),\n        },\n        labelProps: {\n          style: {\n            fontWeight: \"400\",\n            fontSize: 14,\n            color: \"gray\",\n          },\n        },\n      }}\n      src=\"harrydhillon.near/widget/Keypom.Components.Input\"\n    />\n    <p style={{ fontWeight: \"500\", marginBottom: 5 }}>\n      Price per ticket (NEAR)*\n    </p>\n    <div style={{ display: \"flex\", alignItems: \"center\", marginBottom: 10 }}>\n      {nearAmount.map((item) => (\n        <div>{nearLabel(item, parseInt(item) === state.selected)}</div>\n      ))}\n      {nearLabel(\"Custom Amount\", state.selected === \"Custom Amount\")}\n    </div>\n    {state.selected === \"Custom Amount\" && (\n      <>\n        <Widget\n          props={{\n            label: \"Custom Near Amount\",\n            inputProps: {\n              placeholder:\n                \"Please enter the near amount you want to sell your tickets for\",\n              required: true,\n              value: state.nearAmountForTicket,\n              type: \"number\",\n              onChange: (e) =>\n                State.update({ nearAmountForTicket: e.target.value }),\n            },\n            labelProps: {\n              style: {\n                fontWeight: \"500\",\n              },\n            },\n          }}\n          src=\"harrydhillon.near/widget/Keypom.Components.Input\"\n        />\n        {showFormError(\"nearAmountForTicket\", \"Custom Near Amount\")}\n      </>\n    )}\n    <p style={{ color: \"gray\" }}>\n      You receive{\" \"}\n      {state.selected === \"Custom Amount\"\n        ? state.nearAmountForTicket\n        : state.selected}{\" \"}\n      NEAR. Buyer pays{\" \"}\n      {state.selected === \"Custom Amount\"\n        ? state.nearAmountForTicket\n        : state.selected}\n      .187 NEAR.\n    </p>\n    <p style={{ fontWeight: \"500\", marginBottom: 0 }}>Ticket Artwork</p>\n    <Widget\n      props={{\n        setImageState: (props) => {\n          State.update({ image: props });\n        },\n        imageState: state.image,\n      }}\n      src=\"harrydhillon.near/widget/Keypom.Components.Imageupload\"\n    />\n    {showFormError(\"image\", \"Ticket artwork\")}\n    <button\n      onClick={() => {\n        const isValid = Object.keys(executeValidation()).length === 0;\n        if (isValid) {\n          props.onSave({\n            ...state,\n            ticketPricing:\n              state.selected === \"Custom Amount\"\n                ? state.nearAmountForTicket\n                : state.selected,\n          });\n        }\n      }}\n      style={{\n        width: \"100%\",\n        backgroundColor: \"black\",\n        fontSize: 14,\n        borderRadius: 10,\n        borderWidth: 0,\n        marginTop: 10,\n      }}\n    >\n      {props.editMode ? \"Update\" : \"Create\"}\n    </button>\n    <button\n      onClick={props.onClose}\n      style={{\n        width: \"100%\",\n        backgroundColor: \"white\",\n        fontSize: 14,\n        borderRadius: 10,\n        borderWidth: 1,\n        borderColor: \"lightgray\",\n        marginTop: 5,\n        color: \"black\",\n      }}\n    >\n      Cancel\n    </button>\n  </TopLevelContainerDiv>\n);\n\nif (props.editMode && props.isOpen && !state.hasBeenEditUpdated) {\n  State.update({ ...props.editVal, hasBeenEditUpdated: true });\n}\n\nreturn (\n  <Widget\n    src=\"harrydhillon.near/widget/Keypom.Components.Modal\"\n    props={{\n      children: AddTicketModal,\n      isOpen: props.isOpen,\n      contentStyles: {\n        style: {\n          width: 550,\n        },\n      },\n    }}\n  />\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/harrydhillon.near/widget/Keypom.Tickets.AddTicketModal", "fact_widget_deployments_id": "f1c736495ad1e8d8b7bee9fb828a4e53", "inserted_timestamp": "2023-09-08T20:50:31.401Z", "modified_timestamp": "2023-09-08T20:50:31.401Z", "__row_index": 3}
{"tx_hash": "5ZYUZhW6Aj1dGtSpMzzRaDAdTDzYFC7QV2dvgeQX48Xh", "action_id_social": "CVSR34dUpywV5M7m2TSAm8q3t5ZxLErX1bQK6yxkKiqB-0-widget", "block_id": 111635401, "block_timestamp": "2024-01-29T20:50:24.364Z", "signer_id": "bwe-demos.near", "widget_name": "Posts.Account", "source_code": "import { useEffect, useState } from 'react';\n\ninterface Profile {\n  description?: string;\n  name?: string;\n  image?: {\n    ipfs_cid?: string;\n    url?: string;\n  };\n  tags?: string[];\n}\n\nexport function BWEComponent(props: { account: string }) {\n  const defaults = {\n    name: props.account,\n    image: {\n      ipfs_cid: 'bafkreibiyqabm3kl24gcb2oegb7pmwdi6wwrpui62iwb44l7uomnn3lhbi',\n    },\n  };\n\n  const [profile, setProfile] = useState<Profile>();\n\n  const fetchProfile = async () => {\n    try {\n      const response = await fetch('https://api.near.social/get', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          keys: [`${props.account}/profile/**`],\n        }),\n      });\n      if (!response.ok) throw new Error('profile fetch error');\n\n      let p: Profile = (await response.json())?.[props.account]?.profile;\n      // if (!p && response.ok) {\n      //   // defaults\n      //   p = {\n      //     name: props.account,\n      //     image: defaultImage,\n      //   };\n      // }\n      // debugger;\n\n      p = { ...defaults, ...p };\n      console.log(p);\n      setProfile(p);\n    } catch (err) {\n      console.log('profile fetch error', err);\n    }\n  };\n\n  useEffect(() => {\n    fetchProfile();\n  }, []);\n\n  return profile ? (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        columnGap: '0.5rem',\n        alignItems: 'center',\n      }}\n    >\n      <div\n        style={{\n          width: '40px',\n          height: '40px',\n          flexShrink: 0,\n          border: '1px solid #eceef0',\n          overflow: 'hidden',\n          borderRadius: '40px',\n          transition: 'border-color 200ms',\n        }}\n      >\n        <img\n          src={\n            profile.image?.url ||\n            `https://ipfs.near.social/ipfs/${profile.image?.ipfs_cid}`\n          }\n          style={{\n            objectFit: 'cover',\n            width: '100%',\n            height: '100%',\n            margin: '0 !important',\n          }}\n        />\n      </div>\n      <div>{profile.name}</div>\n    </div>\n  ) : (\n    <>...</>\n  );\n}\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bwe-demos.near/widget/Posts.Account", "fact_widget_deployments_id": "c54d78d705648f664a01b106362aa751", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
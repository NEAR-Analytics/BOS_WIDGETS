{"tx_hash": "2kvUQ5JUWVcfx7bgpugmvrGZrdhhppgEGQxZvBYBPmiT", "action_id_social": "75mXjbMWYEWZnnt1EUqYEMCNeRPeFep2hSxgCRq8LZdM-0-widget", "block_id": 105315744, "block_timestamp": "2023-11-09T19:24:48.804Z", "signer_id": "bwe-demos.near", "widget_name": "Posts.Account", "source_code": "interface Profile {\n  description?: string;\n  name?: string;\n  image?: {\n    ipfs_cid?: string;\n    url?: string;\n  };\n  tags?: string[];\n}\n\nconst defaults = {\n  name: props.account,\n  image: {\n    ipfs_cid: \"bafkreibiyqabm3kl24gcb2oegb7pmwdi6wwrpui62iwb44l7uomnn3lhbi\",\n  },\n};\n\nconst [profile, setProfile] = useState<Profile>();\n\nconst fetchProfile = async () => {\n  try {\n    const response = await fetch(\"https://api.near.social/get\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        keys: [`${props.account}/profile/**`],\n      }),\n    });\n    if (!response.ok) throw new Error(\"profile fetch error\");\n\n    let p: Profile = (await response.json())?.[props.account]?.profile;\n    // if (!p && response.ok) {\n    //   // defaults\n    //   p = {\n    //     name: props.account,\n    //     image: defaultImage,\n    //   };\n    // }\n    // debugger;\n\n    p = { ...defaults, ...p };\n    console.log(p);\n    setProfile(p);\n  } catch (err) {\n    console.log(\"profile fetch error\", err);\n  }\n};\n\nuseEffect(() => {\n  fetchProfile();\n}, []);\n\n// @ts-expect-error\nreturn profile ? (\n  <div\n    style={{\n      display: \"flex\",\n      flexDirection: \"row\",\n      columnGap: \"0.5rem\",\n      alignItems: \"center\",\n    }}\n  >\n    <div\n      style={{\n        width: \"40px\",\n        height: \"40px\",\n        flexShrink: 0,\n        border: \"1px solid #eceef0\",\n        overflow: \"hidden\",\n        borderRadius: \"40px\",\n        transition: \"border-color 200ms\",\n      }}\n    >\n      <img\n        src={\n          profile.image?.url ||\n          `https://ipfs.near.social/ipfs/${profile.image?.ipfs_cid}`\n        }\n        style={{\n          objectFit: \"cover\",\n          width: \"100%\",\n          height: \"100%\",\n          margin: \"0 !important\",\n        }}\n      />\n    </div>\n    <div>{profile.name}</div>\n  </div>\n) : (\n  <>...</>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bwe-demos.near/widget/Posts.Account", "fact_widget_deployments_id": "fb9b39801a59aaddfc257018ffd16bf5", "inserted_timestamp": "2023-11-09T21:27:01.952Z", "modified_timestamp": "2023-11-09T21:27:01.952Z", "__row_index": 0}
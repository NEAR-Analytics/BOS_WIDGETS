{"tx_hash": "CC9GcHy83rphSqwYdFGRGRyFvEi4uTU9wceCkLZk2NT3", "action_id_social": "4DSN3SK9hpm79UiPYgKx3J9sAV4XbSPNkc15u1u7PCXy-0-widget", "block_id": 120166680, "block_timestamp": "2024-05-31T23:45:45.327Z", "signer_id": "hyperbuild.near", "widget_name": "explore.thing", "source_code": "if (typeof props.path !== \"string\") return \"send {path} as string in props\";\nState.init({\n  selectedTab: \"explore\",\n  selectedBlockHeight: \"final\",\n});\nconst historyBlocksRequest = Social.keys(`${props.path}`, \"final\", {\n  return_type: \"History\",\n});\nif (historyBlocksRequest === null) return \"loading...\";\nconst [widgetAccountId, _, widgetName] = props.path.split(\"/\");\nlet blocksChanges =\n  historyBlocksRequest[widgetAccountId]?.[\"widget\"]?.[widgetName];\nif (props.count) props.count(blocksChanges.length);\nif (blocksChanges) blocksChanges = blocksChanges?.sort((a, b) => b - a);\nif (!state.selectedBlockHeight) state.selectedBlockHeight = blocksChanges[0];\nfunction getDatastringFromBlockHeight(blockHeight) {\n  const block = Near.block(blockHeight);\n  const date = new Date(block.header.timestamp_nanosec / 1e6);\n  return date.toDateString() + \" \" + date.toLocaleTimeString();\n}\nconst renderBlockChangesLink = (blockHeight) => {\n  return (\n    <div>\n      <button\n        className={`list-group-item list-group-item-action ${\n          state.selectedBlockHeight != blockHeight ? \"\" : \"list-group-item-info\"\n        }`}\n        onClick={() => {\n          State.update({ selectedBlockHeight: blockHeight });\n        }}\n      >\n        #{blockHeight} * {getDatastringFromBlockHeight(blockHeight)}\n      </button>\n    </div>\n  );\n};\nfunction blockHeightToWidgetCode(blockHeight) {\n  const index = blocksChanges.findIndex((el) => el == blockHeight);\n  return (\n    <div class=\"mb-3\">\n      <Widget\n        key={blockHeight}\n        src={`bozon.near/widget/WidgetHistory.CodeHistoryCard`}\n        props={{\n          pathToWidget: props.path,\n          currentBlockHeight: blockHeight,\n          prevBlockHeight: blocksChanges[index + 1],\n        }}\n      />\n    </div>\n  );\n}\nfunction blockHeightToWidgetRender(blockHeight) {\n  const index = blocksChanges.findIndex((el) => el == blockHeight);\n  return (\n    <Widget\n      style={{ minHeight: \"200px\" }}\n      key={blockHeight}\n      src={`bozon.near/widget/WidgetHistory.RenderCode`}\n      props={{\n        pathToWidget: props.path,\n        currentBlockHeight: blockHeight,\n        prevBlockHeight: blocksChanges[index + 1],\n      }}\n    />\n  );\n}\nconst Tabs = styled.div`\n  display: flex;\n  padding: 0 12px;\n  height: 48px;\n  border-bottom: 1px solid #eceef0;\n`;\nconst TabsButton = styled.button`\n  font-weight: 400;\n  font-size: 14px;\n  line-height: 17px;\n  padding: 0 12px;\n  position: relative;\n  color: ${(p) => (p.selected ? \"#11181C\" : \"#687076\")};\n  background: none;\n  border: none;\n  outline: none;\n  &:hover {\n    color: #11181c;\n  }\n  &::after {\n    content: \"\";\n    display: ${(p) => (p.selected ? \"block\" : \"none\")};\n    position: absolute;\n    bottom: 0;\n    left: 12px;\n    right: 12px;\n    height: 3px;\n    background: #0091ff;\n  }\n`;\nreturn (\n  <div>\n    {!blocksChanges ? (\n      <div>invalid path</div>\n    ) : (\n      <div>\n        <Tabs>\n          <TabsButton\n            type=\"button\"\n            onClick={() =>\n              State.update({\n                selectedTab: \"connect\",\n              })\n            }\n            selected={state.selectedTab == \"connect\"}\n          >\n            Connect\n          </TabsButton>\n          <TabsButton\n            type=\"button\"\n            onClick={() =>\n              State.update({\n                selectedTab: \"explore\",\n              })\n            }\n            selected={state.selectedTab == \"explore\"}\n          >\n            Explore\n          </TabsButton>\n        </Tabs>\n        {!state.selectedTab && (\n          <div className=\"m-2\">\n            <p>Hello</p>\n          </div>\n        )}\n        {state.selectedTab == \"connect\" && (\n          <div className=\"m-2\">\n            <Widget src=\"hack.near/widget/explore.connect\" />\n          </div>\n        )}\n        {state.selectedTab == \"explore\" && (\n          <div>{blockHeightToWidgetRender(state.selectedBlockHeight)}</div>\n        )}\n      </div>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hyperbuild.near/widget/explore.thing", "fact_widget_deployments_id": "ef1f42413381d60134edc9adc72a2cdb", "inserted_timestamp": "2024-06-01T02:00:15.259Z", "modified_timestamp": "2024-06-01T02:00:15.259Z", "__row_index": 3}
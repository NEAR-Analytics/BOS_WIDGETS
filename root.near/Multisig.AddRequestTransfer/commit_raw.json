{"tx_hash": "BmsB5P4iRt7V2SVy1wNr5rUSjRs1inRaARZiihz6wrXt", "action_id_social": "GardP1kkn9xPuc3SiwFzzzUfoa8Ag4bbk2PJTWEVoLK3-0-widget", "block_id": 111032069, "block_timestamp": "2024-01-22T11:09:05.350Z", "signer_id": "root.near", "widget_name": "Multisig.AddRequestTransfer", "source_code": "const contract_id = props.contract_id;\nconst receiver_id = props.receiver_id ?? \"\";\nconst token_id = props.token_id ?? \"\";\nconst amount = props.amount ?? \"\";\n\nfunction onTransfer() {\n  const defaultGas = 300 * 1000000000000;\n  const functionCallGas = 200 * 1000000000000;\n  if (state.token_id == \"near\") {\n    const amount = new Big(state.amount).mul(new Big(10).pow(24)).toFixed();\n    Near.call(\n      contract_id,\n      \"add_proposal\",\n      {\n        request: {\n          receiver_id: state.token_id,\n          actions: [\n            {\n              type: \"Transfer\",\n              amount,\n            },\n          ],\n        },\n      },\n      defaultGas,\n      1\n    );\n    return;\n  }\n\n  const metadata = Near.view(state.token_id, \"ft_metadata\", {});\n  const decimals = metadata.decimals;\n  const amount = new Big(state.amount).mul(new Big(10).pow(decimals)).toFixed();\n  console.log({\n    decimals,\n    receiver_id: state.receiver_id,\n    token_id: state.token_id,\n    amount,\n  });\n  const args = { amount, receiver_id: state.receiver_id };\n  Near.call(\n    contract_id,\n    \"add_proposal\",\n    {\n      request: {\n        receiver_id: state.token_id,\n        actions: [\n          {\n            type: \"FunctionCall\",\n            method_name: \"ft_transfer\",\n            args: btoa(JSON.stringify(args)),\n            deposit: \"1\",\n            gas: functionCallGas,\n          },\n        ],\n      },\n    },\n    defaultGas,\n    1\n  );\n}\n\nState.init({\n  receiver_id,\n  token_id,\n  amount,\n});\n\nconst debounce = (func, wait) => {\n  const pause = wait || 350;\n  let timeout;\n\n  return (args) => {\n    const later = () => {\n      clearTimeout(timeout);\n      func(args);\n    };\n\n    clearTimeout(timeout);\n    timeout = setTimeout(later, pause);\n  };\n};\n\nconst onReceiverChange = debounce((e) => {\n  State.update({\n    receiver_id: e.target.value,\n  });\n});\n\nconst onTokenChange = debounce((e) => {\n  State.update({\n    token_id: e.target.value,\n  });\n});\n\nconst onAmountChange = debounce((e) => {\n  State.update({\n    amount: e.target.value,\n  });\n});\n\nreturn (\n  <div>\n    <div class=\"row mb-4\">\n      <div class=\"col d-flex w-100\">\n        <div class=\"form-outline mb-4 w-100\">\n          <input\n            class=\"form-control\"\n            type=\"text\"\n            id=\"transfer-receiver\"\n            placeholder=\"Receiver\"\n            onChange={onReceiverChange}\n            defaultValue={state.receiver_id}\n          />\n          <label class=\"form-label\" for=\"transfer-receiver\">\n            Enter receiver\n          </label>\n        </div>\n      </div>\n      <div class=\"col d-flex w-100\">\n        <div class=\"form-outline mb-4 w-100\">\n          <input\n            class=\"form-control\"\n            type=\"text\"\n            id=\"transfer-token\"\n            placeholder=\"Token\"\n            onChange={onTokenChange}\n            defaultValue={state.token_id}\n          />\n          <label class=\"form-label\" for=\"transfer-token\">\n            Enter token\n          </label>\n        </div>\n      </div>\n      <div class=\"col d-flex w-100\">\n        <div class=\"form-outline mb-4 w-100\">\n          <input\n            class=\"form-control\"\n            type=\"text\"\n            id=\"transfer-amount\"\n            placeholder=\"Amount\"\n            onChange={onAmountChange}\n            defaultValue={state.amount}\n          />\n          <label class=\"form-label\" for=\"transfer-amount\">\n            Amount\n          </label>\n        </div>\n      </div>\n      <div class=\"col-12 col-lg-6 text-left justify-content-left\">\n        <button type=\"button\" onClick={onTransfer}>\n          Transfer\n        </button>\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/root.near/widget/Multisig.AddRequestTransfer", "fact_widget_deployments_id": "b74a89e932a7eba5b5723acf291ab793", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 6}
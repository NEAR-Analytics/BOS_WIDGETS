{"tx_hash": "9Kze2AVg7a9cCrTfMtGvzVVosyDEN3F5Jk8D8CsA873N", "action_id_social": "E6JU5EgF2yJyf2TES1JDb843CBNRX4QSBDddYUs6rHm3-0-widget", "block_id": 111565867, "block_timestamp": "2024-01-29T00:37:23.806Z", "signer_id": "meerkatamaran.near", "widget_name": "nft-selector", "source_code": "const [selectedNFT, setSelectedNFT] = useState(null);\nconst [allNFTs, setAllNFTs] = useState([]);\nconst [filteredNFTs, setFilteredNFTs] = useState([]);\nconst [contractFilter, setContractFilter] = useState(\"\");\nconst accountId = props.accountId || context.accountId;\n\nconst onChange = props.onChange;\n\nif (!accountId) {\n  return <></>;\n}\n\nconst size = \"100%\";\n\nconst data = fetch(\"https://graph.mintbase.xyz\", {\n  method: \"POST\",\n  headers: {\n    \"mb-api-key\": \"omni-site\",\n    \"Content-Type\": \"application/json\",\n    \"x-hasura-role\": \"anonymous\",\n  },\n  body: JSON.stringify({\n    query: `\n  query v2_omnisite_GetOwnedTokens{\n    tokens: mb_views_nft_owned_tokens(\n      where: {\n        owner: { _eq: \"${accountId}\" }\n        minted_timestamp: {_lt: \"01/01/2024\"},\n      }\n    ) {\n      tokenId: token_id\n      contractId: nft_contract_id\n      media\n    }}\n`,\n  }),\n});\n\nconst finalData = data?.body?.data;\nsetAllNFTs(data.data.tokens);\nsetFilteredNFTs(data.data.tokens);\nconst handleSelectNFT = (nft) => {\n  setSelectedNFT(nft);\n  onChange(nft);\n};\n\nconst isSelected = (nft) => {\n  return (\n    selectedNFT &&\n    nft.tokenId === selectedNFT.tokenId &&\n    nft.contractId === selectedNFT.contractId\n  );\n};\n\nif (!finalData) {\n  return (\n    <>\n      <Image src=\"https://cloudflare-ipfs.com/ipfs/bafybeihrehidexjc54qj2t7lvo54wpkwuabm2uikwkf3ld36rbj25a3s2i\"></Image>\n    </>\n  );\n}\n\nreturn (\n  <>\n    <div\n      className=\"d-flex flex-wrap gap-2 justify-content-center\"\n      style={{\n        height: \"334px\",\n        overflow: \"auto\",\n      }}\n    >\n      {finalData.tokens.map((nft, index) => (\n        <div\n          key={`${nft.contractId}-${nft.tokenId}-${index}`}\n          role=\"button\"\n          style={{\n            width: \"15%\",\n            aspectRatio: \"1/1\",\n            border: isSelected(nft) ? \"4px solid blue\" : \"none\", // Apply border if selected\n          }}\n          onClick={() => handleSelectNFT(nft)}\n        >\n          <Widget\n            src=\"sharddog.near/widget/Image.Minted\"\n            props={{\n              nft: { tokenId: nft.tokenId, contractId: nft.contractId },\n              title: nft.owner_id,\n              timestamp: nft.minted_timestamp,\n              image: {\n                url: nft.media,\n              },\n              style: {\n                width: size,\n                height: size,\n                objectFit: \"cover\",\n                minWidth: size,\n                minHeight: size,\n                maxWidth: size,\n                maxHeight: size,\n                overflowWrap: \"break-word\",\n              },\n              className: \"\",\n              fallbackUrl:\n                \"https://ipfs.near.social/ipfs/bafkreihdiy3ec4epkkx7wc4wevssruen6b7f3oep5ylicnpnyyqzayvcry\",\n              alt: `NFT ${nft.contractId} ${nft.tokenId}`,\n            }}\n          />\n        </div>\n      ))}\n    </div>\n  </>\n);\n", "metadata": {"image": {}}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/meerkatamaran.near/widget/nft-selector", "fact_widget_deployments_id": "0f83e1f85341c1b50e9d842c10d45df0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 18}
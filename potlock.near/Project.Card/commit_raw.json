{"tx_hash": "FnE2QAbQeorvEwtmwnBrzkydkYuNU59hiaGfN3A2yBm2", "action_id_social": "3Www55Q3fZst26Enzy5bssQWvDCsrRXN48RVZwu7yDMk-0-widget", "block_id": 112395906, "block_timestamp": "2024-02-08T16:07:00.886Z", "signer_id": "potlock.near", "widget_name": "Project.Card", "source_code": "const { ownerId } = props;\nconst donationContractId = \"donate.potlock.near\";\n\nconst Card = styled.a`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  border-radius: 12px;\n  background: white;\n  box-shadow: 0px -2px 0px #dbdbdb inset;\n  border: 1px solid #dbdbdb;\n  &:hover {\n    text-decoration: none;\n    cursor: pointer;\n  }\n  margin-left: auto;\n  margin-right: auto;\n  height: 500px;\n`;\n\nconst Info = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-top: 145px;\n  padding: 16px 24px;\n  gap: 16px;\n  flex: 1;\n\n  @media screen and (max-width: 768px) {\n    margin-top: 122px;\n  }\n`;\n\nconst Title = styled.div`\n  font-size: 16px;\n  font-weight: 600;\n  color: #2e2e2e;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  width: 100%;\n`;\n\nconst SubTitle = styled.div`\n  font-size: 16px;\n  font-weight: 400;\n  color: #2e2e2e;\n  word-wrap: break-word;\n`;\n\nconst Tags = styled.div`\n  display: flex;\n  gap: 8px;\n`;\n\nconst Tag = styled.span`\n  box-shadow: 0px -0.699999988079071px 0px rgba(123, 123, 123, 0.36) inset;\n  padding: 4px 8px;\n  border-radius: 4px;\n  border: 1px solid rgba(123, 123, 123, 0.36);\n  color: #2e2e2e;\n`;\n\nconst DonationsInfoContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 24px;\n  width: 100%;\n  border-top: 1px #f0f0f0 solid;\n`;\n\nconst DonationsInfoItem = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  align-items: center;\n`;\n\nconst projectId = props.project.id || props.projectId || context.accountId;\nconst projectProfile = Social.getr(`${projectId}/profile`);\n\nif (!projectProfile) return \"\";\n\nconst MAX_DESCRIPTION_LENGTH = 80;\n\nconst { name, description, category } = projectProfile;\n// const name = projectProfile?.name || \"No name\";\n// const description = projectProfile?.description || \"No description\";\n// const category = projectProfile?.category || \"No category\";\n\nconst tags = [category.text ?? props.CATEGORY_MAPPINGS[category] ?? \"\"];\n\nconst donationsForProject = Near.view(donationContractId, \"get_donations_for_recipient\", {\n  recipient_id: projectId,\n});\n\n// console.log(donationsForProject);\n\nconst [totalAmount, totalDonors] = useMemo(() => {\n  if (!donationsForProject) return [null, null];\n  const donors = [];\n  let totalDonationAmount = new Big(0);\n  for (const donation of donationsForProject) {\n    if (!donors.includes(donation.donor_id)) {\n      donors.push(donation.donor_id);\n    }\n    totalDonationAmount = totalDonationAmount.plus(new Big(donation.total_amount));\n  }\n  return [\n    props.nearToUsd\n      ? (props.nearToUsd * totalDonationAmount.div(1e24).toNumber()).toFixed(2)\n      : totalDonationAmount.div(1e24).toNumber().toFixed(2),\n    donors.length,\n  ];\n}, [donationsForProject]);\n\nconst projectUrl = props.hrefWithEnv(`?tab=project&projectId=${projectId}`);\n\nreturn (\n  <Card href={projectUrl} key={projectId}>\n    <Widget\n      src={`${ownerId}/widget/Project.BannerHeader`}\n      props={{\n        ...props,\n        projectId,\n        profile,\n        profileImageTranslateYPx: 145,\n        profileImageTranslateYPxMobile: 122,\n        containerStyle: {\n          paddingLeft: \"16px\",\n        },\n        backgroundStyle: {\n          objectFit: \"cover\",\n          left: 0,\n          top: 0,\n          height: \"168px\",\n          borderRadius: \"6px 6px 0px 0px\",\n        },\n        imageStyle: {\n          width: \"40px\",\n          height: \"40px\",\n          position: \"absolute\",\n          bottom: \"-10px\",\n          left: \"14px\",\n        },\n      }}\n    />\n    <Info>\n      <Title>{name}</Title>\n      <SubTitle>\n        {description.length > MAX_DESCRIPTION_LENGTH\n          ? description.slice(0, MAX_DESCRIPTION_LENGTH) + \"...\"\n          : description}\n      </SubTitle>\n      <Widget\n        src={`${ownerId}/widget/Project.Tags`}\n        props={{\n          ...props,\n          tags,\n        }}\n      />\n    </Info>\n    <DonationsInfoContainer>\n      <DonationsInfoItem>\n        <Title>{totalDonors || totalDonors === 0 ? totalDonors : \"-\"}</Title>\n        <SubTitle>{totalDonors === 1 ? \"Donor\" : \"Donors\"}</SubTitle>\n      </DonationsInfoItem>\n      <DonationsInfoItem>\n        <Title>{props.nearToUsd ? `$${totalAmount}` : `${totalAmount} N`}</Title>\n        <SubTitle>Raised</SubTitle>\n      </DonationsInfoItem>\n    </DonationsInfoContainer>\n    {props.allowDonate && (\n      <Widget\n        src={`${ownerId}/widget/Cart.AddToCart`}\n        props={{\n          ...props,\n          projectId,\n          style: {\n            borderRadius: \"0px 0px 6px 6px\",\n            boxShadow: \"0px\",\n            border: \"0px\",\n          },\n          stopPropagation: true,\n          showModal: false,\n        }}\n      />\n    )}\n  </Card>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/potlock.near/widget/Project.Card", "fact_widget_deployments_id": "2a4734cbdbb94ebd1af938b7c8321a84", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 15}
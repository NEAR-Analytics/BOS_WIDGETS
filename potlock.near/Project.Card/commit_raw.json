{"tx_hash": "5TVv1Ff2mVHr1JRoyLstKvx3CXs243LLCpvLFvYvxkT6", "action_id_social": "7kkQ6yzPrrY7pm6x4S5He5QFeYwHUPZqrpKbqyfkbz1C-0-widget", "block_id": 104858538, "block_timestamp": "2023-11-03T18:26:41.477Z", "signer_id": "potlock.near", "widget_name": "Project.Card", "source_code": "const ownerId = \"potlock.near\";\nconst donationContractId = \"donate.potlock.near\";\nconst registryContractId = \"registry.potlock.near\";\n\nconst Card = styled.a`\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  max-width: 30%;\n  min-width: 320px;\n  border-radius: 7px;\n  background: white;\n  box-shadow: 0px -2px 0px #dbdbdb inset;\n  border: 1px solid #dbdbdb;\n  &:hover {\n    text-decoration: none;\n    cursor: pointer;\n  }\n`;\n\nconst Info = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-top: 160px;\n  padding: 16px 24px;\n  gap: 16px;\n  flex: 1;\n`;\n\nconst Title = styled.div`\n  font-size: 16px;\n  font-weight: 600;\n  color: #2e2e2e;\n`;\n\nconst SubTitle = styled.div`\n  font-size: 16px;\n  font-weight: 400;\n  color: #2e2e2e;\n  word-wrap: break-word;\n`;\n\nconst Tags = styled.div`\n  display: flex;\n  gap: 8px;\n`;\n\nconst Tag = styled.span`\n  box-shadow: 0px -0.699999988079071px 0px rgba(123, 123, 123, 0.36) inset;\n  padding: 4px 8px;\n  border-radius: 4px;\n  border: 1px solid rgba(123, 123, 123, 0.36);\n  color: #2e2e2e;\n`;\n\nconst DonationsInfoContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 24px;\n  width: 100%;\n  border-top: 1px #f0f0f0 solid;\n`;\n\nconst DonationsInfoItem = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  align-items: center;\n`;\n\nconst MAX_DESCRIPTION_LENGTH = 120;\n\nconst { id, bannerImageUrl, profileImageUrl, name, description, tags } = props.project;\n\nconst donationsForProject = Near.view(donationContractId, \"get_donations_for_recipient\", {\n  recipient_id: id,\n});\n\nconst [totalAmount, totalDonors] = useMemo(() => {\n  if (!donationsForProject) return [null, null];\n  const donors = [];\n  let totalDonationAmount = new Big(0);\n  for (const donation of donationsForProject) {\n    if (!donors.includes(donation.donor_id)) {\n      donors.push(donation.donor_id);\n    }\n    totalDonationAmount = totalDonationAmount.plus(new Big(donation.total_amount));\n  }\n  return [\n    props.nearToUsd ? (props.nearToUsd * totalDonationAmount.div(1e24).toNumber()).toFixed(2) : \"-\",\n    donors.length,\n  ];\n}, [donationsForProject]);\n\nconst PROJECT_STATUSES = [\n  \"Submitted\",\n  \"InReview\",\n  \"Approved\",\n  \"Rejected\",\n  \"Graylisted\",\n  \"Blacklisted\",\n];\n\nreturn (\n  <>\n    <Card href={`?tab=project&projectId=${id}`} key={id}>\n      <Widget\n        src={`${ownerId}/widget/Project.BannerHeader`}\n        props={{\n          ...props,\n          projectId: id,\n          profile,\n          profileImageTranslateYPx: 168,\n          containerStyle: {\n            paddingLeft: \"16px\",\n          },\n          backgroundStyle: {\n            objectFit: \"cover\",\n            left: 0,\n            top: 0,\n            height: \"168px\",\n            borderRadius: \"6px 6px 0px 0px\",\n          },\n          imageStyle: {\n            width: \"40px\",\n            height: \"40px\",\n            position: \"absolute\",\n            bottom: \"-10px\",\n            left: \"14px\",\n          },\n        }}\n      />\n      <Info>\n        <Title>{name}</Title>\n        <SubTitle>\n          {description.length > MAX_DESCRIPTION_LENGTH\n            ? description.slice(0, MAX_DESCRIPTION_LENGTH) + \"...\"\n            : description}\n        </SubTitle>\n        <Widget\n          src={`${ownerId}/widget/Project.Tags`}\n          props={{\n            ...props,\n            tags,\n          }}\n        />\n      </Info>\n      <DonationsInfoContainer>\n        <DonationsInfoItem>\n          <Title>{totalDonors || totalDonors === 0 ? totalDonors : \"-\"}</Title>\n          <SubTitle>{totalDonors === 1 ? \"Donor\" : \"Donors\"}</SubTitle>\n        </DonationsInfoItem>\n        <DonationsInfoItem>\n          <Title>${totalAmount || \"-\"}</Title>\n          <SubTitle>Raised</SubTitle>\n        </DonationsInfoItem>\n      </DonationsInfoContainer>\n    </Card>\n    {props.registryAdmins && props.registryAdmins.includes(context.accountId) && (\n      <Widget\n        src={`${ownerId}/widget/Inputs.Select`}\n        props={{\n          noLabel: true,\n          options: PROJECT_STATUSES.map((status) => ({\n            value: status,\n            text: status,\n          })),\n          value: { text: props.project.status, value: props.project.status },\n          onChange: (status) => {\n            if (status.value != project.status) {\n              Near.call([\n                {\n                  contractName: registryContractId,\n                  methodName: \"admin_set_project_status\",\n                  args: { project_id: id, status: status.value },\n                },\n              ]);\n            }\n          },\n          containerStyles: {\n            padding: \"16px 24px\",\n          },\n        }}\n      />\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/potlock.near/widget/Project.Card", "fact_widget_deployments_id": "388fdc86029cdf7e89f229d182e4e7b9", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
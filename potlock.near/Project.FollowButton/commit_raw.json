{"tx_hash": "3AfpEHEBRbD1Y1rKnkHhVUazzE8GwpYopi4LPKvRBcpx", "action_id_social": "5XuikHovnsxXB5hThkTN7D7f1c5SeRpA9BL6XEAi9b6Y-0-widget", "block_id": 105152288, "block_timestamp": "2023-11-07T14:19:58.518Z", "signer_id": "potlock.near", "widget_name": "Project.FollowButton", "source_code": "const ownerId = \"potlock.near\";\n\nif (!props.accountId || !context.accountId || context.accountId === props.accountId) {\n  return \"\";\n}\n\nconst followEdge = Social.keys(`${context.accountId}/graph/follow/${props.accountId}`, undefined, {\n  values_only: true,\n});\n\nconst inverseEdge = Social.keys(`${props.accountId}/graph/follow/${context.accountId}`, undefined, {\n  values_only: true,\n});\n\nconst loading = followEdge === null || inverseEdge === null;\nconst follow = followEdge && Object.keys(followEdge).length;\nconst inverse = inverseEdge && Object.keys(inverseEdge).length;\n\nconst type = follow ? \"unfollow\" : \"follow\";\n\nconst socialArgs = {\n  data: {\n    [context.accountId]: {\n      graph: { follow: { [props.accountId]: follow ? null : \"\" } },\n      index: {\n        graph: JSON.stringify({\n          key: \"follow\",\n          value: {\n            type,\n            accountId: props.accountId,\n          },\n        }),\n        notify: JSON.stringify({\n          key: props.accountId,\n          value: {\n            type,\n          },\n        }),\n      },\n    },\n  },\n};\n\nconst buttonText = loading ? \"Loading\" : follow ? \"Following\" : inverse ? \"Follow back\" : \"Follow\";\n\nconst FollowContainer = styled.div`\n  padding: 10px 16px;\n  cursor: pointer;\n`;\n\nconst FollowText = styled.div`\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 20px;\n  color: #dd3345;\n  word-wrap: break-word;\n`;\n\nreturn (\n  <FollowContainer\n    onClick={() => {\n      const transactions = [\n        {\n          contractName: \"social.near\",\n          methodName: \"set\",\n          deposit: Big(JSON.stringify(socialArgs).length * 0.00003).mul(Big(10).pow(24)),\n          args: socialArgs,\n        },\n      ];\n      Near.call(transactions);\n    }}\n  >\n    <FollowText>\n      {loading ? \"Loading\" : follow ? \"Following\" : inverse ? \"Follow back\" : \"Follow\"}\n    </FollowText>\n  </FollowContainer>\n  // <Widget\n  //   src={`${ownerId}/widget/Buttons.ActionButton`}\n  //   props={{\n  //     type: \"tertiary\",\n  //     text: buttonText,\n  //     disabled: loading,\n  //     style: {\n  //       border: \"1px solid rgba(123, 123, 123, 0.36)\",\n  //       boxShadow: \"0px -2.700000047683716px 0px rgba(123, 123, 123, 0.36) inset\",\n  //     },\n  //     onClick: () => {\n  //       const transactions = [\n  //         {\n  //           contractName: \"social.near\",\n  //           methodName: \"set\",\n  //           deposit: Big(JSON.stringify(socialArgs).length * 0.00003).mul(Big(10).pow(24)),\n  //           args: socialArgs,\n  //         },\n  //       ];\n  //       Near.call(transactions);\n  //     },\n  //   }}\n  // />\n  //   <CommitButton\n  //     disabled={loading}\n  //     className={`btn ${loading || follow ? \"btn-outline-dark\" : \"btn-primary\"} rounded-5`}\n  //     data={data}\n  //   >\n  //     {loading ? \"Loading\" : follow ? \"Following\" : inverse ? \"Follow back\" : \"Follow\"}\n  //   </CommitButton>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/potlock.near/widget/Project.FollowButton", "fact_widget_deployments_id": "0c110f00f414966ebef7b94c6c948171", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 8}
{"tx_hash": "9hV3dw7UWWywc9sYn1qWMJmoSaEEVm8W8Q7cSM5hjibS", "action_id_social": "ERZDEAuoseX7gYaDbUtf4cLhdd9ztMCeVZ5iMNDz4L7r-0-widget", "block_id": 115053974, "block_timestamp": "2024-03-19T23:51:49.441Z", "signer_id": "potlock.near", "widget_name": "Pots.Sponsors", "source_code": "// get donations\nconst { potId, potDetail } = props;\n\nconst { ownerId, SUPPORTED_FTS } = VM.require(\"potlock.near/widget/constants\") || {\n  ownerId: \"\",\n  SUPPORTED_FTS: {},\n};\n\nconst PotSDK = VM.require(\"potlock.near/widget/SDK.pot\") || {\n  getMatchingPoolDonations: () => {},\n};\n\nlet sponsorshipDonations = PotSDK.getMatchingPoolDonations(potId);\n\nconst { NEAR } = SUPPORTED_FTS;\n\nState.init({\n  sponsorshipDonations: null,\n});\n\nif (sponsorshipDonations && !state.sponsorshipDonations) {\n  // accumulate donations for each address\n  sponsorshipDonations = sponsorshipDonations.reduce((accumulator, currentDonation) => {\n    accumulator[currentDonation.donor_id] = {\n      amount:\n        parseFloat(accumulator[currentDonation.donor_id].amount || 0) +\n        parseFloat(SUPPORTED_FTS.NEAR.fromIndivisible(currentDonation.net_amount)),\n      ...currentDonation,\n    };\n    return accumulator;\n  }, {});\n\n  // add % share of total to each donation\n  const total = SUPPORTED_FTS.NEAR.fromIndivisible(potDetail.matching_pool_balance);\n\n  sponsorshipDonations = Object.values(sponsorshipDonations).sort((a, b) => b.amount - a.amount);\n  sponsorshipDonations = sponsorshipDonations.map((donation) => {\n    return {\n      ...donation,\n      percentage_share: ((donation.amount / total) * 100).toFixed(2).replace(/[.,]00$/, \"\"),\n    };\n  });\n  State.update({ sponsorshipDonations });\n}\n\nif (!state.sponsorshipDonations) return <div class=\"spinner-border text-secondary\" role=\"status\" />;\n\nconst columns = [\"Rank\", \"Donor\", \"Amount\", \"Percentage\"];\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 24px;\n  width: 100%;\n  @media screen and (min-width: 375px) and (max-width: 768px) {\n    width: 99%;\n  }\n  @media screen and (max-width: 390px) {\n    width: 98%;\n  }\n`;\n\nconst OuterTextContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 10px;\n`;\n\nconst TableContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  border: 0.5px rgba(41, 41, 41, 0.5) solid;\n  box-shadow: 0px 4px 12px -4px rgba(82, 82, 82, 0.2);\n  border-radius: 2px;\n  width: 100%;\n  margin-top: 35px;\n  padding-bottom: 1rem;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  background: #f6f5f3;\n  width: 100%;\n`;\n\nconst HeaderItem = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: space-between;\n  justify-content: flex-start;\n  padding: 10px 20px;\n  width: 24%;\n  @media screen and (min-width: 390px) and (max-width: 768px) {\n    padding: 10px 15px;\n  }\n  @media screen and (max-width: 390px) {\n    padding: 10px;\n  }\n`;\n\nconst HeaderItemText = styled.div`\n  color: #292929;\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 24px;\n  @media screen and (max-width: 390px) {\n    font-size: 12px;\n  }\n`;\n\nconst Row = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n`;\n\nconst RowItem = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 20px;\n  padding: 20px;\n  width: 24%;\n  @media screen and (min-width: 390px) and (max-width: 768px) {\n    padding: 10px 15px;\n    gap: 10px;\n  }\n  @media screen and (max-width: 390px) {\n    padding: 10px;\n    gap: 0px;\n  }\n`;\n\nconst RowText = styled.div`\n  color: #292929;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 24px;\n  @media screen and (max-width: 390px) {\n    font-size: 12px;\n  }\n`;\n\nconst { base_currency } = potDetail;\n\nconst maxRowItemLength = 14;\n\nreturn (\n  <>\n    <Widget\n      src={`${ownerId}/widget/Pots.NavOptionsMobile`}\n      props={{\n        ...props,\n      }}\n    />\n    <Container>\n      <Widget\n        src={`${ownerId}/widget/Pots.SponsorsBoard`}\n        props={{\n          ...props,\n          donations: state.sponsorshipDonations.slice(0, 6),\n          base_currency: base_currency,\n        }}\n      />\n      <TableContainer>\n        <Widget\n          src={`${ownerId}/widget/Components.DonorsLeaderboard`}\n          props={{\n            ...props,\n            sortedDonations: state.sponsorshipDonations,\n          }}\n        />\n      </TableContainer>\n    </Container>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/potlock.near/widget/Pots.Sponsors", "fact_widget_deployments_id": "b3dff023bd0af4c5fc0781e6f70402d6", "inserted_timestamp": "2024-03-20T01:53:27.033Z", "modified_timestamp": "2024-03-20T01:53:27.033Z", "__row_index": 12}
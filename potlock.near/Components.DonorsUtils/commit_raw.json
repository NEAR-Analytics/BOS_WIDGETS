{"tx_hash": "BqeM3Ywrc6fsJGRBfTmgj9VLZufr74kUFAWeWG4uzbeu", "action_id_social": "CbcXWw3Bg8VRMuq2gTqPrRBAjKnvCgLnqJrKCkR4mXx5-0-widget", "block_id": 115722656, "block_timestamp": "2024-03-29T14:20:36.213Z", "signer_id": "potlock.near", "widget_name": "Components.DonorsUtils", "source_code": "// Get the current date in the local time zone\nconst currentDate = new Date();\n\n// Calculate the time zone offset in milliseconds\nlet localTimeZoneOffsetMinutes = currentDate.getTimezoneOffset();\nlocalTimeZoneOffsetMinutes = localTimeZoneOffsetMinutes * 60 * 1000;\n\nconst oneDayTime = 24 * 60 * 60 * 1000;\nconst currentTimestamp = new Date().getTime();\n\nconst yesterday = currentTimestamp - oneDayTime;\nconst lastWeek = currentTimestamp - oneDayTime * 7;\nconst lastMonth = currentTimestamp - oneDayTime * 30;\nconst lastYear = currentTimestamp - oneDayTime * 365;\n\nconst getTimePassed = (timestamp, abbreviate) => {\n  // Calculate the difference in milliseconds\n  const timePassed = currentTimestamp - timestamp;\n\n  // Convert milliseconds to seconds, minutes, hours, etc.\n  const secondsPassed = Math.floor(timePassed / 1000);\n  const minutesPassed = Math.floor(secondsPassed / 60);\n  const hoursPassed = Math.floor(minutesPassed / 60);\n  const daysPassed = Math.floor(hoursPassed / 24);\n\n  let time = 0;\n\n  // Display the time passed conditionally\n  if (daysPassed > 0) {\n    time = !abbreviate ? `${daysPassed} day${daysPassed === 1 ? \"\" : \"s\"}` : `${daysPassed}d`;\n  } else if (hoursPassed > 0) {\n    time = !abbreviate ? `${hoursPassed} hour${hoursPassed === 1 ? \"\" : \"s\"}` : `${hoursPassed}h`;\n  } else if (minutesPassed > 0) {\n    time = !abbreviate\n      ? `${minutesPassed} minute${minutesPassed === 1 ? \"\" : \"s\"}`\n      : `${minutesPassed}m`;\n  } else {\n    time = !abbreviate\n      ? `${secondsPassed} second${secondsPassed === 1 ? \"\" : \"s\"}`\n      : `${secondsPassed}s`;\n  }\n  return time;\n};\n\nconst _address = (address, max) => {\n  const limit = max || 10;\n  if (address.length > limit) return address.slice(0, limit) + \"...\";\n  else return address;\n};\n\nconst reverseArr = (input) => {\n  var ret = new Array();\n  for (var i = input.length - 1; i >= 0; i--) {\n    ret.push(input[i]);\n  }\n  return ret;\n};\n\nconst calcNetDonationAmount = (donation) => {\n  const lastDonationAmount = Big(\n    donation.total_amount - (donation.referrer_fee || 0) - (donation.protocol_fee || 0)\n  ).div(Big(1e24));\n  return parseFloat(lastDonationAmount);\n};\n\nconst filterByDate = (filter, donation) => {\n  const donateAt = donation.donated_at_ms || donation.donated_at;\n\n  switch (filter) {\n    case \"day\":\n      if (donateAt > yesterday) return true;\n      return false;\n    case \"week\":\n      if (donateAt > lastWeek) return true;\n      return false;\n    case \"month\":\n      if (donateAt > lastMonth) return true;\n      return false;\n    case \"year\":\n      if (donateAt > lastYear) return true;\n      return false;\n    case \"all\":\n      return true;\n\n    default:\n      return true;\n  }\n};\n\nreturn {\n  getTimePassed,\n  filterByDate,\n  _address,\n  reverseArr,\n  calcNetDonationAmount,\n};\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/potlock.near/widget/Components.DonorsUtils", "fact_widget_deployments_id": "d570713b36f12bf550970be0cbe99e69", "inserted_timestamp": "2024-03-29T15:31:57.070Z", "modified_timestamp": "2024-03-29T15:31:57.070Z", "__row_index": 0}
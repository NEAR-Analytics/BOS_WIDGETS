{"tx_hash": "2rcmQqATVW4BoygGqtqi6TFhtNMAfoCsjE8tpzC8mMxb", "action_id_social": "8fnVvTj1QcU9PheLuwcDTgaZ5V8G2fvhLdVdnvoTdd27-0-widget", "block_id": 108717292, "block_timestamp": "2023-12-24T17:10:14.832Z", "signer_id": "potlock.near", "widget_name": "Pots.Donations", "source_code": "// get donations\nconst { ownerId, potId, potDetail } = props;\n\nconst donations = Near.view(potId, \"get_public_round_donations\", {});\n\nif (!donations) return \"Loading...\";\n\nconsole.log(\"donations: \", donations);\nconst TitleText = styled.div`\n  color: #3d3d3d;\n  font-size: 24px;\n  font-weight: 600;\n  line-height: 32px;\n  word-wrap: break-word;\n`;\n\nconst RowOuter = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 0px;\n  //   gap: 92px;\n  border-bottom: 1px #f0f0f0 solid;\n  width: 100%;\n`;\n\nconst RowInner = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 10px;\n`;\n\nconst RowText = styled.div`\n  color: #525252;\n  font-size: 20px;\n  font-weight: 600;\n  line-height: 32px;\n  word-wrap: break-word;\n  width: 100%;\n`;\n\nconst daysAgo = (timestamp) => {\n  const now = new Date();\n  const pastDate = new Date(timestamp);\n  const differenceInTime = now - pastDate;\n\n  // Convert time difference from milliseconds to days\n  const differenceInDays = Math.floor(differenceInTime / (1000 * 3600 * 24));\n\n  return `${differenceInDays} ${differenceInDays === 1 ? \"day\" : \"days\"} ago`;\n};\n\nconst { base_currency } = potDetail;\n\nconst columns = [\"Project\", \"Donor\", \"Amount\", \"Date\"];\n\nreturn (\n  <>\n    <props.ToDo>Add totals</props.ToDo>\n    <props.ToDo>Add filters</props.ToDo>\n    <props.ToDo>Order reverse chronologically</props.ToDo>\n    <props.ToDo>Add messages from donations?</props.ToDo>\n    <RowOuter>\n      {columns.map((column, index) => (\n        <TitleText key={index}>{column}</TitleText>\n      ))}\n    </RowOuter>\n    {donations.map((donation, index) => {\n      const { project_id, message, donor_id, total_amount, donated_at } = donation;\n      const totalDonationAmount =\n        props.SUPPORTED_FTS[base_currency.toUpperCase()].fromIndivisible(total_amount);\n\n      return (\n        <RowOuter key={index}>\n          <RowInner>\n            <Widget\n              src={`${ownerId}/widget/Project.ProfileImage`}\n              props={{\n                ...props,\n                accountId: project_id,\n                imageWrapperStyle: {\n                  height: \"32px\",\n                  width: \"32px\",\n                },\n              }}\n            />\n            <RowText>{project_id}</RowText>\n          </RowInner>\n          <RowInner>\n            <Widget\n              src={`${ownerId}/widget/Project.ProfileImage`}\n              props={{\n                ...props,\n                accountId: donor_id,\n                imageWrapperStyle: {\n                  height: \"32px\",\n                  width: \"32px\",\n                },\n              }}\n            />\n            <RowText>{donor_id}</RowText>\n          </RowInner>\n          <RowInner>\n            <RowText>\n              {totalDonationAmount} {base_currency.toUpperCase()}\n            </RowText>\n          </RowInner>\n          <RowInner>\n            <RowText>{props.daysAgo(donated_at)}</RowText>\n          </RowInner>\n        </RowOuter>\n      );\n    })}\n    <props.ToDo>Add pagination</props.ToDo>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/potlock.near/widget/Pots.Donations", "fact_widget_deployments_id": "b365b7aba7f47f7af20ec38c557fc04a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 13}
{"tx_hash": "BqeM3Ywrc6fsJGRBfTmgj9VLZufr74kUFAWeWG4uzbeu", "action_id_social": "CbcXWw3Bg8VRMuq2gTqPrRBAjKnvCgLnqJrKCkR4mXx5-0-widget", "block_id": 115722656, "block_timestamp": "2024-03-29T14:20:36.213Z", "signer_id": "potlock.near", "widget_name": "SDK.cart", "source_code": "/**\n * Items must have \"id\" and \"price\" properties\n */\n\nconst CART_KEY = \"cart\";\nconst DEFAULT_CART = {};\n\nreturn {\n  getCart: () => {\n    const cart = JSON.parse(Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART));\n    return cart;\n  },\n  getCartItemCount: () => {\n    const cart = JSON.parse(Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART));\n    return Object.keys(cart).length;\n  },\n  getCartTotal: () => {\n    const cart = JSON.parse(Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART));\n    let total = 0;\n\n    Object.values(cart).forEach((item) => {\n      total += item.price;\n    });\n\n    return total;\n  },\n  addItemsToCart: (items) => {\n    const cart = JSON.parse(Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART));\n    if (Array.isArray(items)) {\n      items.forEach((item) => {\n        cart[item.id] = item;\n      });\n    } else if (typeof items === \"object\") {\n      cart[items.id] = items;\n    } else {\n      console.log(\"Attempted to add invalid item to cart, item: \", items);\n      return;\n    }\n\n    Storage.set(CART_KEY, JSON.stringify(cart));\n  },\n  removeItemsFromCart: (items) => {\n    const cart = JSON.parse(Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART));\n    if (Array.isArray(items)) {\n      items.forEach((item) => {\n        delete cart[item.id];\n      });\n    } else if (typeof items === \"object\") {\n      delete cart[items.id];\n    } else {\n      console.log(\"Attempted to remove invalid item from cart, item: \", items);\n      return;\n    }\n\n    Storage.set(CART_KEY, JSON.stringify(cart));\n  },\n  clearCart: () => {\n    Storage.set(CART_KEY, JSON.stringify(DEFAULT_CART));\n  },\n  updateItemInCart: (item) => {\n    const cart = JSON.parse(Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART));\n    if (cart[item.id]) {\n      cart[item.id] = item; // Update the item in the cart directly\n      Storage.set(CART_KEY, JSON.stringify(cart));\n    } else {\n      console.log(\"Item not found in cart:\", item);\n    }\n    console.log(\"cart\", cart);\n  },\n  itemExistsInCart: (item) => {\n    const cart = JSON.parse(Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART));\n    return cart[item.id] !== undefined;\n  },\n};\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/potlock.near/widget/SDK.cart", "fact_widget_deployments_id": "8b4863f34a37caea643fa227fc672779", "inserted_timestamp": "2024-03-29T15:31:57.070Z", "modified_timestamp": "2024-03-29T15:31:57.070Z", "__row_index": 0}
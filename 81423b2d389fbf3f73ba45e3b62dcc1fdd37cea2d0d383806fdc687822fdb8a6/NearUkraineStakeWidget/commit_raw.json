{"tx_hash": "HsTB94tGdSGnbK3qa3eYUPxWqvCWU5ePs54YxrnB2kZf", "action_id_social": "2WtC9h1X5K7daZaHQ3MKhDN1C9L2XS5BNFXxv73x96gV-0-widget", "block_id": 115330308, "block_timestamp": "2024-03-23T21:52:03.462Z", "signer_id": "81423b2d389fbf3f73ba45e3b62dcc1fdd37cea2d0d383806fdc687822fdb8a6", "widget_name": "NearUkraineStakeWidget", "source_code": "const SOuterWrapper = styled.div`\r\n  height: 100vh;\r\n  width: 100vw;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  margin: 0;\r\n  padding: 0;\r\n`;\r\n\r\nconst OuterWrapper = styled.div`\r\n  position: absolute;\r\n  top: 10vh;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  color: white;\r\n  font-family: 'Kodchasan', sans-serif;\r\n`;\r\n\r\nconst AmountButton = styled.button`\r\n  /* Adapt the colors based on primary prop */\r\n  background: ${(props) => (props.$primary ? \"blue\" : \"white\")};\r\n  color: ${(props) => (props.$primary ? \"white\" : \"blue\")};\r\n  font-size: 1em;\r\n  margin: 1em;\r\n  padding: 0.25em 1em;\r\n  border: 2px solid blue;\r\n  border-radius: 3px;\r\n`;\r\n\r\nconst StakeButton = styled.button`\r\n  /* Adapt the colors based on primary prop */\r\n  background: ${(props) => (props.$primary ? \"green\" : \"white\")};\r\n  color: ${(props) => (props.$primary ? \"white\" : \"green\")};\r\n  font-size: 1em;\r\n  margin: 1em;\r\n  padding: 0.25em 1em;\r\n  border: 2px solid green;\r\n  border-radius: 3px;\r\n`;\r\n\r\ninitState({ amount: \"1\" });\r\nconst accountId = props.wallet_id || context.accountId;\r\nconst decimals = props.decimal_places ?? 1;\r\n\r\nconst onStakeClick = () => {\r\n  const gas = 300 * 10e11; // 300 TGas\r\n  // TODO: doesn't support floats right now due to limitation of JS integers\r\n  const exactDeposit = parseInt(state.amount) + \"000000000000000000000000\";\r\n  const deposit = (exactDeposit / 10e23).toFixed(decimals);\r\n  console.log(`gas: 300 TGas, deposit: ${deposit} Near`);\r\n  Near.call(\r\n    \"nearuaguild.poolv1.near\",\r\n    \"deposit_and_stake\",\r\n    {},\r\n    gas,\r\n    exactDeposit\r\n  );\r\n};\r\n\r\nconst onAmountInputChange = ({ target }) => {\r\n  let nearAmount;\r\n  if (target.value < 1) {\r\n    nearAmount = 1;\r\n  } else {\r\n    nearAmount = target.value;\r\n  }\r\n  State.update({ amount: nearAmount });\r\n};\r\n\r\nconst onPresetButtonClick = ({ target }) => {\r\n  State.update({ amount: target.value });\r\n};\r\n\r\nconst totalStakedBalance = (\r\n  Near.view(\"nearuaguild.poolv1.near\", \"get_total_staked_balance\", {}) / 1e24\r\n).toFixed(decimals);\r\n\r\nconst yourStakedBalance = (\r\n  Near.view(\"nearuaguild.poolv1.near\", \"get_account_staked_balance\", {\r\n    account_id: accountId,\r\n  }) / 1e24\r\n).toFixed(decimals);\r\n\r\nconst res = fetch(`https://api.nearblocks.io/v1/account/${accountId}`);\r\nconst yourAccountBalance = (res.body.account[0].amount / 1e24).toFixed(\r\n  decimals\r\n);\r\n\r\nconst ButtonContainer = styled.div`\r\n  display: flex;\r\n  justify-content: center; /* \u0412\u0438\u0440\u0456\u0432\u043d\u044e\u0454 \u043a\u043d\u043e\u043f\u043a\u0438 \u043f\u043e \u0446\u0435\u043d\u0442\u0440\u0443 \u043f\u043e \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u0456 */\r\n  width: 100%; /* \u0420\u043e\u0437\u0442\u044f\u0433\u0443\u0454 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0430 \u0432\u0441\u044e \u0448\u0438\u0440\u0438\u043d\u0443 */\r\n`;\r\n\r\nreturn (\r\n  <SOuterWrapper>\r\n    <Widget src=\"nearukraineguild.near/widget/MysteryBox.Components.BackgroundStars\" />\r\n    <OuterWrapper>\r\n      <h1>Stake NEAR in NearUkraine</h1>\r\n      <p>\r\n        Amount:\r\n        <input\r\n          type=\"number\"\r\n          min=\"1\"\r\n          value={state.amount}\r\n          onChange={onAmountInputChange}\r\n        />\r\n      </p>\r\n      <ButtonContainer>\r\n        <AmountButton onClick={onPresetButtonClick} value=\"5\">\r\n          5\r\n        </AmountButton>\r\n        <AmountButton onClick={onPresetButtonClick} value=\"25\">\r\n          25\r\n        </AmountButton>\r\n        <AmountButton onClick={onPresetButtonClick} value=\"50\">\r\n          50\r\n        </AmountButton>\r\n        <AmountButton\r\n          onClick={onPresetButtonClick}\r\n          value={yourAccountBalance - 0.05}\r\n        >\r\n          Max\r\n        </AmountButton>\r\n        <StakeButton onClick={onStakeClick}>Stake</StakeButton>\r\n      </ButtonContainer>\r\n      <p>Total staked balance in validator is: {totalStakedBalance} Near</p>\r\n      <p>Your staked balance in validator is: {yourStakedBalance} Near</p>\r\n      <p>Your balance is: {yourAccountBalance} Near</p>\r\n      <Widget src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.Socials\" />\r\n    </OuterWrapper>\r\n  </SOuterWrapper>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/81423b2d389fbf3f73ba45e3b62dcc1fdd37cea2d0d383806fdc687822fdb8a6/widget/NearUkraineStakeWidget", "fact_widget_deployments_id": "f69fccb30da23a181b0893e622cbadfd", "inserted_timestamp": "2024-03-23T23:28:24.983Z", "modified_timestamp": "2024-03-23T23:28:24.983Z", "__row_index": 54}
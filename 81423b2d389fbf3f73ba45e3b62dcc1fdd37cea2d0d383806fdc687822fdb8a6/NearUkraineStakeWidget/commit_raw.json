{"tx_hash": "AJEox1mZzNKVdDZDxRzFUi2NNTpTvJwtLYBKhA6FYMJT", "action_id_social": "4fv4tfJ9kUGcJqhLHc1Vr1iRMPVvHZD4CZjknft6cGBa-0-widget", "block_id": 115476543, "block_timestamp": "2024-03-26T00:20:45.759Z", "signer_id": "81423b2d389fbf3f73ba45e3b62dcc1fdd37cea2d0d383806fdc687822fdb8a6", "widget_name": "NearUkraineStakeWidget", "source_code": "const font = fetch(\n  \"https://fonts.googleapis.com/css2?family=Kodchasan:wght@700&display=swap\"\n).body;\n\nif (!font) {\n  return <></>;\n}\n\nconst Background = styled.div`\n  height: 100%;\n  width: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  ${font}\n`;\n\nconst Text = styled.p`\n  font-family: 'Kodchasan', sans-serif;\n`;\n\nconst ButtonText = styled.p`\n  font-family: 'Kodchasan', sans-serif;\n    margin: 0;\n`;\n\nconst HeaderText = styled.h1`\n  font-family: 'Kodchasan', sans-serif;\n`;\n\nconst OuterWrapper = styled.div`\n  position: absolute;\n      max-height: 70%;\n    height: 100%;\n  top: 10%;\n  left: 50%;\n  width: 100%;\n  max-width: 80%;\n  transform: translateX(-50%);\n  color: white;\n  font-family: 'Kodchasan', sans-serif;\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n`;\n\nconst ButtonWrapper = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  margin: 20px 0;\n  & button {\n    padding: 0 20px;\n    margin-right: 10px;\n    \n    &:hover {\n      opacity: 0.8;\n    }\n  }\n\n  @media (max-width: 440px) {\n    justify-content: space-between;\n    & button {\n      margin-right: 0;\n    }\n  }\n`;\n\nconst StakeButtonWrapper = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n      margin: 20px 0;\n      & button {\n        padding: 0 20px;\n\n        &:hover {\n          opacity: 0.8;\n        }\n      }\n`;\n\nconst Social = styled.div`\n  display: flex;\n  justify-content: center;\n    align-items: center;\n`;\n\nconst StakeButton = styled.button`\n  background: white;\n  color: green;\n  font-size: 1em;\n  margin: 10px;\n  padding: 0.25em 1em;\n  border: 2px solid green;\n  border-radius: 3px;\n`;\n\nconst SocialText = styled.p`\n  font-family: 'Kodchasan', sans-serif;\n  font-size: 12px;\n  font-weight: 700;\n  line-height: 16px;\n  letter-spacing: 0em;\n  text-align: center;\n  color: #ffffff;\n  text-transform: uppercase;\n  margin: 0;\n`;\n\nconst AmountButton = styled.div`\n  position: relative;\n\n  cursor: pointer;\n  text-align: none;\n  text-decoration: none;\n\n  @media (min-width: 512px) {\n    font-size: 20px;\n    padding: 0.65em 2.5em;\n  }\n\n  font-size: 16px;\n  line-height: 1;\n  padding: 0.6875em 2.5em;\n\n  font-family: 'Kodchasan', sans-serif;\n  font-weight: 700;\n  letter-spacing: 0em;\n  text-align: center;\n  color: #ffffff;\n  text-transform: uppercase;\n\n  background: none;\n\n  &:after {\n    content: '';\n    position: absolute;\n    inset: 0;\n    border-radius: 100px;\n    border: 3px solid transparent;\n    background: linear-gradient(\n        92.13deg,\n        #d2c659 -11.04%,\n        #cb84c3 40.76%,\n        #5c91df 101.98%\n      )\n      border-box;\n    -webkit-mask: /*4*/ linear-gradient(#fff 0 0) padding-box,\n      linear-gradient(#fff 0 0);\n    -webkit-mask-composite: xor; /*5'*/\n    mask-composite: exclude; /*5*/\n    // box-shadow: 0px 8px 24px rgba(21.48, 26.91, 35.06, 0.25);\n  }\n`;\n\ninitState({ amount: \"1\" });\nconst accountId = props.wallet_id || context.accountId;\nconst decimals = props.decimal_places ?? 1;\n\nconst onStakeClick = () => {\n  const gas = 300 * 10e11; // 300 TGas\n  // TODO: doesn't support floats right now due to limitation of JS integers\n  const exactDeposit = parseInt(state.amount) + \"000000000000000000000000\";\n  const deposit = (exactDeposit / 10e23).toFixed(decimals);\n  console.log(`gas: 300 TGas, deposit: ${deposit} Near`);\n  Near.call(\n    \"nearuaguild.poolv1.near\",\n    \"deposit_and_stake\",\n    {},\n    gas,\n    exactDeposit\n  );\n};\n\nconst onAmountInputChange = ({ target }) => {\n  let nearAmount;\n  if (target.value === \"\") {\n    // If input is empty\n    nearAmount = \"\"; // Allow empty input\n  } else if (parseInt(target.value) < 1) {\n    // If input is less than 1\n    nearAmount = 1; // Set it to 1\n  } else {\n    nearAmount = target.value;\n  }\n  State.update({ amount: nearAmount });\n};\n\nconst onPresetButtonClick = (value) => {\n  State.update({ amount: value });\n};\n\nconst totalStakedBalance = (\n  Near.view(\"nearuaguild.poolv1.near\", \"get_total_staked_balance\", {}) / 1e24\n).toFixed(decimals);\n\nconst yourStakedBalance = (\n  Near.view(\"nearuaguild.poolv1.near\", \"get_account_staked_balance\", {\n    account_id: accountId,\n  }) / 1e24\n).toFixed(decimals);\n\nconst res = fetch(`https://api.nearblocks.io/v1/account/${accountId}`);\nconst yourAccountBalance = (res.body.account[0].amount / 1e24).toFixed(\n  decimals\n);\n\nconst ButtonContainer = styled.div`\n  display: flex;\n  justify-content: center; /* \u0412\u0438\u0440\u0456\u0432\u043d\u044e\u0454 \u043a\u043d\u043e\u043f\u043a\u0438 \u043f\u043e \u0446\u0435\u043d\u0442\u0440\u0443 \u043f\u043e \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u0456 */\n  width: 100%; /* \u0420\u043e\u0437\u0442\u044f\u0433\u0443\u0454 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0430 \u0432\u0441\u044e \u0448\u0438\u0440\u0438\u043d\u0443 */\n`;\n\nreturn (\n  <Background>\n    <Widget src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.MenuHeader\" />\n    <Widget src=\"nearukraineguild.near/widget/MysteryBox.Components.BackgroundStars\" />\n    <OuterWrapper>\n      <HeaderText>Stake NEAR with Near Ukraine \ud83c\uddfa\ud83c\udde6</HeaderText>\n\n      <Text>\n        <b>Total staked:</b> {totalStakedBalance} Near <br />\n        <b>Your staked balance:</b> {yourStakedBalance} Near <br />\n        <b>Your balance is:</b> {yourAccountBalance} Near\n      </Text>\n      <div>\n        <Text>Amount:</Text>\n        <input\n          type=\"number\"\n          min=\"1\"\n          value={state.amount}\n          onChange={onAmountInputChange}\n        />\n        <ButtonWrapper>\n          <Widget\n            src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.SubmitButton\"\n            props={{\n              onClick: () => onPresetButtonClick(5),\n              text: \"5\",\n            }}\n          />\n\n          <Widget\n            src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.SubmitButton\"\n            props={{\n              onClick: () => onPresetButtonClick(25),\n              text: \"25\",\n            }}\n          />\n\n          <Widget\n            src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.SubmitButton\"\n            props={{\n              onClick: () => onPresetButtonClick(50),\n              text: \"50\",\n            }}\n          />\n\n          <Widget\n            src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.SubmitButton\"\n            props={{\n              onClick: () => onPresetButtonClick(yourAccountBalance - 0.05),\n              text: \"Max\",\n            }}\n          />\n        </ButtonWrapper>\n        <StakeButtonWrapper>\n          <Widget\n            src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.SubmitButton\"\n            props={{\n              onClick: onStakeClick,\n              text: \"Stake\",\n            }}\n          />\n        </StakeButtonWrapper>\n      </div>\n      <Social>\n        <SocialText>Follow us</SocialText>\n\n        <Widget src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.Socials\" />\n      </Social>\n    </OuterWrapper>\n  </Background>\n);\n", "metadata": {"fork_of": "81423b2d389fbf3f73ba45e3b62dcc1fdd37cea2d0d383806fdc687822fdb8a6/widget/NearUkraineStakeWidget@115042747"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/81423b2d389fbf3f73ba45e3b62dcc1fdd37cea2d0d383806fdc687822fdb8a6/widget/NearUkraineStakeWidget", "fact_widget_deployments_id": "2c10cc41a7feb8a4d6f87f0dce0cade8", "inserted_timestamp": "2024-03-26T01:50:39.596Z", "modified_timestamp": "2024-03-26T01:50:39.596Z", "__row_index": 10}
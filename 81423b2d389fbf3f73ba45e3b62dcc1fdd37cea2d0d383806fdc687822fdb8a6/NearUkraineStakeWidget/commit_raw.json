{"tx_hash": "4jtkJu3tmqeW9x5aPTEbt2ZQA3C6X8yiZLP4upcxjRPL", "action_id_social": "2xBnxxr7Th4pydJEu2ycTjv1iT9rJ1F43enouyikqjsz-0-widget", "block_id": 115167619, "block_timestamp": "2024-03-21T14:59:30.733Z", "signer_id": "81423b2d389fbf3f73ba45e3b62dcc1fdd37cea2d0d383806fdc687822fdb8a6", "widget_name": "NearUkraineStakeWidget", "source_code": "const OuterWrapper = styled.div`\n  position: absolute;\n  top: 0;\n  color: white;\n`;\n\nconst SOuterWrapper = styled.div`\n  height: 100vh;\n  width: 100vw;\n  margin: 0;\n  padding: 0;\n  \n`;\n\ninitState({\n  amount: \"1\",\n  validator: \"nearuaguild.poolv1.near\",\n});\nconst accountId = props.wallet_id || context.accountId;\nconst decimals = props.decimal_places ?? 1;\n\nconst onStakeClick = () => {\n  const gas = 300 * 10e11; // 300 TGas\n  // TODO: doesn't support floats right now due to limitation of JS integers\n  const exactDeposit = parseInt(state.amount) + \"000000000000000000000000\";\n  const deposit = (exactDeposit / 10e23).toFixed(decimals);\n  console.log(`gas: 300 TGas, deposit: ${deposit} Near`);\n  Near.call(state.validator, \"deposit_and_stake\", {}, gas, exactDeposit);\n};\n\nconst onAmountInputChange = ({ target }) => {\n  let nearAmount;\n  if (target.value < 1) {\n    nearAmount = 1;\n  } else {\n    nearAmount = target.value;\n  }\n  State.update({ amount: nearAmount });\n};\n\nconst onValidatorInputChange = ({ target }) => {\n  State.update({ validator: target.value });\n};\n\nconst onPresetButtonClick = ({ target }) => {\n  State.update({ amount: target.value });\n};\n\nconst StakeButton = styled.button`\n  /* Adapt the colors based on primary prop */\n  background: ${(props) => (props.$primary ? \"green\" : \"white\")};\n  color: ${(props) => (props.$primary ? \"white\" : \"green\")};\n  font-size: 1em;\n  margin: 1em;\n  padding: 0.25em 1em;\n  border: 2px solid green;\n  border-radius: 3px;\n`;\n\nconst AmountButton = styled.button`\n  /* Adapt the colors based on primary prop */\n  background: ${(props) => (props.$primary ? \"blue\" : \"white\")};\n  color: ${(props) => (props.$primary ? \"white\" : \"blue\")};\n  font-size: 1em;\n  margin: 1em;\n  padding: 0.25em 1em;\n  border: 2px solid blue;\n  border-radius: 3px;\n`;\n\nconst totalStakedBalance = (\n  Near.view(state.validator, \"get_total_staked_balance\", {}) / 1e24\n).toFixed(decimals);\n\nconst yourStakedBalance = (\n  Near.view(state.validator, \"get_account_staked_balance\", {\n    account_id: accountId,\n  }) / 1e24\n).toFixed(decimals);\n\nconst res = fetch(`https://api.nearblocks.io/v1/account/${accountId}`);\nconst yourAccountBalance = (res.body.account[0].amount / 1e24).toFixed(\n  decimals\n);\n\nreturn (\n  <SOuterWrapper>\n    <Widget src=\"nearukraineguild.near/widget/MysteryBox.Components.BackgroundStars\" />\n    <OuterWrapper>\n      <h1>Stake NEAR</h1>\n      <p>\n        Validator:{\" \"}\n        <input value={state.validator} onChange={onValidatorInputChange} />\n      </p>\n      <p>\n        Amount:\n        <input\n          type=\"number\"\n          min=\"1\"\n          value={state.amount}\n          onChange={onAmountInputChange}\n        />\n      </p>\n      <AmountButton onClick={onPresetButtonClick} value=\"5\">\n        5\n      </AmountButton>\n      <AmountButton onClick={onPresetButtonClick} value=\"10\">\n        10\n      </AmountButton>\n      <AmountButton onClick={onPresetButtonClick} value=\"25\">\n        25\n      </AmountButton>\n      <AmountButton onClick={onPresetButtonClick} value=\"50\">\n        50\n      </AmountButton>\n      <AmountButton onClick={onPresetButtonClick} value=\"100\">\n        100\n      </AmountButton>\n      <AmountButton\n        onClick={onPresetButtonClick}\n        value={yourAccountBalance - 0.05}\n      >\n        Max\n      </AmountButton>\n      <br></br>\n      <StakeButton onClick={onStakeClick}>Stake</StakeButton>\n      <p>Total staked balance in validator is: {totalStakedBalance} Near</p>\n      <p>Your staked balance in validator is: {yourStakedBalance} Near</p>\n      <p>Your balance is: {yourAccountBalance} Near</p>\n      <Widget src=\"nearukraineguild.near/widget/MysteryBox.Manage.Components.Socials\" />\n    </OuterWrapper>\n  </SOuterWrapper>\n);\n", "metadata": {"fork_of": "81423b2d389fbf3f73ba45e3b62dcc1fdd37cea2d0d383806fdc687822fdb8a6/widget/NearUkraineStakeWidget@115042747"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/81423b2d389fbf3f73ba45e3b62dcc1fdd37cea2d0d383806fdc687822fdb8a6/widget/NearUkraineStakeWidget", "fact_widget_deployments_id": "227041a7daa4ab57c043fe803b1238ac", "inserted_timestamp": "2024-03-21T16:29:58.910Z", "modified_timestamp": "2024-03-21T16:29:58.910Z", "__row_index": 4}
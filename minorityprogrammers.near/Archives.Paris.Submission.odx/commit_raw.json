{"tx_hash": "CWwfDUyx4KNKSS6eY8AaesFZcuzpkTMtCVf6tpcgkhiU", "action_id_social": "541GZPBNHQamNHRmFV5S7VHeHaFsc6G1cuqLHZqrtv1H-0-widget", "block_id": 97130357, "block_timestamp": "2023-07-23T07:58:06.387Z", "signer_id": "minorityprogrammers.near", "widget_name": "Archives.Paris.Submission.odx", "source_code": "const ODX = styled.div`\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    .global {\n      border-radius: 20px;\n      border: 20px solid #565568;\n      background: #262637;\n\n      .header {\n        display: flex;\n        align-items: center;\n        height: 70px;\n        border-bottom: 1px solid #565568;\n\n        .logo {\n          margin: 0px 20px 0px 20px;\n\n          .image {\n            width: 85px;\n          }\n        }\n        .blank {\n          flex-grow: 1;\n        }\n        .connect-btn {\n          margin: 0px 20px 0px 20px;\n          padding: 5px 20px 5px 20px;\n          border-radius: 20px;\n          border: none;\n          background: #565568;\n          font-size: 16px;\n          font-weight: 600;\n          color: white;\n          cursor: pointer;\n        }\n        .connect-btn:hover {\n          background: #151522;\n          color: #6B6982;\n        }\n      }\n\n    }\n    .content {\n      display: flex;\n\n      .order-box {\n        width: 350px;\n        border-right: 1px solid #565568;\n        background: #1A1A27;\n\n        .pair {\n          display: flex;\n          align-items: center;\n          height: 40px;\n          border-bottom: 1px solid #565568;\n\n          .text {\n            margin: 0px 0px 0px 10px;\n            color: white;\n          }\n          .image {\n            width: 20px;\n            margin: 0px 0px 0px 10px;\n          }\n        }\n        .order-type {\n          display: flex;\n          align-items: center;\n          border-bottom: 1px solid #565568;\n\n          .type-btn {\n            width: 33%;\n            padding: 10px 0px 10px 0px;\n            cursor: pointer;\n            color: #6B6982;\n            text-align: center;\n          }\n          .type-btn:hover {\n            color: white;\n          }\n          .type-btn-selected {\n            color: white;\n            background: #151522;\n          }\n          .market {\n            border-right: 1px solid #565568;\n          }\n          .limit {\n            border-right: 1px solid #565568;\n          }\n          .stop {\n\n          }\n        }\n        .action-box {\n          display: flex;\n          align-items: center;\n          padding: 20px;\n          border-bottom: 1px solid #565568;\n\n          .action-btn {\n            width: 50%;\n            height: 50px;\n            padding: 15px 0px 15px 0px;\n            border-radius: 4px;\n            font-size: 16px;\n            font-weight: 600;\n            color: #6B6982;\n            text-align: center;\n            cursor: pointer;\n          }\n          .action-btn:hover {\n            color: white;\n          }\n          .sell-btn-selected {\n            background: #FF5353;\n            color: white;\n          }\n          .buy-btn-selected {\n            background: #16B57F;\n            color: white;\n          }\n        }\n        .amount-box {\n          padding: 20px;\n\n          .amount-header {\n            display: flex;\n            align-items: center;\n            margin: 0px 0px 10px 0px;\n\n            .label {\n              font-size: 16px;\n              font-weight: 600;\n              color: white;\n            }\n            .symbol {\n              border-radius: 4px;\n              margin: 0px 0px 0px 8px;\n              padding: 2px 5px 2px 5px;\n              background: #89899C;\n              font-size: 10px;\n              font-weight: 600;\n              text-align: center;\n              color: white;\n            }\n          }\n          .amount-content {\n            display: flex;\n            align-items: center;\n            padding: 10px;\n            border-radius: 4px;\n            background: #232334;\n\n            .input {\n              width: 150px;\n              margin: 0px 10px 0px 0px;\n              border-radius: 4px;\n              background: #232334;\n              border: none;\n              font-weight: 600;\n              color: white;\n            }\n            .input:hover {\n              outline: none !important;\n              border: none;\n            }\n            .input:focus {\n              outline: none !important;\n              border: none;\n            }\n            .blank {\n              flex-grow: 1;\n            }\n            .percent-btn {\n              margin: 0px 10px 0px 0px;\n              color: #6B6982;\n              cursor: pointer;\n            }\n            .percent-btn:hover {\n              color: white;\n            }\n            .max-btn {\n              margin: 0px 10px 0px 0px;\n              color: #6B6982;\n              cursor: pointer;\n            }\n            .max-btn:hover {\n              color: white;\n            }\n          }\n        }\n        .price-box {\n          padding: 20px;\n\n          .price-header {\n            display: flex;\n            align-items: center;\n            margin: 0px 0px 10px 0px;\n\n            .label {\n              font-size: 16px;\n              font-weight: 600;\n              color: white;\n            }\n            .symbol {\n              border-radius: 4px;\n              margin: 0px 0px 0px 8px;\n              padding: 2px 5px 2px 5px;\n              background: #89899C;\n              font-size: 10px;\n              font-weight: 600;\n              text-align: center;\n              color: white;\n            }\n          }\n          .price-content {\n            display: flex;\n            align-items: center;\n            padding: 10px;\n            border-radius: 4px;\n            background: #232334;\n            border-bottom: 1px solid #565568;\n\n            .input {\n              width: 150px;\n              margin: 0px 10px 0px 0px;\n              border-radius: 4px;\n              background: #232334;\n              border: none;\n              font-weight: 600;\n              color: white;\n            }\n            .input:hover {\n              outline: none !important;\n              border: none;\n            }\n            .input:focus {\n              outline: none !important;\n              border: none;\n            }\n          }\n        }\n        .confirm-box {\n          display: flex;\n          align-items: center;\n          padding: 20px;\n          border-bottom: 1px solid #565568;\n\n          .confirm-btn {\n            width: 100%;\n            height: 50px;\n            padding: 15px 0px 15px 0px;\n            background: #16B57F;\n            border-radius: 4px;\n            font-size: 16px;\n            font-weight: 600;\n            color: white;\n            text-align: center;\n            cursor: pointer;\n          }\n        }\n      }\n      .chart {\n\n        .image {\n\n        }\n      }\n    }\n`;\n\n/*\n Contracts\n */\n\nconst contract = {\n  address: \"0x37F46adf5B118BbF3361Ffea6dfe2a3Ce2eD7E4F\",\n  abi: fetch(\n    `https://raw.githubusercontent.com/ETH-Global-Paris-2023/ODX/main/backend/abis/ODX_abi.json`\n  ).body,\n};\n\n/*\n State\n */\nState.init({\n  imports: {},\n  chainId: undefined,\n  connected: false,\n  address: undefined,\n  orderType: \"market\",\n  orderAction: \"buy\",\n  amount: \"12\",\n  price: \"13\",\n});\n\n/*\n Dom Events\n */\n\nconst onAmountChange = ({ target }) => {\n  State.update({\n    amount: target.value,\n  });\n};\nconst onMaxClick = (e) => {\n  State.update({\n    amount: \"1000\",\n  });\n};\nconst onPriceChange = ({ target }) => {\n  State.update({\n    price: target.value,\n  });\n};\nconst onOrderTypeMarket = (e) => {\n  State.update({\n    orderType: \"market\",\n  });\n};\nconst onOrderTypeLimit = (e) => {\n  State.update({\n    orderType: \"limit\",\n  });\n};\nconst onOrderActionSell = (e) => {\n  State.update({\n    orderAction: \"sell\",\n  });\n};\nconst onOrderActionBuy = (e) => {\n  State.update({\n    orderAction: \"buy\",\n  });\n};\nconst onConfirm = () => {\n  if (!state.address) {\n    return;\n  }\n  const tokenDecimals = 18;\n  const provider = Ethers.provider();\n  const signer = provider.getSigner();\n  console.log(\"contract.address\", contract.address);\n  console.log(\"contract.abi\", contract.abi);\n  console.log(\"provider\", provider);\n  console.log(\"signer\", signer);\n\n  const erc20 = new ethers.Contract(contract.address, contract.abi, signer);\n  let amount = ethers.utils\n    .parseUnits(state.amount, tokenDecimals)\n    .toHexString();\n\n  const USDC = \"0xda9d4f9b69ac6C22e444eD9aF0CfC043b7a7f53f\";\n  const WBTC = \"0xf864F011C5A97fD8Da79baEd78ba77b47112935a\";\n\n  erc20\n    .pushOrderLiquidity(\n      state.address,\n      USDC,\n      WBTC,\n      ethers.utils.parseUnits(state.amount, tokenDecimals),\n      ethers.utils.parseUnits(state.price, tokenDecimals)\n    )\n    .then((transactionHash) => {\n      console.log(\"transactionHash is \" + transactionHash);\n    });\n};\n\n/*\n Methods\n */\n\nconst getTypeStyles = (type) => {\n  let styles = `type-btn ${type}`;\n  if (state.orderType == type) {\n    styles += ` type-btn-selected`;\n  }\n  return styles;\n};\n\nconst getActionStyles = (action) => {\n  let styles = `action-btn`;\n  if (state.orderAction == action) {\n    styles += ` ${action}-btn-selected`;\n  }\n  return styles;\n};\n\n/*\n Components\n */\n\nconst priceComponent =\n  state.orderType == \"limit\" ? (\n    <div class=\"price-box\">\n      <div class=\"price-header\">\n        <div class=\"label\">Price</div>\n        <div class=\"symbol\">ETH</div>\n      </div>\n      <div class=\"price-content\">\n        <input class=\"input\" />\n      </div>\n    </div>\n  ) : null;\n\n/*\n Main\n */\n\nif (Ethers.provider()) {\n  const signer = Ethers.provider().getSigner();\n\n  signer.getAddress().then((address) => {\n    State.update({\n      address,\n      connected: true,\n    });\n\n    console.log(\"address\", address);\n\n    if (state.balance === undefined) {\n      Ethers.provider()\n        .getBalance(address)\n        .then((balance) => {\n          State.update({\n            balance: balance.toString(),\n          });\n        });\n    }\n  });\n\n  Ethers.provider()\n    .getNetwork()\n    .then((chainIdData) => {\n      if (chainIdData?.chainId) {\n        State.update({ chainId: chainIdData.chainId });\n      }\n    });\n}\n\n/*\n Render\n */\n\nreturn (\n  <ODX>\n    <div class=\"global\">\n      <div class=\"header\">\n        <div class=\"logo\">\n          <img class=\"image\" src=\"https://i.imgur.com/srQIMqd.png\" />\n        </div>\n        <div class=\"blank\"></div>\n        <Web3Connect className=\"connect-btn\" connectLabel=\"Connect\" />\n      </div>\n      <div class=\"content\">\n        <div class=\"order-box\">\n          <div class=\"pair\">\n            <img\n              class=\"image\"\n              src=\"https://trade.dydx.exchange/currencies/eth.svg\"\n            />\n            <div class=\"text\">CTSI-ETH</div>\n          </div>\n          <div class=\"order-type\">\n            <div\n              className={getTypeStyles(\"market\")}\n              onClick={onOrderTypeMarket}\n            >\n              Market\n            </div>\n            <div className={getTypeStyles(\"limit\")} onClick={onOrderTypeLimit}>\n              Limit\n            </div>\n            <div class=\"type-btn stop\">Stop</div>\n          </div>\n          <div class=\"action-box\">\n            <div\n              className={getActionStyles(\"sell\")}\n              onClick={onOrderActionSell}\n            >\n              Sell\n            </div>\n            <div className={getActionStyles(\"buy\")} onClick={onOrderActionBuy}>\n              Buy\n            </div>\n          </div>\n          <div class=\"amount-box\">\n            <div class=\"amount-header\">\n              <div class=\"label\">Amount</div>\n              <div class=\"symbol\">CTSI</div>\n            </div>\n            <div class=\"amount-content\">\n              <input\n                class=\"input\"\n                onChange={onAmountChange}\n                value={state.amount}\n              />\n              <div class=\"blank\"></div>\n              <div class=\"percent-btn\">%</div>\n              <div class=\"max-btn\" onClick={onMaxClick}>\n                MAX\n              </div>\n            </div>\n          </div>\n          {priceComponent}\n          <div class=\"confirm-box\">\n            <div class=\"confirm-btn\" onClick={(e) => onConfirm()}>\n              Confirm\n            </div>\n          </div>\n        </div>\n        <div class=\"chart\">\n          <img class=\"image\" src=\"https://i.imgur.com/xryEwH1.png\" />\n        </div>\n      </div>\n    </div>\n  </ODX>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/minorityprogrammers.near/widget/Archives.Paris.Submission.odx", "fact_widget_deployments_id": "ebc01f0bdfb413e0755384daa954b2e4", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 0}
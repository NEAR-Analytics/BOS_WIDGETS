{"tx_hash": "C2gCwBgiKs8gFLvu8oZDmJeF43sVGmupkFzaSZbsCVUh", "action_id_social": "FvPNceVkKSpm1CouJJSzu1kzozou2taV2kibYFbEmkSG-0-widget", "block_id": 105883353, "block_timestamp": "2023-11-17T06:24:42.364Z", "signer_id": "systemctl.near", "widget_name": "00-basicForm-IntegrityVault", "source_code": "const accountId = context.accountId; // Set account ID from context\nconst fileAccept = props.fileAccept || \"*\"; // Wich file extensions are accepted\nconst fileIcon = props.fileIcon || \"bi-file\"; // File icon class\nconst buttonText = props.buttonText || \"Upload a file\"; // File button upload text\n\n// Exit if user is not signed (A NEAR Wallet is needed)\nif (!accountId) {\n  return \"Please sign in with NEAR wallet to add a new blog entry\";\n}\n\n// Init State\ninitState({\n  title: \"\",\n  context: \"\",\n  uploading: false,\n  cid: null,\n  filename: null,\n  fileURL: null,\n  observationError: null,\n  titleError: null,\n});\n\n// Constants to save in Entry\nconst timestamp = Date.now();\nconst applicationId = \"IntegrityVault\";\nconst ipfsUrl = (cid) => `https://ipfs.near.social/ipfs/${cid}`;\n\nconst Container = styled.div`\n  width: 100%;\n  display: flex;\n  padding: 2rem 3rem;\n  flex-direction: column;\n  align-items: flex-start;\n  gap: 2rem;\n  border-radius: 0.5rem;\n  border: 1px solid var(--ui-elements-light, #eceef0);\n  background: rgb(128,125,176);\n  background: linear-gradient(180deg, rgba(128,125,176,1) 0%, rgba(255,255,255,1) 58%);\n`;\n\nconst TitlePage = styled.h3`\n  text-transform: uppercase;\n  font-size: 3.75rem;\n  font-weight: 700;\n  margin: 20px 0 20px 0;\n`;\n\nconst CommitButton = styled.button`\n  display: inline-block;\n  color: #BF4F74;\n  font-size: 1em;\n  margin: 1em;\n  padding: 0.25em 1em;\n  border: 2px solid #BF4F74;\n  border-radius: 3px;\n  display: block;\n`;\n\n// Corruption proof\nconst entry = {\n  id: timestamp,\n  applicationName: applicationId,\n  data: {\n    title: state.title,\n    context: state.context,\n    cid: state.cid,\n    fileURL: state.fileURL,\n  },\n};\n\n// Form\nreturn (\n  <Container>\n    <div className=\"row\">\n      <div className=\"mb-2\">\n        <TitlePage>Fight corruption</TitlePage>\n      </div>\n      <Widget\n        src={\"contribut3.near/widget/Inputs.Text\"}\n        props={{\n          label: \"Evidence Title\",\n          placeholder: \"Give a name for your evidence\",\n          value: state.title,\n          onChange: (title) => State.update({ title }),\n          validate: () => {\n            if (state.title.length > 50) {\n              State.update({\n                titleError: \"The URL must be less than 50 characters\",\n              });\n              return;\n            }\n\n            State.update({ titleError: \"\" });\n          },\n        }}\n      />\n      <Widget\n        src={\"contribut3.near/widget/Inputs.TextArea\"}\n        props={{\n          label: \"Evidence observations\",\n          placeholder: \"Give a short description of your evidence\",\n          value: state.context,\n          onChange: (context) => State.update({ context }),\n          validate: () => {\n            if (state.context.length > 500) {\n              State.update({\n                observationError:\n                  \"Observations must be less than 500 characters\",\n              });\n              return;\n            }\n\n            State.update({ descriptionError: \"\" });\n          },\n          error: state.observationError,\n        }}\n      />\n      <div>\n        {state.cid ? (\n          <a href={ipfsUrl(state.cid)} download>\n            {state.filename}\n          </a>\n        ) : (\n          <></>\n        )}\n        <Files\n          multiple={false}\n          accepts={[\"image/*\", \"video/*\", \".pdf\"]}\n          minFileSize={1}\n          clickable\n          className=\"btn btn-outline-primary\"\n          onChange={(files) => {\n            if (!files || !files.length) return;\n\n            const [body] = files;\n\n            State.update({ uploading: true, cid: null });\n            asyncFetch(\"https://ipfs.near.social/add\", {\n              method: \"POST\",\n              headers: { Accept: \"application/json\" },\n              body,\n            }).then(({ body: { cid } }) => {\n              State.update({\n                cid,\n                filename: body.name,\n                uploading: false,\n                fileURL: ipfsUrl(cid),\n              });\n            });\n          }}\n        >\n          {state.uploading ? \"Uploading\" : state.cid ? \"Replace\" : buttonText}\n        </Files>\n      </div>\n      &nbsp;\n      <CommitButton data={{ postEvidenceData: entry }}>\n        Post evidence\n      </CommitButton>\n    </div>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/systemctl.near/widget/00-basicForm-IntegrityVault", "fact_widget_deployments_id": "9a3628426a83442aa6fc5fe926324a74", "inserted_timestamp": "2023-11-17T08:30:52.896Z", "modified_timestamp": "2023-11-17T08:30:52.896Z", "__row_index": 3}
{"tx_hash": "DTzu4myAiqgV6WvCzEjeKTL4xKruEaAqA5fNizpopVKE", "action_id_social": "55PHGBaUikzu6H67jiHgVXkDLRR2Ct1AdYQnL5iZfCvb-0-widget", "block_id": 96926719, "block_timestamp": "2023-07-20T16:28:59.876Z", "signer_id": "a13x.near", "widget_name": "owned-nfts--set-profile-pic", "source_code": "let accountId = props.accountId || context.accountId;\nlet contractId = props.contractId || context.contractId || \"avtr.near\";\n\nconst owned_tokens = Near.view(contractId, \"nft_tokens_for_owner\", {\n  account_id: accountId,\n});\n\n// if (!owned_tokens.length) {\n//   return (\n//     <div class=\"text-center\">\n//       Mint a {contractId}, a Social Avatar, freemint a Shard Dog, or buy and NFT\n//       to set it as a Profile Picture.\n//     </div>\n//   );\n// }\n\nlet tokenImg = styled.img`\nwidth: 100px;\nheight: 100px;\n    `;\n\nlet tokenImgLarge = styled.img`\nmax-width: 50%;\nmax-height: 50%;\n    `;\n\nlet previews = [];\nlet modals = [];\n\nowned_tokens.map((token) => {\n  let price = 0;\n  try {\n    price = new Big(JSON.parse(token.metadata.extra).mint_price)\n      .div(new Big(10).pow(24))\n      .toFixed(0);\n  } catch (e) {\n    console.log(e);\n  }\n\n  const token_id = token.token_id\n    .replace(\"#\", \"-\")\n    .replace(\" \", \"_\")\n    .replace(\":\", \"-\");\n\n  previews.push(\n    <tokenImg\n      src={token.metadata.media}\n      class=\"float-start\"\n      type=\"button\"\n      data-bs-toggle=\"modal\"\n      data-bs-target={`#token-${token_id}`}\n    />\n  );\n\n  modals.push(\n    <div\n      class=\"modal fade\"\n      id={`token-${token_id}`}\n      tabindex=\"-1\"\n      aria-labelledby={`token-${token_id}Label`}\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\" id={`token-${token_id}Label`}>\n              {contractId} \u27a1\ufe0f {token.token_id}\n              {price > 0 && (\n                <span class=\"ms-1 badge bg-success\">\n                  Mint Price: {price} NEAR\n                </span>\n              )}\n            </h5>\n            <button\n              type=\"button\"\n              class=\"btn-close\"\n              data-bs-dismiss=\"modal\"\n              aria-label=\"Close\"\n            ></button>\n          </div>\n          <div class=\"modal-body\">\n            <tokenImgLarge src={token.metadata.media} />\n          </div>\n          <div class=\"modal-footer\">\n            <button\n              type=\"button\"\n              class=\"btn btn-secondary\"\n              data-bs-dismiss=\"modal\"\n            >\n              Close\n            </button>\n            <CommitButton\n              data={{\n                profile: {\n                  image: {\n                    url: null,\n                    nft: {\n                      contractId,\n                      tokenId: token.token_id,\n                    },\n                  },\n                },\n              }}\n            >\n              Set profile picture\n            </CommitButton>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n});\n\nreturn (\n  <>\n    {previews}\n    {modals}\n  </>\n);\n", "metadata": {"platform": "nearpad"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/a13x.near/widget/owned-nfts--set-profile-pic", "fact_widget_deployments_id": "9f6961f83e5d016ca27098458e64e04c", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "EKUno1WXVsnMBzGGHYaX5S9xZ5Sq83gsDiurSWCytTH5", "action_id_social": "9zmtMnEtgqdQkMLKNhBpsAoyvrrCA6EBzgjKiUXJr2Hm-0-widget", "block_id": 110329726, "block_timestamp": "2024-01-13T20:10:19.763Z", "signer_id": "buildhub.near", "widget_name": "components.button.join-now", "source_code": "const daoId = \"build.sputnik-dao.near\";\nconst accountId = context.accountId;\n\n// get DAO policy, deposit, and group\nconst policy = Near.view(daoId, \"get_policy\");\n\nif (policy === null) {\n  return \"\";\n}\n\nconst alreadyJoinedRolesNames = [\"community\", \"council\"];\n\nconst group = policy.roles\n  .filter((role) => alreadyJoinedRolesNames.includes(role.name))\n  .map((role) => {\n    return role.kind.Group;\n  });\n\nconst accounts = new Set(group[0].concat(group[1]));\n\nconst isCommunityOrCouncilMember = accounts.has(accountId);\n\nconst proposalId = Near.view(daoId, \"get_last_proposal_id\") - 1;\n\n// get data from last proposal\nconst proposal = Near.view(daoId, \"get_proposal\", {\n  id: proposalId,\n});\n\nif (proposal === null) {\n  return \"\";\n}\n\n// check if the potential member submitted last proposal\nconst canJoin =\n  accountId && accountId !== proposal.proposer && !isCommunityOrCouncilMember;\n\nconst Bullet = styled.div`\n  width: fit-content;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 12px;\n  background: rgba(81, 255, 234, 0.20);\n  color: rgba(81, 255, 234, 1);\n  border: 1px solid rgba(81, 255, 234, 0.20);\n  font-family: Satoshi, sans-serif;\n  font-size: 0.875rem;\n  font-weight: 500;\n  border-radius: 8px;\n`;\n\n\nconst Button = styled.a`\n  width: max-content;\n  all: unset;\n  display: flex;\n  padding: 10px 20px;\n  justify-content: center;\n  align-items: center;\n  gap: 4px;\n\n  &:hover {\n    text-decoration: none;\n    color: #000 !important;\n    cursor: pointer;\n    background: var(--Yellow, #ffaf51);\n  }\n\n  border-radius: 8px;\n  background: var(--Yellow, #ffaf51);\n\n  color: var(--black-100, #000);\n\n  /* Other/Button_text */\n  font-size: 14px;\n  font-style: normal;\n  font-weight: 500;\n  line-height: normal;\n\n  @media screen and (max-width: 768px) {\n    flex: 1 1 0;\n  }\n`;\n\nconst Container = styled.div`\n  width: max-content;\n  margin-left: auto;\n\n  @media screen and (max-width: 768px) {\n    margin: 0;\n    width: 100%;\n\n    display: flex;\n    justify-content: center;\n  }\n`;\n\nreturn (\n  <Container>\n    {canJoin ? (\n      <Button href={\"/join\"}>Join Now</Button>\n    ) : <Bullet>Joined</Bullet>}\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/buildhub.near/widget/components.button.join-now", "fact_widget_deployments_id": "956c61fec8dc336d9cfde8557a746d02", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 2}
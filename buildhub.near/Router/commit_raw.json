{"tx_hash": "CV8Cs7DdaXkJWPnjPMVt2nqmQUZXXQhHchrhRk52GCwj", "action_id_social": "CVemaBbpRuNAeYvqtXmzV7zVjATVeFeeK3dbU5uTZ18E-0-widget", "block_id": 117392570, "block_timestamp": "2024-04-22T16:24:25.287Z", "signer_id": "buildhub.near", "widget_name": "Router", "source_code": "const { href } = VM.require(\"buildhub.near/widget/lib.url\") || {\n  href: () => \"/\",\n};\nconst Content = styled.div`\n  width: 100%;\n  height: 100%;\n`;\nfunction findDefaultRoute(routesObject) {\n  const routeKey =\n    routesObject &&\n    Object.keys(routesObject).find((key) => {\n      const route = routesObject[key];\n      return route.default === true;\n    });\n  if (routeKey) {\n    return routesObject[routeKey];\n  } else {\n    return null;\n  }\n}\nfunction Router({ config, ...passProps }) {\n  const { routes, PageNotFound, debug, param } = config;\n  if (!param) param = \"page\";\n  const defaultRoute =\n    findDefaultRoute(routes) ??\n    (routes && Object.keys(routes).length && routes[Object.keys(routes)[0]]);\n  const activeRoute =\n    (routes &&\n      routes.hasOwnProperty(passProps[param]) &&\n      routes[passProps[param]]) ||\n    defaultRoute;\n  if (!PageNotFound) PageNotFound = () => <p>404 Not Found</p>;\n  if (!activeRoute) {\n    // Handle 404 or default case for unknown routes\n    return <PageNotFound />;\n  }\n  // An improvement may be to \"lazy load\", e.g. load all widgets at once and only \"display\" the active one\n  // potentionally add a \"lazy: true\" prop to the route object\n  // for each route, if lazy, load the widget and store it in a map\n  // set display for the active route\n  // we may want to convert this to a widget for that purpose, to manage state?\n  if (debug) {\n    return (\n      <div key={JSON.stringify(activeRoute)}>\n        <pre>{JSON.stringify(activeRoute, null, 2)}</pre>\n        <pre>{JSON.stringify(props, null, 2)}</pre>\n      </div>\n    );\n  } else {\n    return (\n      <Content key={param + JSON.stringify(activeRoute)}>\n        <Widget\n          src={activeRoute.path}\n          props={{ ...activeRoute.init, ...passProps }}\n          loading={<div style={{ height: \"100%\", width: \"100%\" }} />}\n        />\n      </Content>\n    );\n  }\n}\nreturn { Router };\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/buildhub.near/widget/Router", "fact_widget_deployments_id": "0fc028ea11660a9404e1358be301a614", "inserted_timestamp": "2024-04-22T18:38:50.728Z", "modified_timestamp": "2024-04-22T18:38:50.728Z", "__row_index": 0}
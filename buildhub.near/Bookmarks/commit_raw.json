{"tx_hash": "E7rFCo5V78bf2LzUPxNQ8z4gx7hNLBvmWqskW7QLDSMr", "action_id_social": "GT8YASP7Z5HeXo38BX3cRJdXwahpS2kjK6r2oTZCmhBD-0-widget", "block_id": 110096458, "block_timestamp": "2024-01-10T22:22:33.131Z", "signer_id": "buildhub.near", "widget_name": "Bookmarks", "source_code": "const { Post } = VM.require(\"buildhub.near/widget/components\") || (() => <></>);\n\nconst accountId = props.accountId ?? context.accountId;\n\nconst bookmarks = Social.getr(`${accountId}/graph/bookmark`, \"final\", {\n  withBlockHeight: true,\n});\n\nconst StorageKey = \"order\";\nconst order = Storage.privateGet(StorageKey);\nconst apps = useMemo(() => {\n  if (bookmarks === null || order === null) {\n    return [];\n  }\n  const starredApps = new Map();\n  const path = [];\n\n  const buildSrc = (node) => {\n    if (node.hasOwnProperty(\"\")) {\n      starredApps.set(path.join(\"/\"), node[\":block\"]);\n    }\n    Object.entries(node).forEach(([key, value]) => {\n      if (typeof value === \"object\") {\n        path.push(key);\n        buildSrc(value);\n        path.pop();\n      }\n    });\n  };\n\n  buildSrc(bookmarks ?? {}, [], starredApps);\n  let apps = [...starredApps.entries()];\n  apps.sort((a, b) => b[1] - a[1]);\n  apps = apps.map((a) => a[0]);\n  apps.sort((a, b) => (order?.[a] || 0) - (order?.[b] || 0));\n  Storage.privateSet(\n    StorageKey,\n    Object.fromEntries(apps.map((a, i) => [a, i + 1]))\n  );\n  return apps;\n}, [bookmarks, order]);\n\nlet transformedArray = apps.map((item) => {\n  let splitParts = item.split(\"/\");\n  let accountId = splitParts[0];\n  let lastPart = splitParts[splitParts.length - 1];\n  let blockHeight = isNaN(lastPart) ? null : parseInt(lastPart);\n\n  return { accountId, blockHeight };\n});\n\nlet filteredArray = transformedArray.filter(\n  (item) => item.blockHeight !== null\n);\n\nreturn (\n  <>\n    {(filteredArray ?? []).map((item) => (\n      <Post\n        accountId={item.accountId}\n        blockHeight={item.blockHeight}\n        noBorder={true}\n      />\n    ))}\n    {filteredArray.length === 0 && (\n      <p className=\"fw-bold text-white\">No Bookmarks Yet!</p>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/buildhub.near/widget/Bookmarks", "fact_widget_deployments_id": "06f2ceeb7d649d1c3aaf6aca38bf1103", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
{"tx_hash": "2D7DA7RvtMhdHsqMGj21pqt6J6gE8pon5ctj7CV1NhXB", "action_id_social": "2dednauqPtTaZ33Qu3oJ5j9agk7MFdgBmwrGRbXXNeBa-0-widget", "block_id": 111942190, "block_timestamp": "2024-02-02T15:47:46.313Z", "signer_id": "buildhub.near", "widget_name": "components.modals.CreateProposal", "source_code": "const { daos } = VM.require(\"buildhub.near/widget/fetch.daos\") || { daos: [] };\n\nif (!daos) {\n  return \"\";\n}\nconst options = daos.map((dao) => dao.contract_id);\n\nconst { Modal, Button, User } = VM.require(\n  \"buildhub.near/widget/components\"\n) || {\n  Modal: () => <></>,\n  Button: () => <></>,\n  User: () => <></>,\n};\n\nconst showModal = props.showModal;\nconst toggleModal = props.toggleModal;\nconst toggle = props.toggle;\nconst bootstrapTheme = props.bootstrapTheme || \"dark\";\nconst editorCSS = props.editorCSS;\n\nif (!showModal) {\n  return \"\";\n}\n\nconst [selectedDAO, setSelectedDAO] = useState(\n  props.daoId || \"build.sputnik-dao.near\"\n);\nconst [daoName, setDAOName] = useState(\"\");\nconst [selectedOption, setSelectedOption] = useState(\"\");\n\nuseEffect(() => {\n  const name = Social.get(`${selectedDAO}/profile/name`);\n  setDAOName(name);\n}, [selectedDAO]);\n\nconst policy = Near.view(selectedDAO, \"get_policy\") || { roles: [] };\nconst roles = policy.roles.map((item) => item.name) || [];\n\nconst StyledTypeahead = styled.div`\n  input,\n  input:focus,\n  .rbt-input-hint {\n    background: #212529;\n    color: #fff;\n\n    &::placeholder {\n      color: #fff;\n      opacity: 1; /* Firefox */\n    }\n    border: 1px solid #434950;\n  }\n\n  .rbt-input-hint {\n    color: rgba(255, 255, 255, 0.2) !important;\n  }\n\n  .rbt-menu,\n  .dropdown-item {\n    background: #212529;\n    color: #fff;\n  }\n`;\n\nreturn (\n  <Modal\n    open={showModal}\n    title={\"Create Proposal\"}\n    onOpenChange={toggleModal}\n    toggle={toggle}\n    key={`${props.item.path}@${props.item.blockHeight}`}\n  >\n    <div className=\"d-flex align-items-center justify-content-between mb-3\">\n      <div className=\"d-flex flex-column align-items-start\">\n        <p>DAO</p>\n        <User\n          accountId={selectedDAO}\n          name={daoName}\n          showTime={false}\n          hideMenu={true}\n        />\n      </div>\n      <div className=\"d-flex flex-column align-items-start\">\n        <p>Proposer</p>\n        <User accountId={context.accountId} showTime={false} hideMenu={true} />\n      </div>\n    </div>\n\n    <StyledTypeahead className=\"mb-3\">\n      <label htmlFor=\"dao-selector\">DAO Contract ID</label>\n      <Typeahead\n        id=\"dao-selector\"\n        options={options}\n        onChange={(v) => {\n          if (options.includes(v[0])) {\n            setSelectedDAO(v[0]);\n          }\n        }}\n        placeholder=\"Search DAO Contract ID\"\n        defaultSelected={[selectedDAO]}\n      />\n    </StyledTypeahead>\n\n    <div className=\"mb-3\">\n      <label htmlFor=\"proposal-type\">Proposal Type</label>\n      <select\n        name=\"proposal-type\"\n        id=\"proposal-type\"\n        data-bs-theme={bootstrapTheme}\n        class=\"form-select\"\n        onChange={(e) => setSelectedOption(e.target.value)}\n        value={selectedOption}\n      >\n        <option selected value=\"\">\n          Open this select menu\n        </option>\n        <option value=\"text\">Text</option>\n        <option value=\"transfer\">Transfer</option>\n        <option value=\"functionCall\">Function Call</option>\n        <option value=\"addMember\">Add Member To Role</option>\n        <option value=\"removeMember\">Remove Member From Role</option>\n      </select>\n    </div>\n\n    <div className=\"mb-3\">\n      {selectedOption === \"text\" && (\n        <>\n          <Widget\n            src=\"buildhub.near/widget/components.modals.propose.Text\"\n            props={{\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n      {selectedOption === \"transfer\" && (\n        <>\n          <Widget\n            src=\"buildhub.near/widget/components.modals.propose.Transfer\"\n            props={{\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n      {selectedOption === \"functionCall\" && (\n        <>\n          <Widget\n            src=\"buildhub.near/widget/components.modals.propose.FunctionCall\"\n            props={{\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n      {selectedOption === \"addMember\" && (\n        <>\n          <Widget\n            src=\"buildhub.near/widget/components.modals.propose.AddMember\"\n            props={{\n              roles: roles,\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n      {selectedOption === \"removeMember\" && (\n        <>\n          <Widget\n            src=\"buildhub.near/widget/components.modals.propose.RemoveMember\"\n            props={{\n              roles: roles,\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n    </div>\n  </Modal>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/buildhub.near/widget/components.modals.CreateProposal", "fact_widget_deployments_id": "58831fa045fdbd69bcfe9df2b6fd0b57", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
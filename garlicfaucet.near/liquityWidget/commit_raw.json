{"tx_hash": "E87XEJWtb21tRzJWaE1gweDShc6gD56vRyjbc2Q3DUH2", "action_id_social": "AU32ithFzLhrbvqrJZeTB4XMES97bhpDdsiZueqwU9tk-0-widget", "block_id": 95089430, "block_timestamp": "2023-06-26T17:25:55.952Z", "signer_id": "garlicfaucet.near", "widget_name": "liquityWidget", "source_code": "/**\n * @description\n * Only the used functions are defined in the abi objects.\n * The contract address is registered on the Ethereum mainnet.\n *\n * Contract list.\n *   1. troveManage\n */\nconst troveManageABI = [\n  {\n    inputs: [{ internalType: \"address\", name: \"_borrower\", type: \"address\" }],\n    name: \"getTroveStatus\",\n    outputs: [{ internalType: \"uint256\", name: \"\", type: \"uint256\" }],\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n];\n\n/**\n * @description\n * This UI style uses the the \"Styled Component\" library.\n * Update this code block to change the style.\n */\nconst WidgetWrapper = styled.div`\n  margin: 0.5rem 0 0.5rem 0;\n  width: 350px;\n  height: 460px;\n  // border: #755ddf 1px solid;\n  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.2);\n  border-radius: 10px;\n  display: flex;\n  flex-direction: column;\n\n  .tab-wrapper {\n    display: flex;\n    justify-content: flex-start;\n    align-items: flex-end;\n    background-color: black;\n    border-radius: 10px 10px 0 0;\n    // height: 2rem;\n    padding: 0.5rem 0 0 0.5rem;\n  }\n  .tab {\n    // margin: 0 0.5rem 0 0.5rem;\n    border: none;\n    border-radius: 10px 10px 0 0;\n    // font-size: 1.1rem;\n    padding: 0.1rem 0.75rem 0.1rem 0.75rem;\n    font-weight: 500;\n    &.active {\n      background-color: white;\n    }\n    &.disabled {\n      color: white;\n      background-color: #3a0ca3;\n    }\n    &.notHaveTrove {\n      background-color: #343a40 !important;\n      color: white;\n    }\n  }\n  .title {\n    flex: 1 0 0;\n    color: white;\n    height: 100%;\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    font-weight: 700;\n    margin-right: 0.5rem;\n  }\n  .widget-wrapper {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    padding: 1rem 1rem 1rem 1rem;\n    flex: 1 0 0;\n  }\n  .wallet-connect {\n    border: 1px solid #3a0ca3;\n    color: #3a0ca3;\n    &:hover {\n      background-color: #3a0ca3;\n      color: white;\n    }\n  }\n  .open-trove-first {\n    width: 100%;\n    font-size: 1.3rem;\n    font-weight: 600;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n`;\n\nState.init({ selectedTab: \"Borrow\" });\nconst troveManageAddress = \"0xA39739EF8b0231DbFA0DcdA07d7e29faAbCf4bb2\";\nconst troveManageInterface = new ethers.utils.Interface(troveManageABI);\n\n/**\n *\n * @description\n * Check trove status\n * trvoe status = 1 ; already have active trove\n */\nconst troveCheckHandler = () => {\n  const signer = Ethers.provider().getSigner();\n  signer.getAddress().then((address) => {\n    State.update({ address });\n\n    const encodedForTroveCheck = troveManageInterface.encodeFunctionData(\n      \"getTroveStatus\",\n      [address]\n    );\n    Ethers.provider()\n      .call({\n        to: troveManageAddress,\n        data: encodedForTroveCheck,\n      })\n      .then((raw) => {\n        const receiverBalanceHex = troveManageInterface.decodeFunctionResult(\n          \"getTroveStatus\",\n          raw\n        );\n        const result = receiverBalanceHex[0].toString();\n\n        State.update({ troveStatus: result });\n      });\n  });\n};\n\nif (Ethers.provider()) {\n  troveCheckHandler();\n}\n\nreturn (\n  <WidgetWrapper>\n    <div className={`tab-wrapper`}>\n      <button\n        className={`tab ${\n          state.selectedTab === \"Borrow\" ? \"active\" : \"disabled\"\n        }`}\n        onClick={() => {\n          State.update({ selectedTab: \"Borrow\" });\n        }}\n      >\n        Borrow\n      </button>\n      <button\n        className={`tab ${\n          state.selectedTab === \"Manage\" ? \"active\" : \"disabled\"\n        }`}\n        onClick={() => {\n          State.update({ selectedTab: \"Manage\" });\n        }}\n      >\n        Manage\n      </button>\n      <button\n        className={`tab ${\n          state.selectedTab === \"Pay off\" ? \"active\" : \"disabled\"\n        }`}\n        onClick={() => {\n          State.update({ selectedTab: \"Pay off\" });\n        }}\n      >\n        Pay off\n      </button>\n      <div className=\"title\">Liquity</div>\n    </div>\n    <div className={`widget-wrapper`}>\n      {state.address ? (\n        state.selectedTab === \"Borrow\" ? (\n          <Widget src={`garlicfaucet.near/widget/liquityOpenTrove`} />\n        ) : state.selectedTab === \"Manage\" ? (\n          state.troveStatus === \"1\" ? (\n            <Widget src={`garlicfaucet.near/widget/liquityManageTrove`} />\n          ) : (\n            <div className=\"open-trove-first\">Open trove first</div>\n          )\n        ) : state.selectedTab === \"Pay off\" ? (\n          state.troveStatus === \"1\" ? (\n            <Widget src={`garlicfaucet.near/widget/liquityCloseTrove`} />\n          ) : (\n            <div className=\"open-trove-first\">Open trove first</div>\n          )\n        ) : (\n          \"\"\n        )\n      ) : (\n        <Web3Connect\n          className=\"wallet-connect\"\n          connectLabel=\"Wallet Connect First \ud83d\ude09\"\n        />\n      )}\n    </div>\n  </WidgetWrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/garlicfaucet.near/widget/liquityWidget", "fact_widget_deployments_id": "f5c1a287fb73dd43ea9d33a5edcbda7c", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
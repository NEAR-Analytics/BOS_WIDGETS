{"tx_hash": "2NmgsFUZPrK6GGCqxM5Ae8UP29kz1PEKsNqBpPWu4xDb", "action_id_social": "CJkS9gb2ZFnGvfgpxyJ4cExXnEktGVLx4RaEsoFMJFNz-0-widget", "block_id": 119511215, "block_timestamp": "2024-05-22T19:34:59.689Z", "signer_id": "old.potlock.near", "widget_name": "Components.DonorsTrx", "source_code": "const { allDonations, filter } = props;\nconst [currentPage, setCurrentPage] = useState(1);\nconst perPage = 30; // need to be less than 50\nuseEffect(() => {\n  setCurrentPage(1);\n}, [filter]);\nconst nearLogo =\n  \"https://ipfs.near.social/ipfs/bafkreicdcpxua47eddhzjplmrs23mdjt63czowfsa2jnw4krkt532pa2ha\";\nconst { getTimePassed, _address, reverseArr } = VM.require(\n  \"old.potlock.near/widget/Components.DonorsUtils\"\n);\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 2rem;\n  width: 100%;\n  .transcation {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    font-size: 14px;\n    .header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 10px;\n      gap: 1rem;\n      background: #f6f5f3;\n      color: #292929;\n      div {\n        width: 100px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        font-weight: 600;\n      }\n    }\n    .address {\n      width: 143px !important;\n    }\n  }\n  @media only screen and (max-width: 768px) {\n    .transcation {\n      font-size: 12px;\n      .header {\n        padding: 10px 0;\n        div {\n          width: 80px !important;\n        }\n      }\n      .address {\n        width: 80px !important;\n        justify-content: center;\n        .profile-image {\n          display: none !important;\n        }\n      }\n    }\n  }\n  @media only screen and (max-width: 480px) {\n    .transcation {\n      font-size: 9px;\n    }\n  }\n`;\nconst TrRow = styled.div`\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n  gap: 1rem;\n  padding: 20px 10px;\n  > div,\n  > span {\n    width: 100px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  .price {\n    display: flex;\n    gap: 1rem;\n    align-items: center;\n    img {\n      width: 1.5rem;\n    }\n  }\n  .address {\n    color: #292929;\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    border-radius: 2px;\n    transition: all 200ms;\n    .profile-image {\n      width: 2rem;\n      height: 2rem;\n      margin-right: 1rem;\n    }\n  }\n  @media only screen and (max-width: 768px) {\n    padding: 10px 0;\n    > div,\n    > span {\n      width: 80px;\n    }\n    .price {\n      gap: 8px;\n      img {\n        width: 1.25rem;\n      }\n    }\n    .address .profile-image {\n      width: 1.5rem;\n      height: 1.5rem;\n      margin-right: 0.5rem;\n    }\n  }\n  @media only screen and (max-width: 480px) {\n    .price img {\n      width: 1rem;\n    }\n  }\n`;\nconst NoResult = styled.div`\n  font-size: 2rem;\n  text-align: center;\n`;\nconst ProfileImg = ({ address }) => (\n  <Widget\n    src=\"mob.near/widget/ProfileImage\"\n    props={{ accountId: address, style: {} }}\n  />\n);\nconst NEAR_DECEMIALS = 24;\nconst calcNetDonationAmount = (amount, decimals) =>\n  Big(amount).div(Big(`1e${decimals}`));\nreturn allDonations.length ? (\n  <Container>\n    <div className=\"transcation\">\n      <div className=\"header\">\n        <div className=\"address\">Donor</div>\n        <div className=\"address\">Project</div>\n        <div>Amount</div>\n        <div>Date</div>\n      </div>\n      {reverseArr(allDonations)\n        .slice((currentPage - 1) * perPage, currentPage * perPage)\n        .map((donation) => {\n          const {\n            donor_id,\n            recipient_id,\n            donated_at_ms,\n            donated_at,\n            project_id,\n            ft_id,\n            total_amount,\n          } = donation;\n          const projectId = recipient_id || project_id;\n          const isNear = ft_id === \"near\";\n          const frMetaDate = !isNear\n            ? Near.view(ft_id, \"ft_metadata\", {})\n            : null;\n          const assetIcon = isNear ? nearLogo : frMetaDate.icon;\n          const decimals = isNear ? NEAR_DECEMIALS : frMetaDate.decimals;\n          console.log(\"decimals\", decimals);\n          return (\n            <TrRow>\n              <a\n                href={props.hrefWithParams(\n                  `?tab=profile&accountId=${donor_id}`\n                )}\n                className=\"address\"\n                target=\"_blank\"\n              >\n                <ProfileImg address={donor_id} />\n                {_address(donor_id)}\n              </a>\n              <a\n                href={props.hrefWithParams(\n                  `?tab=project&projectId=${projectId}`\n                )}\n                className=\"address\"\n                target=\"_blank\"\n              >\n                <ProfileImg address={projectId} />\n                {_address(projectId)}\n              </a>\n              <div className=\"price\">\n                <img src={assetIcon} alt={ft_id} />\n                {decimals\n                  ? calcNetDonationAmount(total_amount, decimals).toFixed(2)\n                  : \"-\"}\n              </div>\n              <div>{getTimePassed(donated_at_ms || donated_at)} ago</div>\n            </TrRow>\n          );\n        })}\n    </div>\n    <Widget\n      src={\"old.potlock.near/widget/Components.Pagination\"}\n      props={{\n        onPageChange: (page) => {\n          setCurrentPage(page);\n        },\n        data: allDonations,\n        currentPage,\n        perPage: perPage,\n        bgColor: \"#292929\",\n      }}\n    />\n  </Container>\n) : (\n  <NoResult>No Donations</NoResult>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/old.potlock.near/widget/Components.DonorsTrx", "fact_widget_deployments_id": "423b01c9de0a0d8d69538d5c18b00e07", "inserted_timestamp": "2024-05-22T20:51:25.115Z", "modified_timestamp": "2024-05-22T21:51:10.417Z", "__row_index": 1}
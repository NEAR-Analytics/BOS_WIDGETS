{"tx_hash": "2NmgsFUZPrK6GGCqxM5Ae8UP29kz1PEKsNqBpPWu4xDb", "action_id_social": "CJkS9gb2ZFnGvfgpxyJ4cExXnEktGVLx4RaEsoFMJFNz-0-widget", "block_id": 119511215, "block_timestamp": "2024-05-22T19:34:59.689Z", "signer_id": "old.potlock.near", "widget_name": "Pots.Sponsors", "source_code": "// get donations\nconst { potId, potDetail } = props;\nconst { SUPPORTED_FTS } = VM.require(\"old.potlock.near/widget/constants\") || {\n  SUPPORTED_FTS: {},\n};\nconst PotSDK = VM.require(\"old.potlock.near/widget/SDK.pot\") || {\n  getMatchingPoolDonations: () => {},\n};\nlet sponsorshipDonations = PotSDK.getMatchingPoolDonations(potId);\nconst { NEAR } = SUPPORTED_FTS;\nState.init({\n  sponsorshipDonations: null,\n});\nif (sponsorshipDonations && !state.sponsorshipDonations) {\n  // accumulate donations for each address\n  sponsorshipDonations = sponsorshipDonations.reduce(\n    (accumulator, currentDonation) => {\n      accumulator[currentDonation.donor_id] = {\n        amount:\n          parseFloat(accumulator[currentDonation.donor_id].amount || 0) +\n          parseFloat(\n            SUPPORTED_FTS.NEAR.fromIndivisible(currentDonation.net_amount)\n          ),\n        ...currentDonation,\n      };\n      return accumulator;\n    },\n    {}\n  );\n  // add % share of total to each donation\n  const total = SUPPORTED_FTS.NEAR.fromIndivisible(\n    potDetail.matching_pool_balance\n  );\n  sponsorshipDonations = Object.values(sponsorshipDonations).sort(\n    (a, b) => b.amount - a.amount\n  );\n  sponsorshipDonations = sponsorshipDonations.map((donation) => {\n    return {\n      ...donation,\n      percentage_share: ((donation.amount / total) * 100)\n        .toFixed(2)\n        .replace(/[.,]00$/, \"\"),\n    };\n  });\n  State.update({ sponsorshipDonations });\n}\nif (!state.sponsorshipDonations)\n  return <div class=\"spinner-border text-secondary\" role=\"status\" />;\nconst columns = [\"Rank\", \"Donor\", \"Amount\", \"Percentage\"];\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 24px;\n  width: 100%;\n  @media screen and (min-width: 375px) and (max-width: 768px) {\n    width: 99%;\n  }\n  @media screen and (max-width: 390px) {\n    width: 98%;\n  }\n`;\nconst TableContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n  margin-top: 35px;\n  padding-bottom: 1rem;\n`;\nconst { base_currency } = potDetail;\nconst maxRowItemLength = 14;\nreturn (\n  <Container>\n    <Widget\n      src={\"old.potlock.near/widget/Pots.SponsorsBoard\"}\n      props={{\n        ...props,\n        donations: state.sponsorshipDonations.slice(0, 6),\n        base_currency: base_currency,\n      }}\n    />\n    <TableContainer>\n      <Widget\n        src={\"old.potlock.near/widget/Pots.SponsorsTable\"}\n        props={{\n          ...props,\n          sponsors: state.sponsorshipDonations,\n        }}\n      />\n    </TableContainer>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/old.potlock.near/widget/Pots.Sponsors", "fact_widget_deployments_id": "859e0ca411ab7b3c8fae32bd0648d14e", "inserted_timestamp": "2024-05-22T20:51:25.115Z", "modified_timestamp": "2024-05-22T21:51:10.417Z", "__row_index": 1}
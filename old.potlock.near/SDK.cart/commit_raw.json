{"tx_hash": "9zqTVjxAkPtBfjqX2fT5FzifJjSP21C86jFz6qdKKgVy", "action_id_social": "HNSjPxZHjQ2Lff1uQ66xsSN13rddtn5VTT4ywqvZwWUv-0-widget", "block_id": 119511074, "block_timestamp": "2024-05-22T19:32:15.684Z", "signer_id": "old.potlock.near", "widget_name": "SDK.cart", "source_code": "/**\n * Items must have \"id\" and \"price\" properties\n */\nconst CART_KEY = \"cart\";\nconst DEFAULT_CART = {};\nreturn {\n  getCart: () => {\n    const cart = JSON.parse(\n      Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART)\n    );\n    return cart;\n  },\n  getCartItemCount: () => {\n    const cart = JSON.parse(\n      Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART)\n    );\n    return Object.keys(cart).length;\n  },\n  getCartTotal: () => {\n    const cart = JSON.parse(\n      Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART)\n    );\n    let total = 0;\n    Object.values(cart).forEach((item) => {\n      total += item.price;\n    });\n    return total;\n  },\n  addItemsToCart: (items) => {\n    const cart = JSON.parse(\n      Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART)\n    );\n    if (Array.isArray(items)) {\n      items.forEach((item) => {\n        cart[item.id] = item;\n      });\n    } else if (typeof items === \"object\") {\n      cart[items.id] = items;\n    } else {\n      console.log(\"Attempted to add invalid item to cart, item: \", items);\n      return;\n    }\n    Storage.set(CART_KEY, JSON.stringify(cart));\n  },\n  removeItemsFromCart: (items) => {\n    const cart = JSON.parse(\n      Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART)\n    );\n    if (Array.isArray(items)) {\n      items.forEach((item) => {\n        delete cart[item.id];\n      });\n    } else if (typeof items === \"object\") {\n      delete cart[items.id];\n    } else {\n      console.log(\"Attempted to remove invalid item from cart, item: \", items);\n      return;\n    }\n    Storage.set(CART_KEY, JSON.stringify(cart));\n  },\n  clearCart: () => {\n    Storage.set(CART_KEY, JSON.stringify(DEFAULT_CART));\n  },\n  updateItemInCart: (item) => {\n    const cart = JSON.parse(\n      Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART)\n    );\n    if (cart[item.id]) {\n      cart[item.id] = item; // Update the item in the cart directly\n      Storage.set(CART_KEY, JSON.stringify(cart));\n    } else {\n      console.log(\"Item not found in cart:\", item);\n    }\n    console.log(\"cart\", cart);\n  },\n  itemExistsInCart: (item) => {\n    const cart = JSON.parse(\n      Storage.get(CART_KEY) ?? JSON.stringify(DEFAULT_CART)\n    );\n    return cart[item.id] !== undefined;\n  },\n};\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/old.potlock.near/widget/SDK.cart", "fact_widget_deployments_id": "4802ee40578776ccc6b0ba5a56397075", "inserted_timestamp": "2024-05-22T20:51:25.115Z", "modified_timestamp": "2024-05-22T21:51:10.417Z", "__row_index": 1}
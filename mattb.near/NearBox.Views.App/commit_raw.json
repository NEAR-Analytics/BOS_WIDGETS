{"tx_hash": "D5fr4j3N5taxcE2zsCm572Mz8qz7a8Fn9AX23c1jxX5f", "action_id_social": "63Uy1aRBochbVz77HEbt66yNjEhxkwjH7pMqUb662Lnr-0-widget", "block_id": 101580941, "block_timestamp": "2023-09-20T22:30:25.688Z", "signer_id": "mattb.near", "widget_name": "NearBox.Views.App", "source_code": "const { MailChain, onMessageSent, onLogout } = props;\nconst WIDGET_OWNER = \"mattb.near\";\n\nState.init({\n  displayMessage: null,\n  writeMessage: false,\n  dropNft: false,\n  messages: [],\n  messagesLoaded: false,\n});\n\nif (!state.messagesLoaded) {\n  Storage.privateGet(\"messages\");\n\n  setTimeout(() => {\n    State.update({\n      messages: Storage.privateGet(\"messages\") || [],\n      messagesLoaded: true,\n    });\n  }, 200);\n}\n\nconst Main = styled.div`\n    width:100%;\n    height:calc(100vh - 70px);\n    background-color:#fff;\n`;\n\nconst Header = styled.div`\n    display:flex;\n    justify-content:space-between;\n    align-items:center;\n    width:100%;\n    padding:.5rem 1rem;\n    box-sizing:border-box;\n    border-top:5px solid #0178D4;\n    background-color:#fff;\n`;\n\nconst Body = styled.div`\n    display:flex;\n    max-width:1080px;\n    margin:0 auto;\n`;\n\nconst Logout = styled.div`\n  display:flex;\n  align-items:center;\n  font-size:.8rem;\n  padding:.5rem 1rem;\n  background-color:#fafafa;\n  border-radius:10px;\n\n  * {\n    opacity:.6;\n    transition: all .2s;\n\n    :hover {\n      opacity:1;\n      transition: all .2s;\n    }\n  }\n\n  p {\n    margin:0;\n    margin-right:.5rem;\n    font-weight:bold;\n  }\n\n  img {\n    cursor:pointer;\n    width:17px;\n    height:17px;\n  }\n`;\n\nconst MessageCorner = styled.div`\n  position:fixed;\n  bottom:0;\n  right:20px;\n`;\n\nconst NftOverlay = styled.div`\n  position:fixed;\n  width:100%;\n  height:100%;\n  top:0;\n  left:0;\n  z-index:9999;\n`;\n\nconst HeaderWrapper = styled.div`\n  display:flex;\n  justify-content:space-between;\n  align-items:center;\n  width:100%;\n  max-width:1080px;\n  margin: 0 auto;\n  div:first-of-type {\n      transform:scale(.8);\n      transform-origin: center left;\n  }\n`;\n\nreturn (\n  <Main>\n    <Header>\n      <HeaderWrapper>\n        <Widget src={`${WIDGET_OWNER}/widget/NearBox.Components.Logo`} />\n\n        <Logout>\n          <p>{!!MailChain && MailChain.getUserAddress()}</p>\n          <img\n            src=\"https://ipfs.near.social/ipfs/bafkreiem7zs4oxkkgsr2hgret2z2h3fj76kngsbmkdstfijcsyakioklzu\"\n            onClick={() => onLogout({ logged: false })}\n          />\n        </Logout>\n      </HeaderWrapper>\n    </Header>\n    <Body>\n      <Widget\n        src={`${WIDGET_OWNER}/widget/NearBox.Components.Sidebar`}\n        props={{\n          onRefresh: (state) => State.update(state),\n        }}\n      />\n\n      <Widget\n        src={`${WIDGET_OWNER}/widget/NearBox.Components.MessageList`}\n        props={{\n          messages: state.messages,\n          onRefresh: (data) => State.update(data),\n        }}\n      />\n\n      {state.dropNft && (\n        <NftOverlay>\n          <Widget\n            src={`${WIDGET_OWNER}/widget/NearBox.Components.DropNFTModal`}\n            props={{\n              MailChain,\n              onClose: () => State.update({ dropNft: false }),\n            }}\n          />\n        </NftOverlay>\n      )}\n\n      {state.displayMessage && !state.writeMessage && (\n        <MessageCorner>\n          <Widget\n            src={`${WIDGET_OWNER}/widget/NearBox.Components.ReadMessage`}\n            props={{\n              message: state.displayMessage,\n              onRefresh: (refresh) => {\n                State.update(refresh);\n              },\n            }}\n          />\n        </MessageCorner>\n      )}\n\n      {state.writeMessage && (\n        <MessageCorner>\n          <Widget\n            src={`${WIDGET_OWNER}/widget/NearBox.Components.WriteMessage`}\n            props={{\n              MailChain: MailChain,\n              onMessageSent: (message) => {\n                State.update({\n                  messages: [...state.messages, message],\n                });\n                Storage.privateSet(\"messages\", state.messages);\n                onMessageSent();\n              },\n              onRefresh: (refresh) => {\n                State.update(refresh);\n              },\n            }}\n          />\n        </MessageCorner>\n      )}\n    </Body>\n  </Main>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mattb.near/widget/NearBox.Views.App", "fact_widget_deployments_id": "734fe6be571e8bea279bbca62db09263", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "EUq4r6c17mnh31RQ4MNfQztN2HZXjXgcPukSPLU4ihWJ", "action_id_social": "8iUip41Ddepa19c3cv8uRsU2gcK14Cj3Fi9crvD91YEN-0-widget", "block_id": 97119456, "block_timestamp": "2023-07-23T04:34:26.636Z", "signer_id": "mattb.near", "widget_name": "Geoquete.Libs.GeoqueteSDK", "source_code": "const { onLoad, loaded } = props;\n\nconst TOKEN_DECIMALS = 18;\nconst GEOQUETE_CONTRACT_ADDRESS = \"0x3C6DdF92d31E1728C23c062b3C1D552E6eA77137\";\nconst APECOIN_CONTRACT_ADDRESS = \"0x328507DC29C95c170B56a1b3A758eB7a9E73455c\";\nconst GEOQUETE_CONTRACT_ABI = fetch(\n  \"https://raw.githubusercontent.com/paris-geo-hackers/ParisContracts/main/contracts/Game.json\"\n);\n\nconst APECOIN_CONTRACT_ABI = fetch(\n  \"https://raw.githubusercontent.com/paris-geo-hackers/ParisContracts/main/contracts/ApeCoinToken.json\"\n);\n\nconst APECOIN_CONTRACT_METHODS = [\n  \"function increaseAllowance(address spender, uint256 addedValue) public {}\",\n];\n\nconst GEOQUETE_CONTRACT_METHODS = [\"function joinQuest(uint256 _questId) {}\"];\n\nconst iface = new ethers.utils.Interface(GEOQUETE_CONTRACT_ABI.body);\nconst apecoinIface = new ethers.utils.Interface(APECOIN_CONTRACT_ABI.body);\n\nconst GeoqueteSDK = {\n  encode: (method, params) => {\n    return iface.encodeFunctionData(method, params);\n  },\n  decode: (method, rawResponse) => {\n    return iface.decodeFunctionResult(method, rawResponse);\n  },\n  call: (method, params) => {\n    return Ethers.provider().call({\n      to: GEOQUETE_CONTRACT_ADDRESS,\n      data: GeoqueteSDK.encode(method, params),\n    });\n  },\n  listQuests: () => {},\n  getQuest: (questId) => {\n    return GeoqueteSDK.call(\"viewQuest\", [questId]);\n  },\n  createQuest: (quest) => {\n    return GeoqueteSDK.call(\"createQuest\", [\n      quest.questName,\n      quest.location,\n      quest.description,\n      quest.coordinates,\n      quest.numberOfPlayers,\n      quest.questPrize,\n      10,\n    ]);\n  },\n  joinQuest: (questId) => {\n    const contract = new ethers.Contract(\n      GEOQUETE_CONTRACT_ADDRESS,\n      GEOQUETE_CONTRACT_METHODS,\n      Ethers.provider().getSigner()\n    );\n\n    return contract.joinQuest(questId);\n  },\n  submitSolution: (questId, zkProof, ipfsPhotoUrl) => {\n    return GeoqueteSDK.call(\"submitSolution\", [questId, zkProof, ipfsPhotoUrl]);\n  },\n  allowSpend: (amount) => {\n    const contract = new ethers.Contract(\n      APECOIN_CONTRACT_ADDRESS,\n      APECOIN_CONTRACT_METHODS,\n      Ethers.provider().getSigner()\n    );\n\n    return contract.increaseAllowance(GEOQUETE_CONTRACT_ADDRESS, amount);\n  },\n  hexToInteger: (hex) => {\n    return parseInt(hex, 16) / Math.pow(10, TOKEN_DECIMALS);\n  },\n};\n\nif (!!onLoad && typeof onLoad === \"function\" && !loaded) {\n  onLoad(GeoqueteSDK);\n}\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mattb.near/widget/Geoquete.Libs.GeoqueteSDK", "fact_widget_deployments_id": "d2083620c8e5accace8579f57c48646e", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 9}
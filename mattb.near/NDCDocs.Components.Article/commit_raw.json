{"tx_hash": "BGmihFAxEvz71uZ1rZ7tLCE32kSgXJ2FMHWaYEnQqFZm", "action_id_social": "8EUNx9hExWzi37gNN2ReepsxVUS82xEMVUHhBNfkNsJT-0-widget", "block_id": 97413132, "block_timestamp": "2023-07-27T00:09:45.681Z", "signer_id": "mattb.near", "widget_name": "NDCDocs.Components.Article", "source_code": "let { previousArticle, nextArticle } = props;\n\nconst addressForComments = \"NDCDOCS-comments\";\nconst addressForArticles = \"ndcWikiArticle\";\nconst authorForWidget = \"neardigitalcollective.near\";\nconst accountId = props.accountId || context.accountId;\n\nconst lastEditor = props.lastEditor;\nconst blockHeight =\n  props.blockHeight === \"now\" ? \"now\" : parseInt(props.blockHeight);\nconst subscribe = !!props.subscribe;\nconst raw = !!props.raw;\n\nconst path = `${context.widgetSrc}?lastEditor=${lastEditor}&blockHeight=${blockHeight}&subscribe=${subscribe}&raw=${raw}`;\n\nconst notifyAccountId = accountId;\n\nState.init({\n  currentSection: 0,\n  index: null,\n  article: null,\n  showMenu: false,\n});\n\nState.update({\n  article:\n    JSON.parse(\n      Social.get(`${lastEditor}/${addressForArticles}/main`, blockHeight)\n    ) || {},\n});\n\nconst getDate = (timestamp) => {\n  const date = new Date(Number(timestamp));\n  return date.toDateString();\n};\n\nfunction getIndex() {\n  let titles = [];\n\n  state.article.body.split(\"\\n\").map((line, idx) => {\n    if (line[0] === \"#\" && line[1] !== \"#\") {\n      titles = titles.map((title) => {\n        if (title.contentEnd == null) {\n          title.contentEnd = idx - 1;\n        }\n        return title;\n      });\n\n      titles.push({\n        title: line.substring(1, line.length).trim(),\n        contentStart: idx,\n        contentEnd: null,\n      });\n    }\n  });\n\n  State.update({ index: titles });\n}\n\ngetIndex();\n\nconst Main = styled.div`\n    display:flex;\n    position:relative;\n    overflow:hidden;\n`;\n\nconst SideBarWrapper = styled.div`\n  min-width:250px;\n  position:relative;\n  z-index:99999;\n\n  @media screen and (max-width:800px) {\n    position:absolute;\n    left:0;\n    background-color:#fff;\n    display:none;\n  }\n\n  &.show {\n    display:block;\n  }\n`;\n\nconst SideBar = styled.div`\n    display:flex;\n    flex-direction:column;\n    position:fixed;\n    width:250px;\n    height:calc(100vh - 1.5rem);\n    border-right:1px solid rgba(0,0,0,.05);\n    box-sizing:border-box;\n    padding:1.5rem;\n    background-color:#fff;\n\n    @media screen and (max-width:800px) {\n      width:100%;\n    }\n\n    h1 {\n      font-size:1.4rem;\n      font-weight:bold;\n    }\n\n    div:nth-child(1) {\n        flex-grow:1;\n        overflow-y:auto;\n    }\n\n    ul {\n        list-style:none;\n\n        li {\n            cursor:pointer;\n            position:relative;\n\n            a {\n              color:#000;\n            }\n            \n            h2 {\n                font-size:.8rem;\n                padding:.5rem;\n                transition: all .2s;\n            }\n\n            &::after {\n                position:absolute;\n                top:0;\n                bottom:0;\n                left:-10px;\n                margin:auto;\n                content: '';\n                width:5px;\n                height:5px;\n                border-radius:100%;\n                background-color:#E5E5E5;\n                box-shadow: 0 0 0 4px #fff;\n                transition: all .2s;\n            }\n\n            &:not(:last-of-type) {\n                &::before {\n                    content: '';\n                    position:absolute;\n                    width:2px;\n                    height:100%;\n                    left:-8.5px;\n                    background-color:#E5E5E5;\n                    transform:translateY(50%);\n                    \n                }\n            }\n\n            &.selected {\n                h2 {\n                    position:relative;\n                    transition: all .2s;\n                    font-weight:bold;\n                }\n\n                &::after {\n                    transition: all .2s;\n                    width:10px;\n                    height:10px;\n                    left:-12.5px;\n                }\n            }\n        }\n    }\n`;\n\nconst ArticleDetails = styled.div`\n    margin:auto;\n    width:100%;\n    min-height:250px;\n    box-sizing:border-box;\n    border-top: 1px solid rgba(0,0,0,.05);\n    padding: .5rem 0;\n\n    .title {\n        font-size:.8rem;\n        font-weight:bold;\n    }\n\n    p {\n        padding:0;\n        margin:0;\n    }\n\n    .title + p {\n        font-size:.7rem;\n        margin-bottom:10px;\n        padding-bottom:10px;\n        &:not(:last-of-type) {\n            border-bottom: 1px solid rgba(0,0,0,.05);\n        }\n    }\n`;\n\nconst Content = styled.div`\n    flex-grow:1;\n    box-sizing:border-box;\n    padding:2rem;\n    min-height:100vh;\n\n    @media screen and (min-width:800px) {\n      padding:1.2rem;\n    }\n\n    h1 {\n        font-weight:bold;\n    }\n\n    .markdown {\n      position:relative;\n      padding:10px 0;\n\n      .link {\n        cursor:pointer;\n        opacity:0;\n        width:20px;\n        height:20px;\n        position:absolute;\n        top:15px;\n        left:-20px;\n        transition:all .2s;\n      }\n\n      &:hover {\n        .link {\n          opacity:.7;\n          transition:all .2s;\n        }\n      }\n      \n      &:first-of-type {\n        padding-top:0;\n\n        .link {\n          top:5px;\n        }\n      }\n    }\n`;\n\nconst Wrapper = styled.div`\n  max-width:800px;\n  margin:0 auto;\n\n  & > div > img, & > div > p img {\n      display:block;\n      height:400px;\n      border-radius:20px;\n      background-color:rgba(0,0,0,.05);\n      margin:30px auto;\n  }\n\n  h1 {\n    font-size:1.8rem;\n    margin-bottom:13px;\n\n    &:first-of-type {\n      margin-top:0;\n    }\n  }\n\n  h4 {\n    font-size:1.2rem;\n  }\n\n`;\n\nconst Controls = styled.div`\n  width:100%;\n  display:flex;\n  justify-content:space-between;\n`;\n\nconst ControlButton = styled.a`\n  display:flex;\n  cursor:pointer;\n  align-items:center;\n  justify-content:center;\n  flex-wrap:wrap;\n  width:250px;\n  height:100px;\n  border-radius:10px;\n  background-color:rgba(0,0,0,.05);\n  border: 1px solid rgba(0,0,0,.05);\n  box-sizing:border-box;\n  padding:1rem;\n  margin-top:20px;\n  transition: all .2s;\n  color:inherit;\n\n  &:not(:last-of-type) {\n    margin-right:20px;\n  }\n\n  * {\n    opacity: .6;\n    transition: all .2s;\n  }\n\n  &:hover {\n    box-shadow:0 0 0 5px rgba(0,0,0,.02);\n\n    * {\n      opacity: .8;\n      transition: all .2s;\n    }\n  }\n\n  &.previous {\n\n    div:nth-child(1) {\n      transform:rotate(180deg);\n    }\n\n    div + div {\n      flex-grow:1;\n      text-align:right;\n\n      p {\n        padding:0;\n        margin:0;\n      }\n\n      & p:nth-child(1) {\n        font-size:.8rem;\n      }\n\n      & p:nth-child(2) {\n        font-weight:bold;\n      }\n\n    }\n\n  }\n\n  &.next {\n    flex-direction:row-reverse;\n\n    div + div {\n      flex-grow:1;\n      text-align:left;\n\n      p {\n        padding:0;\n        margin:0;\n      }\n\n      & p:nth-child(1) {\n        font-size:.8rem;\n      }\n\n      & p:nth-child(2) {\n        font-weight:bold;\n      }\n\n    }\n\n  }\n`;\n\nconst Header = styled.div`\n  display:none;\n  position:relative;\n  box-sizing:border-box;\n  padding:1rem;\n  align-items:center;\n  background-color:rgba(0,0,0,.02);\n\n  > p {\n    margin:0;\n    padding:0;\n    margin-left:10px;\n    font-weight:bold;\n  }\n\n  @media screen and (max-width:800px) {\n    display:flex;\n  }\n`;\n\nconst MenuButton = styled.div`\n    cursor:pointer;\n    width:40px;\n    height:40px;\n    border-radius:10px;\n    background-color:rgba(0,0,0,.05);\n    background-image:url(https://ipfs.near.social/ipfs/bafkreiexzn4c2sc53i5k5u7zaazdkf6j2zhzvifsxp7skcucwaxm46aggi);\n    background-position:center;\n    background-repeat:no-repeat;\n    background-size:20px 20px;\n    transition: all .2s;\n    border: 2px solid rgba(0,0,0,.0);\n\n    &:hover {\n        transition: all .2s;\n        box-shadow: 0 0 10px 5px rgba(0,0,0,.02);\n        border: 2px solid rgba(0,0,0,.02);\n    }\n\n`;\n\nreturn (\n  <>\n    <Header>\n      <MenuButton\n        onClick={() => State.update({ showMenu: !state.showMenu })}\n      ></MenuButton>\n      <p>NDCDocs</p>\n    </Header>\n    <Main>\n      <SideBarWrapper className={state.showMenu ? \"show\" : \"\"}>\n        <SideBar>\n          <div>\n            <h1>{state.article.articleId}</h1>\n            <ul>\n              {state.index.map((obj, key) => (\n                <li\n                  onClick={() => State.update({ currentSection: key })}\n                  className={key === state.currentSection ? \"selected\" : \"\"}\n                >\n                  <a href={`#${obj.contentStart}`}>\n                    <h2>{obj.title}</h2>\n                  </a>\n                </li>\n              ))}\n            </ul>\n          </div>\n          <ArticleDetails>\n            <p className=\"title\">Published by</p>\n            <p>@{state.article.author}</p>\n            <p className=\"title\">Last edit by</p>\n            <p>@{state.article.lastEditor}</p>\n            <p className=\"title\">Modified on</p>\n            <p>{getDate(state.article.timeLastEdit)}</p>\n            <p className=\"title\">Version</p>\n            <p>#{state.article.version}</p>\n          </ArticleDetails>\n        </SideBar>\n      </SideBarWrapper>\n      <Content>\n        <Wrapper>\n          {state.index.map((content) => (\n            <div id={content.contentStart} className=\"markdown\">\n              <div\n                className=\"link\"\n                onClick={() =>\n                  clipboard.writeText(`${path}#${content.contentStart}`)\n                }\n              >\n                \ud83d\udd17\n              </div>\n              <Markdown\n                text={state.article.body\n                  .split(\"\\n\")\n                  .slice(\n                    content.contentStart,\n                    content.contentEnd || state.article.body.split(\"\\n\").length\n                  )\n                  .join(\"\\n\")}\n              />\n            </div>\n          ))}\n          {(previousArticle || nextArticle) && (\n            <Controls>\n              {previousArticle && (\n                <ControlButton href={previousArticle.link} className=\"previous\">\n                  <div>\n                    <img\n                      src=\"https://ipfs.near.social/ipfs/bafkreigygnp234eyi5ljtxf7czp5emmhihjxitbl6e4zzuol3wgxsvkhcu\"\n                      style={{\n                        maxWidth: \"20px\",\n                        maxHeight: \"20px\",\n                      }}\n                    />\n                  </div>\n                  <div>\n                    <p>Previous</p>\n                    <p>{previousArticle.title}</p>\n                  </div>\n                </ControlButton>\n              )}\n              {nextArticle && (\n                <ControlButton href={nextArticle.link} className=\"next\">\n                  <div>\n                    <img\n                      src=\"https://ipfs.near.social/ipfs/bafkreigygnp234eyi5ljtxf7czp5emmhihjxitbl6e4zzuol3wgxsvkhcu\"\n                      style={{\n                        maxWidth: \"20px\",\n                        maxHeight: \"20px\",\n                      }}\n                    />\n                  </div>\n                  <div>\n                    <p>Next</p>\n                    <p>{nextArticle.title}</p>\n                  </div>\n                </ControlButton>\n              )}\n            </Controls>\n          )}\n        </Wrapper>\n      </Content>\n    </Main>\n  </>\n);\n", "metadata": {"platform": "nearpad"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mattb.near/widget/NDCDocs.Components.Article", "fact_widget_deployments_id": "cfbc1f67e98a65ef8d4e2f46dcfc687a", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 24}
{"tx_hash": "292TbkUEUPLPfE7tV9dsxs1B8qo4F5sxXS5tvntAsBEE", "action_id_social": "JDcFPmVehYWdmsqZLZYh6XrG2Q8qwUfdHan9wb9azngt-0-widget", "block_id": 114036390, "block_timestamp": "2024-03-03T21:27:23.157Z", "signer_id": "mattb.near", "widget_name": "NearBadger.Libs.Farcaster", "source_code": "const FarcasterVerifier = VM.require(\n  \"sdks.near/widget/SDKs.Verifiers.FarcasterVerifier\"\n);\n\nconst FarcasterAPI = VM.require(\"sdks.near/widget/SDKs.Farcaster.FarcasterAPI\");\n\nconst FarcasterLib = {\n  createProof: (handle, address, nearAccount, onCommit, onCancel) => {\n    FarcasterVerifier.createProof(handle, address, nearAccount)\n      .then(({ handle, signature }) => {\n        let identity = {\n          farcaster: {\n            name: handle,\n            signature,\n          },\n        };\n\n        Social.set(\n          {\n            identity,\n            index: {\n              identity: JSON.stringify({\n                key: \"farcaster\",\n                value: {\n                  ...identity.farcaster,\n                },\n              }),\n            },\n          },\n          {\n            onCommit: () => {\n              if (typeof onCommit === \"function\") {\n                onCommit(handle);\n              }\n            },\n            onCancel,\n          }\n        );\n      })\n      .catch((error) => {\n        console.error(error);\n        if (typeof onCancel === \"function\") {\n          onCancel();\n        }\n      });\n  },\n  verify: (handle, nearAccount, signature) =>\n    FarcasterVerifier.verify(handle, nearAccount, signature),\n  listRecentlyVerifiedProfiles: (options) => {\n    return FarcasterLib.getIdentity({\n      limit: 5,\n      ...options,\n    });\n  },\n  getVerifiedProfiles: (nearAccounts) => {\n    return FarcasterLib.getIdentity({\n      accountId: nearAccounts,\n    });\n  },\n  getVerifiedProfile: (nearAccount) => {\n    return FarcasterLib.getIdentity({\n      accountId: nearAccount,\n      limit: 1,\n    });\n  },\n  getIdentity: (options) => {\n    return Social.index(\"identity\", \"farcaster\", {\n      order: \"desc\",\n      ...options,\n    });\n  },\n  getAddressesByHandle: (handle) => {\n    return FarcasterAPI.getHandleOwner(handle);\n  },\n};\n\nreturn FarcasterLib;\n", "metadata": {"platform": "jutsu.ai"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/mattb.near/widget/NearBadger.Libs.Farcaster", "fact_widget_deployments_id": "023e95392cc4c726be08c71dca5ae0d6", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
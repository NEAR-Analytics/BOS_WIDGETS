{"tx_hash": "67KvELt7yxmh5edT8Jn4dnKMgYUNm4SnBbcgzkD9hkWF", "action_id_social": "77fS3q2yukWAbvf6LP7HdwgtFQmL2eNTdTfm132tstyF-0-widget", "block_id": 109846460, "block_timestamp": "2024-01-07T21:04:13.746Z", "signer_id": "mattb.near", "widget_name": "NearBadger.Libs.Lens", "source_code": "const LensVerifier = VM.require(\"mattb.near/widget/SDKs.Verifiers.Lens\");\n\nconst LensLib = {\n  createProof: (address, nearAccount, onCommit, onCancel) => {\n    LensVerifier.createProof(address, nearAccount)\n      .then(({ handle, signature }) => {\n        let identity = {\n          lens: {\n            name: handle,\n            signature,\n          },\n        };\n\n        Social.set(\n          {\n            identity,\n            index: {\n              identity: JSON.stringify({\n                key: \"lens\",\n                value: {\n                  ...identity.lens,\n                },\n              }),\n            },\n          },\n          {\n            onCommit: () => {\n              if (typeof onCommit === \"function\") {\n                onCommit(handle);\n              }\n            },\n            onCancel,\n          }\n        );\n      })\n      .catch((error) => {\n        console.error(error);\n        if (typeof onCancel === \"function\") {\n          onCancel();\n        }\n      });\n  },\n  verify: (handle, nearAccount, signature) =>\n    LensVerifier.verify(handle, nearAccount, signature),\n  listRecentlyVerifiedProfiles: (options) => {\n    return LensLib.getIdentity({\n      limit: 5,\n      ...options\n    });\n  },\n  getVerifiedProfiles: (nearAccounts) => {\n    return LensLib.getIdentity({\n      accountId: nearAccounts,\n    });\n  },\n  getVerifiedProfile: (nearAccount) => {\n    return LensLib.getIdentity({\n      accountId: nearAccount,\n      limit: 1,\n    });\n  },\n  getIdentity: (options) => {\n    return Social.index(\"identity\", \"lens\", {\n      order: \"desc\",\n      ...options,\n    });\n  },\n};\n\nreturn LensLib;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mattb.near/widget/NearBadger.Libs.Lens", "fact_widget_deployments_id": "b6fdf6b22bc71c0a4e832eff0876824c", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 6}
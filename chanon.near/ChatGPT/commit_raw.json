{"tx_hash": "4PqmjzHMWRQd48zpuDVcEvxeGWsDJFKhc8vy5tWUHPWq", "action_id_social": "EQomGb2riGYtcuBrAuGUNH8c3LfnHYEeeSanMqcy4XG7-0-widget", "block_id": 100741837, "block_timestamp": "2023-09-09T14:36:25.211Z", "signer_id": "chanon.near", "widget_name": "ChatGPT", "source_code": "// handle only ask once\n// handle waiting process to display\n\nState.init({\n  apiKey: \"\",\n  displayNums: [],\n  lastNumber: 0,\n});\n\nconst queryURI = \"https://api.openai.com/v1/chat/completions\";\nconst token = \"Bearer \";\nconst data = {\n  model: \"gpt-3.5-turbo\",\n  messages: [\n    {\n      role: \"user\",\n      content: \"plan a 30days trip to usa\",\n    },\n  ],\n  temperature: 1,\n  top_p: 1,\n  n: 1,\n  stream: false,\n  max_tokens: 100,\n  presence_penalty: 0,\n  frequency_penalty: 0,\n};\nconst fetchAskChatGPT = (queryURI) => {\n  console.log(token + apiKey);\n  return asyncFetch(queryURI, {\n    method: \"POST\",\n    headers: {\n      Authorization: token + state.apiKey,\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(data),\n  });\n};\n\nconst handleAskChatGPT = () => {\n  fetchAskChatGPT(queryURI).then((res) => {\n    // console.log(res);\n    console.log(res.body.choices[0].message.content);\n  });\n};\n\nconst allNumbers = Array.from(Array(1000).keys());\n\nconst loadNumbers = (page) => {\n  allNumbers\n    .slice(state.lastNumber, state.lastNumber + 10)\n    .map((n) => numberToElem(n))\n    .forEach((i) => state.displayNums.push(i));\n  state.lastNumber += 10;\n  State.update();\n  console.log(\"loading more ...\");\n};\n\nconst numberToElem = (number) => <div> {number} </div>;\n\nreturn (\n  <div>\n    <input\n      value={state.apiKey}\n      onChange={(e) => State.update({ apiKey: e.target.value })}\n      placeholder=\"Please paste your chatgpt api key\"\n    />\n\n    <button class=\"btn btn-success\" onClick={handleAskChatGPT} disabled={false}>\n      Ask ChatGPT\n    </button>\n\n    <InfiniteScroll\n      loadMore={loadNumbers}\n      hasMore={state.displayNums.length < allNumbers.length}\n    >\n      {state.displayNums}\n    </InfiniteScroll>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/chanon.near/widget/ChatGPT", "fact_widget_deployments_id": "be74fc06080bc3c752775ba7418bdf6a", "inserted_timestamp": "2023-09-09T16:34:17.749Z", "modified_timestamp": "2023-09-09T16:34:17.749Z", "__row_index": 1}
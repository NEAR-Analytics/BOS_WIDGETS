{"tx_hash": "9aayD25njK3BjNmTja6ALCfAabKoFFw2rk7uPZjfM8JU", "action_id_social": "6H9jSQr8CgKAbxMZcxVBDN4Jdv8YMpPWG7VHiaqZwNoD-0-widget", "block_id": 105928867, "block_timestamp": "2023-11-17T21:42:55.245Z", "signer_id": "ramgor.near", "widget_name": "PrizePickerW3V0.2", "source_code": "const contract = \"guest-book.near\";\nconst relayerAccountId = \"relayer.pagodaplatform.near\";\nconst messages = Near.view(contract, \"getMessages\", undefined, undefined, true)\n  .reverse()\n  .filter((message) => message.sender === context.accountId);\n\nState.init({\n  newMessage: \"\",\n  inFlightMessage: \"\",\n});\n\nconst addNewMessage = () => {\n  if (state.newMessage.trim() == \"\") {\n    return;\n  }\n\n  Near.call(contract, \"addMessage\", {\n    text: state.newMessage,\n  });\n\n  State.update({\n    newMessage: \"\",\n  });\n};\n\nconst userAccountStatus = fetch(\"https://rpc.mainnet.near.org\", {\n  method: \"POST\",\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n  body: JSON.stringify({\n    jsonrpc: \"2.0\",\n    id: \"dontcare\",\n    method: \"query\",\n    params: {\n      request_type: \"view_account\",\n      finality: \"final\",\n      account_id: context.accountId,\n    },\n  }),\n});\n\nconst relayerAccountStatus = fetch(\"https://rpc.mainnet.near.org\", {\n  method: \"POST\",\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n  body: JSON.stringify({\n    jsonrpc: \"2.0\",\n    id: \"dontcare\",\n    method: \"query\",\n    params: {\n      request_type: \"view_account\",\n      finality: \"final\",\n      account_id: relayerAccountId,\n    },\n  }),\n});\n\nconst nearAmount = (yocto) => (parseInt(yocto) / Math.pow(10, 24)).toFixed(2);\n\nconst StyledContainer = styled.div`\n  border-radius: 10px;\n  padding: 40px;\n\n  .wrapper {\n    max-width: 850px;\n    margin: 0 auto;\n  }\n\n  a,\n  textarea {\n    display: block;\n  }\n\n  h1 {\n    margin: 40px 0;\n    font-weight: bold;\n  }\n\n  h4 {\n    font-weight: normal;\n    line-height: 150%;\n  }\n\n  .relayer-balance {\n    color: inherit;\n    border: 1px solid #000;\n    border-radius: 8px;\n    padding: 10px 20px;\n    width: fit-content;\n    font-size: 12px;\n    margin: 40px auto;\n  }\n\n  .your-balance {\n    font-size: 14px;\n    color: #3e3e3e;\n  }\n\n  textarea {\n    width: 100%;\n    border-radius: 8px;\n    padding: 20px;\n    border: 1px solid #d6d6d6;\n    margin: 20px 0;\n    font-size: 16px;\n    placeholder {\n      color: #818181;\n    }\n    :focus {\n      border: 1px solid #61e5e2;\n      outline: none;\n    }\n  }\n\n  button {\n    color: white;\n    background-color: #000000;\n    border-radius: 8px;\n    padding: 14px 24px;\n    border: none;\n    font-size: 16px;\n    margin-left: auto;\n    display: block;\n    :hover {\n      color: white;\n      background-color: #000000;\n    }\n  }\n\n  .messages {\n    margin: 40px 0;\n    ul {\n      list-style: none;\n      margin: 0;\n      padding: 0;\n    }\n\n    li {\n      margin: 20px 0;\n      padding: 0;\n      background-color: #61e5e2;\n      border-radius: 40px;\n      padding: 10px 20px;\n      color: #000000;\n      width: fit-content;\n      font-size: 14px;\n    }\n  }\n\n  .view-txs-btn {\n    color: black;\n    font-size: 14px;\n    border: 1px solid #000;\n    width: fit-content;\n    border-radius: 8px;\n    padding: 10px 20px;\n  }\n\n  .learn-more-links-wrapper {\n    display: flex;\n    align-items: center;\n    margin: 15px 0;\n\n    :first-of-type {\n      margin-top: 0;\n    }\n  }\n\n  .learn-more-links {\n    color: black;\n    text-decoration: underline;\n    font-size: 22px;\n  }\n\n  .in-flight {\n        animation: shimmer 1s infinite alternate;\n\n        @keyframes shimmer {\n        0% {\n            opacity: 1;\n        }\n        100% {\n            opacity: 0.2;\n        }\n    }\n}\n\n.disclaimer {\n    a {\n        color: #61e5e2;\n        display: inline;\n    }\n}\n`;\n\nreturn (\n  <StyledContainer>\n    <div className=\"wrapper\">\n      <h2> Bienvenidos al sorteo </h2>\n      <div className=\"your-balance\">\n        Tu Saldo: N.{nearAmount(userAccountStatus.body.result.amount)}\n      </div>\n      <textarea\n        name=\"\"\n        id=\"\"\n        cols=\"30\"\n        rows=\"5\"\n        placeholder=\"Lista de participantes, el ganador es publicado en el contrato guest book...\"\n        value={state.newMessage}\n        onChange={(e) => State.update({ newMessage: e.target.value })}\n      ></textarea>\n      <button\n        onClick={() => {\n          State.update({\n            inFlightMessage: state.newMessage,\n          });\n          addNewMessage();\n        }}\n      >\n        Ganador\n      </button>\n      <div className=\"messages\">\n        Ganador\n        {state.inFlightMessage &&\n          !messages\n            .map((data) => data.text)\n            .includes(state.inFlightMessage) && (\n            <ul className=\"in-flight\">\n              <li>{state.inFlightMessage}</li>\n            </ul>\n          )}\n        <ul>\n          Ultimos Ganadores\n          {messages.map((data, key) => {\n            return <li key={key}>{data.text}</li>;\n          })}\n        </ul>\n      </div>\n\n      <h1>Gracias Por participar</h1>\n    </div>\n  </StyledContainer>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/ramgor.near/widget/PrizePickerW3V0.2", "fact_widget_deployments_id": "c62c2048f64b5b47cd91411e71109627", "inserted_timestamp": "2023-11-17T23:35:17.178Z", "modified_timestamp": "2023-11-17T23:35:17.178Z", "__row_index": 1}
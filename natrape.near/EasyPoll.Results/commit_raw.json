{"tx_hash": "HRvLRa47ZRKVFTYyYjSnkWAAr4qnAFAKxcux8hDEDG7E", "action_id_social": "4FP3fCMuez7hgonDntn6bk9i84qz5ZBqjpjdiJHnAu3m-0-widget", "block_id": 98595661, "block_timestamp": "2023-08-11T22:12:26.413Z", "signer_id": "natrape.near", "widget_name": "EasyPoll.Results", "source_code": null, "metadata": null, "branch": {"draft": {"": "const widgetOwner = props.widgetOwner ?? \"easypoll-v0.ndc-widgets.near\";\nconst src =\n  \"chloe.near/easypoll-4.0.0/official/8d2a0277cc1f8lkovkbose5fdf9b0c915\";\nconst accountId = props.accountId ?? context.accountId;\nconst blockHeight = props.blockHeight ?? \"final\";\nconst indexVersion = props.indexVersion ?? \"4.0.0\";\n\nif (!src) {\n  return \"Please provide poll src\";\n}\n\nconst poll = Social.get(`${src}`, blockHeight);\n\nif (!poll) {\n  return \"\";\n}\n\npoll = JSON.parse(poll);\npoll.accountId = src.split(\"/\")[0];\n\nconst formatData = (input) => {\n  let columns = poll.questions.map((v) => {\n    return {\n      title: v.title,\n    };\n  });\n\n  columns = [{ title: \"User\" }, ...columns];\n  let data = input.map((v) => {\n    let items = Object.values(v.value.answers);\n    items = items.map((v) => {\n      if (Array.isArray(v)) {\n        return v.join(\" - \");\n      }\n      return v;\n    });\n    return [v.accountId, ...items];\n  });\n\n  return {\n    input,\n    columns,\n    data,\n  };\n};\n\nconst Component = ({ data }) => {\n  if (!state) {\n    State.init({ ...formatData(data) });\n  }\n  return (\n    <>\n      <Widget\n        src={`${widgetOwner}/widget/EasyPoll.Data.Table`}\n        props={{\n          columns: state.columns,\n          data: state.data,\n          title: \"Results for: \" + poll.title,\n        }}\n      />\n    </>\n  );\n};\n\nreturn (\n  <Widget\n    src={`${widgetOwner}/widget/EasyPoll.Data.GetAnswers`}\n    props={{\n      src,\n      indexVersion,\n      poll,\n      children: Component,\n      loading: () => \"Loading..\",\n      blocking: true,\n    }}\n  />\n);\n\n//https://near.social/mob.near/widget/WidgetSource?src=y3k.near/widget/pieChartSVG#/y3k.near/widget/pieChartSVG\n//near.social/edit/#/natrape.near/widget/pieChartSVG\nreturn (\n  <Widget\n    src=\"y3k.near/widget/pieChartSVG\"\n    props={{\n      columns: state.columns,\n      data: state.data,\n      title: \"Results for: \" + poll.title,\n    }}\n  />\n);\n"}}, "widget_modules_used": null, "widget_url": "https://near.social/#/natrape.near/widget/EasyPoll.Results", "fact_widget_deployments_id": "0c9b493728ce6289376a89be5052376d", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
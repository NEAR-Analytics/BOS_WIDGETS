{"tx_hash": "5NWgJ6qNJeVTXt5HvcvgCtf9eCEQHxsJrL66DYpcLkQF", "action_id_social": "2Dn9GSj46z6EPDczQHba6NcPoGQxSQnZU9xZ1bwFbkry-0-widget", "block_id": 89824104, "block_timestamp": "2023-04-17T23:20:14.558Z", "signer_id": "dorgon108.near", "widget_name": "SearchPost", "source_code": "// Original widget: https://alpha.near.org/#/calebjacob.near/widget/Posts.Post\nconst accountId = props.accountId ?? context.accountId;\nconst blockHeight = props.blockHeight ?? \"now\";\nconst snipContent = props.snipContent ?? false;\nconst snippetMaxWords = props.snippetMaxWords ?? 40;\nlet content = props.content;\nif (content?.text && snippet) {\n  const text = content.text.split(\" \");\n  content.text = text.slice(0, snippetMaxWords);\n  if (text.length >= snippetMaxWords) {\n    content.text.push(props.snippedEnd ?? \"...\");\n  }\n  content.text = content.text.join(\" \");\n}\nconst key = props.key ?? JSON.stringify(content);\nconst postType = props.postType ?? \"post\";\nconst postBlockHeight =\n  postType === \"post\" ? \"blockHeight\" : \"commentBlockHeight\";\nconst postUrl = `https://alpha.near.org/#/adminalpha.near/widget/PostPage?accountId=${accountId}&${postBlockHeight}=${blockHeight}`;\nconst onClick =\n  props.onClick ??\n  (() => {\n    if (props.debug) {\n      console.log(`clicked on post: ${postUrl}`);\n    }\n  });\n\nconst highlightWordInParagraph = (paragraph, word, charLimit) => {\n  console.log(\"the word is \", word);\n  console.log(\"before:\", paragraph);\n\n  paragraph = paragraph.replace(/\\n/g, \"\");\n  console.log(\"after:\", paragraph);\n  const words = paragraph.split(\" \");\n  const wordIndex = words.indexOf(word);\n  console.log(\"the word index is\", wordIndex);\n  if (wordIndex === -1) {\n    return paragraph;\n  }\n\n  const startIndex = Math.max(wordIndex - 3, 0);\n  const endIndex = Math.min(wordIndex + 2, words.length - 1);\n\n  let newParagraph = \"\";\n  let currentLength = 0;\n\n  for (let i = startIndex; i <= endIndex; i++) {\n    const wordToAdd = i === endIndex ? words[i] + \"...\" : words[i] + \" \";\n    const wordToAddLength = wordToAdd.length;\n\n    if (currentLength + wordToAddLength <= charLimit) {\n      newParagraph += wordToAdd;\n      currentLength += wordToAddLength;\n    } else {\n      break;\n    }\n  }\n\n  return newParagraph;\n};\n\nconst Post = styled.a`\n  display: flex;\n  overflow: hidden;\n  flex-direction: row;\n  align-items: center;\n  width: 100%;\n  height: 45px;\n  overflow:hidden;\n  gap:16px;\n  margin:10px;\n\n  \n`;\nconst Header = styled.div`\n  display: flex;\n  align-items: center;\n  flex: 1;\n\n  img {\n    height:24px\n  }\n\n`;\nconst Body = styled.div`\n  align-items: center;\n  flex: 1;\n  font-size:12px\n  \n`;\nconst Content = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 2px;\n  \n`;\n\nconst ButtonLink = styled.a`\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n  background: none;\n  border: none;\n  outline: none;\n  cursor: pointer;\n\n  img {\n    width: 24px;\n    height: 24px;\n  }\n\n  &:hover,\n  &:focus {\n    text-decoration: none;\n    outline: none;\n  }\n`;\n\nconst Text = styled.p`\n  display: block;\n  font-size: 12px;\n  line-height: 20px;\n  font-weight: 400;\n  color: #687076;\n  white-space: nowrap;\n  \n`;\n\nreturn (\n  <Post href={postUrl} onPointerUp={onClick}>\n    <Header>\n      <Widget\n        src=\"adminalpha.near/widget/AccountProfile\"\n        props={{\n          accountId,\n          hideAccountId: true,\n        }}\n      />\n    </Header>\n\n    <Body>\n      {console.log(\"the text is:\", content.text)}\n      {content.text && (\n        <Widget\n          src=\"dorgon108.near/widget/SocialMarkdown\"\n          props={{\n            text: highlightWordInParagraph(content.text, props.term, 10),\n          }}\n        />\n      )}\n      {content.image && (\n        <Widget\n          src=\"mob.near/widget/Image\"\n          props={{\n            image: content.image,\n          }}\n        />\n      )}\n    </Body>\n    <ButtonLink href={postUrl} onPointerUp={onClick}>\n      <img src=\"https://i.imgur.com/dIDX59g.png\" alt=\"Open\" />\n    </ButtonLink>\n  </Post>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/dorgon108.near/widget/SearchPost", "fact_widget_deployments_id": "25a3a57d59ea671a281b7d048c55fa86", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 47}
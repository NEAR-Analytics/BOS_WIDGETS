{"tx_hash": "EiavrNYrKocNb5gNPwgoNc3fqJ3jWeNAS3k5VNZZ41vX", "action_id_social": "5xUVJmAMWX8KoUa6H6uB2WYAGNDknvDxqw9iEzmzKb8t-0-widget", "block_id": 98105396, "block_timestamp": "2023-08-05T04:41:15.982Z", "signer_id": "duocelot.near", "widget_name": "Voyager_AI", "source_code": "const accountId = context.accountId;\n\n<Widget src=\"duocelot.near/widget/error_001\" />;\n\ninitState({\n  img: {},\n  imgRaw: null,\n  prompt:\n    \"a landscape mythical, clouds, sunset, sunrays, flare, 8k photorealistic, watercolor, cinematic lighting, HD, high details, atmospheric\",\n  seed: null,\n  rollImg:\n    \"https://ipfs.fleek.co/ipfs/bafybeih7tutznkvbuecy3nfmpwo7q5w7kzyqwdvlipjtcyqevnkpz2jf44\",\n  blur: 0,\n  width: \"auto\",\n  scale: 7,\n  steps: 20,\n});\n\nasync function uploadImageToIpfs() {\n  const response = await fetch(state.imgRaw);\n  const blob = await response.blob();\n  const formData = new FormData();\n  formData.append(\"file\", blob);\n\n  const ipfsResponse = await fetch(\"https://ipfs.near.social/add\", {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n    },\n    body: formData,\n  });\n\n  const ipfsData = await ipfsResponse.json();\n  console.log(ipfsData);\n}\n\nfunction rollImage() {\n  var seed = Math.trunc(Math.random() * 100000000);\n  state.seed = seed;\n  state.blur = 3;\n  State.update(state);\n\n  var imgSrc = `https://i.gpux.ai/gpux/sdxl?return_grid=true&prompt=${state.seed}&scale=${state.scale}&image_count=1&steps=20&prompt=${state.prompt}`;\n\n  // Instead of uploading to IPFS right away, save the generated image to the state\n  state.imgRaw = imgSrc;\n  State.update(state);\n}\n\nfunction deleteImage() {\n  state.imgRaw = null;\n  State.update(state);\n}\n\nfunction uploadImageToIpfs() {\n  asyncFetch(\"https://ipfs.near.social/add\", {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n    },\n    body: state.imgRaw,\n  })\n    .then((res) => {\n      const cid = res.body.cid;\n      console.log(res.body);\n    })\n    .catch((error) => {\n      console.error(\"Error:\", error);\n    });\n}\n\nreturn (\n  <div\n    style={{\n      width: \"100%\",\n      height: \"100%\",\n      background: \"linear-gradient(to right, black, #3a0201, black)\",\n      backgroundSize: \"100% 100%\",\n      backgroundPosition: \"center\",\n      position: \"relative\",\n      overflow: \"hidden\",\n      zIndex: 0,\n    }}\n  >\n    <div style={{ width: \"100%\" }}>\n      <div\n        style={{\n          backgroundImage:\n            \"url(https://ipfs.fleek.co/ipfs/bafybeihafj7gtw6jrwxb5xjyk22hy642hgwn2rjqguarkpvun5myovtb5i)\",\n          backgroundSize: \"auto\",\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\",\n          height: \"162px\",\n          width: \"100%\",\n          color: \"#fff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}\n      >\n        <img\n          src=\"https://ipfs.fleek.co/ipfs/bafybeihjvub4e3yqyazxr62dxpbohji45wnx7hp7gadxjbiet2nrgkhapy\"\n          alt=\"VG Logo\"\n        />\n      </div>\n\n      <div\n        style={{\n          backgroundImage:\n            \"url(https://ipfs.fleek.co/ipfs/bafybeiazlfekaws35jiqvesssae66xybdsutug7ab7moumr2t35vntbleu)\",\n          backgroundSize: \"auto\",\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\",\n          height: \"81px\",\n          width: \"100%\",\n          color: \"#fff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          position: \"relative\",\n          overflow: \"hidden\",\n        }}\n      >\n        <div style={{ width: \"auto\" }}>\n          <input\n            type=\"text\"\n            value={state.prompt}\n            style={{\n              width: \"auto\",\n              backgroundColor: \"black\",\n              color: \"white\",\n              fontFamily: '\"Press Start 2P\", sans-serif',\n              border: \"1px solid #3a0201\",\n            }}\n            onChange={(e) => {\n              state.prompt = e.target.value;\n              State.update(state);\n            }}\n          />\n        </div>\n      </div>\n      <div\n        style={{\n          backgroundImage:\n            \"url(https://ipfs.fleek.co/ipfs/bafybeiapzstltgyd6pyibvlgkg62wdsuqvbp2wqbwuqxmjhazxm7tgh2ee)\",\n          backgroundSize: \"auto\",\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\",\n          height: \"15px\",\n          width: \"100%\",\n          color: \"#fff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          position: \"relative\",\n          overflow: \"hidden\",\n        }}\n      ></div>\n      <div\n        style={{\n          backgroundImage:\n            \"url(https://ipfs.fleek.co/ipfs/bafybeibzasxppb76w62uje25cioacxzh5olpf76jezydpiywno5ab2zmqy)\",\n          backgroundSize: \"auto\",\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\",\n          height: \"81px\",\n          width: \"100%\",\n          color: \"#fff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          position: \"relative\",\n          overflow: \"hidden\",\n        }}\n      >\n        <div>\n          <input\n            type=\"range\"\n            min={0}\n            max={20}\n            value={state.scale}\n            onChange={(e) => {\n              state.scale = e.target.value;\n              State.update(state);\n            }}\n            style={{\n              width: \"100px\",\n              backgroundColor: \"black\",\n              color: \"white\",\n              fontFamily: '\"Press Start 2P\", sans-serif',\n              margin: \"10px 10px 10px 10px\",\n              border: \"1px solid #3a0201\",\n            }}\n          />\n          <a>CFG {state.scale}</a>\n        </div>\n        <div>\n          <input\n            type=\"range\"\n            min={1}\n            max={150}\n            value={state.steps}\n            onChange={(e) => {\n              state.steps = e.target.value;\n              State.update(state);\n            }}\n            style={{\n              width: \"100px\",\n              backgroundColor: \"black\",\n              color: \"white\",\n              fontFamily: '\"Press Start 2P\", sans-serif',\n              margin: \"10px 10px 10px 10px\",\n              border: \"1px solid #3a0201\",\n            }}\n          />\n          <a>STEPS {state.steps}</a>\n        </div>\n\n        <button\n          onClick={(e) => rollImage()}\n          style={{\n            width: \"200px\",\n            backgroundColor: \"black\",\n            color: \"white\",\n            fontFamily: '\"Press Start 2P\", sans-serif',\n            margin: \"20px 20px 20px 20px\",\n            border: \"1px solid #3a0201\",\n          }}\n        >\n          Generate\n        </button>\n        <a\n          className=\"btn btn-outline-primary\"\n          onClick={(e) => uploadImageToIpfs()}\n          style={{\n            width: \"200px\",\n            backgroundColor: \"black\",\n            color: \"white\",\n            fontFamily: '\"Press Start 2P\", sans-serif',\n            margin: \"20px 20px 20px 20px\",\n            border: \"1px solid #3a0201\",\n          }}\n        >\n          Upload to IPFS\n        </a>\n      </div>\n      <div\n        style={{\n          backgroundImage:\n            \"url(https://ipfs.fleek.co/ipfs/bafybeiaye7rrdceoz44waxyn5ozulhopx6pbq7d4336cn6nenjwxuftsbe)\",\n          backgroundSize: \"auto\",\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\",\n          height: \"8px\",\n          width: \"100%\",\n          color: \"#fff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          position: \"relative\",\n          overflow: \"hidden\",\n        }}\n      ></div>\n      <div\n        style={{\n          backgroundImage:\n            \"url(https://ipfs.fleek.co/ipfs/bafybeihdd765olkr6w2d5p7tiv3cyjqae4eh3b3aokyezyksi65alswybu)\",\n          backgroundSize: \"auto\",\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\",\n          height: \"526px\",\n          color: \"#333\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}\n      >\n        <img\n          src=\"https://ipfs.fleek.co/ipfs/bafybeiburel4azxripu5f6awh6azhitxbptqovppliyav6ilwndswk6yeq\"\n          style={{ position: \"absolute\", zIndex: 1 }}\n        />\n        <img\n          src={state.imgRaw}\n          onLoad={(e) => {\n            state.blur = 0;\n            State.update(state);\n          }}\n          style={{\n            backgroundImage:\n              \"https://fleek.ipfs.io/ipfs/bafybeih7tutznkvbuecy3nfmpwo7q5w7kzyqwdvlipjtcyqevnkpz2jf44\",\n            filter: `blur(${state.blur}px)`,\n            zIndex: 0,\n            objectFit: \"contain\", // ensure that the aspect ratio of the image is maintained\n            maxHeight: \"500px\", // maximum height of the image\n            maxWidth: \"500px\", // maximum width of the image\n          }}\n        />\n      </div>\n      <div\n        style={{\n          backgroundImage:\n            \"url(https://ipfs.fleek.co/ipfs/bafybeihm5fiwy6dos2f4hiz67yaan3jafkndw5zkh23mb5rnue7qu6rh2y)\",\n          backgroundSize: \"auto\",\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\",\n          height: \"123px\",\n          color: \"#fff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}\n      ></div>\n      <div\n        style={{\n          backgroundImage:\n            \"url(https://ipfs.fleek.co/ipfs/bafybeiamgwdx5uhhbgt7usn2wjxybn2b265mubicdj7bkyawgzjrmb22l4)\",\n          backgroundSize: \"auto\",\n          backgroundPosition: \"center\",\n          backgroundRepeat: \"no-repeat\",\n          height: \"523px\",\n          color: \"#fff\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n        }}\n      ></div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/duocelot.near/widget/Voyager_AI", "fact_widget_deployments_id": "57490895e681ba34184b5d49eb0d5eee", "inserted_timestamp": "2023-08-05T05:48:50.365Z", "modified_timestamp": "2023-08-05T05:48:50.365Z", "__row_index": 14}
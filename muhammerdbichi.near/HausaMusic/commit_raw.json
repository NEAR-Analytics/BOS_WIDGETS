{"tx_hash": "75P5anH2kZqteLPipbRi3boC55PwXkhNjsLK9F2qAK7u", "action_id_social": "AVyaWJnR1CzJ4N5jLGdVbtoL1tHwsXQEfrTm1Hw8w15T-0-widget", "block_id": 107605126, "block_timestamp": "2023-12-10T14:29:43.990Z", "signer_id": "muhammerdbichi.near", "widget_name": "HausaMusic", "source_code": "const accountId = props.accountId || context.accountId;\nconst marketId = \"simple.market.mintbase1.near\";\nconst AFFILIATE_ACCOUNT = props.affiliateAccount || \"jass.near\";\nconst autoPlay = props.autoPlay || false;\n\nconst data = fetch(\"https://graph.mintbase.xyz\", {\n  method: \"POST\",\n  headers: {\n    \"mb-api-key\": \"omni-site\",\n    \"Content-Type\": \"application/json\",\n    \"x-hasura-role\": \"anonymous\",\n  },\n  body: JSON.stringify({\n    query: `\n     query MyQuery {\n  mb_views_active_listings(\n    order_by: {}\n    where: {nft_contract_id: {_eq: \"daorecords.mintbase1.near\"}}\n    distinct_on: metadata_id\n  ) {\n    listed_by\n    created_at\n    price\n    nft_contract_id\n    token_id\n    metadata_id\n    title\n    reference_blob(path: \"animation_url\")\n  }\n}\n`,\n  }),\n});\n\n//CSS\nconst styles = {\n  container: {\n    display: \"flex\",\n    //overflowY: \"auto\", // add this\n    flexDirection: \"row\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    //height: \"100%\",\n    //backgroundColor: \"#f0f0f0\",\n    padding: \"1rem\",\n    borderRadius: \"0.5rem\",\n  },\n  innerContainer: {\n    display: \"flex\",\n    //overflowY: \"auto\", // add this\n    flexDirection: \"row\",\n    backgroundColor: \"#f0f0f0\",\n    borderRadius: \"0.5rem\",\n  },\n  playerContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"\",\n    //margin: \"1rem\",\n    //backgroundColor: \"#f0f0f0\",\n    padding: \"1rem\",\n  },\n  buttonContainer: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    marginTop: \"1rem\",\n  },\n  songListContainer: {\n    width: \"24rem\",\n    height: \"24rem\",\n    overflowY: \"auto\",\n    //backgroundColor: \"#f0f0f0\",\n    //borderRadius: \"0.5rem\",\n    padding: \"1rem\",\n  },\n  heading: {\n    textAlign: \"center\",\n    fontWeight: \"bold\",\n    margin: \"1.5rem\",\n  },\n  song: {\n    cursor: \"pointer\",\n    padding: \"0.5rem\", // equivalent to \"p-2\" in tailwind\n    borderRadius: \"0.5rem\", // equivalent to \"rounded-lg\" in tailwind\n    marginBottom: \"0.5rem\", // to separate the song titles a bit\n  },\n  selectedSong: {\n    backgroundColor: \"#60A5FA\", // equivalent to \"bg-blue-300\" in tailwind\n  },\n};\n\n// Initialize state\nlet songs = data.body.data.mb_views_active_listings.filter(\n  (listing) => listing.reference_blob !== \"https://near.social/null\"\n);\n\nState.init({\n  currentSongIndex: 0,\n  autoPlay: autoPlay,\n});\n\nconst currentSong = songs[state.currentSongIndex].reference_blob;\nconst audioElem = new Audio(currentSong);\n\nfunction playSong() {\n  audioElem.play();\n}\n\nif (state.autoPlay) {\n  playSong();\n}\n\n// Call this when you want to play the current song\nfunction playCurrentSong() {\n  audioElem.play();\n}\n\n// Call this when you want to pause the current song\nfunction pauseCurrentSong() {\n  audioElem.pause();\n}\n\n// Call this when you want to play the next song\nfunction playNextSong() {\n  audioElem.pause();\n  // Update the current song index\n  let nextSongIndex = (state.currentSongIndex + 1) % songs.length;\n  State.update({\n    currentSongIndex: nextSongIndex,\n    autoPlay: true,\n  });\n}\n\n// Call this when you want to play the previous song\nfunction playPreviousSong() {\n  audioElem.pause();\n  // Calculate the previous song index\n  let previousSongIndex =\n    (state.currentSongIndex - 1 + songs.length) % songs.length;\n  State.update({\n    currentSongIndex: previousSongIndex,\n    autoPlay: true,\n  });\n}\n\n// Call this when you want to select a specific song\nfunction selectSong(index) {\n  State.update({\n    currentSongIndex: index,\n  });\n}\n\nreturn (\n  <>\n    <h1 style={styles.heading}>Decentralised Music Streaming</h1>\n\n    <div style={styles.container}>\n      <div style={styles.innerContainer}>\n        <div style={styles.playerContainer}>\n          <Widget\n            src=\"mob.near/widget/NftImage\"\n            props={{\n              nft: {\n                tokenId: songs[state.currentSongIndex].token_id,\n                contractId: songs[state.currentSongIndex].nft_contract_id,\n              },\n              style: {\n                width: 300,\n                height: 300,\n                objectFit: \"cover\",\n                minWidth: size,\n                minHeight: size,\n                maxWidth: size,\n                maxHeight: size,\n                overflowWrap: \"break-word\",\n              },\n              thumbnail: \"thumbnail\",\n              //className: \"w-64 h-64 object-cover shadow-lg\",\n              fallbackUrl:\n                \"https://ipfs.near.social/ipfs/bafkreihdiy3ec4epkkx7wc4wevssruen6b7f3oep5ylicnpnyyqzayvcry\",\n            }}\n          />\n\n          <div style={styles.buttonContainer}>\n            <button\n              style={{\n                backgroundColor: \"black\",\n                color: \"white\",\n                marginRight: \"10px\",\n              }}\n              onClick={playPreviousSong}\n            >\n              Previous\n            </button>\n            <button\n              style={{\n                backgroundColor: \"black\",\n                color: \"white\",\n                marginRight: \"10px\",\n              }}\n              onClick={pauseCurrentSong}\n            >\n              Pause\n            </button>\n            <button\n              style={{\n                backgroundColor: \"black\",\n                color: \"white\",\n                marginRight: \"10px\",\n              }}\n              onClick={playCurrentSong}\n            >\n              Play\n            </button>\n            <button\n              style={{\n                backgroundColor: \"black\",\n                color: \"white\",\n                marginRight: \"10px\",\n              }}\n              onClick={playNextSong}\n            >\n              Next\n            </button>\n          </div>\n        </div>\n        <div style={styles.songListContainer}>\n          <h2 className=\"text-2xl font-bold\">Playlist</h2>\n          {songs.map((song, i) => (\n            <Widget\n              src=\"efiz.near/widget/MusicPlayer-Harmonic.Track\"\n              props={{\n                styles,\n                selected: state.currentSongIndex === i,\n                selectSong: () => selectSong(i),\n                song,\n              }}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/muhammerdbichi.near/widget/HausaMusic", "fact_widget_deployments_id": "4473e8a4276e046d6179f9540e7dcd2a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
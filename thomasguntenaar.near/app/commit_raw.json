{"tx_hash": "EXpZ4bgNC4P76o18LpAg8thutA4vhSKSBLx9YppUWFbB", "action_id_social": "2YjC7G8zSRadhzgjT3a92UR9yNRhaJHH17LEDMpDcv5k-0-widget", "block_id": 118960039, "block_timestamp": "2024-05-15T08:41:05.120Z", "signer_id": "thomasguntenaar.near", "widget_name": "app", "source_code": "/**\n * This is the main entry point for the DevHub application.\n * Page route gets passed in through params, along with all other page props.\n */\n\nconst { onDraftStateChange } = VM.require(\n  \"thomasguntenaar.near/widget/devhub.entity.post.draft\"\n);\n\nconst { page, ...passProps } = props;\n\n// Import our modules\nconst { AppLayout } = VM.require(\n  \"thomasguntenaar.near/widget/devhub.components.templates.AppLayout\"\n);\n\nif (!AppLayout) {\n  return <p>Loading modules...</p>;\n}\n\n// CSS styles to be used across the app.\n// Define fonts here, as well as any other global styles.\nconst Theme = styled.div`\n  a {\n    color: inherit;\n  }\n\n  .attractable {\n    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075) !important;\n    transition: box-shadow 0.6s;\n\n    &:hover {\n      box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;\n    }\n  }\n`;\n\nif (!page) {\n  // If no page is specified, we default to the feed page TEMP\n  page = \"home\";\n}\n\n// Track visits\n\nif (\"${REPL_POSTHOG_API_KEY}\".length === 47) {\n  useEffect(() => {\n    const hashedUserId = context.accountId\n      ? Array.from(nacl.hash(Buffer.from(context.accountId)))\n          .map((b) => (\"00\" + b.toString(16)).slice(-2))\n          .join(\"\")\n      : \"unauthenticated\";\n\n    fetch(\"https://eu.posthog.com/capture/\", {\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"application/json\",\n      },\n\n      body: JSON.stringify({\n        api_key: \"${REPL_POSTHOG_API_KEY}\",\n        event: \"devhub_pageview\",\n        properties: {\n          distinct_id: hashedUserId,\n          page,\n          ...props,\n        },\n        timestamp: new Date().toISOString(),\n      }),\n    });\n  }, [props]);\n}\n\n// This is our navigation, rendering the page based on the page parameter\nfunction Page() {\n  const routes = page.split(\".\");\n  switch (routes[0]) {\n    case \"home\": {\n      return (\n        <Widget\n          src=\"thomasguntenaar.near/widget/devhub.page.home\"\n          props={passProps}\n        />\n      );\n    }\n    // ?page=communities\n    case \"communities\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.communities\"}\n          props={passProps}\n        />\n      );\n    }\n    case \"announcements\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.announcements\"}\n          props={passProps}\n        />\n      );\n    }\n\n    // ?page=community\n    case \"community\": {\n      return (\n        // Considering to consolidate this into a single widget,\n        // where each level handles its own routing.\n        // Modularizing a page just like we do with addons\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.entity.community.Provider\"}\n          props={{\n            ...passProps,\n            Children: (p) => {\n              // passing props from the Provider into the Children\n              switch (routes[1]) {\n                // ?page=community.configuration\n                case \"configuration\": {\n                  return (\n                    <Widget\n                      src={\n                        \"thomasguntenaar.near/widget/devhub.page.community.configuration\"\n                      }\n                      props={{\n                        ...passProps,\n                        ...p,\n                      }}\n                    />\n                  );\n                }\n                // ?page=community\n                default: {\n                  return (\n                    <Widget\n                      src={\"thomasguntenaar.near/widget/devhub.page.community.index\"}\n                      props={{\n                        ...passProps,\n                        ...p,\n                      }}\n                    />\n                  );\n                }\n              }\n            },\n          }}\n        />\n      );\n    }\n    // ?page=feed\n    case \"feed\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.feed\"}\n          props={passProps}\n        />\n      );\n    }\n    // ?page=create\n    case \"create\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.entity.post.PostEditor\"}\n          props={{ ...passProps, isCreatePostPage: true, onDraftStateChange }}\n        />\n      );\n    }\n\n    case \"create-proposal\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.entity.proposal.Editor\"}\n          props={{ ...passProps }}\n        />\n      );\n    }\n\n    case \"proposals\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.proposals\"}\n          props={passProps}\n        />\n      );\n    }\n    case \"proposal\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.entity.proposal.Proposal\"}\n          props={passProps}\n        />\n      );\n    }\n    // ?page=about\n    case \"about\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.about\"}\n          props={passProps}\n        />\n      );\n    }\n    case \"contribute\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.contribute\"}\n          props={passProps}\n        />\n      );\n    }\n    case \"profile\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.profile\"}\n          props={passProps}\n        />\n      );\n    }\n    // ?page=blog\n    case \"blog\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.blog\"}\n          props={passProps}\n        />\n      );\n    }\n    case \"blogv2\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.blogv2\"}\n          props={passProps}\n        />\n      );\n    }\n    case \"post\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.post\"}\n          props={passProps}\n        />\n      );\n    }\n    case \"admin\": {\n      return (\n        <Widget\n          src={\"thomasguntenaar.near/widget/devhub.page.admin.index\"}\n          props={passProps}\n        />\n      );\n    }\n    default: {\n      // TODO: 404 page\n      return <p>404</p>;\n    }\n  }\n}\n\nreturn (\n  <Theme>\n    <AppLayout page={page}>\n      <Page />\n    </AppLayout>\n  </Theme>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/thomasguntenaar.near/widget/app", "fact_widget_deployments_id": "f85eea2de6f1fcf382bd982746fb7736", "inserted_timestamp": "2024-05-15T10:50:02.030Z", "modified_timestamp": "2024-05-15T10:50:02.030Z", "__row_index": 12}
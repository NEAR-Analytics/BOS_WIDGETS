{"tx_hash": "Esrde7NbMCdnAP5E7gm7q4zMJyFZJDBzKpcRhAq1VZH", "action_id_social": "GpvjVGr3rqVep3CqDsv4VC9poJnnwdTTgzbt6y3yKvcT-0-widget", "block_id": 106801087, "block_timestamp": "2023-11-29T10:40:25.983Z", "signer_id": "nearweekapp.near", "widget_name": "nw-audio-more", "source_code": "const rootUser = \"nearweekapp.near\";\nconst breakpoints = { md: \"768px\", lg: \"1100px\", xl: \"1300px\" };\n\nfunction NewsletterCard() {\n  const accountId = \"near\";\n  articles;\n  State.init({ active: 0 });\n  const nwSite = \"https://nearweek.com\";\n  let posts = [];\n  const indexedPosts = Social.index(\"post\", \"main\", {\n    accountId,\n    limit: 20,\n    order: \"desc\",\n  });\n  if (indexedPosts?.length > 0) {\n    posts = indexedPosts\n      .map((post) => {\n        const data = Social.get(\n          `${post.accountId}/post/main`,\n          post.blockHeight\n        );\n        if (!data) return;\n        const json = JSON.parse(data);\n        const content = json.text.split(\"\\n\");\n        const title = content[0] || \"\";\n        const url = content[1] || content[2] || \"\";\n        const lastLine = content.pop() || \"\";\n        const hasNewsTag = lastLine.includes(\"#news\");\n        const isValid = hasNewsTag && url.includes(\"https://\");\n        if (isValid) {\n          const block = Near.block(post.blockHeight);\n          const createdAt = block\n            ? new Date(\n                parseFloat(block.header.timestamp_nanosec) / 1e6\n              ).toISOString()\n            : \"\";\n          return {\n            blockHeight: post.blockHeight,\n            title,\n            url,\n            thumbnail: \"https://near.org/favicon.png\",\n            createdAt,\n            categories: [\"Near ORG\", \"blog\"],\n          };\n        }\n      })\n      .filter(Boolean);\n    posts.sort((a, b) => b.blockHeight - a.blockHeight);\n  }\n\n  const cssFont = fetch(\"https://fonts.cdnfonts.com/css/hubot-sans\").body;\n  if (!cssFont) return \"\";\n  if (!state.theme) {\n    State.update({\n      theme: styled.div`\n        font-family: 'Mona Sans', sans-serif;\n        font-style: normal;\n        ${cssFont}\n      }`,\n    });\n  }\n  const Theme = state.theme;\n\n  const TopCardTitle = styled.h2`\n     overflow: hidden;\n      color: #1C1F41;\n      text-overflow: ellipsis;\n      whitespace: nowrap;\n      font-family: Inter;\n      font-size: 18px;\n      font-style: normal;\n      font-weight: 500;\n      display:grid;\n      gap:20px;\n      margin-bottom:27px;\n    `;\n\n  const MainSection = styled.div`\n    padding: 0;\n    @media screen and (min-width: ${breakpoints.lg}) {\n      padding: 30px 16px 20px 16px;\n      width: 100%;\n    }\n    `;\n  const MainContainer = styled.div`\n    display:flex;\n    flex-direction:column;\n    justify-content: center; \n    justify-items: center; \n    margin-top: 32px;\n      @media screen and (min-width: ${breakpoints.lg}) {\n        width: 100%;\n        display: flex;\n        grid-column-gap: 20px;\n        flex-direction: row-reverse;\n      }\n    `;\n  console.log(\"props\", props);\n  const audioDetails = props.audioDetails;\n  const updateAudioDetails = props.updateAudioDetails;\n\n  const ReturnButton = styled.div`\n    cursor: pointer;\n  `;\n  const AudioContainer = styled.div`\n    width: 80%;\n      @media screen and (max-width: ${breakpoints.lg}) {\n        width: 100%;\n      }\n  `;\n\n  const ContentContainer = styled.div`\n  `;\n  const AudioContent = styled.div`\n    display: flex;\n    gap: 1.5rem;\n  `;\n\n  const Title = styled.h2`\n    font-size: 1.5rem;\n    font-weight: 600;\n    margin-left: 4px;\n  `;\n  console.log(audioDetails, \"audioDetails1\");\n  function TopSection() {\n    return (\n      <MainSection>\n        {audioDetails ? (\n          <AudioContainer>\n            <TopCardTitle>\n              <ReturnButton onClick={() => updateAudioDetails(null)}>\n                <Widget src={`${rootUser}/widget/details-return`} />\n              </ReturnButton>\n              <ContentContainer>\n                <AudioContent>\n                  <img\n                    src={audioDetails.thumbnail}\n                    width=\"132\"\n                    height=\"132\"\n                    alt=\"\"\n                    style={{ borderRadius: \"8px\" }}\n                  />\n                  <div>\n                    <Title>{audioDetails.title}</Title>\n                    <iframe\n                      style={{ width: \"100%\" }}\n                      srcDoc={audioDetails.description}\n                    />\n                  </div>\n                </AudioContent>\n                <div className=\"raw-html-embed\">\n                  <iframe\n                    style={{ width: \"100%\" }}\n                    src={audioDetails.frameSrc}\n                  />\n                </div>\n                <Widget\n                  props={{\n                    updateAudioDetails,\n                    audioCardFullWidth: true,\n                  }}\n                  src={`${rootUser}/widget/nw-audio`}\n                />\n              </ContentContainer>\n            </TopCardTitle>\n          </AudioContainer>\n        ) : (\n          <div>Loading ...</div>\n        )}\n      </MainSection>\n    );\n  }\n  const BottomContainer = styled.div`\n    display: none;\n    transform: translateY(50px);\n    @media screen and (min-width: ${breakpoints.lg}) {\n      display: block;\n    }\n`;\n\n  function AudioCard() {\n    return (\n      <Widget\n        props={{\n          updateAudioDetails,\n        }}\n        src={`${rootUser}/widget/nw-audio`}\n      />\n    );\n  }\n\n  return (\n    <Theme>\n      <Widget src={`${rootUser}/widget/nw-navbar`} />\n      <MainContainer>\n        <TopSection />\n        <BottomContainer>\n          <AudioCard />\n        </BottomContainer>\n      </MainContainer>\n    </Theme>\n  );\n}\n\nreturn <NewsletterCard />;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearweekapp.near/widget/nw-audio-more", "fact_widget_deployments_id": "97a4904bb82db210cc803c7b74bc72cb", "inserted_timestamp": "2023-11-29T12:41:01.712Z", "modified_timestamp": "2023-12-20T00:36:59.366Z", "__row_index": 0}
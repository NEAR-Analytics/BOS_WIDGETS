{"tx_hash": "FYuPKbRwqbyPmovJYr46sMTwtWTerK1atzpCUqUinmjj", "action_id_social": "FsgqEHg8ryzzPtcd1DDN9ahjeQQsqDeVztPWDowMx6CA-0-widget", "block_id": 106929970, "block_timestamp": "2023-12-01T13:03:49.160Z", "signer_id": "nearweekapp.near", "widget_name": "nw-audio", "source_code": "const updateAudioDetails = props.updateAudioDetails;\nconst audioCardFullWidth = props.audioCardFullWidth;\n\nfunction AudioCard() {\n  State.init({ page: 1 });\n  const nwSite = \"https://nearweek.com\";\n\n  const fetchData = (url) => {\n    return fetch(url, {\n      method: \"GET\",\n      headers: {\n        Accept: \"*/*\",\n        Authorization:\n          \"Bearer 15699f0723aa9fe9f655b1a94e450552476c08807f67b525b5a3c8011eecc8aee6d45923443620f17815b897858be058cd7bd89ddf23a28aabaecb178e7ebc55d380293beeb51a8ce87b40e1518ce4708e4d51a06b115f27fa64ab5cbee5a3511cec785d7ae6a155ecd05ac8196aadae3e9b8e9401b8df8d8b69904f7364f925\",\n      },\n    });\n  };\n\n  const fetchAudio = fetchData(\n    `https://nearweek.com/api/show-audio?populate=deep&sort=createdAt:desc&pagination[pageSize]=${\n      state.page * 5\n    }`\n  );\n\n  function formatPodcastDate(dateString) {\n    const timeAgo = (diffSec) =>\n      diffSec < 60000\n        ? `${(diffSec / 1000) | 0}s`\n        : diffSec < 3600000\n        ? `${(diffSec / 60000) | 0}m`\n        : diffSec < 86400000\n        ? `${(diffSec / 3600000) | 0}h`\n        : `${(diffSec / 86400000) | 0}d`;\n    const podcastDate = new Date(dateString);\n    const diffMillis = Date.now() - podcastDate.getTime();\n    return timeAgo(diffMillis);\n  }\n\n  const audio = [...(fetchAudio?.body.data ?? [])].map((item) => {\n    const categories = item.categories.map((category) => category.Name);\n\n    return {\n      title: item.Title,\n      thumbnail: nwSite + item.Thumbnail.formats.thumbnail.url,\n      categories: categories.slice(0, 2), // Slice the first two categories\n      createdAt: formatPodcastDate(item.createdAt),\n      url: nwSite + \"/audio/\" + item.slug,\n      frame: item.frame,\n      frameSrc: item.frameSrc,\n      description: item.Description,\n    };\n  });\n\n  const AudioCard = styled.div`\n    position: relative;\n    cursor: pointer;\n    width: 100%;\n    padding: 12px;\n    border-radius: 12px;\n    background: #fff;\n    display:flex;\n    border: 1px solid #eceef0;\n    overflow: hidden;\n    margin-bottom: 10px;\n  `;\n\n  const AudioThumbnail = styled.img`\n  max-width: 70px;\n  max-height: 70px;\n  border-radius: 10px;\n  `;\n\n  const AudioTitle = styled.div`\n  height: 41px;\n  owerflow: hidden;\n  text-overflow: elipsis;\n  whitespace: nowrap;\n  text-decoration: none;\n  cursor: pointer;\n  &:hover {\n    color: black;\n    text-decoration: none;\n    cursor: pointer;\n    }\n  `;\n\n  const AudioTitleText = styled.h4`\n  color: black;  `;\n\n  const AudioTitleLinkContent = styled.p`\n    font-weight: 500;\n    font-size: 12px;\n    line-height: 14px;\n  `;\n\n  const AudioCategories = styled.div`\n    align: left;\n    justify-self: left;\n    grid-area: 2 / 1 / 3 / 2;\n  `;\n\n  const AudioCategoriesContent = styled.p`\n    font-weight: 500;\n    font-size: 10px;\n    line-height: 8.5px;\n    color: #9C9C9C;\n    margin: 0;\n    text-align: center;\n    align-items: center;\n    margin-top: 2.5px;\n    background-color: #F5F5F5;\n    border-radius: 4px;\n    padding: 6px 20px;\n  `;\n\n  const AudioDate = styled.p`\n    color: rgba(28, 31, 65, 0.45);\n    text-align: right;\n    font-size: 12px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: 8.5px; /* 70.833% */\n    letter-spacing: 0.12px;\n    grid-area: 2 / 2 / 3 / 3;\n    padding:2px;\n    margin:0;\n  `;\n  const AudioCardDescription = styled.div`\n    width: 100%;\n    margin-left:15px\n  `;\n\n  const H2 = styled.h2`\n    color: #1C1F41;\n    font-size: 24px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: 15px;\n    margin-bottom: 15px;\n`;\n\n  const AudioButtonLoad = styled.button`\n    width: 180px;\n    padding: 8px;\n    height: 31px;\n    background: transparent;\n    margin: 20px auto 0px auto;\n    border: 1px solid #d7dbdf;\n    border-radius: 100px;\n    font-weight: 500;\n    font-size: 12px;\n    line-height: 22px;\n    letter-spacing: -0.03em;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    cursor: pointer;\n    white-space: nowrap;\n    color: hsla(204, 22%, 9%, 1);\n    &:hover,\n    &:focus {\n      text-decoration: none;\n      outline: none;\n      }\n  `;\n\n  const MainSection = styled.div`\n    border: 1px solid var(--bs-border-color);\n    border-radius: 20px;\n    padding: 20px 15px;\n    margin-bottom: 24px;\n    height: fit-content;\n    width: ${(props) => (props.fullWidth ? \"100%\" : \"341px\")};\n    background: white;\n    @media screen and (min-width: ${breakpoints.lg}) {\n      max-width: 700px;\n    }\n`;\n\n  return (\n    <MainSection fullWidth={audioCardFullWidth} class=\"border border-danger\">\n      <H2>{audioCardFullWidth ? \"Related Audio\" : \"Audio\"}</H2>\n      {audio.length > 0 ? (\n        audio.map((podcast, index) => (\n          <div key={index}>\n            <AudioCard onClick={() => updateAudioDetails(podcast)}>\n              <AudioThumbnail src={podcast.thumbnail} alt={podcast.title} />\n              <AudioCardDescription>\n                {/* Display the podcast title as a link */}\n                <AudioTitle>\n                  <AudioTitleText>\n                    <AudioTitleLinkContent>\n                      {podcast.title}\n                    </AudioTitleLinkContent>\n                  </AudioTitleText>\n                </AudioTitle>\n                {/* Display categories */}\n                <div className=\"d-flex align-items-center gap-1 mt-1 justify-content-between\">\n                  <div className=\"d-flex flex-wrap align-items-center gap-2\">\n                    {podcast.categories.map((c) => {\n                      return (\n                        <AudioCategories key={c}>\n                          <AudioCategoriesContent>{c}</AudioCategoriesContent>\n                        </AudioCategories>\n                      );\n                    })}\n                    {/* Display creation date */}\n                  </div>\n                  <AudioDate>{podcast.createdAt}</AudioDate>\n                </div>\n              </AudioCardDescription>\n            </AudioCard>\n          </div>\n        ))\n      ) : (\n        <div>Loading ...</div>\n      )}\n      <AudioButtonLoad onClick={() => State.update({ page: state.page + 1 })}>\n        Load more\n      </AudioButtonLoad>\n    </MainSection>\n  );\n}\n\nreturn <AudioCard />;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearweekapp.near/widget/nw-audio", "fact_widget_deployments_id": "e9a0dd7cb7635205b23a759bb9479902", "inserted_timestamp": "2023-12-01T15:16:43.300Z", "modified_timestamp": "2023-12-20T03:02:01.702Z", "__row_index": 2}
{"tx_hash": "xbGRaKESPaUhKd3byfD8psSzQA1MeNKgiRrB65bzzBk", "action_id_social": "EaqQFauP78xqYqsFiUMXgRXSqNkyCz69Z9tV6pbnRL3c-0-widget", "block_id": 117455145, "block_timestamp": "2024-04-23T14:19:44.979Z", "signer_id": "nearweekapp.near", "widget_name": "nw-audio", "source_code": "const updateAudioDetails = props.updateAudioDetails;\r\nconst audioCardFullWidth = props.audioCardFullWidth;\r\n\r\nfunction AudioCard() {\r\n  State.init({ page: 1 });\r\n  const nwSite = \"https://nearweek.com\";\r\n\r\n  const fetchData = (url) => {\r\n    return fetch(url, {\r\n      method: \"GET\",\r\n      headers: {\r\n        Accept: \"*/*\",\r\n        Authorization:\r\n          \"Bearer 15699f0723aa9fe9f655b1a94e450552476c08807f67b525b5a3c8011eecc8aee6d45923443620f17815b897858be058cd7bd89ddf23a28aabaecb178e7ebc55d380293beeb51a8ce87b40e1518ce4708e4d51a06b115f27fa64ab5cbee5a3511cec785d7ae6a155ecd05ac8196aadae3e9b8e9401b8df8d8b69904f7364f925\",\r\n      },\r\n    });\r\n  };\r\n\r\n  const fetchAudio = fetchData(\r\n    `https://nearweek.com/api/show-audio?populate=deep&sort=createdAt:desc&pagination[pageSize]=${\r\n      state.page * 5\r\n    }`\r\n  );\r\n\r\n  function formatPodcastDate(dateString) {\r\n    const timeAgo = (diffSec) =>\r\n      diffSec < 60000\r\n        ? `${(diffSec / 1000) | 0}s`\r\n        : diffSec < 3600000\r\n        ? `${(diffSec / 60000) | 0}m`\r\n        : diffSec < 86400000\r\n        ? `${(diffSec / 3600000) | 0}h`\r\n        : `${(diffSec / 86400000) | 0}d`;\r\n    const podcastDate = new Date(dateString);\r\n    const diffMillis = Date.now() - podcastDate.getTime();\r\n    return timeAgo(diffMillis);\r\n  }\r\n\r\n  const audio = [...(fetchAudio?.body.data ?? [])].map((item) => {\r\n    const categories = item.categories.map((category) => category.Name);\r\n\r\n    return {\r\n      title: item.Title,\r\n      thumbnail: nwSite + item.Thumbnail.formats.thumbnail.url,\r\n      categories: categories.slice(0, 2), // Slice the first two categories\r\n      createdAt: formatPodcastDate(item.createdAt),\r\n      url: nwSite + \"/audio/\" + item.slug,\r\n      frame: item.frame,\r\n      frameSrc: item.frameSrc,\r\n      description: item.Description,\r\n    };\r\n  });\r\n\r\n  const AudioCard = styled.div`\r\n    position: relative;\r\n    cursor: pointer;\r\n    width: 100%;\r\n    padding: 12px;\r\n    border-radius: 12px;\r\n    background: #fff;\r\n    display:flex;\r\n    border: 1px solid #eceef0;\r\n    overflow: hidden;\r\n    margin-bottom: 10px;\r\n  `;\r\n\r\n  const AudioThumbnail = styled.img`\r\n  max-width: 70px;\r\n  max-height: 70px;\r\n  border-radius: 10px;\r\n  `;\r\n\r\n  const AudioTitle = styled.div`\r\n  height: 41px;\r\n  owerflow: hidden;\r\n  text-overflow: elipsis;\r\n  whitespace: nowrap;\r\n  text-decoration: none;\r\n  cursor: pointer;\r\n  &:hover {\r\n    color: black;\r\n    text-decoration: none;\r\n    cursor: pointer;\r\n    }\r\n  `;\r\n\r\n  const AudioTitleText = styled.h4`\r\n  color: black;  `;\r\n\r\n  const AudioTitleLinkContent = styled.p`\r\n    font-weight: 500;\r\n    font-size: 12px;\r\n    line-height: 14px;\r\n  `;\r\n\r\n  const AudioCategories = styled.div`\r\n    align: left;\r\n    justify-self: left;\r\n    grid-area: 2 / 1 / 3 / 2;\r\n  `;\r\n\r\n  const AudioCategoriesContent = styled.p`\r\n    font-weight: 500;\r\n    font-size: 10px;\r\n    line-height: 8.5px;\r\n    color: #9C9C9C;\r\n    margin: 0;\r\n    text-align: center;\r\n    align-items: center;\r\n    margin-top: 2.5px;\r\n    background-color: #F5F5F5;\r\n    border-radius: 4px;\r\n    padding: 6px 20px;\r\n  `;\r\n\r\n  const AudioDate = styled.p`\r\n    color: rgba(28, 31, 65, 0.45);\r\n    text-align: right;\r\n    font-size: 12px;\r\n    font-style: normal;\r\n    font-weight: 500;\r\n    line-height: 8.5px; /* 70.833% */\r\n    letter-spacing: 0.12px;\r\n    grid-area: 2 / 2 / 3 / 3;\r\n    padding:2px;\r\n    margin:0;\r\n  `;\r\n  const AudioCardDescription = styled.div`\r\n    width: 100%;\r\n    margin-left:15px\r\n  `;\r\n\r\n  const H2 = styled.h2`\r\n    color: #1C1F41;\r\n    font-size: 24px;\r\n    font-style: normal;\r\n    font-weight: 500;\r\n    line-height: 15px;\r\n    margin-bottom: 15px;\r\n`;\r\n\r\n  const AudioButtonLoad = styled.button`\r\n    width: 180px;\r\n    padding: 8px;\r\n    height: 31px;\r\n    background: transparent;\r\n    margin: 20px auto 0px auto;\r\n    border: 1px solid #d7dbdf;\r\n    border-radius: 100px;\r\n    font-weight: 500;\r\n    font-size: 12px;\r\n    line-height: 22px;\r\n    letter-spacing: -0.03em;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    text-align: center;\r\n    cursor: pointer;\r\n    white-space: nowrap;\r\n    color: hsla(204, 22%, 9%, 1);\r\n    &:hover,\r\n    &:focus {\r\n      text-decoration: none;\r\n      outline: none;\r\n      }\r\n  `;\r\n\r\n  const MainSection = styled.div`\r\n    border: 1px solid var(--bs-border-color);\r\n    border-radius: 20px;\r\n    padding: 20px 15px;\r\n    margin-bottom: 24px;\r\n    height: fit-content;\r\n    width: 100%;\r\n    max-width: ${(props) => (props.fullWidth ? \"100%\" : \"341px\")};\r\n    background: white;\r\n    @media screen and (min-width: ${breakpoints.lg}) {\r\n      max-width: 700px;\r\n    }\r\n`;\r\n\r\n  return (\r\n    <MainSection fullWidth={audioCardFullWidth} class=\"border border-danger\">\r\n      <H2>{audioCardFullWidth ? \"RELATED AUDIO\" : \"AUDIO\"}</H2>\r\n      {audio.length > 0 ? (\r\n        audio.map((podcast, index) => (\r\n          <div key={index}>\r\n            <AudioCard onClick={() => updateAudioDetails(podcast)}>\r\n              <AudioThumbnail src={podcast.thumbnail} alt={podcast.title} />\r\n              <AudioCardDescription>\r\n                {/* Display the podcast title as a link */}\r\n                <AudioTitle>\r\n                  <AudioTitleText>\r\n                    <AudioTitleLinkContent>\r\n                      {podcast.title}\r\n                    </AudioTitleLinkContent>\r\n                  </AudioTitleText>\r\n                </AudioTitle>\r\n                {/* Display categories */}\r\n                <div className=\"d-flex align-items-center gap-1 mt-1 justify-content-between\">\r\n                  <div className=\"d-flex flex-wrap align-items-center gap-2\">\r\n                    {podcast.categories.map((c) => {\r\n                      return (\r\n                        <AudioCategories key={c}>\r\n                          <AudioCategoriesContent>{c}</AudioCategoriesContent>\r\n                        </AudioCategories>\r\n                      );\r\n                    })}\r\n                    {/* Display creation date */}\r\n                  </div>\r\n                  <AudioDate>{podcast.createdAt}</AudioDate>\r\n                </div>\r\n              </AudioCardDescription>\r\n            </AudioCard>\r\n          </div>\r\n        ))\r\n      ) : (\r\n        <div>Loading ...</div>\r\n      )}\r\n      <AudioButtonLoad onClick={() => State.update({ page: state.page + 1 })}>\r\n        Load more\r\n      </AudioButtonLoad>\r\n    </MainSection>\r\n  );\r\n}\r\n\r\nreturn <AudioCard />;\r\n", "metadata": {"fork_of": "nearweekapp.near/widget/nearweek.com@108395848"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearweekapp.near/widget/nw-audio", "fact_widget_deployments_id": "4c4e53f8d266ac6e768b4ddb82f4608b", "inserted_timestamp": "2024-04-23T17:54:15.847Z", "modified_timestamp": "2024-04-23T17:54:15.847Z", "__row_index": 1}
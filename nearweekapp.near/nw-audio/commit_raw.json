{"tx_hash": "HVSLkgL1SY7je2yf9DvJuox5bVAGZjQkAh2RFcBcR7qY", "action_id_social": "F6u9hdBLZ6CWDXMwG1Gf8hQxfAcY6iSRbLN3XiZCV1Pn-0-widget", "block_id": 103200882, "block_timestamp": "2023-10-12T11:43:47.043Z", "signer_id": "nearweekapp.near", "widget_name": "nw-audio", "source_code": "function AudioCard() {\n  const accountId = \"near\";\n  articles;\n  State.init({ active: 0 });\n  const nwSite = \"https://nearweek.com\";\n  let posts = [];\n\n  const fetchData = (url) => {\n    return fetch(url, {\n      method: \"GET\",\n      headers: {\n        Accept: \"*/*\",\n        Authorization:\n          \"Bearer 15699f0723aa9fe9f655b1a94e450552476c08807f67b525b5a3c8011eecc8aee6d45923443620f17815b897858be058cd7bd89ddf23a28aabaecb178e7ebc55d380293beeb51a8ce87b40e1518ce4708e4d51a06b115f27fa64ab5cbee5a3511cec785d7ae6a155ecd05ac8196aadae3e9b8e9401b8df8d8b69904f7364f925\",\n      },\n    });\n  };\n\n  const fetchAudio = fetchData(\n    \"https://nearweek.com/api/show-audio?populate=deep&sort=createdAt:desc&pagination[pageSize]=5\"\n  );\n\n  function formatPodcastDate(dateString) {\n    const timeAgo = (diffSec) =>\n      diffSec < 60000\n        ? `${(diffSec / 1000) | 0}s`\n        : diffSec < 3600000\n        ? `${(diffSec / 60000) | 0}m`\n        : diffSec < 86400000\n        ? `${(diffSec / 3600000) | 0}h`\n        : `${(diffSec / 86400000) | 0}d`;\n    const podcastDate = new Date(dateString);\n    const diffMillis = Date.now() - podcastDate.getTime();\n    return timeAgo(diffMillis);\n  }\n\n  const audio = [...(fetchAudio?.body.data ?? [])].map((item) => {\n    const categories = item.categories.map((category) => category.Name);\n\n    return {\n      title: item.Title,\n      thumbnail: nwSite + item.Thumbnail.formats.thumbnail.url,\n      categories: categories.slice(0, 2), // Slice the first two categories\n      createdAt: formatPodcastDate(item.createdAt),\n      url: nwSite + \"/audio/\" + item.slug,\n    };\n  });\n\n  const cssFont = fetch(\n    \"https://fonts.googleapis.com/css2?family=Space+Grotesk\"\n  ).body;\n\n  if (!cssFont) return \"\";\n\n  if (!state.theme) {\n    State.update({\n      theme: styled.div`\n    font-family: sans-serif;\n    ${cssFont}\n`,\n    });\n  }\n\n  const AudioCard = styled.div`\n    position: relative;\n    width:100%;\n    padding:12px;\n    border-radius: 12px;\n    background: #fff;\n    display:flex;\n    justify-content: center;\n    border: 1px solid #eceef0;\n    overflow: hidden;\n    margin-bottom:24px;\n  `;\n\n  const AudioThumbnail = styled.img`\n  max-width: 70px;\n  max-height: 70px;\n  border-radius: 10px;\n  `;\n\n  const AudioTitle = styled.div`\n  height: 41px;\n  width: 181px;\n  owerflow: hidden;\n  text-overflow: elipsis;\n  whitespace: nowrap;\n  text-decoration: none;\n  cursor: pointer;\n  grid-area: 1 / 1 / 2 / 3;\n  & :hover {\n    color: black;\n    text-decoration: none;\n    cursor: pointer;}\n    `;\n\n  const AudioTitleLink = styled.a`\n  color: black;  `;\n\n  const AudioTitleLinkContent = styled.p`\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 14px;\n  `;\n\n  const AudioCategories = styled.div`\n  align: left;\n  justify-self: left;\n  grid-area: 2 / 1 / 3 / 2;\n  `;\n\n  const AudioCategoriesContent = styled.p`\n  font-weight: 600;\n  font-size: 10px;\n  line-height: 8.5px;\n  color: #9C9C9C;\n  margin: 0;\ntext-align: center;\nalign-items:center;\nmargin-top:2.5px;\n  background-color: #F5F5F5;\n  border-radius: 4px;\n    padding: 6px 20px;\n  `;\n\n  const AudioDate = styled.p`\n    color: rgba(28, 31, 65, 0.45);\n    text-align: right;\n    font-family: Inter;\n    font-size: 12px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: 8.5px; /* 70.833% */\n    letter-spacing: 0.12px;\n    grid-area: 2 / 2 / 3 / 3;\n    padding:2px;\n    margin:0;\n  `;\n  const AudioCardDescription = styled.div`\n    margin-left:15px\n  `;\n\n  const H2 = styled.h2`\ncolor: #1C1F41;\nfont-family: Inter;\nfont-size: 24px;\nfont-style: normal;\nfont-weight: 500;\nline-height: 15px;\nmargin-bottom: 15px;\n`;\n\n  return (\n    <div>\n      <H2>Audio</H2>\n      {audio.length > 0 ? (\n        audio.map((podcast, index) => (\n          <div key={index}>\n            <AudioCard>\n              <AudioThumbnail src={podcast.thumbnail} alt={podcast.title} />\n              <AudioCardDescription>\n                {/* Display the podcast title as a link */}\n                <AudioTitle>\n                  <AudioTitleLink\n                    href={podcast.url}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    <AudioTitleLinkContent>\n                      {podcast.title}\n                    </AudioTitleLinkContent>\n                  </AudioTitleLink>\n                </AudioTitle>\n                <div className=\"d-flex align-items-center gap-1 mt-1 justify-content-between\">\n                  <div className=\"d-flex flex-wrap align-items-center gap-2\">\n                    {podcast.categories.map((c) => {\n                      return (\n                        <AudioCategories key={c}>\n                          <AudioCategoriesContent>{c}</AudioCategoriesContent>\n                        </AudioCategories>\n                      );\n                    })}\n                  </div>\n                  <AudioDate>{podcast.createdAt}</AudioDate>\n                </div>\n              </AudioCardDescription>\n            </AudioCard>\n          </div>\n        ))\n      ) : (\n        <div>Loading ...</div>\n      )}\n    </div>\n  );\n}\n\nreturn <AudioCard />;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearweekapp.near/widget/nw-audio", "fact_widget_deployments_id": "947dddc5bc771d164cd43da2e7555dcc", "inserted_timestamp": "2023-10-12T13:31:15.221Z", "modified_timestamp": "2023-10-12T13:31:15.221Z", "__row_index": 1}
{"tx_hash": "DwsbhZo6bragJQyL3WFYFYXxrwiaFdQCFV6XSaLbQF4k", "action_id_social": "9Ro8h9PCrrTpWaUGfj51gnZTUoMuJtHyxR6htoCjLJS2-0-widget", "block_id": 100973744, "block_timestamp": "2023-09-12T17:22:08.139Z", "signer_id": "nomination.ndctools.near", "widget_name": "NDC.Nomination.Card", "source_code": "const {\n  data,\n  registry_contract,\n  nomination_contract,\n  election_contract,\n  api_key,\n  dev,\n} = props;\n\nState.init({\n  verified: false,\n  start: true,\n  voted: false,\n  shareText: \"Copy link to the clipboard\",\n});\n\nconst widgets = {\n  styledComponents: \"nomination.ndctools.near/widget/NDC.StyledComponents\",\n  candidatePage:\n    \"#/nomination.ndctools.near/widget/NDC.Nomination.Candidate.Page\",\n  addComment: \"nomination.ndctools.near/widget/NDC.Nomination.AddComment\",\n};\n\nconst isHuman = Near.view(registry_contract, \"is_human\", {\n  account: context.accountId,\n});\nState.update({ verified: isHuman[0][1].length > 0 });\n\nconst httpRequestOpt = {\n  headers: { \"x-api-key\": api_key },\n};\n\nasyncFetch(\n  `https://api.pikespeak.ai/nominations/is-upvoted-by?candidate=${data.indexerData.nominee}&upvoter=${context.accountId}&contract=${nomination_contract}`,\n  httpRequestOpt\n).then((res) => {\n  State.update({ voted: res.body });\n});\n\nfunction handleUpVote() {\n  Near.call(\n    nomination_contract,\n    state.voted ? \"remove_upvote\" : \"upvote\",\n    {\n      candidate: data.indexerData.nominee,\n    },\n    300000000000000,\n    state.voted ? 0 : 1000000000000000000000\n  );\n}\n\nfunction handleShare() {\n  State.update({ shareText: \"Copied\" });\n  clipboard.writeText(\n    \"https://near.org/#/nomination.ndctools.near/widget/NDC.Nomination.Candidate.Page?house=\" +\n      data.indexerData.house +\n      \"&candidate=\" +\n      data.indexerData.nominee\n  );\n}\n\nfunction getComponentURL() {\n  const url =\n    \"https%3A%2F%2Fnear.org%2F%23%2Fnomination.ndctools.near%2Fwidget%2FNDC.Nomination.Candidate.Page%3Fhouse%3D\" +\n    data.indexerData.house +\n    \"%26candidate%3D\" +\n    data.indexerData.nominee;\n  return url;\n}\n\nconst Card = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 16px;\n  gap: 16px;\n  background: #f8f8f9;\n  border-radius: 10px;\n`;\nconst HeaderCard = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  width: 100%;\n`;\nconst ProfilePicture = styled.img`\n  width: 45px;\n  height: 45px;\n  border-radius: 50%;\n`;\nconst HeaderContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 4px;\n  width: 56%;\n`;\nconst HeaderTag = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 8px;\n  height: 18px;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  border-radius: 100px;\n`;\nconst HeaderTagP = styled.p`\n  height: 10px;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 11px;\n  display: flex;\n  align-items: center;\n  color: white;\n  margin: 0;\n`;\nconst UserLink = styled.a`\n  width: 100%;\n  cursor: pointer;\n  &:hover {\n    text-decoration: none;\n  }\n`;\nconst NominationName = styled.p`\n  font-weight: 500;\n  font-size: 14px;\n  margin: 0;\n  align-items: center;\n  color: #000000;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\nconst NominationUser = styled.p`\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  margin: 0px;\n  line-height: 120%;\n  display: flex;\n  align-items: center;\n  color: #828688;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst Icon = styled.img`\n  width: 17px;\n  height: 17px;\n`;\nconst CollapseCandidate = styled.div`\n  padding: 12px;\n  background: #ffffff;\n  border-radius: 6px;\n`;\nconst CollapseCandidateContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 5px;\n`;\nconst CollapseCandidateText = styled.p`\n  width: 274px;\n  font-style: normal;\n  font-weight: 700;\n  font-size: 12px;\n  line-height: 120%;\n  margin: 0px;\n  margin-bottom: 3px;\n  color: #000000;\n`;\nconst DownArrow = styled.img`\n  width: 16px;\n  height: 16px;\n`;\nconst CandidateTagContainer = styled.div`\n  gap: 4px;\n`;\n\nconst KeyIssues = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  padding: 12px;\n  gap: 12px;\n  background: #ffffff;\n  border-radius: 6px;\n  width: 100%;\n`;\nconst KeyIssuesContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 12px;\n  width: 100%;\n`;\nconst KeyIssuesHeader = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 12px;\n`;\nconst KeyIssuesTitle = styled.p`\n  font-style: normal;\n  font-weight: 700;\n  font-size: 14px;\n  line-height: 120%;\n  margin-bottom: 0;\n`;\nconst KeyIssuesContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 8px;\n  overflow-y: scroll;\n  height: 140px;\n  width: 100%;\n`;\nconst KeyIssueTitle = styled.p`\n  font-weight: 500;\n  font-size: 12px;\n  margin-bottom: 5px;\n  white-space: pre-wrap;\n`;\nconst KeyIssueDescription = styled.p`\n  font-weight: 400;\n  font-size: 11px;\n  margin-bottom: 0;\n`;\nconst KeyIssueSeparator = styled.div`\n  height: 1px;\n  margin: 7px 0 2px 0;\n  background: rgba(208, 214, 217, 0.4);\n`;\nconst LowerSection = styled.div`\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  gap: 8px;\n`;\nconst LowerSectionContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  gap: 12px;\n  align-self: stretch;\n`;\nconst ButtonsLowerSection = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  width: 100%;\n  height: 28px;\n`;\nconst TextLowerSectionContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  gap: 4px;\n  width: 239px;\n  height: 24px;\n\n  flex-grow: 1;\n`;\nconst ClockIcon = styled.img`\n  width: 12px;\n  height: 12px;\n`;\nconst TimestampText = styled.div`\n  font-style: italic;\n  font-weight: 300;\n  font-size: 11px;\n  line-height: 14px;\n  margin: 0px;\n  gap: 2px;\n  color: #000000;\n\n  b {\n    font-weight: 600;\n  }\n`;\nconst CommentsCounter = styled.p`\n  width: 96px;\n  height: 24px;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 24px;\n  margin: 0px;\n  text-align: right;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;\nconst ButtonsContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  gap: 4px;\n  width: 87px;\n  height: 28px;\n`;\nconst TagSection = styled.div`\n  display: flex;\n  align-items: flex-start;\n  gap: 4px;\n  flex-wrap: wrap;\n  overflow: hidden;\n`;\nconst DropdownContainer = styled.div`\n  position: relative;\n  display: inline-block;\n`;\n\nconst DropdownContent = styled.div`\n  display: none;\n  left: 0;\n  font-size: 12px;\n  flex-direction: column;\n  align-items: flex-start;\n  position: absolute;\n  border-radius: 8px;\n  background: #ffffff;\n  box-shadow: 0px 0px 30px 0px rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  z-index: 1;\n  padding: 8px;\n`;\n\nconst Element = styled.div`\n  width: 150px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  padding: 10px;\n\n  &:hover {\n    border-radius: 6px;\n    background: #f8f8f9;\n  }\n`;\n\nconst ShareLink = styled.a`\n  color: black;\n  margin-right: 8px 12px;\n  text-decoration: none;\n  display: block;\n  text-align: start;\n`;\n\nconst ShareIcon = styled.img`\n  width: 20px;\n`;\n\nconst DropdownContainerHover = styled.div`\n  width: fit-content;\n  float: right;\n\n  &:hover ${DropdownContent} {\n    display: flex;\n    margin-top: -165px;\n  }\n`;\n\nconst Separation = styled.div`\n    position: absolute;\n  }\n`;\n\nconst Wrapper = styled.div`\n    @media only screen and (max-width: 610px) {\n      width: 100%;\n    }\n  }\n`;\n\nconst canUpvote = () =>\n  state.verified &&\n  context.accountId &&\n  context.accountId != data.indexerData?.nominee;\n\nconst trimText = (text, limit) => {\n  if (!text) return \"\";\n\n  const _limit = limit ?? 200;\n  const ending = text.length > _limit ? \"...\" : \"\";\n  const trimmed = text.slice(0, limit ?? 200);\n\n  return `${trimmed}${ending}`;\n};\n\nconst keyIssues = [\n  {\n    title:\n      \"Involvement in the NEAR ecosystem, qualifications to be a candidate and reasons for being voted\",\n    desc: data.nominationData.HAYInvolve,\n  },\n  {\n    title: \"Strategy to develop the NEAR ecosystem\",\n    desc: data.nominationData.WIYStrategy,\n  },\n  {\n    title: \"View and pledge on the issue of User Experience and Accessibility\",\n    desc: data.nominationData.Key_Issue_1,\n  },\n  {\n    title: \"View and pledge on the issue of Economic Growth and Innovation\",\n    desc: data.nominationData.Key_Issue_2,\n  },\n  {\n    title: \"View and pledge on the issue of Marketing and Outreach\",\n    desc: data.nominationData.Key_Issue_3,\n  },\n  {\n    title: \"Other Platform\",\n    desc: data.nominationData.addition_platform,\n  },\n];\n\nconst houseMapping = {\n  HouseOfMerit: 1,\n  CouncilOfAdvisors: 2,\n  TransparencyCommission: 3,\n};\n\nreturn (\n  <Wrapper className=\"p-2 col-lg-4 col-md-6 col-sm-12\">\n    <Card>\n      {state.showModal && (\n        <Widget\n          src={widgets.addComment}\n          props={{\n            candidateOrReplay: true,\n            username: data.indexerData.nominee,\n            onClickConfirm: () => State.update({ showModal: false }),\n            onClickCancel: () => State.update({ showModal: false }),\n            nomination_contract,\n          }}\n        />\n      )}\n      <HeaderCard className=\"d-flex justify-content-between w-100\">\n        <div className=\"d-flex align-items-center gap-2 w-100 justify-content-between\">\n          <Widget\n            src=\"mob.near/widget/ProfileImage\"\n            props={{\n              accountId: data.nominationData?.profileAccount.substring(1),\n              imageClassName: \"rounded-circle w-100 h-100\",\n              style: { minWidth: \"45px\", height: \"45px\" },\n            }}\n          />\n          <HeaderContent>\n            <div className=\"mw-100\">\n              <Widget\n                src={widgets.styledComponents}\n                props={{\n                  Tag: {\n                    title:\n                      data.indexerData.house == \"HouseOfMerit\"\n                        ? \"House of Merit\"\n                        : data.indexerData.house == \"CouncilOfAdvisors\"\n                        ? \"Council of Advisors\"\n                        : \"Transparency Commission\",\n                    className: \"dark\",\n                  },\n                }}\n              />\n            </div>\n            <UserLink\n              href={`${widgets.candidatePage}?house=${\n                data.indexerData.house\n              }&accountId=${data.indexerData.nominee}${dev ? \"&dev=true\" : \"\"}`}\n            >\n              <NominationName>{data.profileData?.name}</NominationName>\n              <NominationUser>{data.indexerData.nominee}</NominationUser>\n            </UserLink>\n          </HeaderContent>\n\n          <Widget\n            src={widgets.styledComponents}\n            props={{\n              Link: {\n                disabled: !canUpvote(),\n                text: \"Vote\",\n                className: \"primary dark\",\n                size: \"sm\",\n                href: `#/election.ndctools.near/widget/NDC.Elections.Main?house=${\n                  houseMapping[data.indexerData.house]\n                }&candidates=[\"${data.indexerData.nominee}\"]`,\n                icon: (\n                  <img\n                    style={{ \"margin-bottom\": \"5px\" }}\n                    src=\"https://ipfs.near.social/ipfs/bafkreia4iqjdjqhwplrunkjvmri2c6egm2pmlt56f3n6qesmy5ofw27g3y\"\n                  />\n                ),\n              },\n            }}\n          />\n        </div>\n      </HeaderCard>\n      <CollapseCandidate className=\"w-100\">\n        <CollapseCandidateContent>\n          <CollapseCandidateText>Candidate Affiliations</CollapseCandidateText>\n          <CandidateTagContainer className=\"w-100 d-flex flex-wrap\">\n            {JSON.parse(data.nominationData?.afiliation).map((data) => (\n              <>\n                {data.company_name && (\n                  <Widget\n                    src={widgets.styledComponents}\n                    props={{\n                      Tag: { title: data.company_name },\n                    }}\n                  />\n                )}\n              </>\n            ))}\n          </CandidateTagContainer>\n        </CollapseCandidateContent>\n      </CollapseCandidate>\n      <KeyIssues>\n        <KeyIssuesContent>\n          <KeyIssuesHeader>\n            <KeyIssuesTitle>Platform</KeyIssuesTitle>\n          </KeyIssuesHeader>\n          <KeyIssuesContainer>\n            {keyIssues.map((issue, i) => (\n              <div className=\"w-100\" key={i}>\n                <KeyIssueTitle>{issue.title}</KeyIssueTitle>\n                <KeyIssueDescription className=\"text-secondary\">\n                  <Widget\n                    src=\"mob.near/widget/SocialMarkdown\"\n                    props={{ text: trimText(issue.desc) }}\n                  />\n                </KeyIssueDescription>\n                <KeyIssueSeparator />\n              </div>\n            ))}\n          </KeyIssuesContainer>\n        </KeyIssuesContent>\n      </KeyIssues>\n      <LowerSection>\n        <LowerSectionContainer>\n          {data.nominationData.tags.length > 0 && (\n            <KeyIssues>\n              <KeyIssuesContent>\n                <KeyIssuesHeader>\n                  <KeyIssuesTitle>Tags</KeyIssuesTitle>\n                </KeyIssuesHeader>\n                <div className=\"d-flex w-100\">\n                  <TagSection>\n                    {data.nominationData.tags\n                      .trim()\n                      .split(\",\")\n                      .map((data) => (\n                        <>\n                          {data && (\n                            <Widget\n                              src={widgets.styledComponents}\n                              props={{\n                                Tag: { title: data },\n                              }}\n                            />\n                          )}\n                        </>\n                      ))}\n                  </TagSection>\n                </div>\n              </KeyIssuesContent>\n            </KeyIssues>\n          )}\n          <ButtonsLowerSection>\n            <TextLowerSectionContainer className=\"align-items-center\">\n              <i className=\"bi bi-clock\"></i>\n              {data.indexerData.timestamp && (\n                <TimestampText>\n                  <span>\n                    {new Date(data.indexerData.timestamp).toDateString()}\n                  </span>\n                  <span>by</span>\n                  <b>{data.indexerData.nominee}</b>\n                </TimestampText>\n              )}\n            </TextLowerSectionContainer>\n          </ButtonsLowerSection>\n          <div className=\"d-flex w-100 align-items-center\">\n            {!data.preview && (\n              <div className=\"d-flex w-100 gap-2 justify-content-between\">\n                <Widget\n                  src={widgets.styledComponents}\n                  props={{\n                    Button: {\n                      text: `+${data.upVoteData.comments.length ?? 0} Comments`,\n                      disabled: true,\n                      size: \"sm\",\n                      className:\n                        \"secondary dark w-100 justify-content-center text-nowrap\",\n                      onClick: () => {\n                        !data.preview ? State.update({ showModal: true }) : \"\";\n                      },\n                      icon: <i className=\"bi bi-chat-square-text-fill\"></i>,\n                    },\n                  }}\n                />\n                <Widget\n                  src={widgets.styledComponents}\n                  props={{\n                    Link: {\n                      text: \"View\",\n                      size: \"sm\",\n                      className: \"primary w-100 justify-content-center\",\n                      href: `${widgets.candidatePage}?house=${\n                        data.indexerData.house\n                      }&accountId=${data.indexerData.nominee}${\n                        dev ? \"&dev=true\" : \"\"\n                      }`,\n                      icon: <i className=\"bi bi-eye fs-6\"></i>,\n                    },\n                  }}\n                />\n              </div>\n            )}\n          </div>\n        </LowerSectionContainer>\n      </LowerSection>\n    </Card>\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nomination.ndctools.near/widget/NDC.Nomination.Card", "fact_widget_deployments_id": "2723785ec59c812188b33b285f65d11f", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
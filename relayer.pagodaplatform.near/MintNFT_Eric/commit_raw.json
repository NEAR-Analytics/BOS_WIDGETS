{"tx_hash": "5yhAN6wom2i7tnSp4XfNFtqqRAcBhho247eYXgstsjFd", "action_id_social": "GbSSnoxNP7iKKUf8frjdd9WmqsWf8g3YpfoSaxi3PYbU-0-widget", "block_id": 96507893, "block_timestamp": "2023-07-15T05:36:31.305Z", "signer_id": "relayer.pagodaplatform.near", "widget_name": "MintNFT_Eric", "source_code": "let { address, tokenId } = props;\n\nlet currentTime = new Date().getTime() / 1000;\n\nState.init({\n  destination: props.destination,\n  expires: currentTime,\n  transaction: null,\n  loading: false,\n  error: null,\n});\n\nconst mintNFT = () => {\n  const nftABI = fetch(\n    \"https://raw.githubusercontent.com/atilatech/together/f69d581b5f6d14b1d9f0d85dbd488f6d7ebce01b/src/artifacts/contracts/RentableNFT.sol/RentableNFT.json\"\n  );\n\n  console.log(\"nftABI\", nftABI);\n\n  const signer = Ethers.provider().getSigner();\n\n  const contractAbi = JSON.parse(nftABI.body);\n  console.log(\"signer, contractAbi\", { signer, contractAbi });\n  const nftContract = new ethers.Contract(address, contractAbi.abi, signer);\n  console.log({ nftContract });\n  console.log(\"state.destination\", state.destination);\n\n  const _tokenURI = nftContract[\"tokenURI(uint256)\"](tokenId).then(\n    (transaction) => {\n      console.log(\"Transaction Hash:\", transaction);\n      State.update({ loading: true });\n      transaction.wait().then(() => {\n        console.log(\"NFT rented successfully!\");\n        State.update({ transaction: transaction, loading: false });\n        console.log(\n          \"Transaction URL:\",\n          `https://goerli.etherscan.io/tx/${transaction.hash}`\n        );\n      });\n    }\n  );\n\n  // {\n  //       \"inputs\": [\n  //         {\n  //           \"internalType\": \"uint256\",\n  //           \"name\": \"tokenId\",\n  //           \"type\": \"uint256\"\n  //         }\n  //       ],\n  //       \"name\": \"tokenURI\",\n  //       \"outputs\": [\n  //         {\n  //           \"internalType\": \"string\",\n  //           \"name\": \"\",\n  //           \"type\": \"string\"\n  //         }\n  //       ],\n  //       \"stateMutability\": \"view\",\n  //       \"type\": \"function\"\n  //     },\n\n  nftContract[\"mint(string)\"](_tokenURI)\n    .then((transaction) => {\n      console.log(\"Transaction Hash:\", transaction);\n      State.update({ loading: true });\n      transaction.wait().then(() => {\n        // {\n        //       \"inputs\": [\n        //         {\n        //           \"internalType\": \"string\",\n        //           \"name\": \"_tokenURI\",\n        //           \"type\": \"string\"\n        //         }\n        //       ],\n        //       \"name\": \"mint\",\n        //       \"outputs\": [],\n        //       \"stateMutability\": \"nonpayable\",\n        //       \"type\": \"function\"\n        //     },\n\n        console.log(\"NFT minted successfully!\");\n        State.update({ transaction: transaction, loading: false });\n        console.log(\n          \"Transaction URL:\",\n          `https://goerli.etherscan.io/tx/${transaction.hash}`\n        );\n      });\n    })\n    .catch((error) => {\n      console.log(\"error\", error);\n      State.update({ error: error.reason || \"Error occured in transaction\" });\n    });\n};\n\nconst transferButton = (\n  <button\n    className=\"btn btn-primary m-3\"\n    onClick={() => mintNFT()}\n    disabled={state.loading}\n  >\n    Mint NFT\n  </button>\n);\n\nconst setDestinationAddress = (value) => {\n  State.update({ destination: value });\n};\n\nreturn (\n  <div className=\"EventDetail container card shadow my-5 p-5\">\n    <h3 className=\"text-center mb-3\">Mint NFT</h3>\n    <div className=\"container\">\n      <div className=\"card shadow-sm\">\n        <div className=\"card-body\">\n          <label className=\"mb-1\">Token ID</label>\n          <input\n            type=\"number\"\n            placeholder=\"Enter Token ID\"\n            value={state.destination}\n            onChange={(e) => setDestinationAddress(e.target.value)}\n            className=\"form-control mb-3\"\n          />\n          {expiresSection}\n          {transferButton}\n          {state.loading && (\n            <>\n              <p className=\"text-primary\">Loading transaction...</p>\n              <div class=\"progress\">\n                <div\n                  class=\"progress-bar progress-bar-striped progress-bar-animated\"\n                  role=\"progressbar\"\n                  aria-valuenow=\"100\"\n                  aria-valuemin=\"0\"\n                  aria-valuemax=\"100\"\n                  style={{ width: \"100%\" }}\n                ></div>\n              </div>\n            </>\n          )}\n          {state.transaction && (\n            <p className=\"text-success\">\n              Rental was succesful!\n              <a\n                href={`https://goerli.etherscan.io/tx/${state.transaction.hash}`}\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                View Transaction\n              </a>\n            </p>\n          )}\n          {state.error && <p className=\"text-danger\">{state.error}</p>}\n        </div>\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/relayer.pagodaplatform.near/widget/MintNFT_Eric", "fact_widget_deployments_id": "328960791f7ff7a11e91456f47958dfa", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 2}
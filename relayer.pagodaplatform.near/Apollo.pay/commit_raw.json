{"tx_hash": "7x5t2BthrF4PV46KquFdadycD9uep4UHQb4jPQ6ybtB2", "action_id_social": "3X2S96mDn6gM1p6UU7mfYkCJjT5SHrq2Wn6dwKruXM9k-0-widget", "block_id": 97323025, "block_timestamp": "2023-07-25T19:46:05.265Z", "signer_id": "relayer.pagodaplatform.near", "widget_name": "Apollo.pay", "source_code": null, "metadata": null, "branch": {"draft": {"": "State.init({\n  stage: \"0\",\n  country: \"ke\",\n  billInfo: {},\n  tillInfo: {},\n  phoneInfo: {},\n  senderInfo: {},\n  sentToEscrow: false,\n  error: false,\n  success: false,\n});\n\nconst ecr20abi = fetch(\n  \"https://raw.githubusercontent.com/corndao/aave-v3-bos-app/main/abi/ERC20Permit.json\"\n).body;\n//const usdcAddresses = fetch(\"\");\nconst usdTestAddress = \"0xfe4F5145f6e09952a5ba9e956ED0C25e3Fa4c7F1\";\nconst apolloPayEscrow = \"0x160d136869e86189a58864Cc40777cDD355501f5\";\n//const usdtAddresses = fetch(\"\");\n\nconst Wrapper = styled.div`\n      display: flex;\n      flex-direction: column;\n      color: blueviolet;\n      padding: 0px 20px 20px 20px;\n      border-radius: 20px;\n      box-shadow: 12px 12px 2px 1px blueviolet;;\n`;\n\nconst Header = styled.div`\n   display: flex;\n   flex-direction: row;\n   justify-content: center;\n   align-items: center;\n`;\n\nconst Content = styled.div`\n   display: flex;\n   flex-direction: column;\n   padding: 10px;\n\n`;\n\nconst StyledButton = styled.button`\n       \n      width:100%;\n      padding: 5px;\n      border-radius: 5px;\n      border-width: 0px;\n      box-shadow: 0px 10px 15px blueviolet;\n    background-color: blueviolet;\n    color: white;\n   background-color: blueviolet;\n`;\n\nconst StyledOl = styled.div`\n   display: flex;\n  flex-direction: row;\n    justify-content: center;\n   align-items: center;\n\n`;\n\nconst StyledInput = styled.input`\n     padding: 5px;\n     border-radius: 5px;\n     border-color:grey;\n     \n    \n\n     :focus {\n      filter: brightness(0.85);\n      background-color:rgb(206, 157, 251);\n       border-color: blueviolet;\n  }\n`;\n\nfunction updateStage(position) {\n  State.update({ ...state, stage: position });\n}\n\nfunction updateCountry(country) {\n  State.update({ ...state, country });\n}\n\nasync function wallletRequestSendTransaction(amount) {\n  const signer = Ethers.provider().getSigner();\n  const sendContract = new ethers.Contract(\n    usdTestAddress,\n    JSON.parse(ecr20abi),\n    signer\n  );\n\n  const prep = sendContract.transfer(apolloPayEscrow, 30);\n\n  prep\n    .then((value) => {\n      console.log(\"Oh yessss!\");\n      console.log({\n        value,\n      });\n\n      State.update({ ...state, sucess: true, stage: \"5\" });\n      return;\n    })\n    .catch((error) => {\n      console.log(\"Oh noooo!\");\n      console.log({\n        error,\n      });\n      State.update({ ...state, sucess: false, stage: \"6\" });\n    });\n}\n\nconst initiatePayout = () => {};\n\nconst sender = Ethers.send(\"eth_requestAccounts\", [])[0];\n\nreturn (\n  <Wrapper>\n    {/* src=\"near/widget/Onboarding.ComponentCard\" to be pasted below */}\n\n    <div>\n      <Header>\n        <h1> Apollo Pay </h1>\n        {sender ? (\n          <p>Account: {sender}</p>\n        ) : (\n          <Web3Connect className=\"web3-connect\" connectLabel=\"Connect Wallet\" />\n        )}\n      </Header>\n      <StyledOl>\n        <h6> Get started &#62; </h6>\n        <h6> select mode & countries &#62; </h6>\n        <h6> Set Amount& Details &#62; </h6>\n        <h6> Pay</h6>\n      </StyledOl>\n    </div>\n\n    {state.stage == \"0\" && (\n      <Content>\n        <p> Pay for your goods and services in East Africa </p>\n        <div>\n          <select\n            name=\"countries\"\n            id=\"\"\n            onChange={(e) => updateCountry(e.target.value)}\n          >\n            <option value=\"0\">--Please choose country --</option>\n            <option value=\"Kenya\">Kenya</option>\n            <option value=\"Uganda\">Uganda</option>\n            <option value=\"Rwanda\">Rwanda</option>\n            <option value=\"Tanzania\">Tanzania</option>\n          </select>\n\n          <select\n            name=\"paymenttype\"\n            id=\"paymenttype\"\n            onChange={(e) => updateStage(e.target.value)}\n          >\n            <option value={0}>--Please payment Type--</option>\n            <option value={1}> Pay Bill</option>\n            <option value={2}>Buy Goods or services</option>\n            <option value={3}> Pay To Phonenumber </option>\n          </select>\n        </div>\n      </Content>\n    )}\n\n    {state.stage == \"1\" && (\n      <Content>\n        <StyledInput\n          placeholder=\"Paybill\"\n          id=\"paybill\"\n          name=\"paybill\"\n          type=\"text\"\n          required\n        />\n\n        <StyledInput\n          id=\"accountnumber\"\n          name=\"accountnumber \"\n          placeholder=\"Account Number\"\n          type=\"text\"\n          required\n        />\n\n        <StyledInput\n          placeholder=\"Amount\"\n          id=\"amount\"\n          name=\"amount\"\n          type=\"number\"\n          required\n        />\n        <StyledButton onClick={() => updateStage(\"4\")}> Pay </StyledButton>\n      </Content>\n    )}\n\n    {/* List of most utils: Water , elec , Gas Cooking, internet */}\n    {state.stage == \"2\" && (\n      <Content>\n        <StyledInput\n          placeholder=\"Till Number\"\n          id=\"tillnumber\"\n          name=\"tillnumber\"\n          type=\"text\"\n        />\n\n        <StyledInput\n          placeholder=\"Amount\"\n          id=\"amount\"\n          name=\"amount\"\n          type=\"number\"\n        />\n\n        <StyledButton onClick={() => updateStage(\"4\")}> Pay </StyledButton>\n      </Content>\n    )}\n\n    {state.stage == \"3\" && (\n      <Content>\n        <StyledInput\n          id=\"Phonenumber\"\n          placeholder=\"Amount\"\n          name=\"Phonenumber\"\n          type=\"phone\"\n          required\n        />\n        <StyledInput\n          placeholder=\"Amount\"\n          id=\"amount\"\n          name=\"amount\"\n          type=\"number\"\n        />\n        <StyledButton onClick={() => updateStage(\"4\")}> Pay </StyledButton>{\" \"}\n      </Content>\n    )}\n\n    {state.stage == \"4\" && (\n      <div>\n        Amount : ssdsdsdsd\n        <br />\n        Till NNumber: edssdsdsd\n        <StyledButton onClick={() => wallletRequestSendTransaction(20)}>\n          {\" \"}\n          Send Coin{\" \"}\n        </StyledButton>{\" \"}\n      </div>\n    )}\n\n    {state.stage == \"5\" && (\n      <div>\n        <h4> Sucess !! </h4>\n        <input />\n      </div>\n    )}\n\n    {state.stage == \"6\" && (\n      <div>\n        <h4> oops something went wrong!! </h4>\n        <button>Retry</button>\n\n        <button>Reset</button>\n      </div>\n    )}\n  </Wrapper>\n);\n"}}, "widget_modules_used": null, "widget_url": "https://near.social/#/relayer.pagodaplatform.near/widget/Apollo.pay", "fact_widget_deployments_id": "d18335fd3da5d73e0fec54d791259b27", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
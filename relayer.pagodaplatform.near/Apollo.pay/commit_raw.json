{"tx_hash": "DfVeK5rsJ4XgFBzADkfgr2Fg4BRHoWoBYcpJ8D4LgRm", "action_id_social": "J8rnBhzxksh98ScVM91xH3pf89Wq6d26wvxFQcVzyRqu-0-widget", "block_id": 96862362, "block_timestamp": "2023-07-19T20:24:34.044Z", "signer_id": "relayer.pagodaplatform.near", "widget_name": "Apollo.pay", "source_code": "State.init({\n  stage: 0,\n  country: \"ke\",\n  billInfo: {},\n  tillInfo: {},\n  phoneInfo: {},\n  senderInfo: {},\n  sentToEscrow: false,\n  error: false,\n  success: false,\n});\n\nconst ecr20abi = fetch(\n  \"https://raw.githubusercontent.com/corndao/aave-v3-bos-app/main/abi/ERC20Permit.json\"\n).body;\n//const usdcAddresses = fetch(\"\");\nconst usdTestAddress = \"0xfe4F5145f6e09952a5ba9e956ED0C25e3Fa4c7F1\";\nconst apolloPayEscrow = \"0x160d136869e86189a58864Cc40777cDD355501f5\";\n//const usdtAddresses = fetch(\"\");\n\nconst Wrapper = styled.div`\n  .hidden {\n    display: none;\n  }\n \n`;\n\nfunction updateStage(position) {\n  State.update({ ...state, stage: position });\n}\n\nfunction updateCountry(country) {\n  State.update({ ...state, country });\n}\n\nasync function wallletRequestSendTransaction(amount) {\n  const signer = Ethers.provider().getSigner();\n  const sendContract = new ethers.Contract(\n    usdTestAddress,\n    JSON.parse(ecr20abi),\n    signer\n  );\n\n  const prep = sendContract.transfer(apolloPayEscrow, 30);\n\n  prep\n    .then((value) => {\n      console.log(\"Oh yessss!\");\n      console.log({\n        value,\n      });\n\n      State.update({ ...state, sucess: true, stage: \"5\" });\n      return;\n    })\n    .catch((error) => {\n      console.log(\"Oh noooo!\");\n      console.log({\n        error,\n      });\n      State.update({ ...state, sucess: false, stage: \"6\" });\n    });\n}\n\nconst initiatePayout = () => {};\n\nconst sender = Ethers.send(\"eth_requestAccounts\", [])[0];\n\nreturn (\n  <Wrapper>\n    {/* src=\"near/widget/Onboarding.ComponentCard\" to be pasted below */}\n\n    <div>\n      <h1> Apollo Pay </h1>\n      Pay for your goods and services in East Africa\n      <br />\n      {sender ? (\n        <p>Account: {sender}</p>\n      ) : (\n        <Web3Connect className=\"web3-connect\" connectLabel=\"Connect Wallet\" />\n      )}\n      <div>\n        <select\n          name=\"countries\"\n          id=\"\"\n          onChange={(e) => updateCountry(e.target.value)}\n        >\n          <option value=\"0\">--Please choose country --</option>\n          <option value=\"Kenya\">Kenya</option>\n          <option value=\"Uganda\">Uganda</option>\n          <option value=\"Rwanda\">Rwanda</option>\n          <option value=\"Tanzania\">Tanzania</option>\n        </select>\n\n        <select\n          name=\"paymenttype\"\n          id=\"paymenttype\"\n          onChange={(e) => updateStage(e.target.value)}\n        >\n          <option value={0}>--Please payment Type--</option>\n          <option value={1}> Pay Bill</option>\n          <option value={2}>Buy Goods or services</option>\n          <option value={3}> Pay To Phonenumber </option>\n        </select>\n      </div>\n    </div>\n    <br />\n\n    {state.stage == \"1\" && (\n      <div>\n        <label for=\"paybill\">Paybill</label>\n        <input id=\"paybill\" name=\"paybill\" type=\"text\" required />\n\n        <label for=\"accountumber\">Account Number</label>\n        <input id=\"accountnumber\" name=\"accountnumber \" type=\"text\" required />\n\n        <label for=\"Amount\">Amount</label>\n        <input id=\"amount\" name=\"amount\" type=\"number\" required />\n        <button onClick={() => updateStage(\"4\")}> Pay </button>\n      </div>\n    )}\n\n    {/* List of most utils: Water , elec , Gas Cooking, internet */}\n    {state.stage == \"2\" && (\n      <div>\n        <label for=\"tillnumber\"> Till Number</label>\n        <input id=\"tillnumber\" name=\"tillnumber\" type=\"text\" />\n\n        <label for=\"Amount\">Amount</label>\n        <input id=\"amount\" name=\"amount\" type=\"number\" />\n\n        <button onClick={() => updateStage(\"4\")}> Pay </button>\n      </div>\n    )}\n\n    {state.stage == \"3\" && (\n      <div>\n        <label for=\"Phonenumber\">Phonenumber</label>\n        <input id=\"Phonenumber\" name=\"Phonenumber\" type=\"phone\" required />\n        <label for=\"Amount\">Amount</label>\n        <input id=\"amount\" name=\"amount\" type=\"number\" />\n        <button onClick={() => updateStage(\"4\")}> Pay </button>{\" \"}\n      </div>\n    )}\n\n    {state.stage == \"4\" && (\n      <div>\n        <button onClick={() => wallletRequestSendTransaction(20)}>\n          {\" \"}\n          Send Coin{\" \"}\n        </button>{\" \"}\n      </div>\n    )}\n\n    {state.stage == \"5\" && (\n      <div>\n        <h4> Sucess !! </h4>\n        <input />\n      </div>\n    )}\n\n    {state.stage == \"6\" && (\n      <div>\n        <h4> oops something went wrong!! </h4>\n        <button>Retry</button>\n\n        <button>Reset</button>\n      </div>\n    )}\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/relayer.pagodaplatform.near/widget/Apollo.pay", "fact_widget_deployments_id": "b51ce9a7f5cff77c4aad83141ee111a0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 4}
{"tx_hash": "F1NtH7Xa38KC2NiS53haZAnXzkgKVoqW1kqo657y8ZZL", "action_id_social": "3wVwY1CLt18eamzH8PLSuvtduWEBDNq6PRmS3yatwacZ-0-widget", "block_id": 105305488, "block_timestamp": "2023-11-09T16:19:31.330Z", "signer_id": "relayer.pagodaplatform.near", "widget_name": "NewQuorum", "source_code": null, "metadata": null, "branch": {"draft": {"": "State.init({\n  documentCid: \"\",\n  isUploading: false,\n  expiration: \"\",\n  quorum: 0,\n  participants: [],\n\n  contractName: \"\",\n  expiration: \"\",\n});\n\nconst abi = `[ { \"inputs\": [ { \"internalType\": \"string\", \"name\": \"_documentCid\", \"type\": \"string\" }, { \"internalType\": \"uint8\", \"name\": \"_vote\", \"type\": \"uint8\" } ], \"name\": \"addVote\", \"outputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"function\" }, { \"inputs\": [], \"name\": \"currentDocumentId\", \"outputs\": [ { \"internalType\": \"uint256\", \"name\": \"\", \"type\": \"uint256\" } ], \"stateMutability\": \"view\", \"type\": \"function\" }, { \"inputs\": [ { \"internalType\": \"string\", \"name\": \"\", \"type\": \"string\" } ], \"name\": \"docCidToVoting\", \"outputs\": [ { \"internalType\": \"uint256\", \"name\": \"documentId\", \"type\": \"uint256\" }, { \"internalType\": \"string\", \"name\": \"documentName\", \"type\": \"string\" }, { \"internalType\": \"address\", \"name\": \"owner\", \"type\": \"address\" }, { \"internalType\": \"string\", \"name\": \"documentCid\", \"type\": \"string\" }, { \"internalType\": \"uint64\", \"name\": \"expiration\", \"type\": \"uint64\" }, { \"internalType\": \"uint256\", \"name\": \"quorum\", \"type\": \"uint256\" } ], \"stateMutability\": \"view\", \"type\": \"function\" }, { \"inputs\": [ { \"internalType\": \"uint256\", \"name\": \"\", \"type\": \"uint256\" } ], \"name\": \"docIdToCid\", \"outputs\": [ { \"internalType\": \"string\", \"name\": \"\", \"type\": \"string\" } ], \"stateMutability\": \"view\", \"type\": \"function\" }, { \"inputs\": [], \"name\": \"getAllDocuments\", \"outputs\": [ { \"components\": [ { \"internalType\": \"uint256\", \"name\": \"documentId\", \"type\": \"uint256\" }, { \"internalType\": \"string\", \"name\": \"documentName\", \"type\": \"string\" }, { \"internalType\": \"address\", \"name\": \"owner\", \"type\": \"address\" }, { \"internalType\": \"string\", \"name\": \"documentCid\", \"type\": \"string\" }, { \"internalType\": \"address[]\", \"name\": \"participants\", \"type\": \"address[]\" }, { \"internalType\": \"uint64\", \"name\": \"expiration\", \"type\": \"uint64\" }, { \"internalType\": \"uint256\", \"name\": \"quorum\", \"type\": \"uint256\" }, { \"internalType\": \"uint8[]\", \"name\": \"currentVotes\", \"type\": \"uint8[]\" } ], \"internalType\": \"struct Calimocho.DocumentVoting[]\", \"name\": \"\", \"type\": \"tuple[]\" } ], \"stateMutability\": \"view\", \"type\": \"function\" }, { \"inputs\": [ { \"internalType\": \"address\", \"name\": \"_owner\", \"type\": \"address\" } ], \"name\": \"getOwnerDocuments\", \"outputs\": [ { \"components\": [ { \"internalType\": \"uint256\", \"name\": \"documentId\", \"type\": \"uint256\" }, { \"internalType\": \"string\", \"name\": \"documentName\", \"type\": \"string\" }, { \"internalType\": \"address\", \"name\": \"owner\", \"type\": \"address\" }, { \"internalType\": \"string\", \"name\": \"documentCid\", \"type\": \"string\" }, { \"internalType\": \"address[]\", \"name\": \"participants\", \"type\": \"address[]\" }, { \"internalType\": \"uint64\", \"name\": \"expiration\", \"type\": \"uint64\" }, { \"internalType\": \"uint256\", \"name\": \"quorum\", \"type\": \"uint256\" }, { \"internalType\": \"uint8[]\", \"name\": \"currentVotes\", \"type\": \"uint8[]\" } ], \"internalType\": \"struct Calimocho.DocumentVoting[]\", \"name\": \"\", \"type\": \"tuple[]\" } ], \"stateMutability\": \"view\", \"type\": \"function\" }, { \"inputs\": [ { \"internalType\": \"address\", \"name\": \"\", \"type\": \"address\" }, { \"internalType\": \"uint256\", \"name\": \"\", \"type\": \"uint256\" } ], \"name\": \"ownerToVotings\", \"outputs\": [ { \"internalType\": \"uint256\", \"name\": \"documentId\", \"type\": \"uint256\" }, { \"internalType\": \"string\", \"name\": \"documentName\", \"type\": \"string\" }, { \"internalType\": \"address\", \"name\": \"owner\", \"type\": \"address\" }, { \"internalType\": \"string\", \"name\": \"documentCid\", \"type\": \"string\" }, { \"internalType\": \"uint64\", \"name\": \"expiration\", \"type\": \"uint64\" }, { \"internalType\": \"uint256\", \"name\": \"quorum\", \"type\": \"uint256\" } ], \"stateMutability\": \"view\", \"type\": \"function\" }, { \"inputs\": [ { \"internalType\": \"string\", \"name\": \"_documentName\", \"type\": \"string\" }, { \"internalType\": \"string\", \"name\": \"_documentCid\", \"type\": \"string\" }, { \"internalType\": \"address[]\", \"name\": \"_participants\", \"type\": \"address[]\" }, { \"internalType\": \"uint64\", \"name\": \"_expiration\", \"type\": \"uint64\" }, { \"internalType\": \"uint256\", \"name\": \"_quorum\", \"type\": \"uint256\" } ], \"name\": \"registerDocument\", \"outputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"function\" } ]`;\n\nconst contract = new ethers.Contract(\n  \"0x3d2b168d1807f04835d213f386c644b138cb0ee8\",\n  abi,\n  Ethers.provider()\n);\n\nconst ProjectContainer = styled.div`\n  width: 800px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-inline: 8px;\n  color: #0095b6;\n  border-style: solid;\n\n  .cali-btn-primary {\n    background-color: #0095b6;\n    color: white;\n    border: none;\n  }\n`;\nconst Button = styled.div`\n  height: 60px;\n  width: 100%;\n  display: flex;\n  justify-content: end;\n  align-items: center;\n  gap: 12px;\n  font-weight: 500;\n\n  a {\n    color: #0095b6;\n    font-size: 16px;\n  }\n`;\n\nconst uploadFileUpdateState = (body) => {\n  asyncFetch(\"https://ipfs.near.social/add\", {\n    method: \"POST\",\n    headers: { Accept: \"application/json\" },\n    body,\n  }).then((res) => {\n    const cid = res.body.cid;\n    console.log(\"DocumentCid: \", cid);\n    State.update({ documentCid: cid, isUploading: false });\n  });\n};\n\nconst filesOnChange = (files) => {\n  if (files) {\n    State.update({ isUploading: true, documentCid: \"\" });\n    uploadFileUpdateState(files[0]);\n  }\n};\n\nconst onNameChange = (e) => {\n  state.contractName = e.target.value;\n};\n\nconst onExpirationChange = (e) => {\n  console.log(\"expiration: \", e);\n  state.expiration = e.target.value;\n};\n\nfunction getAllDocuments() {\n  contract\n    .getAllDocuments()\n    // .currentDocumentId()\n    .then((docId) => {\n      console.log(\"DocId: \", docId);\n      console.log(\"there\");\n    })\n    .catch((e) => console.log(\"Error calling getAllDocuments: \", e.message));\n}\ngetAllDocuments();\n\n// Login Check\nconst loggedIn = !!context.accountId;\n\nconst Main = (\n  <ProjectContainer className=\"m-2 p-4\">\n    <div className=\"row\">\n      <div ClassName=\"center\">\n        <h4 style={{ fontWeight: 1000 }}>Calimocho</h4>\n        <h5 style={{ fontWeight: 200 }}>contract sign</h5>\n      </div>\n\n      <div>\n        <div\n          className=\"flex flex-wrap flex-1 text-center justify-center border rounded m-4\"\n          hidden={!loggedIn}\n        >\n          <label className=\"font-bold mr-8\">\n            duration time:\n            <select className=\"p-2 m-2 border rounded\">\n              <option value=\"1\">1 day</option>\n              <option value=\"1\">2 day</option>\n              <option value=\"1\">3 day</option>\n              <option value=\"1\">4 day</option>\n              <option value=\"2\">5 days</option>\n              <option value=\"3\">1 week</option>\n              <option value=\"4\">2 weeks</option>\n              <option value=\"4\">3 weeks</option>\n              <option value=\"4\">4 weeks</option>\n            </select>\n          </label>\n\n          <label className=\"\" hidden={!loggedIn}>\n            minimal person quorum:\n            <select className=\"p-2 m-2 border rounded\">\n              <option value=\"2\">2 persons</option>\n              <option value=\"3\">3 persons</option>\n              <option value=\"4\">4 persons</option>\n              <option value=\"4\">5 persons</option>\n              <option value=\"4\">6 persons</option>\n              <option value=\"4\">7 persons</option>\n              <option value=\"4\">8 persons</option>\n              <option value=\"4\">9 persons</option>\n              <option value=\"4\">10 persons</option>\n            </select>\n          </label>\n        </div>\n        <div class=\"p-4\">\n          <div className=\"input-group pb-4\" hidden={!loggedIn}>\n            <input placeholder=\"contract name\" onChange={onNameChange} />\n          </div>\n\n          <div className=\"input-group pb-4\" hidden={!loggedIn}>\n            <input\n              type=\"date\"\n              placeholder=\"date\"\n              onChange={onExpirationChange}\n            />\n          </div>\n          <div className=\"input-group pb-4\" hidden={!loggedIn}>\n            <input placeholder=\"participants\" onChange={onInputChange} />\n          </div>\n          <div\n            className=\"flex justify-center p-2 button-group text-center\"\n            hidden={!loggedIn}\n          ></div>\n\n          <div className=\"input-group pb-4\" hidden={!loggedIn}>\n            <input\n              disabled\n              placeholder=\"upload file...\"\n              value={\n                state.documentCid && `https://ipfs.io/ipfs/${state.documentCid}`\n              }\n              onChange={onInputChange}\n            />\n            <Files\n              multiple={false}\n              accepts={[\"application/pdf\"]}\n              minFileSize={1}\n              clickable\n              className=\"btn btn-outline-primary cali-btn-primary\"\n              onChange={filesOnChange}\n            >\n              {state.isUploading ? <> Uploading </> : \"Upload an Document\"}\n            </Files>\n          </div>\n        </div>\n\n        <p class=\"text-center py-2\" hidden={loggedIn}>\n          Login to Sign the contract\n        </p>\n      </div>\n\n      <div className=\"\">\n        <Button className=\"p-2\">\n          <a\n            href=\"#\"\n            style={{\n              backgroundColor: \"#0095b6\",\n              color: \"#FFF\",\n              height: 40,\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              paddingInline: 24,\n              border: \"2px solid black\",\n            }}\n          >\n            Publish\n          </a>\n        </Button>\n        <Button className=\"p-2\">\n          <a\n            href=\"#\"\n            style={{\n              backgroundColor: \"#f7a3b0\",\n              color: \"#FFF\",\n              height: 40,\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              paddingInline: 24,\n              border: \"2px solid black\",\n            }}\n          >\n            Cancel\n          </a>\n        </Button>\n      </div>\n    </div>\n  </ProjectContainer>\n);\n\nreturn <div>{Main}</div>;\n"}}, "widget_modules_used": null, "widget_url": "https://near.social/#/relayer.pagodaplatform.near/widget/NewQuorum", "fact_widget_deployments_id": "cb12e3c81aed03ee8806d75c49b9e942", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
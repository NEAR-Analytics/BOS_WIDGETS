{"tx_hash": "4mZUG3P32KrfgzXs1rsRt17XeHXqVdv2wYw91VegT878", "action_id_social": "3tmiPzMrTWBREbCixSXDf8TMg16z6UeUfdcd2Jr5qT74-0-widget", "block_id": 108217441, "block_timestamp": "2023-12-18T02:39:28.530Z", "signer_id": "relayer.pagodaplatform.near", "widget_name": "test-contract", "source_code": "if (state.sender == undefined && Ethers.provider()) {\n  Ethers.provider()\n    .send(\"eth_requestAccounts\", [])\n    .then((accounts) => {\n      if (accounts.length) {\n        // save sender address to the state\n        State.update({ sender: accounts[0] });\n      }\n    });\n}\n\nconst BillBOSCoreABI = fetch(\n  \"https://gist.githubusercontent.com/jimmy-ez/f5f8dd1487cf564e561f5302efb910d8/raw/2155161dbe2e9e09b6d89890440b820dc2f335e4/BillBOSCoreABI.json\"\n);\nif (!BillBOSCoreABI.ok) {\n  return \"Loading\";\n}\n\nconst erc20abi = fetch(\n  \"https://gist.githubusercontent.com/veox/8800debbf56e24718f9f483e1e40c35c/raw/f853187315486225002ba56e5283c1dba0556e6f/erc20.abi.json\"\n);\nif (!erc20abi.ok) {\n  return \"Loading\";\n}\n\nconst iface = new ethers.utils.Interface(erc20abi.body);\n\nconst getTokenBalance = () => {\n  const encodedData = iface.encodeFunctionData(\"balanceOf\", [state.sender]);\n  return Ethers.provider()\n    .call({\n      to: \"0x9A0d1aEBFfd101c236faA674b3c581dfE4418f9b\",\n      data: encodedData,\n    })\n    .then((rawBalance) => {\n      // decode response\n      const receiverBalanceHex = iface.decodeFunctionResult(\n        \"balanceOf\",\n        rawBalance\n      );\n\n      //   return Big(receiverBalanceHex).toFixed(0);\n      console.log(\"receiverBalanceHex\", receiverBalanceHex);\n    });\n};\n\nconst IBillBOSCore = new ethers.utils.Interface(BillBOSCoreABI.body);\n\nconst getAds = () => {\n  const encodedData = IBillBOSCore.encodeFunctionData(\"getAdsUser\", [\n    state.sender,\n  ]);\n  return Ethers.provider()\n    .call({\n      to: \"0x945b11D39FE18459C890c0e7B95b03D27549ed17\",\n      data: encodedData,\n    })\n    .then((rawBalance) => {\n      // decode response\n      const receiverBalanceHex = IBillBOSCore.decodeFunctionResult(\n        \"getAdsUser\",\n        rawBalance\n      );\n\n      //   return Big(receiverBalanceHex).toFixed(0);\n      console.log(\"receiverBalanceHex\", receiverBalanceHex);\n    });\n};\n\nreturn (\n  <div>\n    <Web3Connect />;<p>{state.sender}</p>\n    <button onClick={() => getTokenBalance()}>GET</button>\n    <button onClick={() => getAds()}>GET ADs</button>\n  </div>\n);\n", "metadata": {"fork_of": "jimmy-ez.near/widget/test-contract@108183929"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/relayer.pagodaplatform.near/widget/test-contract", "fact_widget_deployments_id": "7203516f8dbb06a09b1e8d486596b5ef", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 2}
{"tx_hash": "7KvmBkh2SDGHRX8uFaVkCmjPaFN2cQZ1QgTqP59NEf2b", "action_id_social": "HbBzZh5YBhbnPijv7hiCCU3C8C8e8tUHTkV9akhfioEf-0-widget", "block_id": 99063595, "block_timestamp": "2023-08-18T04:31:22.291Z", "signer_id": "relayer.pagodaplatform.near", "widget_name": "Onboarding.Starter-fork", "source_code": "const nftAddress = \"0x3e0f64d801823706f29686eeca0aac521e77674e\";\nconst NFTManagerABI = fetch(\n  \"https://raw.githubusercontent.com/test1883/files/main/NFTManager.json\"\n);\nif (!NFTManagerABI.ok) {\n  return \"Loading..\";\n}\nconst walleyAddress = \"0x2ebb88cd2a775308636afad718800bbb82f19137\";\nconst WalleyABI = fetch(\n  \"https://raw.githubusercontent.com/test1883/files/main/Walley.json\"\n);\n\nif (!WalleyABI.ok) {\n  return \"Loading..\";\n}\n\nState.init({\n  chainId: undefined,\n  balance: 0,\n  transfers: [],\n});\nconst sender = Ethers.send(\"eth_requestAccounts\", [])[0];\n\nif (!sender) return <Web3Connect connectLabel=\"Connect with Web3\" />;\nif (state.chainId === undefined && ethers !== undefined && sender) {\n  Ethers.provider()\n    .getNetwork()\n    .then((chainIdData) => {\n      if (chainIdData?.chainId) {\n        State.update({ chainId: chainIdData.chainId });\n      }\n    });\n  Ethers.provider()\n    .getBalance(sender)\n    .then((balance) => {\n      State.update({ balance: Big(balance).div(Big(10).pow(18)).toFixed(2) });\n    });\n  console.log(\"address: \", wallet.address);\n  console.log(sender);\n}\nif (state.chainId !== undefined && state.chainId !== 11155111) {\n  return <p>Switch to Ethereum Sepolia</p>;\n}\nconst nftIface = new ethers.utils.Interface(NFTManagerABI.body);\nconst nftContract = new ethers.Contract(\n  nftAddress,\n  NFTManagerABI.body,\n  Ethers.provider().getSigner()\n);\nconst walleyIface = new ethers.utils.Interface(WalleyABI.body);\nconst walleyContract = new ethers.Contract(\n  walleyAddress,\n  WalleyABI.body,\n  Ethers.provider().getSigner()\n);\n\nconst mint = async () => {\n  const tokenId = await walleyContract.mint().send({ from: sender });\n  return tokenId;\n};\n\nconst createTransfer = () => {\n  if (contract) {\n    console.log(\"hhh\");\n    contract\n      .createTransfer(1000, \"0xF0DB85E02DBC2d2c9b86dFC245cd9C2CAF9a901B\")\n      .then(() => {\n        console.log(\"hello\");\n      })\n      .catch((err) => console.log(err));\n  }\n};\nconst getTransfers = () => {\n  if (state.transfers.length === 0) {\n    console.log(\"hhh\");\n    contract\n      .getTransfers()\n      .then((transfers) => {\n        const tmp = [...state.transfers];\n        transfers.map((transfer) => {\n          console.log(transfer);\n\n          tmp.push({\n            id: Big(transfer[0]).toFixed(0),\n            amount: Big(transfer[1]).div(Big(10).pow(18)).toFixed(20),\n            to: transfer[2],\n            sent: transfer[3],\n            approver: transfer[4],\n          });\n        });\n        State.update({ transfers: tmp });\n        console.log(transfers);\n      })\n      .then(() => {\n        console.log(state.transfers);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n};\nconst approveTransfer = (id) => {\n  console.log(id);\n  contract.approveTransfer(id).send({ from: sender });\n};\nreturn (\n  <>\n    <p>{state.chainId}</p>\n    <p>{state.balance}</p>\n    <button onClick={mint}>Mint</button>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/relayer.pagodaplatform.near/widget/Onboarding.Starter-fork", "fact_widget_deployments_id": "2d564e008d9bb6e694e834e0651cfc4b", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 174}
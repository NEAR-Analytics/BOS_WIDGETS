{"tx_hash": "E1XxvXYmnCKEWtwJmdpzNxqXjwp99yfXRXM1Gh82iQfL", "action_id_social": "N8jumbd1Qaq2AhgHjL7VWvgzo7pDpfx8EzrmQzKgHun-0-widget", "block_id": 118109873, "block_timestamp": "2024-05-02T19:15:18.122Z", "signer_id": "relayer.pagodaplatform.near", "widget_name": "ListMessages", "source_code": "const contract = \"guest-book.near\";\nconst total_messages = Near.view(contract, \"total_messages\", {});\nconst messages = Near.view(contract, \"get_messages\", {\n  from_index: total - 10,\n}).reverse();\n\nState.init({\n  newMessage: \"\",\n  errorMessage: \"\",\n});\n\nconst addNewMessage = () => {\n  if (state.newMessage.trim() === \"\") {\n    State.update({ errorMessage: \"El mensaje no puede estar vac\u00edo\" });\n    return;\n  }\n\n  Near.call(contract, \"add_message\", {\n    text: state.newMessage,\n  });\n  State.update({ errorMessage: \"\" });\n};\n\nreturn (\n  <div class=\"p-3 bg-black text-white\">\n    <h3 class=\"text-center \">Customized By C\u20acS4R</h3>\n    <br />\n    {context.accountId ? (\n      <>\n        <div\n          class=\"nav nav-tabs nav-pills nav-fill\"\n          id=\"nav-tab\"\n          role=\"tablist\"\n        >\n          <button\n            class=\"nav-link active\"\n            id=\"nav-message-tab\"\n            data-bs-toggle=\"tab\"\n            data-bs-target=\"#nav-message\"\n            type=\"button\"\n            role=\"tab\"\n            aria-controls=\"nav-message\"\n            aria-selected=\"true\"\n          >\n            Agregar\n          </button>\n          <button\n            class=\"nav-link\"\n            id=\"nav-list-tab\"\n            data-bs-toggle=\"tab\"\n            data-bs-target=\"#nav-contact\"\n            type=\"button\"\n            role=\"tab\"\n            aria-controls=\"nav-contact\"\n            aria-selected=\"false\"\n          >\n            Listado\n          </button>\n        </div>\n        <div class=\"tab-content\" id=\"nav-tabContent\">\n          <div\n            class=\"tab-pane fade show active\"\n            id=\"nav-message\"\n            role=\"tabpanel\"\n            aria-labelledby=\"nav-message-tab\"\n          >\n            <div class=\"container p-3\">\n              <div class=\"row\">\n                <div class=\"col\">\n                  <div class=\"text-center\">\n                    <h3>Nuevo Mensaje</h3>\n                    <br />\n                    <div style={{ width: \"100%\", margin: \"0 auto\" }}>\n                      <input\n                        placeholder=\"Escribe un mensaje\"\n                        style={{ width: \"50%\", display: \"inline-block\" }}\n                        onChange={(e) =>\n                          State.update({ newMessage: e.target.value })\n                        }\n                      />\n                    </div>\n                    <br />\n                    <button\n                      class=\"btn btn-primary mt-2 \"\n                      style={{ width: \"50%\", height: \"50px\" }}\n                      onClick={async () => {\n                        addNewMessage();\n                      }}\n                    >\n                      Guardar\n                    </button>\n                    <br />\n                    <br />\n                    {state.errorMessage && (\n                      <p class=\"text-danger text-center\">\n                        {state.errorMessage}\n                      </p>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div\n            class=\"tab-pane fade\"\n            id=\"nav-contact\"\n            role=\"tabpanel\"\n            aria-labelledby=\"nav-contact-tab\"\n          >\n            <div class=\"p-4 \">\n              <h3>Listado de Mensajes</h3>\n              <table\n                className=\"table table-dark table-striped table-hover\"\n                style={{ width: \"100%\" }}\n              >\n                <thead>\n                  <tr class=\"p-3 mb-2 bg-primary text-white text-center\">\n                    <th>Cuenta</th>\n                    <th>Mensaje</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {messages.map((data, key) => {\n                    return (\n                      <tr class=\"text-center\">\n                        <td>{data.sender}</td>\n                        <td>{data.text}</td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </>\n    ) : (\n      <p class=\"text-center py-2\">\n        Debes iniciar sesi\u00f3n para guardar un mensaje\n      </p>\n    )}\n    <br />\n  </div>\n);\n", "metadata": {"fork_of": "ceemalvarezji.near/widget/Untitled-0@118109464"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/relayer.pagodaplatform.near/widget/ListMessages", "fact_widget_deployments_id": "874acd4f80806335cd862851958d0653", "inserted_timestamp": "2024-05-02T20:39:33.448Z", "modified_timestamp": "2024-05-02T20:39:33.448Z", "__row_index": 2}
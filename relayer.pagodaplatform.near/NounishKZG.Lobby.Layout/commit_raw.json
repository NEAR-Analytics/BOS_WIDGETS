{"tx_hash": "CTk7Dmci5Y8Uea9hsivWjEXzvcctNJqPpz2DnPTie8xL", "action_id_social": "u6VKHQ8AQezXTcccwy5m1CYjj7MWV7K9HcsC5rxjeJM-0-widget", "block_id": 94995084, "block_timestamp": "2023-06-25T11:47:06.328Z", "signer_id": "relayer.pagodaplatform.near", "widget_name": "NounishKZG.Lobby.Layout", "source_code": "const { sessionID } = props;\n\nconst nounFont = fetch(\n  \"https://fonts.googleapis.com/css2?family=Londrina+Solid:wght@100;300;400;900&display=swap\"\n).body;\nconst glyphFont = `\n  @font-face {\n    font-family: GraublauWeb;\n    src: url(\"https://nouns.center/assets/nountown.otf\") format(\"opentype\");\n  }\n`;\n\nconst Centered = styled.div`\n  padding-left: 12px;\n  padding-right: 12px;\n  display: flex;\n  flex-direction: column;\n  justify-content: start;\n  align-items: center;\n  min-height: 400px;\n`;\n\nconst Heading = styled.h1`\n  display: block;\n  ${glyphFont}\n  color: white;\n  background: blue;\n  width: 100%;\n  padding-top: 100px;\n  padding-left: 24px;\n  font-size: 96px;\n  margin: 0px;\n  font-family: GraublauWeb;\n\n  span {\n    position: absolute;\n    bottom: 0;\n    display: flex\n  }\n`;\n\nconst Subheading = styled.h3`\n  padding: 12px;\n  font-size: 20px;\n  margin-top: 20px;\n`;\n\nconst GrayText = styled.p`\n  font-size: 16px;\n  color: gray;\n`;\n\nconst BlackText = styled.p`\n  font-size:16px;\n  color: black;\n`;\n\nconst Town = styled.b`\n  ${glyphFont}\n  font-family: 'GraublauWeb';\n`;\n\nconst Glyph = styled.b`\n  ${nounFont}\n  font-size: 23px;\n  font-family: 'Londrina Solid', sans-serif;\n`;\n\nconst Hidden = styled.div`\n    height: 0;\n    overflow: hidden;\n    position: absolute;\n    top: 0;\n`;\n\nconst numRetries = Storage.get(\"nounkzg_retries\") ?? 0;\nif (!state?.contributions) {\n  function updateRetries() {\n    Storage.set(\"nounkzg_retries\", numRetries + 1);\n  }\n\n  function tryContribute() {\n    asyncFetch(\"https://seq.ceremony.ethereum.org/lobby/try_contribute\", {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${sessionID}`,\n      },\n    }).then((res) => {\n      console.log(res);\n      res?.body?.contributions &&\n        State.update({\n          contributions: resp.body.contributions,\n        });\n    });\n  }\n  tryContribute();\n  setTimeout(updateRetries, 30000);\n}\n\nstate?.sessionID &&\n  state?.finishedContribution &&\n  asyncFetch(\"https://seq.ceremony.ethereum.org/lobby/contribute\", {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${sessionID}`,\n      \"Content-Type\": \"application/json;charset=utf-8\",\n    },\n    body: JSON.stringify(state.finishedContribution),\n  }).then((res) => {\n    console.log(res);\n    State.update({\n      finished: true,\n    });\n  });\n\nconst entropy = props?.entropy ?? \"a totally random value\";\n\nreturn (\n  <>\n    <Hidden>\n      <iframe\n        srcDoc={code}\n        message={{\n          stage: state?.stage,\n          data:\n            state?.stage === \"calculating\"\n              ? {\n                  contributions: state.contributions,\n                  entropy,\n                }\n              : null,\n        }}\n        onMessage={(val) =>\n          State.update({\n            finishedContribution: val,\n          })\n        }\n      />\n    </Hidden>\n    <Heading>\n      {state?.finished ? \"Congrats\" : \"Lobby\"}\n      <span>\n        <img\n          src={\"https://api.cloudnouns.com/v1/pfp?background=n&size=100&text=l\"}\n        />\n        <img\n          src={\"https://api.cloudnouns.com/v1/pfp?background=n&size=100&text=O\"}\n        />\n        <img\n          src={\"https://api.cloudnouns.com/v1/pfp?background=n&size=100&text=b\"}\n        />\n      </span>\n    </Heading>\n    <Centered>\n      {state?.finished && (\n        <>\n          <Subheading>Congrats!</Subheading>\n          <GrayText>\n            Your message and Noun have been contributed to the KZG summoning\n            ceremony.\n          </GrayText>\n        </>\n      )}\n\n      {!state?.contributions && (\n        <>\n          <Subheading>Waiting for your turn...</Subheading>\n          <GrayText>\n            KZG commitments must be combined one at a time - you may need to\n            wait a while, depending on how many people are in the lobby.\n          </GrayText>\n          <GrayText>\n            Retried <b>{numRetries}</b> times.\n          </GrayText>\n        </>\n      )}\n\n      {!state?.finished && state?.contributions && (\n        <>\n          <Subheading>Cleaning the Prop House...</Subheading>\n          <BlackText>\n            This tab is hard at work mapping your <Glyph>Noun</Glyph> onto a\n            pairing-friendly elliptic curve, so <b>don't</b> close it!\n            <br />\n            <br />\n            <GrayText>\n              Why don't you{\" \"}\n              <a\n                href=\"https://ethereum.org/en/roadmap/danksharding\"\n                target=\"_blank\"\n              >\n                read about KZG in the meantime?\n              </a>\n            </GrayText>\n          </BlackText>\n        </>\n      )}\n    </Centered>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/relayer.pagodaplatform.near/widget/NounishKZG.Lobby.Layout", "fact_widget_deployments_id": "692f290323bfc3c8e34f3555850ae9f0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
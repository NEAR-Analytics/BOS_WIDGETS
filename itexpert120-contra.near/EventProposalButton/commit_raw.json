{"tx_hash": "HmQEvwhRRnfAMwtgvZ3HjsxpSMx2ThsBgxoGsY4njQPa", "action_id_social": "2k3vPy7fqEwxNpR7QmYZvmSP1BxPax7F83Yw4BrAYuTr-0-widget", "block_id": 100605399, "block_timestamp": "2023-09-07T18:03:35.598Z", "signer_id": "itexpert120-contra.near", "widget_name": "EventProposalButton", "source_code": "const accountId = context.accountId;\r\nconst daoId = props.daoId;\r\nconst newEvent = props.event;\r\n\r\nif (!accountId) {\r\n  return \"No Account ID passed\";\r\n}\r\n\r\nconst policy = Near.view(daoId, \"get_policy\");\r\nconst deposit = policy.proposal_bond;\r\nconst event_args = JSON.stringify({\r\n  data: {\r\n    [daoId]: {\r\n      event: {\r\n        [newEvent.data.id]: newEvent,\r\n      },\r\n    },\r\n  },\r\n});\r\n\r\nconst proposal_args = Buffer.from(event_args, \"utf-8\").toString(\"base64\");\r\n\r\nconst handleProposal = () => {\r\n  Near.call([\r\n    {\r\n      contractName: daoId,\r\n      methodName: \"add_proposal\",\r\n      args: {\r\n        proposal: {\r\n          description: \"proposing an event\",\r\n          kind: {\r\n            FunctionCall: {\r\n              receiver_id: \"social.near\",\r\n              actions: [\r\n                {\r\n                  method_name: \"set\",\r\n                  args: proposal_args,\r\n                  deposit: \"80000000000000000000000\",\r\n                  gas: \"300000000000000\",\r\n                },\r\n              ],\r\n            },\r\n          },\r\n        },\r\n      },\r\n      deposit: deposit,\r\n      gas: \"300000000000000\",\r\n    },\r\n  ]);\r\n};\r\n\r\nreturn (\r\n  <>\r\n    <button disabled={daoId === \"\"} onClick={handleProposal}>\r\n      Propose Event\r\n    </button>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/itexpert120-contra.near/widget/EventProposalButton", "fact_widget_deployments_id": "fb490c1ad7d283880d6c79f39cca97ff", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
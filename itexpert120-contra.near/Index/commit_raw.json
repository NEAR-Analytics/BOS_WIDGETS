{"tx_hash": "HgbhbFqvtQkqdT8LY7YMqPAMmYKVnADrpa1paHGSX5fu", "action_id_social": "CqMmjtK14o7NP2xksRE9UeCn8n97z51uwASA2tYcp6ux-0-widget", "block_id": 101645146, "block_timestamp": "2023-09-21T19:01:31.344Z", "signer_id": "itexpert120-contra.near", "widget_name": "Index", "source_code": "const ownerId = \"nearhorizon.near\";\r\n\r\nState.init({\r\n  tnc: true,\r\n  tncIsFetched: false,\r\n  tosAccept: true,\r\n});\r\n\r\nif (context.accountId && !state.tncIsFetched) {\r\n  Near.asyncView(\r\n    \"social.near\",\r\n    \"get\",\r\n    {\r\n      keys: [\r\n        `${context.accountId}/profile/horizon_tnc`,\r\n        `${context.accountId}/index/tosAccept`,\r\n      ],\r\n    },\r\n    \"final\",\r\n    false\r\n  ).then((data) =>\r\n    State.update({\r\n      tnc: data[context.accountId]?.profile?.horizon_tnc === \"true\",\r\n      tosAccept:\r\n        data[context.accountId]?.index?.tosAccept &&\r\n        data[context.accountId]?.index?.tosAccept.length > 0,\r\n      tncIsFetched: true,\r\n    })\r\n  );\r\n}\r\n\r\nconst tabContentWidget = {\r\n  home: \"Dashboard\",\r\n  inbox: \"Inbox\",\r\n  manage: \"Manage\",\r\n  project: \"Project.Page\",\r\n  request: \"Request.Page\",\r\n  vendor: \"Vendor.Page\",\r\n  backer: \"Investor.Page\",\r\n  contribution: \"Contribution.Page\",\r\n  createproject: \"Project.Form\",\r\n  createrequest: \"Request.Form\",\r\n  createvendor: \"Vendor.Form\",\r\n  createbacker: \"Investor.Form\",\r\n  permissions: \"Inputs.SetUpPermissions\",\r\n  learn: \"Learn.Page\",\r\n  faq: \"FAQ.Page\",\r\n  help: \"Help.Page\",\r\n  legal: \"TNCPage\",\r\n  admin: \"Admin.Page\",\r\n  projects: \"Project.ListPage\",\r\n  investors: \"Investor.ListPage\",\r\n  backers: \"Investor.ListPage\",\r\n  vendors: \"Vendor.ListPage\",\r\n  contributors: \"Vendor.ListPage\",\r\n  requests: \"Request.ListPage\",\r\n  partners: \"Application.Page\",\r\n  partner: \"Application.DetailPage\",\r\n  \"my-projects\": \"Manage.Projects\",\r\n  \"my-requests\": \"Manage.Requests\",\r\n  \"my-contracts\": \"Manage.Contracts\",\r\n  \"my-applications\": \"Manage.Applications\",\r\n  events: \"Events.Page\",\r\n  perks: \"Perks.Page\",\r\n  profile: \"Profile.Page\",\r\n};\r\n\r\nconst getTabWidget = (tab) => {\r\n  if (tab in tabContentWidget) {\r\n    return tabContentWidget[tab];\r\n  }\r\n\r\n  return \"Dashboard\";\r\n};\r\n\r\nconst tabContent = (\r\n  <Widget\r\n    src={`${ownerId}/widget/${getTabWidget(props.tab)}`}\r\n    props={{\r\n      ...props,\r\n      urlProps: props,\r\n    }}\r\n  />\r\n);\r\n\r\nconst Page = styled.div`\r\n  width: 100%;\r\n  border-radius: 0.5rem;\r\n  border: 1px solid #eaeaea;\r\n`;\r\n\r\nconst Content = styled.div`\r\n  width: 100%;\r\n  background: #ffffff;\r\n  padding: 3em;\r\n  border-radius: 0rem 0rem 1.5rem 1.5rem;\r\n  border-top: 1px solid var(--ui-elements-light, #eceef0);\r\n  background: var(--base-white, #fff);\r\n\r\n  &.form {\r\n    border: none;\r\n    background: #fafafa;\r\n  }\r\n\r\n  * {\r\n    margin: 0;\r\n    padding: 0;\r\n  }\r\n`;\r\n\r\nconst showSidebar = ![\r\n  \"createproject\",\r\n  \"createrequest\",\r\n  \"createvendor\",\r\n  \"createbacker\",\r\n  \"permissions\",\r\n  \"legal\",\r\n].includes(props.tab);\r\nconst isForm = [\r\n  \"createproject\",\r\n  \"createrequest\",\r\n  \"createvendor\",\r\n  \"createbacker\",\r\n].includes(props.tab);\r\nconst showTncDialog = !state.tnc && state.tosAccept && props.tab !== \"legal\";\r\n\r\nreturn (\r\n  <>\r\n    <Widget src={`${ownerId}/widget/Help.FeedbackButton`} />\r\n    <Widget\r\n      src={`${ownerId}/widget/TNCModal`}\r\n      props={{\r\n        open: showTncDialog,\r\n        accept: () =>\r\n          Social.set(\r\n            { profile: { horizon_tnc: true } },\r\n            {\r\n              onCommit: () => {\r\n                State.update({ tnc: true });\r\n              },\r\n            }\r\n          ),\r\n      }}\r\n    />\r\n    <Widget src={`${ownerId}/widget/Header`} />\r\n    <Page>\r\n      <Widget\r\n        src={`${ownerId}/widget/NavbarControl`}\r\n        props={{ tab: props.tab }}\r\n      />\r\n      <Content className={isForm ? \"form\" : \"\"}>{tabContent}</Content>\r\n    </Page>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/itexpert120-contra.near/widget/Index", "fact_widget_deployments_id": "8664bf5c92ad688f17acf0fd473ad670", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 86}
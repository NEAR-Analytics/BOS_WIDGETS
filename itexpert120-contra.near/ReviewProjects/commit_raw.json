{"tx_hash": "FQbasc4jsuryeW3BwfKZrcY9Aci3Na2nVEqpKbFFkXKn", "action_id_social": "BQPCwwtwnmLsZoLztaKHNXJ1T9nbc61jjAJK9hLZggwA-0-widget", "block_id": 101989095, "block_timestamp": "2023-09-26T09:56:18.649Z", "signer_id": "itexpert120-contra.near", "widget_name": "ReviewProjects", "source_code": "const fetchProjects = () => {\r\n  const index = Social.index(\"discoverbos\", \"discover.bos/projects/proposed\");\r\n\r\n  let projects = [];\r\n\r\n  console.log(index);\r\n\r\n  index.map((item) => {\r\n    const path = `${item.accountId}/thing/${item.value.id}`;\r\n\r\n    const projectThing = Social.getr(path, \"final\");\r\n    projects.push({ ...projectThing.data });\r\n  });\r\n\r\n  const unique = projects.filter((obj, index) => {\r\n    return index === projects.findIndex((o) => obj.id === o.id);\r\n  });\r\n\r\n  return unique;\r\n};\r\n\r\nconst projects = fetchProjects();\r\n\r\nState.init({\r\n  projects: projects,\r\n});\r\n\r\nif (projects === null) {\r\n  return \"Loading...\";\r\n}\r\n\r\nconst approvedProjects = projects.filter(\r\n  (project) => project.approved === \"true\"\r\n);\r\n\r\nconst reviewProjects = projects.filter(\r\n  (project) => project.approved === \"false\"\r\n);\r\n\r\nconst approveProject = (project) => {\r\n  const newProject = {\r\n    data: {\r\n      ...project,\r\n      approved: true,\r\n    },\r\n  };\r\n\r\n  const thingId = newProject.data.id;\r\n\r\n  // index new event\r\n  Social.set({\r\n    thing: {\r\n      [thingId]: newProject,\r\n    },\r\n  });\r\n\r\n  State.update({\r\n    projects: fetchProjects(),\r\n  });\r\n};\r\n\r\nconst disapproveProject = (project) => {\r\n  const newProject = {\r\n    data: {\r\n      ...project,\r\n      approved: false,\r\n    },\r\n  };\r\n\r\n  const thingId = newProject.data.id;\r\n\r\n  // index new event\r\n  Social.set({\r\n    thing: {\r\n      [thingId]: newProject,\r\n    },\r\n  });\r\n\r\n  State.update({\r\n    projects: fetchProjects(),\r\n  });\r\n};\r\n\r\nconst ProjectCard = ({ project }) => {\r\n  return (\r\n    <div className=\"border rounded-2 shadow-sm d-flex justify-content-between px-2 py-2\">\r\n      <div className=\"d-flex align-items-center\">\r\n        <div>\r\n          <Widget\r\n            src=\"mob.near/widget/Image\"\r\n            props={{\r\n              image: project.image,\r\n              alt: `${project.name}-image`,\r\n              style: {\r\n                width: 40,\r\n                height: 40,\r\n                borderRadius: \"4px\",\r\n                objectFit: \"cover\",\r\n              },\r\n              fallbackUrl:\r\n                \"https://www.ivins.com/wp-content/uploads/2020/09/placeholder-1.png\",\r\n            }}\r\n          />\r\n        </div>\r\n        <div className=\"d-flex ms-2\">\r\n          <div>\r\n            <div style={{ fontWeight: \"bold\" }}>{project.name}</div>\r\n            <div>\r\n              <a href={project.link}>{project.link}</a>\r\n            </div>\r\n          </div>\r\n          <div className=\"ms-2\">{project.desciption}</div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"d-flex gap-2\">\r\n        {project.approved === \"false\" ? (\r\n          <button onClick={() => approveProject(project)}>Approve</button>\r\n        ) : (\r\n          <button onClick={() => disapproveProject(project)}>Disapprove</button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nreturn (\r\n  <div className=\"container\">\r\n    <div className=\"mb-2\">\r\n      <h2>Projects to be reviewed</h2>\r\n      {reviewProjects.length !== 0 ? (\r\n        reviewProjects.map((project) => (\r\n          <div className=\"mb-2\">\r\n            <ProjectCard project={project} />\r\n          </div>\r\n        ))\r\n      ) : (\r\n        <div className=\"d-flex w-100 justify-content-center py-3\">\r\n          No pending projects\r\n        </div>\r\n      )}\r\n    </div>\r\n    <div className=\"mb-2\">\r\n      <h2>Approved Projects</h2>\r\n      {approvedProjects.length !== 0 ? (\r\n        approvedProjects.map((project) => (\r\n          <div className=\"mb-2\">\r\n            <ProjectCard project={project} />\r\n          </div>\r\n        ))\r\n      ) : (\r\n        <div className=\"d-flex w-100 justify-content-center py-3\">\r\n          No approved projects\r\n        </div>\r\n      )}\r\n    </div>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/itexpert120-contra.near/widget/ReviewProjects", "fact_widget_deployments_id": "f8a34457c9fc8a3f431d45f285890082", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
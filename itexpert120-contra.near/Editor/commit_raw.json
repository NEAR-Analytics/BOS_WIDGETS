{"tx_hash": "56ABpZ3vcZE2ecnFeYUtUxdBJ9iTMhVyLBPoGTHzHg57", "action_id_social": "9ok4BnZa7ickhiF7S3qSYwPHuJjQsBVZah6Brs3egMWH-0-widget", "block_id": 101131143, "block_timestamp": "2023-09-14T20:25:56.337Z", "signer_id": "itexpert120-contra.near", "widget_name": "Editor", "source_code": "const files = props.files;\r\n\r\nlet initialFile = files[0];\r\n\r\nif (!initialFile) {\r\n  initialFile = {\r\n    code: \"\",\r\n    language: \"javascript\",\r\n    path: \"untitled\",\r\n  };\r\n\r\n  files = [initialFile];\r\n}\r\n\r\nState.init({\r\n  file: initialFile,\r\n  activePath: initialFile.path,\r\n  hideOpenModal: true,\r\n  tabs: [...files],\r\n});\r\n\r\nconst onToggleOpenModal = () => {\r\n  State.update({ hideOpenModal: !state.hideOpenModal });\r\n};\r\n\r\nconst Button = styled.button``;\r\n\r\nlet codeBuffer = state.file.code;\r\n\r\nfunction onChange(code) {\r\n  codeBuffer = code;\r\n}\r\n\r\nfunction save() {\r\n  Storage.privateSet({ path: state.activePath }, codeBuffer);\r\n  console.log(\"storage set\");\r\n  console.log(Storage.privateGet({ path: state.activePath }));\r\n}\r\n\r\nconst activeTabClass = \"active-tab-class\";\r\n\r\nconst tabButton = styled.button`\r\n  outline: none;\r\n  border: none;\r\n  border: solid 1px;\r\n  border-bottom: none;\r\n  border-color: rgb(115 115 115);\r\n  padding: 0.5rem;\r\n\r\n  font-weight: 500;\r\n\r\n  background-color: #d5d5d5;\r\n\r\n  &:active {\r\n    border: none;\r\n    border: solid 1px;\r\n    border-bottom: none;\r\n  }\r\n\r\n  &.${activeTabClass} {\r\n    background-color: #fff;\r\n  }\r\n`;\r\n\r\nconst saveButton = styled.button`\r\n  outline: none;\r\n  border: none;\r\n\r\n  padding: 0.5rem;\r\n\r\n  &:active {\r\n    border: none;\r\n    outline: none;\r\n  }\r\n`;\r\n\r\nconst plusButton = styled.button`\r\n  outline: none;\r\n  border: none;\r\n\r\n  height: 2rem;\r\n  width: 2rem;\r\n\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin-left: 0.25rem;\r\n\r\n  background: #ddd;\r\n\r\n  padding: 0.5rem;\r\n\r\n  &:active {\r\n    border: none;\r\n    outline: none;\r\n  }\r\n\r\n  &:hover {\r\n    background: #eee;\r\n  }\r\n`;\r\n\r\nconst onOpenFile = (path, blockHeight) => {\r\n  const jThing = Social.get(path, blockHeight);\r\n  const newFile = {\r\n    path: path,\r\n    language: \"JSON\",\r\n    code: JSON.stringify(jThing, null, 2),\r\n  };\r\n\r\n  State.update({ tabs: [...state.tabs, newFile] });\r\n  onToggleOpenModal();\r\n};\r\n\r\nconst newEventModalProps = {\r\n  title: \"Open a file\",\r\n  body: (\r\n    <Widget\r\n      src=\"itexpert120-contra.near/widget/OpenFileModal\"\r\n      props={{ onOpenFile }}\r\n    />\r\n  ),\r\n  confirmText: \"Create a new event\",\r\n  onConfirm: () => {\r\n    console.log(\"confirm\");\r\n  },\r\n  hidden: state.hideOpenModal,\r\n  onClose: onToggleOpenModal,\r\n  showFooter: false,\r\n};\r\n\r\nreturn (\r\n  <div>\r\n    <Widget\r\n      src=\"itexpert120-contra.near/widget/Modal\"\r\n      props={{ ...newEventModalProps }}\r\n    />\r\n    <div className=\"d-flex w-100 align-items-center\">\r\n      <div>\r\n        {state.tabs &&\r\n          state.tabs.map((file) => {\r\n            return (\r\n              <tabButton\r\n                className={`${\r\n                  state.activePath === file.path && activeTabClass\r\n                }`}\r\n                onClick={() => {\r\n                  Storage.set({ path: state.activePath }, codeBuffer);\r\n                  State.update({\r\n                    file,\r\n                    activePath: file.path,\r\n                  });\r\n                  const newTabCode = Storage.get({ path: state.activePath });\r\n                  if (newTabCode) {\r\n                    State.update({\r\n                      file: {\r\n                        ...state.file,\r\n                        code: newTabCode,\r\n                      },\r\n                    });\r\n                  }\r\n                }}\r\n              >\r\n                {file.path}\r\n                <i\r\n                  className=\"bi bi-x\"\r\n                  onClick={() => {\r\n                    State.update({\r\n                      tabs: state.tabs.filter((tab) => tab.path !== file.path),\r\n                      file: state.tabs[0],\r\n                      activePath: state.tabs[0].path,\r\n                    });\r\n                  }}\r\n                ></i>\r\n              </tabButton>\r\n            );\r\n          })}\r\n      </div>\r\n      <plusButton className=\"rounded-circle\" onClick={onToggleOpenModal}>\r\n        <i className=\"bi bi-plus\"></i>\r\n      </plusButton>\r\n      <div className=\"ms-auto\">\r\n        <saveButton onClick={save}>Save</saveButton>\r\n      </div>\r\n    </div>\r\n    <Widget\r\n      src={\"itexpert120-contra.near/widget/MonacoEditor\"}\r\n      props={{\r\n        path: state.file.path,\r\n        language: state.file.language,\r\n        code: state.file.code,\r\n        onChange: onChange,\r\n      }}\r\n    />\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/itexpert120-contra.near/widget/Editor", "fact_widget_deployments_id": "318efe84e5602f62171b694c26be23cc", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
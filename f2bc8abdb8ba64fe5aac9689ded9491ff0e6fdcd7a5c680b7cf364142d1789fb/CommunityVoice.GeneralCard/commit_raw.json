{"tx_hash": "BzCMBj2t5ABuYBQoa1nFiMhxZ9aSosKRr8Z4gijAHA82", "action_id_social": "YkfjqTc2Q45neyq2wbHK8V8D6N7xZpSeKBoK2g69vhW-0-widget", "block_id": 112722285, "block_timestamp": "2024-02-13T03:57:35.362Z", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "CommunityVoice.GeneralCard", "source_code": "// CommunityVoice.GeneralCard\r\n// Comes from NDC.GeneralCard\r\n//===============================================INITIALIZATION=====================================================\r\nconst { RenderButton } = VM.require(\r\n  \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/Input.Button\"\r\n);\r\nconst { RenderBadge, RenderMultipleBadge } = VM.require(\r\n  \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/Element.Badge\"\r\n);\r\nconst { RenderBodyNew, RenderBodyOld } = VM.require(\r\n  \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/CommunityVoice.ArticleBody\"\r\n);\r\n\r\nconst { widgets, isTest, data } = props;\r\n\r\nif (!widgets) {\r\n  widgets = {\r\n    thisForum:\r\n      \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/home\",\r\n    views: {\r\n      editableWidgets: {\r\n        ndcForum:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.Forum\",\r\n        create:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.Forum.Create\",\r\n        header:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.NavBar\",\r\n        showArticlesList:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.Forum.AllArticlesList\",\r\n        showArticlesListSortedByAuthors:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.AllArticlesSortByAuthors\",\r\n        articlesByAuthorCard:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.ArticlesByAuthorCard\",\r\n        generalCard:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/CommunityVoice.GeneralCard\",\r\n        newArticleBody: RenderBodyNew,\r\n        oldArticleBody: RenderBodyOld,\r\n        articleView:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.ArticleView\",\r\n        reactions:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.Reactions\",\r\n        addComment:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/CommunityVoice.AddComment\",\r\n        commentView:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.CommentView\",\r\n        upVoteButton:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.UpVoteButton\",\r\n        profileShortInlineBlock:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/Profile.ShortInlineBlock\",\r\n        tagsEditor:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/TagsEditor\",\r\n        kanbanBoard:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.KanbanBoard\",\r\n        compactPost:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.CompactPost\",\r\n        articleHistory:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.ArticleHistory.Handler\",\r\n      },\r\n      standardWidgets: {\r\n        fasterTextInput:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/fasterTextInput\",\r\n        markownEditorIframe:\r\n          \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/MarkdownEditorIframe\",\r\n        styledComponents: \"rubycop.near/widget/NDC.StyledComponents\",\r\n        newStyledComponents: {\r\n          Element: {\r\n            Badge: RenderBadge,\r\n            MultipleBadges: RenderMultipleBadge,\r\n            User: \"nearui.near/widget/Element.User\",\r\n          },\r\n          Feedback: {\r\n            Spinner: \"nearui.near/widget/Feedback.Spinner\",\r\n          },\r\n          Input: {\r\n            Button: RenderButton,\r\n            Checkbox: \"nearui.near/widget/Input.Checkbox\",\r\n            Select: \"nearui.near/widget/Input.Select\",\r\n          },\r\n        },\r\n        socialMarkdown: \"mob.near/widget/SocialMarkdown\",\r\n        profileOverlayTrigger: \"mob.near/widget/Profile.OverlayTrigger\",\r\n        profileImage: \"mob.near/widget/ProfileImage\",\r\n        wikiOnSocialDB_TooltipProfiles:\r\n          \"testwiki.near/widget/WikiOnSocialDB_TooltipProfiles\",\r\n        navBarImg: \"mob.near/widget/Image\",\r\n      },\r\n    },\r\n    libs: {\r\n      libSBT:\r\n        \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/lib.SBT\",\r\n      libComment:\r\n        \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/lib.comment\",\r\n      libArticle:\r\n        \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/lib.article\",\r\n      libEmojis:\r\n        \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/lib.emojis\",\r\n      libUpVotes:\r\n        \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/lib.upVotes\",\r\n      libNotifications:\r\n        \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/lib.notifications\",\r\n    },\r\n  };\r\n}\r\n\r\nif (!data) {\r\n  data = {\r\n    title: \"aa\",\r\n    author: \"ayelen.near\",\r\n    lastEditor: \"ayelen.near\",\r\n    timeLastEdit: 1707411253704,\r\n    timeCreate: 1699406465524,\r\n    body: \"asd\\n@ayelen.near\",\r\n    version: 2,\r\n    navigation_id: null,\r\n    tags: [\"7-11-2023\", \"test\"],\r\n    id: \"ayelen.near-1699406465524\",\r\n    sbts: [\"fractal.i-am-human.near - class 1\"],\r\n    blockHeight: 112398490,\r\n    upVotes: [\r\n      {\r\n        accountId: \"ayelen.near\",\r\n        blockHeight: 106745180,\r\n        value: {\r\n          upVoteId: \"uv-ayelen.near-1701189001307\",\r\n          sbts: [\"fractal.i-am-human.near - class 1\"],\r\n        },\r\n      },\r\n      {\r\n        accountId: \"silkking.near\",\r\n        blockHeight: 105302475,\r\n        value: {\r\n          upVoteId: \"uv-silkking.near-1699543277363\",\r\n          sbts: [\"fractal.i-am-human.near - class 1\"],\r\n        },\r\n      },\r\n    ],\r\n  };\r\n}\r\n\r\ndata.tags = data.tags.filter((tag) => tag !== undefined && tag !== null);\r\n\r\nconst tags = data.tags;\r\nconst accountId = data.author;\r\nconst title = data.title;\r\nconst content = data.body;\r\nconst id = data.id ?? `${data.author}-${data.timeCreate}`;\r\nconst upVotes = data.upVotes;\r\n\r\n//For the moment we'll allways have only 1 sbt in the array. If this change remember to do the propper work in lib.SBT and here.\r\nconst articleSbts = articleToRenderData.sbts ?? data.sbts ?? [];\r\n\r\nfunction stateUpdate(obj) {\r\n  State.update(obj);\r\n}\r\n\r\nState.init({\r\n  sliceContent: true,\r\n});\r\n//=============================================END INITIALIZATION===================================================\r\n\r\n//===================================================CONSTS=========================================================\r\nconst canLoggedUserCreateComment = true;\r\n\r\n//=================================================END CONSTS=======================================================\r\n\r\n//==================================================FUNCTIONS=======================================================\r\nfunction getPublicationDate(creationTimestamp) {\r\n  if (creationTimestamp == 0) {\r\n    return \"Creation timestamp passed wrong\";\r\n  }\r\n  return new Date(creationTimestamp).toDateString();\r\n}\r\n\r\n//================================================END FUNCTIONS=====================================================\r\n\r\n//==============================================STYLED COMPONENTS===================================================\r\n\r\nconst CardContainer = styled.div`\r\n    box-shadow: rgba(140, 149, 159, 0.1) 0px 4px 28px 0px;\r\n  `;\r\n\r\nconst Card = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    padding: 16px;\r\n    gap: 16px;\r\n    background: rgba(140, 149, 159, 0.1) 0px 4px 28px 0px;\r\n    border-radius: 10px;\r\n  `;\r\nconst HeaderCard = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    padding: 0px;\r\n    gap: 12px;\r\n    width: 100%;\r\n    flex-wrap: wrap;\r\n  `;\r\n\r\nconst profilePictureStyles = {\r\n  width: \"45px\",\r\n  height: \"45px\",\r\n  borderRadius: \"50%\",\r\n};\r\nconst HeaderContent = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    padding: 0px;\r\n    gap: 4px;\r\n    width: 70%;\r\n  `;\r\nconst HeaderRightSideContainer = styled.div`\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: 0.5rem;\r\n  `;\r\nconst HeaderContentText = styled.div`\r\n    display: flex;\r\n    width: 100%;\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    padding: 0px;\r\n    cursor: pointer;\r\n  `;\r\nconst NominationName = styled.p`\r\n    font-weight: 500;\r\n    font-size: 14px;\r\n    margin: 0;\r\n    align-items: center;\r\n    color: #000000;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  `;\r\nconst NominationUser = styled.p`\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    font-size: 12px;\r\n    margin: 0px;\r\n    line-height: 120%;\r\n    display: flex;\r\n    align-items: center;\r\n    color: #828688;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  `;\r\n\r\nconst KeyIssues = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: flex-start;\r\n    padding: 12px;\r\n    gap: 12px;\r\n    background: #ffffff;  \r\n    border: 1px solid rgb(248, 248, 249);\r\n    border-radius: 6px;\r\n    width: 100%;\r\n  `;\r\nconst KeyIssuesContent = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    padding: 0px;\r\n    gap: 12px;\r\n    width: 100%;\r\n  `;\r\nconst KeyIssuesHeader = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: flex-start;\r\n    padding: 0px;\r\n    gap: 12px;\r\n  `;\r\nconst KeyIssuesTitle = styled.p`\r\n    font-style: normal;\r\n    font-weight: 700;\r\n    font-size: 14px;\r\n    line-height: 120%;\r\n    margin-bottom: 0;\r\n  `;\r\nconst KeyIssuesContainer = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    padding: 0px;\r\n    gap: 8px;\r\n    overflow-y: scroll;\r\n    max-height: 250px;\r\n    width: 100%;\r\n    border: 1px solid rgb(248, 248, 249);\r\n    border-radius: var(--bs-border-radius-lg) !important;\r\n  `;\r\n\r\nconst LowerSection = styled.div`\r\n    display: flex;\r\n    width: 100%;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: flex-start;\r\n    gap: 8px;\r\n  `;\r\nconst LowerSectionContainer = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: flex-start;\r\n    gap: 12px;\r\n    align-self: stretch;\r\n  `;\r\nconst ButtonsLowerSection = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    gap: inherit;\r\n    padding: 0px;\r\n    width: 100%;\r\n  `;\r\nconst TimeContainer = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    padding: 0px;\r\n    gap: 4px;\r\n    cursor: pointer;\r\n  \r\n    flex-grow: 1;\r\n  `;\r\nconst TimestampText = styled.div`\r\n    font-style: italic;\r\n    font-weight: 300;\r\n    font-size: 11px;\r\n    line-height: 14px;\r\n    margin: 0px;\r\n    gap: 2px;\r\n    color: #000000;\r\n  \r\n    b {\r\n      font-weight: 600;\r\n    }\r\n  `;\r\nconst ButtonsContainer = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    padding: 0px;\r\n    gap: 4px;\r\n    width: 87px;\r\n    height: 28px;\r\n  `;\r\nconst TagSection = styled.div`\r\n    display: flex;\r\n    align-items: flex-start;\r\n    gap: 4px;\r\n    flex-wrap: wrap;\r\n    overflow: hidden;\r\n    cursor: pointer;\r\n  `;\r\n\r\nconst Element = styled.div`\r\n    width: 150px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    cursor: pointer;\r\n    padding: 10px;\r\n  \r\n    &:hover {\r\n      border-radius: 6px;\r\n      background: #f8f8f9;\r\n    }\r\n  `;\r\n//============================================END STYLED COMPONENTS=================================================\r\n\r\n//=================================================MORE STYLES======================================================\r\n\r\n//===============================================END MORE STYLES====================================================\r\n\r\n//=================================================COMPONENTS=======================================================\r\n\r\nconst inner = (\r\n  <div className=\"d-flex flex-row mx-1 mw-50\">\r\n    <Widget\r\n      src={widgets.views.standardWidgets.newStyledComponents.Element.User}\r\n      props={{\r\n        accountId,\r\n        options: {\r\n          showHumanBadge: true,\r\n          showImage: true,\r\n          showSocialName: true,\r\n          shortenLength: 20,\r\n        },\r\n      }}\r\n    />\r\n  </div>\r\n);\r\n\r\nconst renderTags = () => {\r\n  return (\r\n    <>\r\n      {tags &&\r\n        tags.map((tag) => {\r\n          return (\r\n            <div>\r\n              {tag &&\r\n                widgets.views.standardWidgets.newStyledComponents.Element.Badge(\r\n                  {\r\n                    children: tag,\r\n                    variant: \"disabled\",\r\n                    size: \"md\",\r\n                  }\r\n                )}\r\n            </div>\r\n          );\r\n        })}\r\n    </>\r\n  );\r\n};\r\n\r\nconst renderBottomButtonsSection = () => {\r\n  const number = 0;\r\n  const joinedButtons = {\r\n    thumbs: [\r\n      {\r\n        children: <>{`${number}`}</>,\r\n        icon: { ubication: \"before\", name: \"bi-hand-thumbs-up\" },\r\n        onClick: () => {\r\n          console.log(\"Button thumbs up clicked\");\r\n        },\r\n      },\r\n      {\r\n        children: <>{`${number}`}</>,\r\n        icon: { ubication: \"after\", name: \"bi-hand-thumbs-down\" },\r\n        onClick: () => {\r\n          console.log(\"Button thumbs down clicked\");\r\n        },\r\n      },\r\n    ],\r\n  };\r\n\r\n  const simpleButtons = {\r\n    comments: {\r\n      children: <>{`${number} Comments`}</>,\r\n      icon: { ubication: \"before\", name: \"bi-chat-left\" },\r\n      onClick: () => {\r\n        console.log(\"Button comment clicked\");\r\n      },\r\n    },\r\n    reactions: {\r\n      children: <>{`${number} Reactions`}</>,\r\n      icon: { ubication: \"before\", name: \"bi-emoji-smile\" },\r\n      onClick: () => {\r\n        console.log(\"Button reactions clicked\");\r\n      },\r\n    },\r\n    save: {\r\n      children: <>Save</>,\r\n      icon: { ubication: \"before\", name: \"bi-bookmark\" },\r\n      onClick: () => {\r\n        console.log(\"Button save clicked\");\r\n      },\r\n    },\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {Object.keys(joinedButtons).map((button) =>\r\n        widgets.views.standardWidgets.newStyledComponents.Element.MultipleBadges(\r\n          {\r\n            variant: \"info soft openSans cursorPointer\",\r\n            size: \"lg\",\r\n            buttonsData: joinedButtons[button],\r\n          }\r\n        )\r\n      )}\r\n      {Object.keys(simpleButtons).map((button) =>\r\n        widgets.views.standardWidgets.newStyledComponents.Element.Badge({\r\n          variant: \"info soft openSans cursorPointer\",\r\n          size: \"lg\",\r\n          children: simpleButtons[button].children,\r\n          onClickFunction: simpleButtons[button].onClick,\r\n          icon: simpleButtons[button].icon,\r\n        })\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\n//===============================================END COMPONENTS====================================================\r\n\r\n//===================================================RENDER========================================================\r\n\r\nreturn (\r\n  <CardContainer className=\"bg-white rounded-3 p-3 m-3 col-12\">\r\n    <Card>\r\n      <HeaderCard className=\"d-flex justify-content-between pb-1\">\r\n        <div className=\"d-flex align-items-center gap-2\">\r\n          <Widget\r\n            src={widgets.views.standardWidgets.profileOverlayTrigger}\r\n            props={{ accountId, children: inner }}\r\n          />\r\n        </div>\r\n        <HeaderRightSideContainer>\r\n          <TimeContainer className=\"align-items-center\">\r\n            <TimestampText>\r\n              <span>{getPublicationDate(data.timeCreate)}</span>\r\n            </TimestampText>\r\n          </TimeContainer>\r\n          {widgets.views.standardWidgets.newStyledComponents.Input.Button({\r\n            size: \"sm\",\r\n            className: \"info soft icon\",\r\n            children: <i className=\"bi bi-flag\"></i>,\r\n            onClick: () => {\r\n              console.log(\"click flag button\");\r\n            },\r\n          })}\r\n          {widgets.views.standardWidgets.newStyledComponents.Input.Button({\r\n            size: \"sm\",\r\n            className: \"info soft icon\",\r\n            children: <i className=\"bi bi-share\"></i>,\r\n            onClick: () => {\r\n              console.log(\"click share button\");\r\n            },\r\n          })}\r\n        </HeaderRightSideContainer>\r\n      </HeaderCard>\r\n      <KeyIssuesHeader>\r\n        <KeyIssuesTitle\r\n          role=\"button\"\r\n          onClick={() => {\r\n            // handleOpenArticle(data);\r\n          }}\r\n        >\r\n          {title}\r\n        </KeyIssuesTitle>\r\n      </KeyIssuesHeader>\r\n      <KeyIssuesContent>\r\n        <KeyIssuesContainer>\r\n          {widgets.views.editableWidgets.oldArticleBody({\r\n            widgets,\r\n            authorForWidget,\r\n            content,\r\n            sliceContent: state.sliceContent,\r\n          })}\r\n        </KeyIssuesContainer>\r\n      </KeyIssuesContent>\r\n      <LowerSection>\r\n        <LowerSectionContainer>\r\n          {tags.length > 0 && (\r\n            <KeyIssues>\r\n              <KeyIssuesContent>\r\n                <KeyIssuesHeader>\r\n                  <KeyIssuesTitle>Tags</KeyIssuesTitle>\r\n                </KeyIssuesHeader>\r\n                <div className=\"d-flex w-100\">\r\n                  <TagSection>{renderTags()}</TagSection>\r\n                </div>\r\n              </KeyIssuesContent>\r\n            </KeyIssues>\r\n          )}\r\n          <ButtonsLowerSection>\r\n            {renderBottomButtonsSection()}\r\n          </ButtonsLowerSection>\r\n        </LowerSectionContainer>\r\n      </LowerSection>\r\n    </Card>\r\n  </CardContainer>\r\n);\r\n", "metadata": {"fork_of": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/NDC.GeneralCard@112399495"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/CommunityVoice.GeneralCard", "fact_widget_deployments_id": "72790eadec931703038390087b3a6875", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 2}
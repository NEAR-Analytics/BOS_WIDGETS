{"tx_hash": "9ANuftu5U61QrVbo8fCj4zn4y35gNbxcafb6VbfW9sD6", "action_id_social": "J1ZUA1Yz2ByUW3ZpUgkT8PzpJSox26WsgyfMDmtmuhjo-0-widget", "block_id": 96850380, "block_timestamp": "2023-07-19T16:41:48.984Z", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "SayALot_Comment.Compose", "source_code": "const isDebug = props.isDebug;\r\n\r\nconst addressForComments = isDebug\r\n  ? \"test_sayalot-comments\"\r\n  : \"sayalot-comments\";\r\n\r\nconst addressForArticles = isDebug ? \"test_sayALotArticle\" : \"sayALotArticle\";\r\nconst authorForWidget =\r\n  \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb\";\r\nif (!context.accountId) {\r\n  return \"\";\r\n}\r\n\r\nconst item = props.item;\r\n\r\nif (!context.accountId) {\r\n  return \"\";\r\n}\r\n\r\nconst composeCommentData = () => {\r\n  const data = {\r\n    [addressForArticles]: {\r\n      [addressForComments]: JSON.stringify(\r\n        Object.assign({ item }, state.content)\r\n      ),\r\n    },\r\n    index: {\r\n      [addressForComments]: JSON.stringify({\r\n        key: item,\r\n        value: {\r\n          type: \"md\",\r\n        },\r\n      }),\r\n    },\r\n  };\r\n\r\n  return data;\r\n};\r\n\r\nState.init({\r\n  content: \"\",\r\n  onChange: ({ content }) => {\r\n    State.update({ content });\r\n  },\r\n});\r\n\r\nreturn (\r\n  <>\r\n    <Widget\r\n      src=\"mob.near/widget/Common.Compose\"\r\n      props={{\r\n        placeholder: \"Reply\",\r\n        initialText: props.initialText,\r\n        onChange: state.onChange,\r\n        onHelper: ({ extractTagNotifications }) => {\r\n          State.update({ extractTagNotifications });\r\n        },\r\n        composeButton: (onCompose) => (\r\n          <CommitButton\r\n            disabled={!state.content}\r\n            force\r\n            className=\"btn btn-dark rounded-3\"\r\n            data={composeCommentData}\r\n            onCommit={() => {\r\n              onCompose();\r\n              props.onComment && props.onComment(state.content);\r\n            }}\r\n          >\r\n            Comment\r\n          </CommitButton>\r\n        ),\r\n      }}\r\n    />\r\n    {state.content && (\r\n      <div className=\"mt-3\">\r\n        <Widget\r\n          src={`${authorForWidget}/widget/SayALot_Comment`}\r\n          props={{\r\n            item,\r\n            accountId: context.accountId,\r\n            content: state.content,\r\n            blockHeight: \"now\",\r\n            isDebug,\r\n          }}\r\n        />\r\n      </div>\r\n    )}\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/SayALot_Comment.Compose", "fact_widget_deployments_id": "42db7555053d0959deacc1509a4e8a0f", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 1}
{"tx_hash": "2pEZBgFAA88Et3M9URuTHhGCkxX2xEJDCzWeAKJYVzng", "action_id_social": "LP1cxaBrPT9zVzbc1ZzdwbTVsBdBYeTj46ZCFW7Jma9-0-widget", "block_id": 102032143, "block_timestamp": "2023-09-26T23:58:33.226Z", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "SayALot.GeneralCard", "source_code": "//===============================================INITIALIZATION=====================================================\n\nconst {\n  widgets,\n  isTest,\n  data,\n  displayOverlay,\n  handleOpenArticle,\n  handleFilterArticles,\n  addressForArticles,\n  authorForWidget,\n} = props;\n\nconst tags = data.tags;\nconst accountId = data.author;\nconst title = data.articleId;\nconst content = data.body;\nconst timeLastEdit = data.timeLastEdit;\nconst realArticleId = data.realArticleId ?? `${data.author}-${data.timeCreate}`;\n\nState.init({\n  verified: true,\n  start: true,\n  voted: false,\n  sliceContent: true,\n});\n//=============================================END INITIALIZATION===================================================\n\n//===================================================CONSTS=========================================================\n\n//=================================================END CONSTS=======================================================\n\n//==================================================FUNCTIONS=======================================================\nfunction getPublicationDate(creationTimestamp) {\n  if (creationTimestamp == 0) {\n    return \"Creation timestamp passed wrong\";\n  }\n  return new Date(creationTimestamp).toDateString();\n}\n\nfunction getUserName() {\n  const profile = data.authorProfile;\n\n  return profile.name ?? getShortUserName();\n}\n\nconst getShortUserName = () => {\n  const userId = accountId;\n\n  if (userId.length === 64) return `${userId.slice(0, 4)}..${userId.slice(-4)}`;\n  const name = userId.slice(0, -5); // truncate .near\n\n  return name.length > 20 ? `${name.slice(0, 20)}...` : name;\n};\n\n//================================================END FUNCTIONS=====================================================\n\n//==============================================STYLED COMPONENTS===================================================\n\nconst Card = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 16px;\n  gap: 16px;\n  background: rgba(140, 149, 159, 0.1) 0px 4px 28px 0px;\n  border-radius: 10px;\n`;\nconst HeaderCard = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  gap: 12px;\n  width: 100%;\n`;\n\nconst profilePictureStyles = {\n  width: \"45px\",\n  height: \"45px\",\n  borderRadius: \"50%\",\n};\nconst ProfilePicture = styled.img`\n  width: ${profilePictureStyles.width};\n  height: ${profilePictureStyles.height};\n  border-radius: ${profilePictureStyles.borderRadius};\n`;\nconst HeaderContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 4px;\n  width: 70%;\n`;\nconst HeaderTag = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 8px;\n  height: 18px;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  border-radius: 100px;\n`;\nconst HeaderTagP = styled.p`\n  height: 10px;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 11px;\n  display: flex;\n  align-items: center;\n  color: white;\n  margin: 0;\n`;\nconst HeaderContentText = styled.div`\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  cursor: pointer;\n`;\nconst NominationName = styled.p`\n  font-weight: 500;\n  font-size: 14px;\n  margin: 0;\n  align-items: center;\n  color: #000000;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\nconst NominationUser = styled.p`\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  margin: 0px;\n  line-height: 120%;\n  display: flex;\n  align-items: center;\n  color: #828688;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst Icon = styled.img`\n  width: 17px;\n  height: 17px;\n`;\nconst CollapseCandidate = styled.div`\n  padding: 12px;\n  background: #ffffff;\n  border-radius: 6px;\n`;\nconst CollapseCandidateContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 5px;\n`;\nconst CollapseCandidateText = styled.p`\n  width: 274px;\n  font-style: normal;\n  font-weight: 700;\n  font-size: 12px;\n  line-height: 120%;\n  margin: 0px;\n  margin-bottom: 3px;\n  color: #000000;\n`;\nconst DownArrow = styled.img`\n  width: 16px;\n  height: 16px;\n`;\nconst CandidateTagContainer = styled.div`\n  gap: 4px;\n`;\n\nconst KeyIssues = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  padding: 12px;\n  gap: 12px;\n  background: #ffffff;\n  border-radius: 6px;\n  width: 100%;\n`;\nconst KeyIssuesContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 12px;\n  width: 100%;\n`;\nconst KeyIssuesHeader = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 12px;\n`;\nconst KeyIssuesTitle = styled.p`\n  font-style: normal;\n  font-weight: 700;\n  font-size: 14px;\n  line-height: 120%;\n  margin-bottom: 0;\n`;\nconst KeyIssuesContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 8px;\n  overflow-y: scroll;\n  height: 250px;\n  width: 100%;\n`;\n\nconst ArticleBodyContainer = styled.div`\n  margin-right: 0.5rem;\n`;\n\nconst KeyIssueTitle = styled.p`\n  font-weight: 500;\n  font-size: 11px;\n  margin-bottom: 0px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n`;\nconst KeyIssueDescription = styled.p`\n  font-weight: 400;\n  font-size: 11px;\n  margin-bottom: 0;\n`;\nconst KeyIssueSeparator = styled.div`\n  height: 1px;\n  margin: 7px 0 2px 0;\n  background: rgba(208, 214, 217, 0.4);\n`;\nconst LowerSection = styled.div`\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  gap: 8px;\n`;\nconst LowerSectionContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  gap: 12px;\n  align-self: stretch;\n`;\nconst ButtonsLowerSection = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  width: 100%;\n`;\nconst TextLowerSectionContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  gap: 4px;\n  width: 239px;\n  height: 24px;\n  cursor: pointer;\n\n  flex-grow: 1;\n`;\nconst TimestampText = styled.div`\n  font-style: italic;\n  font-weight: 300;\n  font-size: 11px;\n  line-height: 14px;\n  margin: 0px;\n  gap: 2px;\n  color: #000000;\n\n  b {\n    font-weight: 600;\n  }\n`;\nconst CommentsCounter = styled.p`\n  width: 96px;\n  height: 24px;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 24px;\n  margin: 0px;\n  text-align: right;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;\nconst ButtonsContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  gap: 4px;\n  width: 87px;\n  height: 28px;\n`;\nconst TagSection = styled.div`\n  display: flex;\n  align-items: flex-start;\n  gap: 4px;\n  flex-wrap: wrap;\n  overflow: hidden;\n  cursor: pointer;\n`;\n\nconst CommentButtonDisabled = styled.button`\n  display: flex;\n  padding: 2px 12px;\n  align-items: center;\n  gap: 6px;\n  border-radius: 4px;\n  b\n  background: var(--buttons-disable, #c3cace);\n  cursor: default !important;\n`;\nconst CommentButtonDiv = styled.button`\n  display: flex;\n  padding: 2px 12px;\n  align-items: center;\n  gap: 6px;\n  b\n  border-radius: 80px;\n  background-image: linear-gradient(#f8f8f9, #f8f8f9),\n    radial-gradient(circle at top left, #9333ea 0%, #4f46e5 100%);\n  background-origin: border-box;\n  background-clip: padding-box, border-box;\n  border-radius: 4px;\n`;\nconst CommentButtonCounter = styled.p`\n  font-size: 12px;\n  font-weight: 500;\n  line-height: 24px;\n  margin: 0px;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;\nconst CommentButtonIcon = styled.img`\n  width: 14px;\n  height: 14px;\n`;\n\nconst DropdownContainer = styled.div`\n  position: relative;\n  display: inline-block;\n`;\n\nconst Dropbtn = styled.button`\n  background-color: #4caf50;\n  color: white;\n  padding: 16px;\n  font-size: 16px;\n`;\n\nconst DropdownContent = styled.div`\n  display: none;\n  left: 0;\n  font-size: 12px;\n  flex-direction: column;\n  align-items: flex-start;\n  position: absolute;\n  border-radius: 8px;\n  background: #ffffff;\n  box-shadow: 0px 0px 30px 0px rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  z-index: 1;\n  padding: 8px;\n`;\n\nconst Element = styled.div`\n  width: 150px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  padding: 10px;\n\n  &:hover {\n    border-radius: 6px;\n    background: #f8f8f9;\n  }\n`;\n\nconst ShareLink = styled.a`\n  color: black;\n  margin-right: 8px 12px;\n  text-decoration: none;\n  display: block;\n  text-align: start;\n`;\n\nconst ShareIcon = styled.img`\n  width: 20px;\n`;\n\nconst DropdownContainerHover = styled.div`\n  width: fit-content;\n  float: right;\n\n  &:hover ${DropdownContent} {\n    display: flex;\n    margin-top: -165px;\n  }\n`;\n\nconst Separation = styled.div`\n    position: absolute;\n  }\n`;\n//============================================END STYLED COMPONENTS=================================================\n\n//=================================================MORE STYLES======================================================\n\nconst sayALotProfileImageStyles = {\n  width: profilePictureStyles.width,\n  height: profilePictureStyles.height,\n  borderRadius: profilePictureStyles.borderRadius,\n  overflow: \"hidden\",\n};\n\n//===============================================END MORE STYLES====================================================\n\n//=================================================COMPONENTS=======================================================\n\nconst inner = (\n  <div className=\"d-flex flex-row mx-1\">\n    <Widget\n      src=\"mob.near/widget/ProfileImage\"\n      props={{\n        metadata,\n        accountId,\n        widgetName,\n        style: sayALotProfileImageStyles,\n        className: \"me-2 rounded-pill\",\n      }}\n    />\n  </div>\n);\n\nconst renderTags = () => {\n  return (\n    <>\n      {tags &&\n        tags.map((tag) => {\n          const filter = { filterBy: \"tag\", value: tag };\n\n          return (\n            <div onClick={() => handleFilterArticles(filter)}>\n              {tag && (\n                <Widget\n                  src={widgets.styledComponents}\n                  props={{\n                    Tag: { title: tag },\n                  }}\n                />\n              )}\n            </div>\n          );\n        })}\n    </>\n  );\n};\n\nconst renderArticleBody = () => {\n  let displayedContent = state.sliceContent ? content.slice(0, 1000) : content;\n  return (\n    <ArticleBodyContainer>\n      <Widget\n        src=\"mob.near/widget/SocialMarkdown\"\n        props={{\n          text: displayedContent,\n          onHashtag: (hashtag) => (\n            <span\n              key={hashtag}\n              className=\"d-inline-flex\"\n              style={{ fontWeight: 500 }}\n            >\n              <a\n                href={`https://near.social/${authorForWidget}/widget/${widgets.sayALot}?tagShared=${hashtag}`}\n                target=\"_blank\"\n              >\n                #{hashtag}\n              </a>\n            </span>\n          ),\n        }}\n      />\n      {state.sliceContent && content.length > 1000 && (\n        <Widget\n          src={widgets.styledComponents}\n          props={{\n            Button: {\n              text: `Show more`,\n              size: \"sm\",\n              className: \"w-100 justify-content-center\",\n              onClick: () => {\n                State.update({ sliceContent: false });\n              },\n              icon: <i className=\"bi bi-chat-square-text-fill\"></i>,\n            },\n          }}\n        />\n      )}\n    </ArticleBodyContainer>\n  );\n};\n\n//===============================================END COMPONENTS====================================================\n\n//===================================================RENDER========================================================\nreturn (\n  <div className=\"bg-white rounded-3 p-3 ml-2 col-lg-10 col-md-10 col-sm-12\">\n    <Card>\n      {state.showModal && (\n        <Widget\n          src={widgets.addComment}\n          props={{\n            widgets,\n            article: data,\n            isReplying: false,\n            isTest,\n            username: data.author,\n            realArticleId,\n            onCloseModal: () => State.update({ showModal: false }),\n          }}\n        />\n      )}\n      <HeaderCard className=\"d-flex justify-content-between\">\n        <div className=\"d-flex align-items-center gap-2\">\n          <Widget\n            src=\"mob.near/widget/Profile.OverlayTrigger\"\n            props={{ accountId, children: inner }}\n          />\n          <HeaderContent>\n            <HeaderContentText\n              onClick={() => {\n                handleOpenArticle(data);\n              }}\n            >\n              <NominationName>{getUserName()}</NominationName>\n              <NominationUser>{getShortUserName()}</NominationUser>\n            </HeaderContentText>\n          </HeaderContent>\n        </div>\n        <Widget\n          src={widgets.upVoteButton}\n          props={{ isTest, authorForWidget, reactedElementData: data, widgets }}\n        />\n      </HeaderCard>\n      <KeyIssuesHeader>\n        <KeyIssuesTitle\n          role=\"button\"\n          onClick={() => {\n            handleOpenArticle(data);\n          }}\n        >\n          {title}\n        </KeyIssuesTitle>\n      </KeyIssuesHeader>\n      <KeyIssues>\n        <KeyIssuesContent>\n          <KeyIssuesContainer>{renderArticleBody()}</KeyIssuesContainer>\n        </KeyIssuesContent>\n      </KeyIssues>\n      <LowerSection>\n        <LowerSectionContainer>\n          {tags.length > 0 && (\n            <KeyIssues>\n              <KeyIssuesContent>\n                <KeyIssuesHeader>\n                  <KeyIssuesTitle>Tags</KeyIssuesTitle>\n                </KeyIssuesHeader>\n                <div className=\"d-flex w-100\">\n                  <TagSection>{renderTags()}</TagSection>\n                </div>\n              </KeyIssuesContent>\n            </KeyIssues>\n          )}\n          <ButtonsLowerSection>\n            <TextLowerSectionContainer\n              className=\"align-items-center\"\n              onClick={() => {\n                handleOpenArticle(data);\n              }}\n            >\n              <i className=\"bi bi-clock\"></i>\n              <TimestampText>\n                <span>{getPublicationDate(timeLastEdit)}</span>\n                <span>by</span>\n                <b>{author}</b>\n              </TimestampText>\n            </TextLowerSectionContainer>\n            <Widget\n              src={widgets.reactions}\n              props={{\n                widgets,\n                isTest,\n                authorForWidget,\n                elementReactedId: realArticleId,\n              }}\n            />\n          </ButtonsLowerSection>\n          <div className=\"d-flex w-100 align-items-center\">\n            <div className=\"d-flex w-100 gap-2 justify-content-between\">\n              <Widget\n                src={widgets.styledComponents}\n                props={{\n                  Button: {\n                    text: `Add comment`,\n                    disabled:\n                      !context.accountId || context.accountId === accountId,\n                    size: \"sm\",\n                    className: \"secondary dark w-100 justify-content-center\",\n                    onClick: () => {\n                      State.update({ showModal: true });\n                    },\n                    icon: (\n                      <>\n                        <i className=\"bi bi-chat-square-text-fill\"></i>\n                      </>\n                    ),\n                  },\n                }}\n              />\n              <Widget\n                src={widgets.styledComponents}\n                props={{\n                  Button: {\n                    text: \"View\",\n                    size: \"sm\",\n                    className: \"primary w-100 justify-content-center\",\n                    icon: <i className=\"bi bi-eye fs-6\"></i>,\n                    onClick: () => {\n                      handleOpenArticle(data);\n                    },\n                  },\n                }}\n              />\n            </div>\n          </div>\n        </LowerSectionContainer>\n      </LowerSection>\n    </Card>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/SayALot.GeneralCard", "fact_widget_deployments_id": "123a5385d7ad8f709ae6f470076c6d72", "inserted_timestamp": "2023-09-27T01:53:12.017Z", "modified_timestamp": "2023-09-27T01:53:12.017Z", "__row_index": 41}
{"tx_hash": "F3iB8ZuxQZbyavEeLpAXbdN4DZvJXFCRV8VeBZgjML4T", "action_id_social": "BcrNQsEm3P4MtUj7Mj8ugeSS9mDgBWg6onsmbNc6jbHa-0-widget", "block_id": 108738214, "block_timestamp": "2023-12-24T23:49:31.630Z", "signer_id": "aaron.near", "widget_name": "Minter", "source_code": null, "metadata": null, "branch": {"draft": {"": "const nearContract = \"core.isnft.near\";\nconst ownerId = \"vitalpointai.near\"; // attribution\nlet accountId = context.accountId;\n\nconst contractAddresses = {\n  0: [nearContract, \"Near\"],\n};\n\nconst chains = [\n  {\n    id: \"0\",\n    name: \"Near\",\n    url: \"https://ipfs.near.social/ipfs/bafkreigv55ubnx3tfhbf56toihekuxvgzfqn5c3ndbfjcg3e4uvaeuy5cm\",\n  },\n];\n\nconst handleMint = () => {\n  console.log(\"it's here\", state.title && state.description && state.image.cid);\n  if (!state.image.cid) {\n    return;\n  }\n  if (!state.title) {\n    console.log(\"Please Enter title\");\n    State.update({\n      showAlert: true,\n      toastMessage: \"Please enter a title for the NFT\",\n    });\n\n    setTimeout(() => {\n      State.update({\n        showAlert: false,\n      });\n    }, 3000);\n  } else if (!state.description) {\n    State.update({\n      showAlert: true,\n      toastMessage: \"Please enter a description for the NFT\",\n    });\n    setTimeout(() => {\n      State.update({\n        showAlert: false,\n      });\n    }, 3000);\n  } else {\n    const gas = 200000000000000;\n    const deposit = 10000000000000000000000;\n    const metadata = {\n      name: state.title,\n      description: state.description,\n      properties: [],\n      image: `ipfs://${state.image.cid}`,\n    };\n    asyncFetch(\"https://ipfs.near.social/add\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n      },\n      body: metadata,\n    }).then((res) => {\n      const cid = res.body.cid;\n      const Id = Math.floor(Math.random() * (9999999 - 100000 + 1) + 100000);\n      console.log(\"in the promise\", res, Id);\n      Near.call([\n        {\n          contractName: nearContract,\n          methodName: \"nft_mint\",\n          args: {\n            token_id: `${Date.now()}`,\n            metadata: {\n              title: state.title,\n              description: state.description,\n              media: `https://ipfs.io/ipfs/${state.image.cid}`,\n              reference: `ipfs://${cid}`,\n            },\n            receiver_id: state.recipient || accountId,\n          },\n          gas: gas,\n          deposit: deposit,\n        },\n      ]);\n    });\n    return;\n  }\n  console.log(\"passed checks\");\n};\n\nState.init({\n  title: \"\",\n  description: \"\",\n  recipient: \"\",\n  showAlert: false,\n  toastMessage: \"\",\n});\n\nconst onChangeTitle = (title) => {\n  console.log(\"go daddy\", state.recipient);\n  State.update({\n    title,\n  });\n};\n\nconst onChangeRecipient = (recipient) => {\n  State.update({\n    recipient,\n  });\n};\n\nconst onChangeDesc = (description) => {\n  console.log(\"Log ciritcal critics:\", state.title);\n  State.update({\n    description,\n  });\n};\n\nconst Heading = styled.p`\n  margin: 3px auto 3px auto;\n  font-size: 1em;\n  color:#0f1d40;\n  line-height:2.1rem;\n  width:60%;\n  text-align: center;\n  font-family: \"SF Pro Display\",sans-serif;\n`;\n\nconst ImageUploadCard = styled.div`\ndisplay:flex;\nflex-flow: column nowrap;\nalign-items: center;\n  width:80%;\n  border: 2px dashed #0d99ff;\n  border-radius: 1rem;\n  box-shadow: 4px 4px 20px 6px rgba(0,0,0,.2);\n  margin:30px auto;\n  padding:1.5rem;\n  text-align: center;\n`;\n\nconst Main = styled.div`\n  display: grid;\n  gap: 3rem;\n  align-content:center;\n  grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));\n  justify-content: center;\n  // background: linear-gradient(180deg,#e4f1fb,hsla(0,0%,85.1%,0));\n  margin-top: 5px;\n  width:100%;\n  padding: 1rem;\n`;\n\nconst Text = styled.p`\nfont-size: .9rem;\ncolor: #525c76;\nline-height:1.rem;\nmargin: 3px;\n`;\n\nconst MainRoot = styled.div`\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    justify-content: space-between;\n`;\n\nconst Elipse = styled.div`\nbackground-color:#dff3f9;\nheight: 100px;\nwidth: 100px;\nborder-radius: 50%;\n`;\n\nconst Card = styled.div`\npadding: 1em;\nborder: 1px solid #e5e8eb;\ngap: 2em;\nmargin: 10px auto;\nborder-radius: .7em;\n`;\n\nconst ImageCard = styled.div`\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);\n  height:100%;\n  max-height:100%;\n  width: 90%;\n  max-width: 500px;\n  border-radius: 1rem;\n  &>img{\n  object-fit: cover;\n  width: 100%;\n  height: 100%;\n  }\n`;\n\nconst Input = styled.input`\n  display: block;\n  padding:.5em;\n  width:100%;\n  border: 1px solid #e5e8eb;\n  border-radius: 10px;\n  outline: none;\n  background: #f4f5f6;\n  color: #525c76;\n  :focus{\n    border:1px solid #0d99ff;\n  }\n  ::placeholder {\n    color: palevioletred;\n  }\n`;\n\nconst TextArea = styled.textarea`\n  display: block;\n  padding:.5em;\n  width:100%;\n  border: 1px solid #e5e8eb;\n  border-radius: 10px;\n  outline: none;\n  background: #f4f5f6;\n  color: #525c76;\n  :focus{\n    border:1px solid #0d99ff;\n  }\n`;\n\nconst SelectTag = styled.select`\n  height: fit-content;\n  width: 300px;\n`;\n\nconst ChainIcon = styled.option`\n  display: flex;\n  height: 130px;\n  padding: 1rem auto;\n  &>img{\n    height:100px;\n    width: 100px;\n    object-fit: contain;\n  }\n`;\n\nif (!accountId) {\n  console.log(\"Please login here now\");\n  State.update({\n    showAlert: true,\n    toastMessage: \"Please sign in.\",\n  });\n}\n\nreturn (\n  <MainRoot>\n    {state.showAlert && <Widget src=\"aaron.near/widget/Toast\" props={state} />}\n    <Heading className=\"text-center fs-2 fw-bold\">Mint NFT</Heading>\n    <Main className=\"container-fluid\">\n      {!state.image.cid ? (\n        <div className=\"flex-grow-1\">\n          <Heading>Upload an image to create an NFT!</Heading>\n          <ImageUploadCard className=\"flex-grow-1\">\n            <Elipse />\n            <IpfsImageUpload\n              image={state.image}\n              className=\"btn text-decoration-none link-primary pe-auto\"\n            />\n            <div>\n              {\n                //   <Heading\n                //   onDrop={handleDrop}\n                //   onDragOver={(event) => event.preventDefault()}\n                // >\n                //   Drag and Drop your image file here\n                // </Heading>\n              }\n              <Text>\n                We support .jpg, .jpeg, .png, .webp, .gif files and deploy to\n                Near\n              </Text>\n              <Text>Max file size: 20mb</Text>\n            </div>\n          </ImageUploadCard>\n        </div>\n      ) : (\n        <>\n          <Card className=\"d-flex flex-column align-items-center w-100\">\n            <div>\n              <IpfsImageUpload\n                image={state.image}\n                className=\"btn btn-outline-primary border-0 rounded-3\"\n              />\n            </div>\n            <ImageCard>\n              <img\n                src={`https://ipfs.io/ipfs/` + state.image.cid}\n                alt=\"uploaded image\"\n                width=\"100%\"\n                height=\"100%\"\n                className=\"rounded-3\"\n              />\n            </ImageCard>\n          </Card>\n          <div>\n            <Card>\n              <Card>\n                Title:\n                <Input\n                  type=\"text\"\n                  value={state.title || \"\"}\n                  onChange={(e) => onChangeTitle(e.target.value)}\n                />\n              </Card>\n              <Card>\n                Description:\n                <TextArea\n                  type=\"text\"\n                  value={state.description || \"\"}\n                  onChange={(e) => onChangeDesc(e.target.value)}\n                />\n              </Card>\n              <Card>\n                Mint To:\n                <Input\n                  type=\"text\"\n                  placeholder={accountId}\n                  value={state.recipient}\n                  onChange={(e) => onChangeRecipient(e.target.value)}\n                />\n              </Card>\n            </Card>\n            <button\n              type=\"button\"\n              className=\"btn btn-primary d-flex flex-column align-items-center mx-auto\"\n              onClick={handleMint}\n            >\n              Mint to NEAR\n            </button>\n          </div>\n        </>\n      )}\n    </Main>\n  </MainRoot>\n);\n"}}, "widget_modules_used": null, "widget_url": "https://near.social/#/aaron.near/widget/Minter", "fact_widget_deployments_id": "047d25a74049499a0edae797596930fb", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
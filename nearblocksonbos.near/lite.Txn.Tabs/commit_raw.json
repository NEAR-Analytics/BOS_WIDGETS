{"tx_hash": "FvdRP1PiPmnptX7mFcnPuhYGERZRiajbKdrNWBasgZJb", "action_id_social": "56iEW1bdwo8f8XNCtUHwY4sJdoetA6bLcHayHpWeubQn-0-widget", "block_id": 121020858, "block_timestamp": "2024-06-12T18:24:59.507Z", "signer_id": "nearblocksonbos.near", "widget_name": "lite.Txn.Tabs", "source_code": "let ErrorSkeleton = window?.ErrorSkeleton || (() => <></>);\nlet TxnTabsSkeleton = window?.TxnTabsSkeleton || (() => <></>);\nlet TxnExecutionSkeleton = window?.TxnExecutionSkeleton || (() => <></>);\nlet tabs = [0];\nconst Tabs = ({ hash, rpcUrl }) => {\n  let { rpcFetch } = VM.require(\n    `nearblocksonbos.near/widget/lite.libs.fetcher`\n  );\n  let { nestReceipts, parseOutcome, parseReceipt } = VM.require(\n    `nearblocksonbos.near/widget/lite.libs.execution`\n  );\n  if (!rpcFetch || !nestReceipts || !parseOutcome || !parseReceipt)\n    return <TxnTabsSkeleton />;\n  const [active, setActive] = useState(tabs[0]);\n  const [data, setData] = useState({});\n  const [error, setError] = useState({});\n  const [loading, setLoading] = useState({});\n  useEffect(() => {\n    if (rpcFetch && rpcUrl && hash && active === 0) {\n      setLoading((prev) => ({ ...prev, [active]: true }));\n      rpcFetch(rpcUrl, \"EXPERIMENTAL_tx_status\", {\n        sender_account_id: \"bowen\",\n        tx_hash: hash,\n        wait_until: \"NONE\",\n      })\n        .then((response) => {\n          const blocksMap = response.receipts_outcome.reduce(\n            (map, row) =>\n              map.set(row.block_hash, {\n                hash: row.block_hash,\n                height: 0,\n                timestamp: 0,\n              }),\n            new Map()\n          );\n          const receiptsMap = response.receipts_outcome.reduce(\n            (mapping, receiptOutcome) => {\n              const receipt = parseReceipt(\n                response.receipts.find(\n                  (rpcReceipt) => rpcReceipt.receipt_id === receiptOutcome.id\n                ),\n                receiptOutcome,\n                response.transaction\n              );\n              return mapping.set(receiptOutcome.id, {\n                ...receipt,\n                outcome: parseOutcome(receiptOutcome, blocksMap),\n              });\n            },\n            new Map()\n          );\n          setData((state) => ({\n            ...state,\n            [active]: nestReceipts(\n              response.transaction_outcome.outcome.receipt_ids[0],\n              receiptsMap\n            ),\n          }));\n        })\n        .catch((err) => setError((state) => ({ ...state, [active]: err })))\n        .finally(() => setLoading((state) => ({ ...state, [active]: false })));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [hash, active, data]);\n  return (\n    <div className=\"bg-bg-box lg:rounded-xl shadow px-6 mt-8\">\n      <div className=\"pt-4 pb-6\">\n        {tabs.map((tab) => (\n          <button\n            className={`py-1 mr-4 ${\n              active === tab\n                ? \"font-medium border-b-[3px] border-text-body\"\n                : \"text-text-label\"\n            }`}\n            key={tab}\n            onClick={() => setActive(tab)}\n          >\n            {tab === 0 && \"Execution Plan\"}\n          </button>\n        ))}\n      </div>\n      <div className=\"lg:px-4 pb-6\">\n        {error[active] ? (\n          <Widget\n            key=\"error\"\n            loading={<ErrorSkeleton />}\n            props={{ title: \"Error Fetching Txn Details\" }}\n            src={`nearblocksonbos.near/widget/lite.Atoms.Error`}\n          />\n        ) : loading[active] ? (\n          <>{active === 0 && <TxnExecutionSkeleton />}</>\n        ) : (\n          <>\n            {active === 0 && (\n              <Widget\n                key=\"execution\"\n                loading={<TxnExecutionSkeleton />}\n                props={{ receipt: data[active] }}\n                src={`nearblocksonbos.near/widget/lite.Txn.Execution`}\n              />\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\nreturn Tabs(props);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearblocksonbos.near/widget/lite.Txn.Tabs", "fact_widget_deployments_id": "cd279a2bef58c505892926461b2d929f", "inserted_timestamp": "2024-06-12T20:05:24.439Z", "modified_timestamp": "2024-06-12T20:05:24.439Z", "__row_index": 0}
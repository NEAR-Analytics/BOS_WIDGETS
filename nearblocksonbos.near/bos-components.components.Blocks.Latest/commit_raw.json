{"tx_hash": "A2kEG8iFgFpY12S1gGXUQyoASbTtYT3CPG1mFHQj7w99", "action_id_social": "7rCQXLuS1JxKX1Lw6uz9hj8xGgCM1G43TyEZgsAH53CV-0-widget", "block_id": 117096865, "block_timestamp": "2024-04-18T09:43:01.951Z", "signer_id": "nearblocksonbos.near", "widget_name": "bos-components.components.Blocks.Latest", "source_code": "/**\n * Component: BlocksLatest\n * Author: Nearblocks Pte Ltd\n * License: Business Source License 1.1\n * Description: Latest Blocks on Near Protocol.\n * @interface Props\n * @param {string} [network] - The network data to show, either mainnet or testnet\n * @param {Function} [t] - A function for internationalization (i18n) provided by the next-translate package.\n * @param {string} ownerId - The identifier of the owner of the component.\n */\n\n\n\n\n\n\n\n/* INCLUDE COMPONENT: \"includes/Common/Skeleton.jsx\" */\n/**\n * @interface Props\n * @param {string} [className] - The CSS class name(s) for styling purposes.\n */\n\n\n\n\n\nconst Skeleton = (props) => {\n  return (\n    <div\n      className={`bg-gray-200 dark:bg-black-200 rounded shadow-sm animate-pulse ${props.className}`}\n    ></div>\n  );\n};/* END_INCLUDE COMPONENT: \"includes/Common/Skeleton.jsx\" */\n\n\nfunction MainComponent({ network, t, ownerId }) {\n  const { convertToMetricPrefix, getTimeAgoString, localFormat } = VM.require(\n    `${ownerId}/widget/includes.Utils.formats`,\n  );\n\n  const { getConfig, handleRateLimit, nanoToMilli } = VM.require(\n    `${ownerId}/widget/includes.Utils.libs`,\n  );\n\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(false);\n  const [blocks, setBlocks] = useState([]);\n\n  const config = getConfig && getConfig(network);\n\n  useEffect(() => {\n    let delay = 5000;\n\n    function fetchLatestBlocks() {\n      asyncFetch(`${config?.backendUrl}blocks/latest`)\n        .then((data) => {\n          const resp = data?.body?.blocks;\n          if (data.status === 200) {\n            setBlocks(resp);\n            setError(false);\n            if (isLoading) setIsLoading(false);\n          } else {\n            handleRateLimit(data, fetchLatestBlocks, () => {\n              if (isLoading) setIsLoading(false);\n            });\n          }\n        })\n        .catch(() => {\n          setError(true);\n        });\n    }\n\n    if (config.backendUrl) {\n      fetchLatestBlocks();\n    }\n    const interval = setInterval(fetchLatestBlocks, delay);\n\n    return () => clearInterval(interval);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [config.backendUrl, isLoading]);\n\n  return (\n    <>\n      <div className=\"relative\">\n        <ScrollArea.Root>\n          <ScrollArea.Viewport>\n            {!blocks && error && (\n              <div className=\"flex items-center h-16 mx-3 py-2 text-nearblue-700 text-xs\">\n                {t ? t('home:error') : 'Error!'}\n              </div>\n            )}\n            {!error && !isLoading && blocks?.length === 0 && (\n              <div className=\"flex items-center h-16 mx-3 py-2 text-nearblue-700 text-xs\">\n                {t ? t('home:noBlocks') : 'No blocks found'}\n              </div>\n            )}\n            {isLoading && blocks?.length === 0 && (\n              <div className=\"px-3 divide-y dark:divide-black-200 h-80\">\n                {[...Array(5)].map((_, i) => (\n                  <div\n                    className=\"grid grid-cols-2 md:grid-cols-3 gap-3 py-3\"\n                    key={i}\n                  >\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 rounded-xl h-10 w-10 bg-blue-900/10 dark:text-white flex items-center justify-center text-sm\">\n                        BK\n                      </div>\n                      <div className=\"px-2\">\n                        <div className=\"text-green-500 dark:text-green-250 text-sm\">\n                          <div className=\"h-5 w-14\">\n                            <Skeleton className=\"h-4\" />\n                          </div>\n                        </div>\n                        <div className=\"text-nearblue-700 text-xs\">\n                          <div className=\"h-4 w-24\">\n                            <Skeleton className=\"h-3\" />\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"col-span-2 md:col-span-1 px-2 order-2 md:order-1 text-sm\">\n                      <div className=\"h-5 w-36\">\n                        <Skeleton className=\"h-4\" />\n                      </div>\n                      <div className=\"text-nearblue-700 text-sm\">\n                        <div className=\"h-5 w-14\">\n                          <Skeleton className=\"h-4\" />\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"text-right order-1 md:order-2\">\n                      <div className=\"ml-auto w-32\">\n                        <Skeleton className=\"h-4\" />\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n            {blocks?.length > 0 && (\n              <div className=\"px-3 divide-y dark:divide-black-200 h-80\">\n                {blocks?.map((block) => {\n                  return (\n                    <div\n                      className=\"grid grid-cols-2 md:grid-cols-3 gap-2 lg:gap-3 py-3\"\n                      key={block?.block_hash}\n                    >\n                      <div className=\" flex items-center\">\n                        <div className=\"flex-shrink-0 rounded-xl h-10 w-10 bg-blue-900/10 dark:text-white  flex items-center justify-center text-sm\">\n                          BK\n                        </div>\n                        <div className=\"overflow-hidden pl-2\">\n                          <div className=\"text-green-500 dark:text-green-250 text-sm font-medium \">\n                            <Link\n                              href={`/blocks/${block?.block_hash}`}\n                              className=\"hover:no-underline\"\n                            >\n                              <a className=\"text-green-500 dark:text-green-250 hover:no-underline\">\n                                {block?.block_height\n                                  ? localFormat(block?.block_height)\n                                  : block?.block_height ?? ''}\n                              </a>\n                            </Link>\n                          </div>\n                          <div className=\"text-nearblue-700 text-xs truncate\">\n                            {block?.block_timestamp\n                              ? getTimeAgoString(\n                                  nanoToMilli(block?.block_timestamp),\n                                )\n                              : ''}\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"col-span-2 md:col-span-1 px-2 order-2 md:order-1  text-sm whitespace-nowrap dark:text-green-250 truncate\">\n                        <span className=\"dark:text-white\">\n                          {t ? t('home:blockMiner') : 'Author'}\n                        </span>\n                        <Link\n                          href={`/address/${block?.author_account_id}`}\n                          className=\"hover:no-underline\"\n                        >\n                          <a className=\"text-green-500  dark:text-green-250 font-medium hover:no-underline \">\n                            {block?.author_account_id}\n                          </a>\n                        </Link>\n                        <div className=\"text-nearblue-700 text-sm \">\n                          {block?.transactions_agg?.count\n                            ? localFormat(block?.transactions_agg?.count)\n                            : block?.transactions_agg?.count ?? ''}{' '}\n                          txns{' '}\n                        </div>\n                      </div>\n                      <div className=\"text-right order-1 md:order-2 overflow-hidden\">\n                        <Tooltip.Provider>\n                          <Tooltip.Root>\n                            <Tooltip.Trigger asChild>\n                              <span className=\"u-label--badge-in text-nearblue-700 truncate\">\n                                {block?.chunks_agg?.gas_used\n                                  ? convertToMetricPrefix(\n                                      block?.chunks_agg?.gas_used,\n                                    ) + 'gas'\n                                  : block?.chunks_agg?.gas_used ?? '' + 'gas'}\n                              </span>\n                            </Tooltip.Trigger>\n                            <Tooltip.Content\n                              className=\"h-auto max-w-xs bg-black bg-opacity-90 z-10 text-white text-xs p-2\"\n                              sideOffset={5}\n                            >\n                              Gas used\n                            </Tooltip.Content>\n                          </Tooltip.Root>\n                        </Tooltip.Provider>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </ScrollArea.Viewport>\n          <ScrollArea.Scrollbar\n            className=\"flex select-none touch-none p-0.5 bg-neargray-25 dark:bg-black-600 transition-colors duration-[160ms] ease-out hover:bg-neargray-25 data-[orientation=vertical]:w-2.5 data-[orientation=horizontal]:flex-col data-[orientation=horizontal]:h-2.5\"\n            orientation=\"vertical\"\n          >\n            <ScrollArea.Thumb className=\"flex-1 bg-neargray-50 dark:bg-black-200 rounded-[10px] relative before:content-[''] before:absolute before:top-1/2 before:left-1/2 before:-translate-x-1/2 before:-translate-y-1/2 before:w-full before:h-full before:min-w-[44px] before:min-h-[44px]\" />\n          </ScrollArea.Scrollbar>\n          <ScrollArea.Scrollbar\n            className=\"flex select-none touch-none p-0.5 bg-neargray-25 dark:bg-black-600 transition-colors duration-[160ms] ease-out hover:bg-neargray-25 data-[orientation=vertical]:w-2.5 data-[orientation=horizontal]:flex-col data-[orientation=horizontal]:h-2.5\"\n            orientation=\"horizontal\"\n          >\n            <ScrollArea.Thumb className=\"flex-1 bg-neargray-50 dark:bg-black-600 rounded-[10px] relative before:content-[''] before:absolute before:top-1/2 before:left-1/2 before:-translate-x-1/2 before:-translate-y-1/2 before:w-full before:h-full before:min-w-[44px] before:min-h-[44px]\" />\n          </ScrollArea.Scrollbar>\n          <ScrollArea.Corner className=\"bg-neargray-50\" />\n        </ScrollArea.Root>\n      </div>\n      {isLoading && blocks?.length === 0 && (\n        <div className=\"border-t dark:border-black-200 px-2 py-3 text-nearblue-600\">\n          <Skeleton className=\"h-10\" />\n        </div>\n      )}\n      {blocks && blocks?.length > 0 && (\n        <div className=\"border-t dark:border-black-200 px-2 py-3 text-nearblue-600\">\n          <Link href=\"/blocks\">\n            <a className=\"block  dark:text-white text-center border border-green-900/10 bg-green-500 dark:bg-black-600/[0.75] hover:bg-green-400 font-thin dark:font-normal dark:hover:text-green-250 text-white dark:text-sm text-xs py-3 rounded w-full focus:outline-none hover:no-underline\">\n              View all blocks\n            </a>\n          </Link>\n        </div>\n      )}\n    </>\n  );\n}\n\nreturn MainComponent(props, context);", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearblocksonbos.near/widget/bos-components.components.Blocks.Latest", "fact_widget_deployments_id": "6e9f69793b49dfe0fd1b892d26aa82b2", "inserted_timestamp": "2024-04-18T11:33:47.467Z", "modified_timestamp": "2024-04-18T11:33:47.467Z", "__row_index": 0}
{"tx_hash": "45AtC6efzxtnz9zobneQs6sdTjwRBvsT4gbZD9oE4NcR", "action_id_social": "25wqWSCFttNS1mSezXjaDzneCgUmccLYmiwcD32kPAZU-0-widget", "block_id": 117594496, "block_timestamp": "2024-04-25T13:15:42.400Z", "signer_id": "nearblocksonbos.near", "widget_name": "bos-components.components.Shared.TokenInfo", "source_code": "/* INCLUDE COMPONENT: \"includes/icons/TokenImage.jsx\" */\n/**\n * @interface Props\n * @param {string} [src] - The URL string pointing to the image source.\n * @param {string} [alt] - The alternate text description for the image.\n * @param {string} [className] - The CSS class name(s) for styling purposes.\n * @param {string} [appUrl] - The URL of the application.\n */\n\n\n\n\n\n\n\n\n\n\nconst TokenImage = ({\n  appUrl,\n  src,\n  alt,\n  className,\n  onLoad,\n  onSetSrc,\n}) => {\n  const placeholder = appUrl\n    ? `${appUrl}images/tokenplaceholder.svg`\n    : '/images/tokenplaceholder.svg';\n\n  const handleLoad = () => {\n    if (onLoad) {\n      onLoad();\n    }\n  };\n\n  const handleError = () => {\n    if (onSetSrc) {\n      onSetSrc(placeholder);\n    }\n    if (onLoad) {\n      onLoad();\n    }\n  };\n\n  return (\n    <img\n      src={src || placeholder}\n      alt={alt}\n      className={className}\n      onLoad={handleLoad}\n      onError={handleError}\n    />\n  );\n};/* END_INCLUDE COMPONENT: \"includes/icons/TokenImage.jsx\" */\n\n\nfunction MainComponent(props) {\n  const { network, contract, amount, decimals, ownerId } = props;\n\n  const { shortenToken, shortenTokenSymbol, localFormat } = VM.require(\n    `${ownerId}/widget/includes.Utils.formats`,\n  );\n\n  const { getConfig } = VM.require(`${ownerId}/widget/includes.Utils.libs`);\n\n  const { decodeArgs, tokenAmount } = VM.require(\n    `${ownerId}/widget/includes.Utils.near`,\n  );\n  const [meta, setMeta] = useState({} );\n\n  const config = getConfig && getConfig(network);\n\n  const Loader = (props) => {\n    return (\n      <div\n        className={`bg-gray-200 dark:bg-black-200 h-5 rounded shadow-sm animate-pulse ${props.className} ${props?.wrapperClassName}`}\n      ></div>\n    );\n  };\n\n  useEffect(() => {\n    function fetchMetadata(contract) {\n      if (contract) {\n        asyncFetch(`${config?.rpcUrl}`, {\n          method: 'POST',\n          body: JSON.stringify({\n            jsonrpc: '2.0',\n            id: 'dontcare',\n            method: 'query',\n            params: {\n              request_type: 'call_function',\n              finality: 'final',\n              account_id: contract,\n              method_name: 'ft_metadata',\n              args_base64: '',\n            },\n          }),\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        })\n          .then(\n            (data\n\n\n\n) => {\n              const resp = data?.body?.result;\n              setMeta(decodeArgs(resp.result));\n            },\n          )\n          .catch(() => {});\n      }\n    }\n\n    fetchMetadata(contract);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [contract, config?.rpcUrl]);\n\n  return !meta?.name ? (\n    <Loader wrapperClassName=\"flex w-full max-w-xs\" />\n  ) : (\n    <>\n      <span className=\"font-normal px-1\">\n        {amount\n          ? localFormat(tokenAmount(amount, decimals || meta?.decimals, true))\n          : amount ?? ''}\n      </span>\n      <Link href={`/token/${contract}`} className=\"hover:no-underline\">\n        <a className=\"text-green flex items-center hover:no-underline dark:text-green-250\">\n          <span className=\"flex items-center\">\n            <TokenImage\n              src={meta?.icon}\n              alt={meta?.name}\n              appUrl={config?.appUrl}\n              className=\"w-4 h-4 mx-1\"\n            />\n            {shortenToken(meta?.name)}\n            <span>&nbsp;({shortenTokenSymbol(meta?.symbol)})</span>\n          </span>\n        </a>\n      </Link>\n    </>\n  );\n}\n\nreturn MainComponent(props, context);", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearblocksonbos.near/widget/bos-components.components.Shared.TokenInfo", "fact_widget_deployments_id": "78a3012c16a7f243946dc3bbd76165a6", "inserted_timestamp": "2024-04-25T14:01:49.942Z", "modified_timestamp": "2024-04-25T14:01:49.942Z", "__row_index": 19}
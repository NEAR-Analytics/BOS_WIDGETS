{"tx_hash": "9dCcXVf15RmhW8GqGFDcwv63RCab4GamiBr92AZWcUb9", "action_id_social": "7dGnMgJ7oNmmd7k4iuthUgJWuGpyadrzKqgWG6JL8o4G-0-widget", "block_id": 119542521, "block_timestamp": "2024-05-23T05:36:40.235Z", "signer_id": "nearblocksonbos.near", "widget_name": "bos-components.components.Comments.Feed", "source_code": "/**\n * Component: CommentsFeed\n * Author: Nearblocks Pte Ltd\n * License: Business Source License 1.1\n * Description: The component enables users to view and interact with comments.\n * @interface Props\n * @param {string} [network] - The network data to show, either mainnet or testnet\n * @param {string} [path] - The path identifier passed as a string.\n * @param {number} [limit] - The maximum number of comments to display.\n * @param {string} ownerId - The identifier of the owner of the component.\n * @param {Function} [requestSignInWithWallet] - Function to initiate sign-in with a wallet.\n */\n\n\n\n\n\n\n\n\n\nfunction MainComponent(props) {\n  const { requestSignInWithWallet } = props;\n  const [content, setContent] = useState('');\n\n  const path = props.path;\n  const index = {\n    action: 'post',\n    key: path,\n    options: {\n      limit: props.limit ?? 3,\n      order: 'desc',\n      subscribe: true,\n      accountId: context.accountId,\n    },\n  };\n  const composeData = () => {\n    const data = {\n      index: {\n        post: JSON.stringify({\n          key: path,\n          value: {\n            type: 'md',\n            post: content,\n          },\n        }),\n      },\n    };\n\n    return data;\n  };\n  const onChange = (newContent\n\n) => {\n    setContent(newContent.content);\n  };\n\n  const renderItem = (item\n\n\n\n) =>\n    item.value.type === 'md' && (\n      <div key={JSON.stringify(item)} className=\"\">\n        <Widget\n          src={`${props.ownerId}/widget/bos-components.components.Comments.Comment`}\n          props={{\n            accountId: item.accountId,\n            blockHeight: item.blockHeight,\n            ownerId: props.ownerId,\n            post: item.value.post,\n          }}\n        />\n      </div>\n    );\n\n  return (\n    <>\n      <div className=\"border-b  dark:border-black-200\">\n        {!context.accountId ? (\n          <>\n            <div className=\"w-full p-6 mx-auto m-2\">\n              <div className=\"flex items-center justify-center h-40 bg-gray-100 border-2 border-gray-300 rounded-md dark:bg-black-600\">\n                <p className=\"text-center text-gray-600 dark:text-neargray-10\">\n                  You must be\n                  <a\n                    href=\"#\"\n                    className=\"text-green-500 dark:text-green-250 underline\"\n                    onClick={requestSignInWithWallet}\n                  >\n                    logged in\n                  </a>\n                  to post a comment\n                </p>\n              </div>\n            </div>\n          </>\n        ) : (\n          <Widget\n            src={`${props.ownerId}/widget/bos-components.components.Comments.InputField`}\n            props={{\n              onChange: onChange,\n              composeButton: (onCompose) => (\n                <CommitButton\n                  disabled={!content}\n                  force\n                  className=\"btn-primary rounded-5\"\n                  data={composeData}\n                  onCommit={() => {\n                    onCompose();\n                  }}\n                >\n                  <OverlayTrigger\n                    placement=\"bottom\"\n                    delay={{ show: 500, hide: 0 }}\n                    overlay={\n                      !context.accountId ? (\n                        <Tooltip className=\"fixed bg-white shadow-lg border rounded-b-lg p-2 z-50\">\n                          <p className=\"text-sm text-nearblue-600\">\n                            Please sign in to your wallet\n                          </p>\n                        </Tooltip>\n                      ) : (\n                        <></>\n                      )\n                    }\n                  >\n                    <button\n                      type=\"submit\"\n                      disabled={!content}\n                      className={`inline-flex justify-center p-2 ${\n                        !content || !context.accountId\n                          ? 'text-neargray-600'\n                          : 'text-green-500'\n                      } rounded-full cursor-pointer hover:bg-neargray-800`}\n                    >\n                      <svg\n                        className=\"w-5 h-5 rotate-90 rtl:-rotate-90\"\n                        aria-hidden=\"true\"\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        fill=\"currentColor\"\n                        viewBox=\"0 0 18 20\"\n                      >\n                        <path d=\"m17.914 18.594-8-18a1 1 0 0 0-1.828 0l-8 18a1 1 0 0 0 1.157 1.376L8 18.281V9a1 1 0 0 1 2 0v9.281l6.758 1.689a1 1 0 0 0 1.156-1.376Z\" />\n                      </svg>\n                    </button>\n                  </OverlayTrigger>\n                </CommitButton>\n              ),\n            }}\n          />\n        )}\n      </div>\n      <ScrollArea.Root className=\"w-full rounded overflow-hidden bg-white dark:bg-black-600\">\n        <ScrollArea.Viewport className=\"w-full max-h-screen rounded\">\n          <div className=\"px-3 pb-2\">\n            {\n              <Widget\n                src={`${props.ownerId}/widget/bos-components.components.Comments.List`}\n                props={{\n                  index,\n                  renderItem,\n                  nextLimit: 10,\n                  loadMoreText: 'Show earlier comments...',\n                }}\n              />\n            }\n          </div>\n        </ScrollArea.Viewport>\n        <ScrollArea.Scrollbar\n          className=\"flex select-none touch-none p-0.5 bg-neargray-25 dark:bg-black-600 transition-colors duration-[160ms] ease-out hover:bg-neargray-25 dark:hover:bg-black-200 data-[orientation=vertical]:w-2.5 data-[orientation=horizontal]:flex-col data-[orientation=horizontal]:h-2.5\"\n          orientation=\"vertical\"\n        >\n          <ScrollArea.Thumb className=\"flex-1 bg-neargray-50 dark:bg-black-200 rounded-[10px] relative before:content-[''] before:absolute before:top-1/2 before:left-1/2 before:-translate-x-1/2 before:-translate-y-1/2 before:w-full before:h-full before:min-w-[44px] before:min-h-[44px]\" />\n        </ScrollArea.Scrollbar>\n        <ScrollArea.Scrollbar\n          className=\"flex select-none touch-none p-0.5 bg-neargray-25 dark:bg-black-600 transition-colors duration-[160ms] ease-out hover:bg-neargray-25 dark:hover:bg-black-200 data-[orientation=vertical]:w-2.5 data-[orientation=horizontal]:flex-col data-[orientation=horizontal]:h-2.5\"\n          orientation=\"horizontal\"\n        >\n          <ScrollArea.Thumb className=\"flex-1 bg-neargray-50 dark:bg-black-200 rounded-[10px] relative before:content-[''] before:absolute before:top-1/2 before:left-1/2 before:-translate-x-1/2 before:-translate-y-1/2 before:w-full before:h-full before:min-w-[44px] before:min-h-[44px]\" />\n        </ScrollArea.Scrollbar>\n        <ScrollArea.Corner className=\"bg-neargray-50\" />\n      </ScrollArea.Root>\n    </>\n  );\n}\n\nreturn MainComponent(props, context);", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearblocksonbos.near/widget/bos-components.components.Comments.Feed", "fact_widget_deployments_id": "40220332df2a3bb49c86cbc894a0f922", "inserted_timestamp": "2024-05-23T07:53:47.264Z", "modified_timestamp": "2024-05-23T07:53:47.264Z", "__row_index": 2}
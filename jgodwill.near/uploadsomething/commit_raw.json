{"tx_hash": "2tEtrr86rierttLD1AwQiP5VKZxcS5PNyHd2Agqi6UdB", "action_id_social": "5WmZ493zRgrDhhkWu3iZY5yLcJGDwR3otRTL72eVV5Rb-0-widget", "block_id": 118955268, "block_timestamp": "2024-05-15T07:06:24.294Z", "signer_id": "jgodwill.near", "widget_name": "uploadsomething", "source_code": "const [img, setImg] = useState(null);\nconst { UploadField } = VM.require(\"buildhub.near/widget/components\");\nconst [msg, setMsg] = useState(<UploadField />);\n\nconst uploadFile = (files) => {\n  setMsg(\"Uploading...\");\n\n  const file = files[0];\n\n  const uploadPromise = asyncFetch(\"https://ipfs.near.social/add\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": file.type, // Set content type based on file\n    },\n    body: file, // Assuming direct file upload is supported\n  })\n    .then((response) => {\n      if (!response.ok) {\n        setMsg(\"Upload failed!\");\n        return Promise.reject(new Error(\"Upload failed\")); // Reject with error message\n      }\n      return response.body;\n    })\n    .then((data) => {\n      setImg(data.cid);\n    })\n    .catch((error) => {\n      console.error(\"Upload error:\", error);\n      setMsg(\"Upload failed!\");\n    })\n    .finally(() => {\n      setMsg(<UploadField />);\n    });\n\n  // Handle the promise if needed (optional)\n  uploadPromise\n    .then(() => {\n      console.log(\"Upload successful!\");\n    })\n    .catch((error) => {\n      console.error(\"Upload failed:\", error);\n    });\n};\n\nreturn (\n  <>\n    <Files\n      multiple={false}\n      accepts={[\"image/*\"]}\n      clickable\n      className=\"\"\n      onChange={uploadFile}\n    >\n      {msg}\n    </Files>\n    {img ? (\n      <div>\n        <img src={`https://ipfs.near.social/ipfs/${img}`} />\n      </div>\n    ) : (\n      \"\"\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/jgodwill.near/widget/uploadsomething", "fact_widget_deployments_id": "12eb2ab2bafb34b6f0700c2cab1fce93", "inserted_timestamp": "2024-05-15T08:51:40.294Z", "modified_timestamp": "2024-05-15T08:51:40.294Z", "__row_index": 4}
{"tx_hash": "C1zCAWphvfa8E6gN6gcAsy3wm5dyA1V5cLZ1Ge8BEdtu", "action_id_social": "4y9Qhr76z9RDKhk9UpJ54cKwz4SEWyuKJwZLUPTZtcHQ-0-widget", "block_id": 104689900, "block_timestamp": "2023-11-01T13:33:31.428Z", "signer_id": "jgodwill.near", "widget_name": "CPlanet.MainPage.Social", "source_code": "const hashtag = props.hashtag;\n\nif (!state || state.hashtag !== hashtag) {\n  State.update({\n    feedIndex: hashtag ? 1 : context.accountId ? 0 : 1,\n    hashtag,\n  });\n}\n\nconst options = [\n  {\n    title: \"C Constellation\",\n  },\n  {\n    title: \"CDAOs Feed\",\n  },\n  {\n    title: \"DAOs You Follow\",\n    disabled: !context.accountId,\n  },\n];\n\nif (hashtag) {\n  options.push({\n    title: `#${hashtag}`,\n  });\n}\n\nlet accounts = undefined;\n\nconst getFollowedDAOs = (accountId) => {\n  let following = Social.keys(`${context.accountId}/graph/follow/*`, \"final\", {\n    return_type: \"BlockHeight\",\n  });\n\n  if (following === null) return null;\n\n  following = Object.keys(following[accountId].graph.follow || {}).filter(\n    (account) => account.endsWith(\".sputnik-dao.near\")\n  );\n  return following;\n};\n\nif (state.feedIndex === 2) {\n  const graph = Social.keys(`${context.accountId}/graph/follow/*`, \"final\");\n\n  const following = getFollowedDAOs(props.accountId ?? context.accountId ?? \"\");\n  if (graph !== null) {\n    // accounts = Object.keys(graph[context.accountId].graph.follow || {});\n    // accounts.push(context.accountId);\n    accounts = [...following];\n    console.log(accounts);\n  } else {\n    accounts = [];\n  }\n}\n\nif (state.feedIndex === 1) {\n  const response = fetch(\n    \"https://raw.githubusercontent.com/GenaDrop/genadrop-bos-widgets/main/data/cdao-daos.json\"\n  );\n  const daos = response.ok && JSON.parse(response.body);\n  accounts = [...daos.daos];\n  console.log(accounts);\n}\n\nconst CPlanetFont = styled.div`\n*, *::before, *::after{\n  font-family: Helvetica Neue;\n  box-sizing: border-box;\n}\n`;\n\nconst Nav = styled.div`\n  .nav-pills {\n    background: #fbfbfb;\n    font-weight: 500;\n    --bs-nav-pills-border-radius: 0;\n    --bs-nav-link-color: #B0B0B0;\n    --bs-nav-pills-link-active-color: #000;\n    --bs-nav-pills-link-active-bg: #fbfbfb;\n    --bs-nav-link-padding-y: 0.75rem;\n    border-bottom: 1px solid #eee;\n    padding-top: 3px;\n  }\n  .nav-link.active {\n    border-bottom: 3px solid #000;\n    font-weight: 600;\n  }\n\n  .nav-item:hover {\n    background: rgba(0, 0, 0, 0.15);\n    *{color: #000 !important;}\n  }\n\n  margin: 0 -12px;\n`;\n\nconst SocialWrapper = styled.div`\n    display: flex;\n    flex-direction:row;\n    gap: 2rem;\n    .rhs, .lhs{\n        width: 360px;\n        padding: 16px 24px 476px 24px; \n        border: 1px solid #EFEFEF;\n        background: #F8F8F8;\n    }\n    .mid{\n        flex: 1;\n    }\n`;\n\nreturn (\n  <CPlanetFont>\n    <SocialWrapper>\n      <div className=\"rhs\">\n        <Widget src=\"jgodwill.near/widget/People\" props={{}} />\n      </div>\n      <div className=\"mid\">\n        {context.accountId && (\n          <div className=\"mb-3\">\n            <Widget\n              src=\"jgodwill.near/widget/CPlanet.MainPage.Compose\"\n              props={{}}\n            />\n          </div>\n        )}\n        <Nav>\n          <ul className=\"nav nav-pills nav-fill mb-3\">\n            {options.map((option, i) => (\n              <li className=\"nav-item\" key={i}>\n                <button\n                  className={`nav-link ${\n                    state.feedIndex === i ? \"active\" : \"\"\n                  } ${option.disabled ? \"disabled\" : \"\"}`}\n                  aria-disabled={!!option.disabled}\n                  onClick={() =>\n                    !option.disabled && State.update({ feedIndex: i })\n                  }\n                >\n                  {option.title}\n                </button>\n              </li>\n            ))}\n          </ul>\n        </Nav>\n        {state.feedIndex === 3 ? (\n          <Widget src=\"mob.near/widget/Hashtag.Feed\" props={{ hashtag }} />\n        ) : (\n          <Widget\n            src=\"jgodwill.near/widget/CPlanet.MainPage.Feed\"\n            props={{ accounts }}\n          />\n        )}\n      </div>\n      <div className=\"lhs\"></div>\n    </SocialWrapper>\n  </CPlanetFont>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/jgodwill.near/widget/CPlanet.MainPage.Social", "fact_widget_deployments_id": "ecf241654fc645e6a900eada34e85d38", "inserted_timestamp": "2023-11-01T15:32:58.841Z", "modified_timestamp": "2023-11-01T15:32:58.841Z", "__row_index": 6}
{"tx_hash": "8e7GaFN5vbXdSuBcUeFq9AhARpE3x9KPVhVDCz5eurSA", "action_id_social": "FhUm8xc1YZ1SaW14qnUvqmkbF5sBtw7JpPyk7ZUe6J3q-0-widget", "block_id": 109574568, "block_timestamp": "2024-01-04T13:48:38.759Z", "signer_id": "jgodwill.near", "widget_name": "PageFeedsEditor", "source_code": "const pageFeedPattern = props.pageFeedPattern ?? \"*/profile/feed/*\";\nconst placeholder = props.placeholder ?? \"Feeds\";\nconst initialPageFeedsObject = props.initialPageFeedsObject || {};\nconst disabled = props.disabled;\n\nconst pageFeedsObject = Social.keys(pageFeedPattern, \"final\");\nconst pageFeedsArr = Social.keys(\"*/profile/*\", \"final\");\n\nif (pageFeedsObject === null || pageFeedsArr === null) {\n  return \"Loading\";\n}\n\n// console.log(\"feed\", pageFeedsObject);\n\n// State.init({\n//   account: accountId,\n// });\nconst accounts = Object.entries(pageFeedsArr);\n\nconst allWidgets = [];\n\nfor (let i = 0; i < accounts.length; ++i) {\n  const accountId = accounts[i][0];\n  allWidgets.push(accountId);\n}\n\n// const pageFeedsCount = {};\n\n// const processPageFeedObject = (obj) => {\n//   Object.entries(obj).forEach((kv) => {\n//     if (typeof kv[1] === \"object\") {\n//       processPageFeedObject(kv[1]);\n//     } else {\n//       pageFeedsCount[pageFeed] = (pageFeedsCount[pageFeed] || 0) + 1;\n//     }\n//   });\n// };\n\n// const getpageFeeds = () => {\n//   processPageFeedObject(pageFeedsObject);\n//   const pageFeeds = Object.entries(pageFeedsCount);\n//   pageFeeds.sort((a, b) => b[1] - a[1]);\n//   return pageFeeds.map((t) => ({\n//     name: t[0],\n//     count: t[1],\n//   }));\n// };\n\n// console.log(Object.keys(initialPageFeedsObject));\nif (!state.allPageFeeds) {\n  initState({\n    allPageFeeds: allWidgets,\n    pageFeeds: Object.keys(initialPageFeedsObject).map((pageFeed) => pageFeed),\n    originalPageFeeds: Object.fromEntries(\n      Object.keys(initialPageFeedsObject).map((pageFeed) => [pageFeed, null])\n    ),\n    id: `pageFeeds-selector-${Date.now()}`,\n  });\n  // console.log(\"we'renot here\", allPageFeeds);\n}\n\nconst setPageFeeds = (pageFeeds) => {\n  pageFeeds = pageFeeds.map((o) => {\n    o = o;\n    console.log(\"o\", o);\n    return o;\n  });\n  State.update({ pageFeeds: pageFeeds });\n\n  const newPageFeedsObject = Object.fromEntries(\n    pageFeeds.map((pageFeed) => [pageFeed, \"\"])\n  );\n  const updatedPageFeedsObject = {\n    ...state.originalPageFeeds,\n    ...newPageFeedsObject,\n  };\n\n  if (props.setPageFeedsObject) {\n    props.setPageFeedsObject(updatedPageFeedsObject);\n  }\n};\n\ndisabled && setPageFeeds([]);\n// console.log(\"init\", initialPageFeedsObject);\n// console.log(\"feeds\", state.pageFeeds);\n// console.log(\"origin\", state.originalPageFeeds);\n// console.log(\"new\", pageFeedsObject);\n\nreturn (\n  <>\n    <Typeahead\n      id={state.id}\n      disabled={disabled}\n      multiple\n      labelKey=\"name\"\n      onChange={setPageFeeds}\n      options={state.allPageFeeds}\n      placeholder={placeholder}\n      selected={state.pageFeeds}\n      positionFixed\n      allowNew\n    />\n    {props.debug && (\n      <div>\n        Debugging pageFeeds:\n        <pre>{JSON.stringify(state.pageFeeds)}</pre>\n      </div>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/jgodwill.near/widget/PageFeedsEditor", "fact_widget_deployments_id": "2902a3804a5df0867805738b015c7cbb", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
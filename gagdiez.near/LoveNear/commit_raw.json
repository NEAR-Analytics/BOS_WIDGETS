{"tx_hash": "Dqbf2fHS3edj81V8wGnPB3c3UAXJ4jfmiS1xUrnFaiY6", "action_id_social": "ABpcjxmFF7wjR1BrLshNmVTtWdE6s6g9WCyz9nBb8cdb-0-widget", "block_id": 105015214, "block_timestamp": "2023-11-05T18:54:33.673Z", "signer_id": "gagdiez.near", "widget_name": "LoveNear", "source_code": "if (context.loading) return \"Loading ...\";\n\nconst elementToLike = \"I<3Near\";\nconst [hasLike, setHasLike] = useState(false);\nconst [totalLikes, setTotalLikes] = useState(0);\n\nconst likes = Social.index(\"like\", elementToLike, { subscribe: true });\nconst userLike = context.accountId\n  ? Social.index(\"like\", elementToLike, {\n      accountId: context.accountId,\n      subscribe: true,\n    })\n  : [];\n\nlet dataLoading = likes === null || userLike === null;\n\nuseEffect(() => {\n  likes && setTotalLikes(likes.length);\n}, [likes]);\n\nuseEffect(() => {\n  userLike && setHasLike(userLike.length > 0);\n}, [userLike]);\n\nconst LikeButton = styled.button`\n  border: 0;\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  color: #687076;\n  font-weight: 400;\n  font-size: 3rem;\n  line-height: 17px;\n  cursor: pointer;\n  background: none;\n  padding: 6px;\n  transition: color 200ms;\n\n  i {\n    font-size: 3rem;\n    transition: color 200ms;\n\n    &.bi-heart-fill {\n      color: #E5484D !important;\n    }\n  }\n`;\n\nconst Main = styled.div`\n  font-family: -apple-system, BlinkMacSystemFont, Segoe UI\n`;\n\nconst likeClick = () => {\n  const data = {\n    index: {\n      like: JSON.stringify({\n        key: elementToLike,\n        value: \"liked\",\n      }),\n    },\n  };\n\n  Social.set(data, {\n    onCommit: () => {\n      setHasLike(true);\n      setTotalLikes(totalLikes + 1);\n    },\n    onCancel: () => {},\n  });\n};\n\nconst loggedIn = (\n  <>\n    You're gonna <span class=\"text-danger\">like it</span> here\n  </>\n);\nconst loggedOut = (\n  <>\n    Login to show some <span className=\"text-danger\">love</span>\n  </>\n);\n\nreturn (\n  <Main>\n    <div className=\"text-center\">\n      <h3 className=\"font-weight-bold\"> Welcome to Near </h3>\n\n      <div className=\"container py-3 text-dark bg-light rounded-3\">\n        <p className=\"small font-weight-light\">\n          {context.accountId ? loggedIn : loggedOut}\n        </p>\n\n        <LikeButton onClick={likeClick}>\n          <i className={`${hasLike ? \"bi-heart-fill\" : \"bi-heart\"}`} />\n          {totalLikes}\n        </LikeButton>\n      </div>\n    </div>\n  </Main>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/gagdiez.near/widget/LoveNear", "fact_widget_deployments_id": "6eeba19b518e0a7d2a4fdbdf68306c9c", "inserted_timestamp": "2023-11-05T20:44:14.585Z", "modified_timestamp": "2023-11-05T20:44:14.585Z", "__row_index": 4}
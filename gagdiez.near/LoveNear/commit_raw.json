{"tx_hash": "61wyjf9GRZ46C4zWsunKyMyNr3moG1sAPhoBxLb1z8pu", "action_id_social": "BTtMDJcMbwUbJ2vkudoeYaBuRTrarBpDDQLKvjQTLbcT-0-widget", "block_id": 105013914, "block_timestamp": "2023-11-05T18:31:38.247Z", "signer_id": "gagdiez.near", "widget_name": "LoveNear", "source_code": "if (context.loading) return \"Loading ...\";\n\nconst elementToLike = \"I<3Near\";\nconst [hasLike, setHasLike] = useState(false);\nconst [totalLikes, setTotalLikes] = useState(0);\n\nconst likes = Social.index(\"like\", elementToLike, { subscribe: true });\nconst userLike = context.accountId\n  ? Social.index(\"like\", elementToLike, {\n      accountId: context.accountId,\n      subscribe: true,\n    })\n  : [];\n\nlet dataLoading = likes === null || userLike === null;\n\nuseEffect(() => {\n  likes && setTotalLikes(likes.length);\n}, [likes]);\n\nuseEffect(() => {\n  userLike && setHasLike(userLike.length > 0);\n}, [userLike]);\n\nconst LikeButton = styled.button`\n  border: 0;\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  color: #687076;\n  font-weight: 400;\n  font-size: 3rem;\n  line-height: 17px;\n  cursor: pointer;\n  background: none;\n  padding: 6px;\n  transition: color 200ms;\n\n  i {\n    font-size: 3rem;\n    transition: color 200ms;\n\n    &.bi-heart-fill {\n      color: #E5484D !important;\n    }\n  }\n`;\n\nconst Main = styled.div`\n  font-family: -apple-system, BlinkMacSystemFont, Segoe UI\n`;\n\nconst likeClick = () => {\n  const data = {\n    index: {\n      like: JSON.stringify({\n        key: elementToLike,\n        value: \"liked\",\n      }),\n    },\n  };\n\n  Social.set(data, {\n    onCommit: () => {\n      setHasLike(true);\n      setTotalLikes(totalLikes + 1);\n    },\n    onCancel: () => {},\n  });\n};\n\nreturn (\n  <Main>\n    <div class=\"text-center\">\n      <h3 class=\"font-weight-bold\"> Welcome to Near </h3>\n\n      <div class=\"container py-3 text-dark bg-light rounded-3\">\n        <p class=\"small font-weight-light\">\n          You're gonna\n          <span class=\"text-danger\">like it</span>\n          here\n        </p>\n\n        <LikeButton\n          disabled={context.loading || dataLoading || !context.accountId}\n          onClick={likeClick}\n        >\n          <i className={`${hasLike ? \"bi-heart-fill\" : \"bi-heart\"}`} />\n          {totalLikes}\n        </LikeButton>\n      </div>\n    </div>\n  </Main>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/gagdiez.near/widget/LoveNear", "fact_widget_deployments_id": "997a0a91b1f073d3e4778b57930125ee", "inserted_timestamp": "2023-11-05T20:29:58.272Z", "modified_timestamp": "2023-11-05T20:29:58.272Z", "__row_index": 3}
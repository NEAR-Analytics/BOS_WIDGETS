{"tx_hash": "HZpEcigmYSYVDVSY1i4w9xevrZBgjpGWb8rJDgueQG7x", "action_id_social": "83Rg8Aseq4wqiSQM6e9SCSsFypSQwHxL21gcbwb5Mukq-0-widget", "block_id": 95316166, "block_timestamp": "2023-06-29T16:41:50.124Z", "signer_id": "jay100.near", "widget_name": "PlayerDashboard", "source_code": "const PlayerDashboard = async () => {\r\n  let playerData = Near.view(\"pixeltoken.near\", \"ctt_get_player_data\", {\r\n    account_id: context.accountId,\r\n  });\r\n  let units_ids = playerData.playerdata.unit_ids.map((id) => {\r\n    return id;\r\n  });\r\n  let units_data = Near.view(\"pixeltoken.near\", \"ctt_get_units_by_ids\", {\r\n    token_ids: units_ids,\r\n  });\r\n  const code = `\r\n\r\n<head>\r\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css\" integrity=\"sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65\" crossorigin=\"anonymous\">\r\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js\" integrity=\"sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V\" crossorigin=\"anonymous\"></script>\r\n    <script src=\"https://code.jquery.com/jquery-3.7.0.slim.min.js\" integrity=\"sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE=\" crossorigin=\"anonymous\"></script>\r\n</head>\r\n<style>\r\n    @import url('https://fonts.googleapis.com/css?family=Press+Start+2P');\r\n\r\n    body {\r\n        padding: 5px;\r\n        background: rgb(14, 14, 30);\r\n        font-family: \"Pixel Emulator\", \"Press Start 2P\", Courier new, monospace;\r\n        color: #f8f8f8;\r\n        text-shadow: 2px 0 0 #000, 0 2px 0 #000;\r\n    }\r\n\r\n    .troop-details {\r\n        display: flex;\r\n        flex-direction: column;\r\n        padding: 5px;\r\n        width: 300px;\r\n        height: 200px;\r\n        margin: 2rem 0 2rem 0;\r\n    }\r\n\r\n    .troop-details-list {\r\n        padding: 0.2rem;\r\n    }\r\n\r\n    .troop-details ul.troop-details-list li.troop-details-item {\r\n        list-style: square inside url(\"data:image/gif;base64,R0lGODlhEAAQAJEAAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAIOlI+py+0Po5y02ouzPgUAOw==\");\r\n        font-size: .8rem;\r\n        padding: .2rem;\r\n    }\r\n\r\n    .troop-details ul.troop-details-list li.troop-details-item.selected {\r\n        list-style-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAFo9M/3AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNmlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjarY6xSsNQFEDPi6LiUCsEcXB4kygotupgxqQtRRCs1SHJ1qShSmkSXl7VfoSjWwcXd7/AyVFwUPwC/0Bx6uAQIYODCJ7p3MPlcsGo2HWnYZRhEGvVbjrS9Xw5+8QMUwDQCbPUbrUOAOIkjvjB5ysC4HnTrjsN/sZ8mCoNTIDtbpSFICpA/0KnGsQYMIN+qkHcAaY6addAPAClXu4vQCnI/Q0oKdfzQXwAZs/1fDDmADPIfQUwdXSpAWpJOlJnvVMtq5ZlSbubBJE8HmU6GmRyPw4TlSaqo6MukP8HwGK+2G46cq1qWXvr/DOu58vc3o8QgFh6LFpBOFTn3yqMnd/n4sZ4GQ5vYXpStN0ruNmAheuirVahvAX34y/Axk/96FpPYgAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAAF2/XWh+QAAABoUlEQVR42mJg2MHAICGh8Z9BQkLj/4IDB/4DAAAA//9iZNjBwMDAwMDAtIDjwH8GBgYGAAAAAP//YpCQ0Pj/4ccPOGZk2MHAIJGgAZFlYGAAAAAA//9igJuyg4GBYQcDA4qWihkz/jNWzJjxX0NDg+HGjRsMHQoZjHAtMG0AAAAA//+C21vxAKKyIiIDbvyLBTcYmSQSNP4v4DjwX0NDg4GBgYGhY8UMBmTAwsDAwFARkcGQ0FCAIvFiwQ1GBgYGBkYJCWQ3YwIAAAAA//+CuwHmOZhODI/C/FUxY8Z/FF9UzJjxn4GBgaEiIQHDeA0FAwbGDz9+/N9w4gRc8MaNGwwLGiYgvLnhxAmGGzduYOiGuYUFJomsCNmhWKKHATMk8YUDQAzweNyB8PKCAwdQohQlvtEw3AkvFtxglEjQ+N+xYgZDgIUF3HzkEEAGFREZDC8W3GBkkUjQ+H/jwQWGjgUL/mus0MBQGGBhwYArpOCJAR1gsxWW1OAhuAAaihISGv/RUxI2sKBhApZ0giUMsBmGSzNRyZUQwEjOuBIELjnAADXE07fDV16dAAAAAElFTkSuQmCC\");\r\n    }\r\n\r\n    .troop-details.ff {\r\n        background-color: #282880;\r\n        box-shadow: 0 0 0 1px #c8e0e0, 0 0 0 2px #808080, 0 0 0 3px #283030, inset 0 0 0 1px #303088;\r\n        border-radius: 5px;\r\n        height: 100%;\r\n    }\r\n\r\n    .troopdata {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-around;\r\n    }\r\n</style>\r\n\r\n<body>\r\n    <div id=\"balance\">\r\n    </div>\r\n    <div id=\"troopdata\" class=\"troopdata container-fluid row\">\r\n    </div>\r\n</body>\r\n<script>\r\n    window.addEventListener(\"message\", (event) => {\r\n        const data = event.data.data;\r\n        const balances = data[0].balance;\r\n        const troops = data[1];\r\n        const playerId = data[2];\r\n        const pixeltokens = $(\"<p></p>\").text(\"PixelTokens:\");\r\n        const tokens = $(\"<p></p>\").text(\"Units:\");\r\n        const player = $(\"<p></p>\").text(\"Player:\");\r\n        pixeltokens.append(balances.pixeltoken);\r\n        tokens.append(balances.tokens);\r\n        player.append(playerId);\r\n        $(\"#balance\").append(player, pixeltokens, tokens);\r\n        troops.map((troop) => {\r\n            const meta_data = troop.metadata;\r\n            const dataContainer = $(\"<div></div>\").addClass(\"troop-details ff\");\r\n            const dataList = $(\"<ul></ul>\").addClass(\"troop-details-list\");\r\n            const troopDetails = {\r\n                name: meta_data.title.split(\"|\")[0].split(\"-\")[1].trim(),\r\n                power: meta_data.title.split(\"|\")[1].trim()\r\n            }\r\n            const troopid = $(\"<li></li>\").text(\"ID: \").append(troop.token_id).addClass(\"troop-details-item\");\r\n            const unit_type = $(\"<li></li>\").text(\"Type: \").append(troop.unit_type).addClass(\"troop-details-item\");\r\n            const health_mod = $(\"<li></li>\").text(\"Health Mod: \").append(troop.health_mod).addClass(\"troop-details-item\");\r\n            const damage_mod = $(\"<li></li>\").text(\"Damage Mod: \").append(troop.damage_mod).addClass(\"troop-details-item\");\r\n            const speed_mod = $(\"<li></li>\").text(\"Speed Mod: \").append(troop.speed_mod).addClass(\"troop-details-item\");\r\n            const price = $(\"<li></li>\").text(\"Price: \").append(troop.price).addClass(\"troop-details-item\");\r\n            const title = $(\"<li></li>\").text(\"Class: \").append(troopDetails.name).addClass(\"troop-details-item\");\r\n            const power = $(\"<li></li>\").text(troopDetails.power).addClass(\"troop-details-item\");\r\n            // const image = $(\"<img />\").attr(\"src\", meta_data.media);\r\n            dataList.append(troopid, unit_type, health_mod, damage_mod, speed_mod, price, title, power);\r\n            dataContainer.append(dataList);\r\n            $(\"#troopdata\").append(dataContainer);\r\n        })\r\n    });\r\n</script> `;\r\n  return (\r\n    <div>\r\n      <div style={{ backgroundColor: \"white\" }} className=\"d-flex\">\r\n        <iframe\r\n          style={{ height: \"70vh\", width: \"100%\" }}\r\n          srcDoc={code}\r\n          message={{\r\n            data:\r\n              [playerData, units_data, context.accountId] || \"No Player Data\",\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nreturn (\r\n  <>\r\n    <PlayerDashboard />\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/jay100.near/widget/PlayerDashboard", "fact_widget_deployments_id": "376896e5cad3b204a31c97f621b4bbe8", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 4}
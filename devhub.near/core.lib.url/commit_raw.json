{"tx_hash": "GsmbY925VV8HAiKEVZvLetjtsJknXGDCfp39uavGgKxC", "action_id_social": "6vsLw9C1JuT2hVhkxAWP3GSu6YxfCroK44UYieQoDNYp-0-widget", "block_id": 120933232, "block_timestamp": "2024-06-11T13:47:58.964Z", "signer_id": "devhub.near", "widget_name": "core.lib.url", "source_code": "/**\n * Generates a URL to a widget.\n *\n * @param {Object} options - Configuration options for constructing the URL.\n * @param {string} [options.gateway] - The gateway or server address where the widget source is hosted (optional).\n * @param {string} options.widgetSrc - The source path of the widget (required).\n * @param {Object} [options.params] - An object containing key-value pairs representing query parameters to be appended to the URL (optional).\n * @returns {string} - The constructed URL.\n */\nfunction href({ gateway, widgetSrc, params }) {\n  // Check if query parameters are provided and filter out null values\n  if (params) {\n    params = (Object.entries(params) || [])\n      .filter(([_key, nullable]) => (nullable ?? null) !== null)\n      .map(([key, value]) => {\n        // Omit the parameter if the value is null or the array is empty\n        if (value === null || (Array.isArray(value) && value.length === 0)) {\n          return null;\n        }\n\n        // Convert array values to a comma-separated string with no spaces\n        if (Array.isArray(value)) {\n          return `${key}=${value.join(\",\")}`;\n        } else {\n          return `${key}=${value}`;\n        }\n      })\n      .join(\"&\");\n  }\n\n  // Check if the gateway already includes \"https://\" and construct the final URL accordingly\n  if (gateway) {\n    if (/(^https:\\/\\/)|(^http:\\/\\/)/.test(gateway)) {\n      return `/${gateway}/${widgetSrc}${params && `?${params}`}`;\n    } else {\n      return `https://${gateway}/${widgetSrc}${params && `?${params}`}`;\n    }\n  } else {\n    return `/${widgetSrc}${params && `?${params}`}`;\n  }\n}\n\nfunction getLinkUsingCurrentGateway(url) {\n  const data = fetch(`https://httpbin.org/headers`);\n  const gatewayURL = data?.body?.headers?.Origin ?? \"\";\n  return `https://${\n    gatewayURL.includes(\"near.org\") ? \"near.org\" : \"near.social\"\n  }/${url}`;\n}\n\nreturn { href, getLinkUsingCurrentGateway };\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/devhub.near/widget/core.lib.url", "fact_widget_deployments_id": "fbdf2b4a433e58b127cf3091eee82c8d", "inserted_timestamp": "2024-06-11T15:05:48.085Z", "modified_timestamp": "2024-06-11T15:05:48.085Z", "__row_index": 6}
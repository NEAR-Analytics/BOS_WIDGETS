{"tx_hash": "EaZnr1RnSAYp14BKhMjR73dPAeUbV6wfP7CUKDNUp4Dn", "action_id_social": "Hz3aKLrVmTHM7Qzv7K72oBC84x3Wti7Df6a1b4MjJni3-0-widget", "block_id": 125326215, "block_timestamp": "2024-08-08T19:10:36.713Z", "signer_id": "dev-queryapi.dataplatform.near", "widget_name": "QueryApi.Editor", "source_code": "const path = props.path || \"query-api-editor\";\nconst tab = props.tab || \"\";\nconst activeView = props.activeView || \"editor\";\nlet accountId = props.accountId || context.accountId;\nlet externalAppUrl = `https://queryapi-frontend-vcqilefdcq-ew.a.run.app/${path}?accountId=${accountId}`;\n\nconst { wizardContractFilter, wizardMethods, wizardEvents } = props;\n\nif (props.indexerName) {\n  externalAppUrl += `&indexerName=${props.indexerName}`;\n}\nconst initialViewHeight = 1000;\n\nconst initialPayload = {\n  height: Near.block(\"optimistic\").header.height,\n  selectedTab: tab,\n  activeView,\n  currentUserAccountId: context.accountId,\n};\n\nconst registerFunctionHandler = (request, response) => {\n  const gas = 200000000000000;\n  const { indexerName, code, schema, startBlock, contractFilter, forkedFrom } =\n    request.payload;\n\n  const jsonFilter = `{\"indexer_rule_kind\":\"Action\",\"matching_rule\":{\"rule\":\"ACTION_ANY\",\"affected_account_id\":\"${contractFilter || \"social.near\"}\",\"status\":\"SUCCESS\"}}`\n\n  Near.call(\n    `dev-queryapi.dataplatform.near`,\n    \"register\",\n    {\n      function_name: indexerName,\n      code,\n      schema,\n      start_block: startBlock,\n      rule: {\n        kind: \"ACTION_ANY\",\n        affected_account_id: contractFilter,\n        status: \"SUCCESS\"\n      },\n      ...(forkedFrom && { forked_from: forkedFrom }),\n    },\n    gas\n  );\n};\n\nlet deleteIndexer = (request) => {\n  const { indexerName } = request.payload;\n  const gas = 200000000000000;\n  Near.call(\n    `dev-queryapi.dataplatform.near`,\n    \"remove_indexer_function\",\n    {\n      function_name: indexerName,\n    },\n    gas\n  );\n};\n\nconst getLaunchpadCode = (request, response) => {\n  const wizardContractFilter = wizardContractFilter ?? 'noFilter';\n  const wizardMethods = wizardMethods;\n  const wizardEvents = wizardEvents;\n  response(request).send({ wizardContractFilter, wizardMethods, wizardEvents });\n}\n\n/**\n * Request Handlers here\n */\nconst requestHandler = (request, response) => {\n  switch (request.type) {\n    case \"register-function\":\n      registerFunctionHandler(request, response);\n      break;\n    case \"delete-indexer\":\n      deleteIndexer(request, response);\n      break;\n    case \"launchpad-create-indexer\":\n      getLaunchpadCode(request, response);\n      break\n    case \"default\":\n      console.log(\"default case\");\n  }\n};\n\n// NearSocialBridgeCore widget is the core that makes all the \"magic\" happens\nreturn (\n  <Widget\n    src={\"wendersonpires.near/widget/NearSocialBridgeCore\"}\n    props={{\n      externalAppUrl,\n      path,\n      initialViewHeight,\n      initialPayload,\n      requestHandler,\n    }}\n  />\n);\n", "metadata": {"description": "Helper widget for QueryApi.Dashboard. Loads QueryAPI's React App which allows you to edit indexers inside the browser", "image": {}, "name": "Editor", "tags": {"data-platform": "", "indexers": "", "react": ""}}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/dev-queryapi.dataplatform.near/widget/QueryApi.Editor", "fact_widget_deployments_id": "988e3561eb2d02c03d1edbe7ad9ee2e3", "inserted_timestamp": "2024-08-08T20:56:45.645Z", "modified_timestamp": "2024-08-08T20:56:45.645Z", "__row_index": 16}
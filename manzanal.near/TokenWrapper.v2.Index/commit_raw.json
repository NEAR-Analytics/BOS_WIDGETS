{"tx_hash": "Es3qwCqaTN8v1BrDd9ABaeij9V644Los9qMkpkKDtNWC", "action_id_social": "CexsvtQLZ7AwGesyU8ubJ8Jbz7fnfiQata2j1sHf75QC-0-widget", "block_id": 96867473, "block_timestamp": "2023-07-19T22:00:40.916Z", "signer_id": "manzanal.near", "widget_name": "TokenWrapper.v2.Index", "source_code": "const authorId = \"manzanal.near\";\nconst NETWORK_NEAR = \"NEAR\";\nconst NETWORK_ETH = \"ETH\";\nconst NETWORK_POLYGON = \"POLYGON\";\nconst ETH_CHAINID = 1;\nconst POLYGON_CHAINID = 137;\nState.init({\n  network: null,\n  networkIsLoaded: false,\n  error: null,\n  sender: null,\n});\n\nconst getEVMAccountId = () => {\n  if (ethers !== undefined) {\n    return Ethers.send(\"eth_requestAccounts\", [])[0] ?? \"\";\n  }\n  return \"\";\n};\n\nif (state.sender === undefined) {\n  return State.update({\n    sender: getEVMAccountId(),\n  });\n}\n\nconsole.log(\"ethers\", ethers);\nif (!state.networkIsLoaded) {\n  if (state.sender) {\n    console.log(\"ethers is loading network\");\n    Ethers.provider()\n      .getNetwork()\n      .then((chainIdData) => {\n        console.log(\"chainId\", chainIdData.chainId);\n        if (chainIdData.chainId === ETH_CHAINID) {\n          // ETH\n          State.update({\n            network: NETWORK_ETH,\n            networkIsLoaded: true,\n            error: null,\n          });\n        } else if (chainIdData.chainId === POLYGON_CHAINID) {\n          // POLYGON\n          State.update({\n            network: NETWORK_POLYGON,\n            networkIsLoaded: true,\n            error: null,\n          });\n        } else {\n          State.update({\n            network: null,\n            networkIsLoaded: true,\n            error: \"Wrong network. Please connect to Ethereum mainnet\",\n          });\n        }\n      });\n  } else {\n    // ethers not supported on this gateway\n    State.update({ network: NETWORK_NEAR, networkIsLoaded: true, error: null });\n  }\n}\n\nconsole.log(\"NETWORK\", state.network);\nif (!state.networkIsLoaded) return <>Loading</>;\nif (state.error) return <>{state.error}</>;\nconst getContent = {\n  NEAR: (\n    <Widget src={`${authorId}/widget/TokenWrapper.v2.NearWrapper`} props={{}} />\n  ),\n  ETH: (\n    <Widget\n      src={`${authorId}/widget/TokenWrapper.v2.EthWrapper`}\n      props={{ sender: state.sender }}\n    />\n  ),\n  POLYGON: (\n    <Widget\n      src={`${authorId}/widget/TokenWrapper.v2.MaticWrapper`}\n      props={{}}\n    />\n  ),\n}[state.network];\n\nconst Container = styled.div`\n  width: 100%;\n\n  * {\n    margin: 0;\n  }\n`;\nreturn <Container>{getContent}</Container>;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/manzanal.near/widget/TokenWrapper.v2.Index", "fact_widget_deployments_id": "785408de720d708405a250a7f8a22ed3", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 7}
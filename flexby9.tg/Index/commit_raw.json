{"tx_hash": "qtxbsbUQe14yAJBZpoQvQTJVntCkatmFfPV1MZchoSF", "action_id_social": "2HzftEAoLZKuXdWs5sCsyPkDekHYqp2vJbh9TXbjrTKD-0-widget", "block_id": 116739738, "block_timestamp": "2024-04-13T06:28:22.579Z", "signer_id": "flexby9.tg", "widget_name": "Index", "source_code": "const owner = \"nearcatalog.near\";\nconst componentPath = `${owner}/widget/NearCatalog`;\nconst indexer = \"https://nearcatalog.xyz/wp-json/nearcatalog/v1\";\nconst defaultImg =\n  \"https://learnnear.club/wp-content/uploads/2021/09/lnc-profile-desktop-150x150.png\";\n\nconst projects = {};\nlet router = \"home\";\nconst query = \"\";\n\nlet widgetSrc = \"\";\nlet widgetProps = {};\n\nif (props?.bookmark) {\n  router = \"bookmark\";\n} else if (props?.cat.length > 0) {\n  router = \"category\";\n} else if (props?.id) {\n  router = \"project\";\n}\n\nfunction loadingScreen() {\n  return <>\ud83d\udc40\ud83d\udcd7~~</>;\n}\n\nconsole.log(\"router: \", router);\n\nconsole.log(\n  \"bookmarks: \",\n  (projects = Storage.get(\"nearcatalogBookmark\", componentPath + \".Project\"))\n);\n\nswitch (router) {\n  case \"project\":\n    query = fetch(indexer + \"/project?pid=\" + props.id);\n    if (!query || !query.body) {\n      return loadingScreen();\n    }\n    widgetSrc = `${componentPath}.Project`;\n    widgetProps = {\n      id: props.id,\n      project: query.body,\n    };\n    break;\n\n  case \"category\":\n    query = fetch(indexer + \"/projects-by-category?cid=\" + props.cat);\n    projects = query.body;\n    if (!query) {\n      return loadingScreen();\n    }\n    widgetSrc = `${componentPath}.Layout.AppGrid`;\n    widgetProps = {\n      cat: props.cat,\n    };\n    break;\n\n  case \"bookmark\":\n    widgetSrc = `${componentPath}.Layout.AppGrid`;\n    widgetProps = {\n      bookmark: true,\n    };\n    projects = Storage.get(\"nearcatalogBookmark\", componentPath + \".Project\");\n    break;\n\n  default:\n    //home router\n    query = fetch(indexer + \"/projects\");\n    if (!query || !query.body) {\n      return loadingScreen();\n    }\n    projects = query.body;\n    widgetSrc = `${componentPath}.Layout.AppGrid`;\n    break;\n}\n\nlet p = {\n  ...{\n    componentPath,\n    indexPath: owner + \"/widget/Index\",\n    owner,\n    indexer,\n    projects,\n    defaultImg,\n    router,\n  },\n  ...widgetProps,\n};\nconsole.log(\"final props\", p);\nreturn (\n  <div key={router}>\n    <Widget src={widgetSrc} props={p} />\n  </div>\n);\n", "metadata": {"fork_of": "nearcatalog.near/widget/Index@113970922"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/flexby9.tg/widget/Index", "fact_widget_deployments_id": "bd150cd337a5e15699f878f00b32e20b", "inserted_timestamp": "2024-04-13T07:37:42.153Z", "modified_timestamp": "2024-04-13T08:34:47.543Z", "__row_index": 270}
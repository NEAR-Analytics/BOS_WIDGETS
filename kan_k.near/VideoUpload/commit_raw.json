{"tx_hash": "HDW9s59WwQ1Y3Qi1JDAcXxo78hg8b1cszJEe3iM37GeV", "action_id_social": "A9JapBE1k8SCEUp8RgNMXMys6DWFZb8n9q5R8UCddPKw-0-widget", "block_id": 108256941, "block_timestamp": "2023-12-18T14:31:06.840Z", "signer_id": "kan_k.near", "widget_name": "VideoUpload", "source_code": "const accountId = props.accountId ?? context.accountId;\nconst vdoUrl = props.vdoUrl\n  ? props.vdoUrl\n  : \"https://firebasestorage.googleapis.com/v0/b/component-dev-lab.appspot.com/o/uploads%2F1702888364122-CAMT%2020th%203%20Generations.mp4?alt=media&token=9f29b9a6-00ef-43c5-89e5-1dc2e0127bdb\";\n\nState.init({\n  id: \"\",\n  timestamp: Date.now(),\n  title: \"\",\n  description: \"\",\n  owner: accountId,\n  src: vdoUrl,\n  thumbnail: \"https://ipfs.near.social/ipfs/\",\n  tag: \"\",\n  parentVdoId: props.parentVdoId || \"\",\n});\n\nconst onTimestampChange = ({ target }) => {\n  State.update({ timestamp: target.value });\n};\n\nconst onTitleChange = ({ target }) => {\n  State.update({ title: target.value });\n};\n\nconst onDescriptionChange = ({ target }) => {\n  State.update({ description: target.value });\n};\n\nconst onOwnerChange = ({ target }) => {\n  State.update({ owner: target.value });\n};\n\nconst onSrcChange = ({ target }) => {\n  State.update({ src: target.value });\n};\n\nconst onThumbnailChange = ({ target }) => {\n  State.update({ thumbnail: target.value });\n};\n\nconst onTagChange = ({ target }) => {\n  State.update({ tag: target.value });\n};\n\nconst checkWallet = () => {\n  try {\n    const operationChainId = 25925;\n    Ethers.provider()\n      .getNetwork()\n      .then((chainIdData) => {\n        const chainId = chainIdData.chainId;\n        if (chainId !== operationChainId) {\n          const res = Ethers.send(\"wallet_switchEthereumChain\", [\n            { chainId: `0x${Number(operationChainId).toString(16)}` },\n          ]);\n\n          if (res === null) {\n            Ethers.send(\"wallet_addEthereumChain\", [\n              {\n                chainId: `0x${Number(operationChainId).toString(16)}`,\n                chainName: \"Bitkub Chain - Testnet\",\n                nativeCurrency: {\n                  name: \"tKUB\",\n                  symbol: \"tKUB\",\n                  decimals: 18,\n                },\n                rpcUrls: [\"https://rpc-testnet.bitkubchain.io\"],\n                blockExplorerUrls: [\"https://testnet.bkcscan.com \"],\n              },\n            ]);\n          }\n        } else {\n          console.log(\"OK on chain\");\n        }\n      });\n  } catch (e) {\n    console.log(\"No wallet provider\");\n  }\n};\n\ncheckWallet();\n\nconst abi = fetch(\n  `https://eth.blockscout.com/api?module=contract&action=getabi&address=0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2`\n);\n\nif (!abi.ok) {\n  return \"Loading\";\n}\n\n// console.log(abi.body.result);\n\nconst onBtnClick = async () => {\n  const body = {\n    timestamp: Date.now(),\n    title: state.title,\n    description: state.description,\n    owner: state.owner,\n    src: vdoUrl,\n    thumbnail: `https://ipfs.near.social/ipfs/${state.thumbnail.cid}`,\n    tag: state.tag,\n    parentVdoId: state.parentVdoId,\n  };\n\n  console.log(body);\n\n  const CONTRACT_ADDRESS = \"0xFEfa855e3CeAcD2eFCdE30d062ca7b83D6F614c9\";\n  const signer = Ethers.provider().getSigner();\n  const contract = new ethers.Contract(\n    CONTRACT_ADDRESS,\n    abi.body.result,\n    signer\n  );\n  contract.addVideo(body.title, body.description, body.src, body.thumbnail, 0, [\n    body.tag,\n  ]);\n};\n\nreturn (\n  <div className=\"m-10 VStack Subtitle  w-1/3 gap-10\">\n    <div className=\"VStack justify-between h-full\">\n      <div className=\"VStack gap-4\"></div>\n      <div className=\"VStack gap-2\">\n        <p className=\" text-md\">Title</p>\n        <input\n          type=\"text\"\n          name=\"\"\n          id=\"\"\n          placeholder=\"title\"\n          onChange={onTitleChange}\n          className=\"p-2 rounded-md System-background-blue\"\n        />\n        <div className=\"VStack gap-2\">\n          <p className=\" text-md\">Description</p>\n          <textarea\n            name=\"\"\n            id=\"\"\n            cols={30}\n            rows={7}\n            onChange={onDescriptionChange}\n            className=\"p-2 rounded-md System-background-blue\"\n            placeholder=\"lorem10\"\n          ></textarea>\n        </div>\n\n        <p className=\" text-md\">Tag</p>\n        <input\n          type=\"text\"\n          name=\"\"\n          id=\"\"\n          onChange={onTagChange}\n          placeholder=\"tag\"\n          className=\"p-2 rounded-md System-background-blue\"\n        />\n      </div>\n\n      <div className=\"mt-2 mb-3\">\n        <p className=\" text-md\">Thumbnail</p>\n        <IpfsImageUpload\n          image={state.thumbnail}\n          className=\"Button-primary rounded-md\"\n        />\n      </div>\n    </div>\n    <div className=\"w-fullitems-end text-right mt-6\">\n      {\" \"}\n      <button className=\"p-2 Button-primary rounded-md \" onClick={onBtnClick}>\n        Publish\n      </button>\n    </div>\n  </div>\n);\n", "metadata": {"fork_of": "kan_k.near/widget/VideoUpload@108256729"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/kan_k.near/widget/VideoUpload", "fact_widget_deployments_id": "c653498682f40bc2e39497dd209a4927", "inserted_timestamp": "2023-12-18T16:54:40.747Z", "modified_timestamp": "2023-12-20T03:22:11.422Z", "__row_index": 6}
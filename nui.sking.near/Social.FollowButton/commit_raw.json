{"tx_hash": "FVrxLgGweqftHJa5aZAUhX3LahVXcVNwDcjJCM1iv27u", "action_id_social": "Ec2oJTEs27ZXcRBqSKHYeRSPfT1HMwpYWnBcvtpKhAWK-0-widget", "block_id": 97171527, "block_timestamp": "2023-07-23T20:49:43.646Z", "signer_id": "nui.sking.near", "widget_name": "Social.FollowButton", "source_code": "if (\n  !props.accountId ||\n  !context.accountId ||\n  context.accountId === props.accountId\n) {\n  return \"\";\n}\n\nState.init({\n  loading: false,\n});\n\nconst followEdge = Social.keys(\n  `${context.accountId}/graph/follow/${props.accountId}`,\n  undefined,\n  {\n    values_only: true,\n  }\n);\n\nconst inverseEdge = Social.keys(\n  `${props.accountId}/graph/follow/${context.accountId}`,\n  undefined,\n  {\n    values_only: true,\n  }\n);\n\nconst loading = followEdge === null || inverseEdge === null;\nconst isFollowing = Object.keys(followEdge || {}).length > 0;\nconst isInverse = Object.keys(inverseEdge || {}).length > 0;\n\nconst type = follow ? \"unfollow\" : \"follow\";\n\nconst data = {\n  graph: { follow: { [props.accountId]: isFollowing ? null : \"\" } },\n  index: {\n    graph: JSON.stringify({\n      key: \"follow\",\n      value: {\n        type,\n        accountId: props.accountId,\n      },\n    }),\n    notify: JSON.stringify({\n      key: props.accountId,\n      value: {\n        type,\n      },\n    }),\n  },\n};\n\nreturn (\n  <Widget\n    src=\"nui.sking.near/widget/Input.Button\"\n    props={{\n      children: (\n        <>\n          {isFollowing && <i className=\"bi bi-check-lg\"></i>}\n          {isFollowing ? \"Following\" : isInverse ? \"Follow Back\" : \"Follow\"}\n        </>\n      ),\n      variant: props.variant ?? (isFollowing ? [] : [\"secondary\"]),\n      disabled: props.disabled ?? loading,\n      onClick: () => {\n        State.update({ loading: true });\n        Social.set(data, {\n          force: true,\n          onCommit: () => {\n            State.update({ loading: false });\n          },\n          onCancel: () => {\n            State.update({ loading: false });\n          },\n        });\n      },\n      ...props,\n    }}\n  />\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nui.sking.near/widget/Social.FollowButton", "fact_widget_deployments_id": "6dc02ca26b3e34b897ed351a96f34732", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
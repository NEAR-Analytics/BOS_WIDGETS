{"tx_hash": "E4XamxmeoXK72RN4rkEXtGNRomWL2kajffM599MzNKb1", "action_id_social": "EUL5aaE8J2vHCswGdwffmQCjo6qK4NzEJr7qcCpS8QFo-0-widget", "block_id": 96352747, "block_timestamp": "2023-07-13T05:20:31.259Z", "signer_id": "easypoll-v0.ndc-widgets.near", "widget_name": "EasyPoll.Data.Table", "source_code": "const columns = props.columns ?? [];\nconst data = props.data ?? [];\nconst title = props.title ?? \"exported\";\n\nState.init({\n  loading: true,\n});\n\nconst code = `\n<!DOCTYPE html>\n<html>\n<head>\n  <link rel=\"stylesheet\" href=\"https://unpkg.com/bootstrap@5.3.0/dist/css/bootstrap.min.css\">\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://unpkg.com/datatables.net-bs5@1.13.5/css/dataTables.bootstrap5.min.css\">\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap5.min.css\">\n\n  <script src=\"https://unpkg.com/jquery@3.7.0/dist/jquery.min.js\"></script>\n  <script type=\"text/javascript\" src=\"https://unpkg.com/datatables@1.10.18/media/js/jquery.dataTables.min.js\"></script>\n  <script type=\"text/javascript\" src=\"https://unpkg.com/datatables.net-bs5@1.13.5/js/dataTables.bootstrap5.min.js\"></script>\n  <script type=\"text/javascript\" src=\"https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js\"></script>\n\n\n  <style>\n  td {\n    white-space: normal !important;\n    word-wrap: break-word;\n  }</style>\n</head>\n<body>\n<table id=\"thetable\" class=\"display nowrap table table-striped\" style=\"width:100%\">\n<thead>\n          <tr>\n          </tr>\n      </thead>\n  </table>\n</body>\n<script>\nconst handleMessage = (m) => {\n    const data = m;\n    $('#thetable').DataTable( {\n        responsive: true,\n        data: data.tableData,\n        columns: data.columns\n    });\n};\n\n// finally, configure iframe resizer options before importing the script\nwindow.iFrameResizer = {\n    onMessage: handleMessage\n}\n</script>\n<script type=\"text/javascript\" src=\"https://unpkg.com/iframe-resizer@4.3.6/js/iframeResizer.contentWindow.js\"></script>\n</html>\n`;\n\nconst Container = styled.div`\n  border-radius: 16px;\n  box-shadow: rgba(0, 0, 0, 0.05) 0px 6px 24px 0px,\n    rgba(0, 0, 0, 0.08) 0px 0px 0px 1px;\n  padding: 16px 0;\n  display: flex;\n  flex-direction: column;\n\n  @media screen and (min-width: 768px) {\n    padding: 16px 24px;\n  }\n`;\n\n\nfunction escapeCsvField(value) {\n  if (typeof value === \"string\" && value.includes('\"')) {\n    // Escape double quotes by doubling them\n    return '\"' + value.replace(/\"/g, '\"\"') + '\"';\n  }\n  return `\"${value}\"`;\n}\n\n// Convert array to CSV string\nlet csvColumns = columns\n  .map((row) => {\n    return escapeCsvField(row[\"title\"]);\n  })\n  .join(\",\");\nlet csv = data.map((row) => {\n  return row.map((item) => escapeCsvField(item)).join(\",\");\n});\ncsv.unshift(csvColumns);\ncsv = csv.join(\"\\n\");\n\n\nconst blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\nconst csvURL = URL.createObjectURL(blob);\n\nreturn (\n  <Container>\n    <div className=\"d-flex justify-content-between gap-2 mb-4 align-items-center flex-wrap px-2 px-sm-0\">\n      <h2\n        style={{\n          fontSize: title.length > 200 ? 18 : 24,\n          fontWeight: 500,\n          letterSpacing: \"-1px\",\n        }}\n      >\n        {title}\n      </h2>\n      <a\n        href={csvURL}\n        download={title + \".csv\"}\n        className=\"ms-auto text-decoration-none\"\n        style={{\n          minWidth: 150,\n        }}\n      >\n        <Widget\n          src=\"rubycop.near/widget/NDC.StyledComponents\"\n          props={{\n            Button: {\n              text: \"Export CSV\",\n              icon: <i className=\"bi bi-file-earmark-arrow-down\" />,\n              className: \"primary dark d-flex gap-2 align-items-center\",\n              onClick: () => {},\n            },\n          }}\n        />\n      </a>\n    </div>\n    {state.loading && (\n      <div\n        className=\"d-flex flex-column gap-1\"\n        style={{\n          padding: \"60px 12px\",\n        }}\n      >\n        <Widget\n          src={`easypoll-v0.ndc-widgets.near/widget/Common.Spinner`}\n          props={{\n            color1: \"#ffd50d\",\n            color2: \"#4f46e5\",\n          }}\n        />\n        <span\n          style={{\n            fontWeight: \"bold\",\n            fontsize: 15,\n            color: \"#4f46e5\",\n            textAlign: \"center\",\n          }}\n        >\n          Loading...\n        </span>\n      </div>\n    )}\n    <iframe\n      iframeResizer\n      className=\"w-100\"\n      srcDoc={code}\n      style={{\n        display: state.loading ? \"none\" : \"block\",\n      }}\n      message={{ tableData: data, columns }}\n      onLoad={() => {\n        State.update({ loading: false });\n      }}\n    />\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/easypoll-v0.ndc-widgets.near/widget/EasyPoll.Data.Table", "fact_widget_deployments_id": "b143a81a2291bc08d6f4c063d06672c1", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
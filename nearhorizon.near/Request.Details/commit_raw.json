{"tx_hash": "GbsvwtrLTBqVKLiEDsUcacDY7jeiK6oNGCX4zL6k76W3", "action_id_social": "GfLeDjyyBrTjK9T9hviNf6tnBfLeEFLCKh9AB1LwQvrv-0-widget", "block_id": 95605138, "block_timestamp": "2023-07-03T11:50:06.862Z", "signer_id": "nearhorizon.near", "widget_name": "Request.Details", "source_code": "const onSave = props.onSave ?? (() => {});\nconst ownerId = \"nearhorizon.near\";\nconst isAdmin = props.isAdmin;\nconst request = props.request;\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  padding: 0.5em 0.2em;\n  max-width: 100%;\n  font-size: 0.9em;\n`;\n\nconst Heading = styled.div`\n  padding-bottom: 0.5em;\n  border-bottom: 1px solid #eceef0;\n  font-style: normal;\n  font-weight: 600;\n  font-size: 1em;\n  line-height: 1.4em;\n  color: #000;\n  width: 100%;\n`;\n\nState.init({\n  paymentSources: [],\n  paymentTypes: [],\n  requestTypes: [],\n  isFetched: false,\n  name: \"\",\n  nameIsFetched: false,\n});\n\nif (!state.isFetched) {\n  Near.asyncView(ownerId, \"get_payment_types\", {}, \"final\", false).then(\n    (paymentTypes) =>\n      State.update({\n        paymentTypes: paymentTypes.map((value) => ({ value, text: value })),\n      })\n  );\n  Near.asyncView(ownerId, \"get_payment_sources\", {}, \"final\", false).then(\n    (paymentSources) =>\n      State.update({\n        paymentSources: paymentSources.map((value) => ({ value, text: value })),\n      })\n  );\n  Near.asyncView(ownerId, \"get_request_types\", {}, \"final\", false).then(\n    (requestTypes) =>\n      State.update({\n        requestTypes: requestTypes.map((value) => ({ value, text: value })),\n      })\n  );\n  State.update({ isFetched: true });\n}\n\nif (!state.nameIsFetched) {\n  Near.asyncView(\n    \"social.near\",\n    \"get\",\n    { keys: [`${request.project_id}/profile/name`] },\n    \"final\",\n    false\n  ).then((data) =>\n    State.update({\n      name: data[request.project_id].profile.name,\n      nameIsFetched: true,\n    })\n  );\n  return <>Loading...</>;\n}\n\nconst Project = styled.a`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 0.25em;\n  width: 100%;\n\n  div {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: flex-start;\n    gap: 0.5em;\n  }\n\n  label {\n    font-style: normal;\n    font-weight: 600;\n    font-size: 0.95em;\n    line-height: 1em;\n    color: #11181c;\n  }\n\n  &:hover,\n  &:focus,\n  &:active {\n    text-decoration: none;\n    color: unset;\n  }\n`;\n\nreturn (\n  <Container>\n    <Heading>Request Details</Heading>\n    <Project\n      href={`/${ownerId}/widget/Index?tab=project&accountId=${request.project_id}`}\n    >\n      <label>Project</label>\n      <div>\n        <Widget\n          src={`${ownerId}/widget/Project.Icon`}\n          props={{ accountId: request.project_id, size: \"2.5em\" }}\n        />\n        <Widget\n          src={`${ownerId}/widget/NameAndAccount`}\n          props={{\n            accountId: request.project_id,\n            name: state.name,\n            nameSize: \".95em\",\n            accountSize: \".75em\",\n          }}\n        />\n      </div>\n    </Project>\n    <Widget\n      src={`${ownerId}/widget/Inputs.Viewable.Number`}\n      props={{\n        label: \"Budget\",\n        id: \"bugdet\",\n        value: request.budget,\n        onSave: (budget) => onSave({ budget }),\n        canEdit: isAdmin,\n      }}\n    />\n    <Widget\n      src={`${ownerId}/widget/Inputs.Viewable.Select`}\n      props={{\n        label: \"Payment source\",\n        id: \"source\",\n        value: { value: request.source, text: request.source },\n        options: state.paymentSources,\n        onSave: ({ value: source }) => onSave({ source }),\n        canEdit: isAdmin,\n      }}\n    />\n    <Widget\n      src={`${ownerId}/widget/Inputs.Viewable.Select`}\n      props={{\n        label: \"Payment type\",\n        id: \"payment_type\",\n        value: { value: request.payment_type, text: request.payment_type },\n        options: state.paymentTypes,\n        onSave: ({ value: payment_type }) => onSave({ payment_type }),\n        canEdit: isAdmin,\n      }}\n    />\n    <Widget\n      src={`${ownerId}/widget/Inputs.Viewable.Select`}\n      props={{\n        label: \"Request type\",\n        id: \"request_type\",\n        value: { value: request.request_type, text: request.request_type },\n        options: state.requestTypes,\n        onSave: ({ value: request_type }) => onSave({ request_type }),\n        canEdit: isAdmin,\n      }}\n    />\n    <Widget\n      src={`${ownerId}/widget/Inputs.Viewable.Date`}\n      props={{\n        label: \"Deadline\",\n        id: \"deadline\",\n        value: request.deadline,\n        onSave: (deadline) =>\n          onSave({ deadline: `${new Date(deadline).getTime()}` }),\n        canEdit: isAdmin,\n      }}\n    />\n    {/*<Widget\n      src={`${ownerId}/widget/Inputs.Viewable.Tags`}\n      props={{\n        label: \"Tags\",\n        id: \"tags\",\n        value: request.tags.map((name) => ({ name })),\n        options: [\n          { name: \"defi\" },\n          { name: \"exchange\" },\n          { name: \"staking\" },\n          { name: \"farming\" },\n        ],\n        onSave: (tags) => onSave({ tags: tags.map(({ name }) => name) }),\n        canEdit: isAdmin,\n      }}\n    />*/}\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearhorizon.near/widget/Request.Details", "fact_widget_deployments_id": "a6816416943371a2b6c9782503625ec0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 2}
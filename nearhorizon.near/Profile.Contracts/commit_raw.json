{"tx_hash": "FhQ6Fqa9uVLjGtmy3ckQ4d6k8wiC8kCvVW8MN8MVLcqN", "action_id_social": "Em4NZqvPW3f76SPCkHbkkZZBSBYrpE8FfFQyAQZvSrjK-0-widget", "block_id": 101408611, "block_timestamp": "2023-09-18T15:03:46.184Z", "signer_id": "nearhorizon.near", "widget_name": "Profile.Contracts", "source_code": "const ownerId = \"nearhorizon.near\";\nconst apiUrl = \"https://api-op3o.onrender.com\";\n\nconst Centered = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  gap: 0.75rem;\n  height: 100%;\n  width: 100%;\n\n  & > h5 {\n    color: var(--ui-elements-dark, #11181c);\n    text-align: center;\n    font-family: Inter;\n    font-size: 1rem;\n    font-style: normal;\n    font-weight: 600;\n    line-height: 140%; /* 1.4rem */\n  }\n\n  & > p {\n    color: var(--ui-elements-gray, #7e868c);\n    text-align: center;\n    font-family: \"Mona Sans\";\n    font-size: 0.875rem;\n    font-style: normal;\n    font-weight: 400;\n    line-height: 140%; /* 1.225rem */\n  }\n`;\n\nState.init({\n  contracts: [],\n  contractsIsFetched: false,\n});\n\nif (!state.contractsIsFetched) {\n  asyncFetch(`${apiUrl}/transactions/all`).then(({ body: txs }) => {\n    Near.asyncView(\n      ownerId,\n      \"get_project_contributions\",\n      { account_id: context.accountId },\n      \"final\",\n      false,\n    ).then((contracts) => {\n      txs = txs.filter(\n        ({ method_name, args }) =>\n          method_name === \"add_contribution\" &&\n          args.project_id === context.accountId,\n      );\n\n      const contractsWithTxs = contracts.map(([_, vendor_id]) => {\n        const txsForContribution = txs.filter(\n          ({ args }) => args.vendor_id === vendor_id,\n        );\n\n        return [context.accountId, vendor_id, txsForContribution];\n      });\n\n      State.update({\n        contracts: contractsWithTxs,\n        contractsIsFetched: true,\n      });\n    });\n  });\n}\n\nreturn (\n  <Centered>\n    {!state.contractsIsFetched ? (\n      \"Loading...\"\n    ) : state.contracts.length === 0 ? (\n      <>\n        <h5>You don't have any contracts yet</h5>\n        <p>\n          Contracts are the way to track ongoing work agreements with\n          contractors that you hired\n        </p>\n      </>\n    ) : (\n      state.contracts.map((contract) => contract.toString())\n    )}\n  </Centered>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearhorizon.near/widget/Profile.Contracts", "fact_widget_deployments_id": "8f99e86543e212e47ca905355dceff70", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
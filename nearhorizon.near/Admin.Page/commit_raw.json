{"tx_hash": "FhQ6Fqa9uVLjGtmy3ckQ4d6k8wiC8kCvVW8MN8MVLcqN", "action_id_social": "Em4NZqvPW3f76SPCkHbkkZZBSBYrpE8FfFQyAQZvSrjK-0-widget", "block_id": 101408611, "block_timestamp": "2023-09-18T15:03:46.184Z", "signer_id": "nearhorizon.near", "widget_name": "Admin.Page", "source_code": "const ownerId = \"nearhorizon.near\";\n\nconst availableContent = [\"claims\", \"applications\", \"vendors\", \"metrics\"];\n\nconst getContent = (content) => {\n  if (!content || !availableContent.includes(content)) {\n    return \"claims\";\n  }\n\n  return content;\n};\n\nState.init({\n  isOwner: false,\n  isOwnerFetched: false,\n});\n\n// TODO: THIS IS A HACK AND SHOULD BE REMOVED ASAP - NEED TO ADD PERMISSION SYSTEM\nconst allowedUsers = [\"lccc.near\", \"jarrodbarnes.near\"];\n\nif (context.accountId && !state.isOwnerFetched) {\n  Near.asyncView(\n    ownerId,\n    \"check_is_owner\",\n    { account_id: context.accountId },\n    \"final\",\n    false,\n  ).then((isOwner) =>\n    State.update({\n      isOwner: isOwner || allowedUsers.includes(context.accountId),\n      isOwnerFetched: true,\n    }),\n  );\n}\n\nif (!state.isOwner) {\n  return (\n    <Widget\n      src={`${ownerId}/widget/InfoSegment`}\n      props={{\n        title: \"Permission Denied!\",\n        description: (\n          <>\n            You need to log in with an admin account to access the admin\n            dashboard!\n          </>\n        ),\n      }}\n    />\n  );\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 1em;\n  width: 100%;\n`;\n\nconst HeaderDetails = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 80%;\n`;\n\nconst HeaderProgress = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  width: 20%;\n`;\n\nconst ContentContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 100%;\n`;\n\nconst MainContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 100%;\n  padding-top: 0.25em;\n`;\n\nconst Sidebar = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 20%;\n`;\n\nconst circledPlus = (\n  <svg\n    width=\"18\"\n    height=\"18\"\n    viewBox=\"0 0 18 18\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <g clip-path=\"url(#clip0_1624_38049)\">\n      <path\n        d=\"M9 6V12M6 9H12M16.5 9C16.5 13.1421 13.1421 16.5 9 16.5C4.85786 16.5 1.5 13.1421 1.5 9C1.5 4.85786 4.85786 1.5 9 1.5C13.1421 1.5 16.5 4.85786 16.5 9Z\"\n        stroke=\"currentColor\"\n        stroke-width=\"1.66667\"\n        stroke-linecap=\"round\"\n        stroke-linejoin=\"round\"\n      />\n    </g>\n    <defs>\n      <clipPath id=\"clip0_1624_38049\">\n        <rect width=\"18\" height=\"18\" fill=\"white\" />\n      </clipPath>\n    </defs>\n  </svg>\n);\n\nconst plus = (\n  <svg\n    width=\"18\"\n    height=\"18\"\n    viewBox=\"0 0 18 18\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      d=\"M9 3.75V14.25M3.75 9H14.25\"\n      stroke=\"#006ADC\"\n      stroke-width=\"1.66667\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n  </svg>\n);\n\nconst CTARow = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 0.75em;\n  margin-top: 1em;\n`;\n\nconst content = {\n  claims: (\n    <Widget\n      src={`${ownerId}/widget/Admin.Claims`}\n      props={{ accountId: props.accountId, isAdmin: state.isAdmin }}\n    />\n  ),\n  applications: (\n    <Widget\n      src={`${ownerId}/widget/Admin.Applications`}\n      props={{ accountId: props.accountId }}\n    />\n  ),\n  vendors: (\n    <Widget\n      src={`${ownerId}/widget/Admin.Vendors`}\n      props={{ accountId: props.accountId, isAdmin: state.isAdmin }}\n    />\n  ),\n  metrics: (\n    <Widget\n      src={`${ownerId}/widget/Admin.Completion`}\n      props={{ accountId: props.accountId }}\n    />\n  ),\n}[getContent(props.content)];\n\nreturn (\n  <Container>\n    <Header>\n      <HeaderDetails>\n        <h1>Admin dashboard</h1>\n      </HeaderDetails>\n      <HeaderProgress></HeaderProgress>\n    </Header>\n    <ContentContainer>\n      <MainContent>\n        <Widget\n          src={`${ownerId}/widget/TabSelector`}\n          props={{\n            tab: \"admin\",\n            content: getContent(props.content),\n            search: props.search,\n            update: props.update,\n            accountId: props.accountId,\n            buttons: [\n              {\n                id: \"claims\",\n                text: \"Claims\",\n              },\n              {\n                id: \"applications\",\n                text: \"Credit applications\",\n              },\n              {\n                id: \"vendors\",\n                text: \"Vendors\",\n              },\n              {\n                id: \"metrics\",\n                text: \"Metrics\",\n              },\n            ],\n          }}\n        />\n        {content}\n      </MainContent>\n    </ContentContainer>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearhorizon.near/widget/Admin.Page", "fact_widget_deployments_id": "2fa0958d7ef4127956c911f76aac4eb0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
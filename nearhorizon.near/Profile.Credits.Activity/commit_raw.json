{"tx_hash": "FhQ6Fqa9uVLjGtmy3ckQ4d6k8wiC8kCvVW8MN8MVLcqN", "action_id_social": "Em4NZqvPW3f76SPCkHbkkZZBSBYrpE8FfFQyAQZvSrjK-0-widget", "block_id": 101408611, "block_timestamp": "2023-09-18T15:03:46.184Z", "signer_id": "nearhorizon.near", "widget_name": "Profile.Credits.Activity", "source_code": "const ownerId = \"nearhorizon.near\";\nconst apiUrl = \"https://api-op3o.onrender.com\";\n\nState.init({\n  project: null,\n  projectIsFetched: false,\n  transactions: [],\n  transactionsIsFetched: false,\n  incentiveDetails: null,\n  incentiveDetailsIsFetched: false,\n});\n\nif (!state.projectIsFetched) {\n  Near.asyncView(\n    ownerId,\n    \"get_project\",\n    { account_id: context.accountId },\n    \"final\",\n    false,\n  ).then((project) => {\n    State.update({ project, projectIsFetched: true });\n  });\n}\n\nif (!state.transactionsIsFetched) {\n  asyncFetch(`${apiUrl}/transactions/all`).then(({ body: transactions }) => {\n    State.update({\n      transactions: transactions\n        .filter(\n          (tx) =>\n            tx.method_name === \"add_incentive\" &&\n            tx.args.account_id === context.accountId,\n        )\n        .sort((a, b) => Number(a.timestamp) - Number(b.timestamp)),\n      transactionsIsFetched: true,\n    });\n  });\n}\n\nif (!state.incentiveDetailsIsFetched) {\n  Near.asyncView(ownerId, \"get_incentive_data\", {}, \"final\", false).then(\n    (incentiveDetails) => {\n      State.update({ incentiveDetails, incentiveDetailsIsFetched: true });\n    },\n  );\n}\n\nif (!state.projectIsFetched || !state.transactionsIsFetched) {\n  return <>Loading...</>;\n}\n\nconst List = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 4fr 1fr;\n  width: 100%;\n\n  & > div:nth-child(-n + 3) {\n    display: flex;\n    height: 2.75rem;\n    padding: 0.75rem 1.5rem;\n    align-items: center;\n    border-bottom: 1px solid var(--gray-200, #eaecf0);\n    background: var(--gray-50, #f9fafb);\n    color: var(--gray-600, #475467);\n    font-family: \"Mona Sans\";\n    font-size: 0.75rem;\n    font-style: normal;\n    font-weight: 600;\n    line-height: 1.0375rem; /* 138.333% */\n  }\n\n  & > div:nth-child(1),\n  & > div:nth-child(3) {\n    display: flex;\n    height: 2.75rem;\n    padding: 0.75rem 1.5rem;\n    justify-content: center;\n    align-items: center;\n    gap: 0.75rem;\n    align-self: stretch;\n  }\n\n  & > div:nth-child(3n + 4) {\n    display: flex;\n    padding: 1.5rem;\n    justify-content: center;\n    align-items: center;\n    flex: 1 0 0;\n    align-self: stretch;\n    border-bottom: 1px solid var(--gray-200, #eaecf0);\n    color: var(--text-text-dark, #11181c);\n    font-family: \"Mona Sans\";\n    font-size: 0.75rem;\n    font-style: normal;\n    font-weight: 400;\n    line-height: 1.1rem; /* 146.667% */\n  }\n\n  & > div:nth-child(3n + 5) {\n    display: flex;\n    padding: 1rem 1.5rem;\n    align-items: center;\n    gap: 1rem;\n    align-self: stretch;\n    border-bottom: 1px solid var(--gray-200, #eaecf0);\n    color: var(--gray-900, #101828);\n    font-family: \"Mona Sans\";\n    font-size: 0.875rem;\n    font-style: normal;\n    font-weight: 600;\n    line-height: 142%; /* 1.2425rem */\n  }\n\n  & > div:nth-child(3n + 6) {\n    display: flex;\n    padding: 1.5rem;\n    justify-content: center;\n    align-items: center;\n    flex: 1 0 0;\n    align-self: stretch;\n    border-bottom: 1px solid var(--gray-200, #eaecf0);\n    color: var(--primary-primary-pressed, #04a46e);\n    font-family: \"Mona Sans\";\n    font-size: 0.875rem;\n    font-style: normal;\n    font-weight: 600;\n    line-height: 142%; /* 1.2425rem */\n  }\n`;\n\nconst achievements = state.transactions\n  .reduce(\n    ([seenSet, list], current) => {\n      if (\n        seenSet.has(current.args.incentive) &&\n        state.incentiveDetails[current.args.incentive][0] === \"Once\"\n      ) {\n        return [seenSet, list];\n      }\n\n      return [seenSet.add(current.args.incentive), list.concat(current)];\n    },\n    [new Set(), []],\n  )[1]\n  .map((tx) => (\n    <>\n      <div>\n        {new Date(Number(`${tx.timestamp}`.substring(0, 13)))\n          .toLocaleDateString(\"en-GB\")\n          .replace(/\\//g, \".\")}\n      </div>\n      <div>{tx.args.incentive}</div>\n      <div>+{state.incentiveDetails[tx.args.incentive][1]} NHZN</div>\n    </>\n  ));\n\nreturn achievements.length > 0 ? (\n  <List>\n    <div>Date</div>\n    <div>Achievement</div>\n    <div>Reward</div>\n    {achievements}\n  </List>\n) : (\n  <>\n    <List>\n      <div>Date</div>\n      <div>Achievement</div>\n      <div>Reward</div>\n    </List>\n    <p>No achievements yet</p>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearhorizon.near/widget/Profile.Credits.Activity", "fact_widget_deployments_id": "c2fee70ad1a7ce6b0ddafc1beba498f4", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
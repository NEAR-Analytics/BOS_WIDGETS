{"tx_hash": "9zhW9HCQgmacPxnaCmHUExCghWrN2FfcrKwgXH1BnkMf", "action_id_social": "FBw1oX5ZFU3vBS3ZZLZmf2AJZUMCPvaeF5NL8fYyuvv8-0-widget", "block_id": 96647403, "block_timestamp": "2023-07-17T00:55:48.718Z", "signer_id": "5842af77c5d5647d86a6d42e4b7dcbf3d00be0311b321ab60a31ef0fab8e097c", "widget_name": "pick-em-leaderboard", "source_code": null, "metadata": null, "branch": {"draft": {"": "const matches = Near.view(\"pickem.near\", \"getMatches\");\nconst picks = Near.view(\"pickem.near\", \"getAllPicks\");\n\nconst users = {};\npicks.forEach((pick) => {\n  const match = matches\n    .filter((m) => m.status === 1)\n    .find((match) => match.index === pick.index);\n  if (match) {\n    const winner = match.score1 > match.score2 ? 1 : 2;\n    if (pick.team === winner) {\n      if (users[pick.predictor]) {\n        users[pick.predictor] += 10;\n      } else {\n        users[pick.predictor] = 10;\n      }\n    }\n  }\n});\nconsole.log(picks, matches);\nconst leaderboard = Object.keys(users)\n  .map((user) => {\n    return { name: user, points: users[user] };\n  })\n  .sort((a, b) => b.points - a.points);\nconsole.log(leaderboard);\n\nreturn (\n  <div style={{ display: \"flex\", flexDirection: \"column\", gap: \"8px\" }}>\n    <h1 style={{ fontWeight: 800, opacity: 1 }}>BIG3 Pick 'Em Leaderboard</h1>\n    {leaderboard.length > 0 &&\n      leaderboard.map((user, i) => (\n        <div\n          style={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            border: \"1px solid #ADADAD\",\n            borderRadius: \"8px\",\n            padding: \"16px\",\n            alignContent: \"center\",\n          }}\n        >\n          <div\n            style={{\n              display: \"flex\",\n              alignContent: \"center\",\n              gap: 16,\n              backgroundColor: i > 10 ? \"\"\n            }}\n          >\n            <div style={{ fontWeight: 600, fontSize: 24, opacity: 0.5 }}>\n              {i + 1}\n            </div>\n            <div style={{ fontWeight: 800, fontSize: 24, opacity: 1 }}>\n              {user.name}\n            </div>\n          </div>\n          <div style={{ fontWeight: 400, fontSize: 24, opacity: 0.5 }}>\n            {user.points}\n          </div>\n        </div>\n      ))}\n  </div>\n);\n"}}, "widget_modules_used": null, "widget_url": "https://near.social/#/5842af77c5d5647d86a6d42e4b7dcbf3d00be0311b321ab60a31ef0fab8e097c/widget/pick-em-leaderboard", "fact_widget_deployments_id": "15b5e7c93285e4958db4fc1781903412", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 3}
{"tx_hash": "4kiTzYPiBY7WJiuh1mUCbLAn1jro4jxJ2jLaQj6k8am1", "action_id_social": "7wkYTUzAoqYbhMaJp6Tn4qsASEwibyJmafvcv38vqm2w-0-widget", "block_id": 97990051, "block_timestamp": "2023-08-03T15:34:14.173Z", "signer_id": "5842af77c5d5647d86a6d42e4b7dcbf3d00be0311b321ab60a31ef0fab8e097c", "widget_name": "pick-em-select", "source_code": "const team_data = [\n  {\n    short_name: \"3HM\",\n    id: 3084,\n    name: \"3 Headed Monsters\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/3hmonsters-1.svg\",\n  },\n  {\n    short_name: \"3CO\",\n    id: 2915,\n    name: \"3's Company\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/3scompany-1.svg\",\n  },\n  {\n    short_name: \"ALI\",\n    id: 2916,\n    name: \"Aliens\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/Aliens.svg\",\n  },\n  {\n    short_name: \"BH\",\n    id: 2917,\n    name: \"Ball Hogs\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/ballhogs-1.svg\",\n  },\n  {\n    short_name: \"BIV\",\n    id: 2918,\n    name: \"Bivouac\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/Bivouac300x300.svg\",\n  },\n  {\n    short_name: \"ENM\",\n    id: 2919,\n    name: \"Enemies\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/enemies.svg\",\n  },\n  {\n    short_name: \"GB\",\n    id: 2920,\n    name: \"Ghost Ballers\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/ghostballers-1.svg\",\n  },\n  {\n    short_name: \"K3\",\n    id: 2921,\n    name: \"Killer 3's\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/killer3s-1.svg\",\n  },\n  {\n    short_name: \"POW\",\n    id: 2922,\n    name: \"Power\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/power-1.svg\",\n  },\n  {\n    short_name: \"TS\",\n    id: 2923,\n    name: \"Tri-State\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/tristate-1.svg\",\n  },\n  {\n    short_name: \"TRI\",\n    id: 2924,\n    name: \"Trilogy\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/trilogy-1-1.svg\",\n  },\n  {\n    short_name: \"TRP\",\n    id: 2925,\n    name: \"Triplets\",\n    image:\n      \"https://fhfaxdtipfmoxqxoxtec.supabase.co/storage/v1/object/public/images/Triplets-2.svg\",\n  },\n];\n\nState.init({\n  selections: [],\n  picksMade: false,\n});\n\nconst matches = Near.view(\"pickem.near\", \"getMatches\").filter(\n  (m) => new Date() < new Date(m.time)\n);\nconst predictions = Near.view(\"pickem.near\", \"getAllPicks\");\n\nconst onTeamSelect = (team, matchIndex) => {\n  let _selections = state.selections.filter((t) => t.index !== matchIndex);\n  _selections.push({\n    selection: team,\n    index: matchIndex,\n  });\n  State.update({ selections: _selections });\n};\n\nconst onSubmit = () => {\n  Near.call(\"pickem.near\", \"bulkPick\", state.selections);\n  State.update({ picksMade: true });\n};\n\nconst button = (name, image, first, selected, onClick) => (\n  <button\n    onClick={onClick}\n    disabled={!context.accountId}\n    style={{\n      display: \"flex\",\n      padding: \"0.25rem\",\n      backgroundColor: selected ? \"#00A160\" : \"#ffffff\",\n      flexDirection: \"column\",\n      justifyContent: first ? \"end\" : \"start\",\n      alignItems: \"center\",\n      width: \"100%\",\n      borderRadius: \"0.5rem\",\n      borderWidth: \"2px\",\n      borderColor: \"#00A160\",\n      gap: \"1rem\",\n      color: selected ? \"#ffffff\" : \"#000000\",\n      fontSize: \"1rem\",\n      fontWeight: 600,\n      opacity: onClick ? \"100%\" : \"50%\",\n    }}\n  >\n    <img src={image} width={100} height={100} alt=\"\" />\n    <div className=\"\">{name}</div>\n  </button>\n);\n\nconst matchup = (index, team1, team2, isActive) => (\n  <div\n    style={{\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      width: \"100%\",\n      gap: \"1rem\",\n    }}\n  >\n    {button(\n      team1.name,\n      team1.image,\n      true,\n      state.selections.some((s) => s.index === index && s.selection === 1) ||\n        predictions.some(\n          (p) =>\n            p.predictor === context.accountId &&\n            p.index === index &&\n            p.team === 1\n        ),\n      isActive ? () => onTeamSelect(1, index) : false\n    )}\n    <div className=\"flex items-center justify-center text-xl font-bold\">vs</div>\n    {button(\n      team2.name,\n      team2.image,\n      false,\n      state.selections.some((s) => s.index === index && s.selection === 2) ||\n        predictions.some(\n          (p) =>\n            p.predictor === context.accountId &&\n            p.index === index &&\n            p.team === 2\n        ),\n      isActive ? () => onTeamSelect(2, index) : false\n    )}\n  </div>\n);\n\nreturn (\n  <div\n    style={{\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      width: \"100%\",\n      gap: \"1rem\",\n    }}\n  >\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        gap: \"0.5rem\",\n      }}\n    >\n      <h1\n        style={{\n          fontSize: \"1.875rem\",\n          lineHeight: \"2.25rem\",\n          fontWeight: \"800\",\n          letterSpacing: \"-0.05em\",\n          lineHeight: \"1.25\",\n          lineHeight: \"2.5rem\",\n        }}\n      >\n        BIG3 Week 7 Charlotte Pick 'Em\n      </h1>\n      <p\n        style={{\n          fontSize: \"1.125rem\",\n          lineHeight: \"1.75rem\",\n        }}\n      >\n        {context.accountId ? (\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n              alignItems: \"flex-start\",\n              gap: \"0.5rem\",\n            }}\n          >\n            Signed in as {context.accountId.slice(0, 12)}...\n          </div>\n        ) : (\n          <div\n            style={{\n              display: \"flex\",\n              color: \"#000000\",\n              fontWeight: \"700\",\n              flexDirection: \"column\",\n              alignItems: \"flex-start\",\n              gap: \"0.5rem\",\n            }}\n          >\n            Connect your NEAR wallet to make your picks\n          </div>\n        )}\n      </p>\n      {state.picksMade ? (\n        <p\n          style={{\n            fontSize: \"1.125rem\",\n            lineHeight: \"1.75rem\",\n            padding: \"1rem\",\n            color: \"white\",\n            fontWeight: 800,\n            backgroundColor: \"#00A160\",\n            borderRadius: \"0.25rem\",\n          }}\n        >\n          Your picks MIGHT have been submitted! Refresh the page to make sure\n          they went through.\n        </p>\n      ) : (\n        <></>\n      )}\n    </div>\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        gap: \"8rem\",\n        alignItems: \"start\",\n        width: \"100%\",\n        maxWidth: \"1000px\",\n      }}\n    >\n      {matches.length > 0 &&\n      matches.filter(\n        (m) =>\n          !context.accountId ||\n          !predictions.some(\n            (p) => p.index === m.index && p.predictor === context.accountId\n          )\n      ).length > 0 ? (\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            gap: \"2rem\",\n            width: \"100%\",\n            alignItems: \"start\",\n          }}\n        >\n          <h2>Upcoming Games</h2>\n          {matches\n            .filter(\n              (m) =>\n                !context.accountId ||\n                !predictions.some(\n                  (p) =>\n                    p.index === m.index && p.predictor === context.accountId\n                )\n            )\n            .map((m) => {\n              return matchup(\n                m.index,\n                {\n                  ...team_data.find((t) => t.id === m.team1),\n                },\n                {\n                  ...team_data.find((t) => t.id === m.team2),\n                },\n                true\n              );\n            })}\n          <button\n            style={{\n              borderColor: \"#00A160\",\n              backgroundColor: \"#00A160\",\n            }}\n            onClick={onSubmit}\n          >\n            Submit Picks\n          </button>\n        </div>\n      ) : (\n        <></>\n      )}\n      {matches.length > 0 &&\n      matches.filter((m) =>\n        predictions.some(\n          (p) => p.index === m.index && p.predictor === context.accountId\n        )\n      ).length > 0 ? (\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            gap: \"2rem\",\n            width: \"100%\",\n            alignItems: \"start\",\n          }}\n        >\n          <h2>Your Picks</h2>\n          {matches\n            .filter((m) =>\n              predictions.some(\n                (p) => p.index === m.index && p.predictor === context.accountId\n              )\n            )\n            .map((m) => {\n              return matchup(\n                m.index,\n                {\n                  ...team_data.find((t) => t.id === m.team1),\n                },\n                {\n                  ...team_data.find((t) => t.id === m.team2),\n                },\n                false\n              );\n            })}\n        </div>\n      ) : (\n        <></>\n      )}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/5842af77c5d5647d86a6d42e4b7dcbf3d00be0311b321ab60a31ef0fab8e097c/widget/pick-em-select", "fact_widget_deployments_id": "b5c9d3c43d7397770299a726d5b0fe00", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
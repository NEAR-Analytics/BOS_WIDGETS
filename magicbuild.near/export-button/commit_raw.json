{"tx_hash": "HRSRCMTJmpVfx8zcwfYybLfCTaVZkjFz5QFWQasHgw5b", "action_id_social": "Ftd65zUjYGxDGRocjrfRnFbLaKum3ZpaW6xWt2Rxzuio-0-widget", "block_id": 103067710, "block_timestamp": "2023-10-10T17:54:27.146Z", "signer_id": "magicbuild.near", "widget_name": "export-button", "source_code": "State.init({\n  cMethod: props.cMethod,\n  widgetName: `MagicBuilder-widget-form-${Date.now()}`,\n});\nconst onSwitchChangeArgExport = (fIndex) => {\n  const abiMethod = state.cMethod;\n  abiMethod[fIndex].export = !abiMethod[fIndex].export;\n  State.update({ cMethod: abiMethod });\n};\nconst onInputChangeWidgetName = ({ target }) => {\n  State.update({ widgetName: target.value.replaceAll(\" \", \"-\") });\n};\nconst saveClient = () => {\n  const abi = {\n    schema_version: \"0.3.0\",\n    address: props.contractAddress,\n    metadata: {\n      name: \"\",\n      version: \"0.1.0\",\n      authors: [\"\"],\n    },\n    body: {\n      functions: [],\n    },\n  };\n\n  const abiMethod = state.cMethod;\n  abiMethod.forEach((item) => {\n    abi.body.functions.push(item);\n  });\n\n  const data = {\n    magicbuild: {\n      client: {\n        [props.id]: {\n          abi: JSON.stringify(abi),\n        },\n      },\n    },\n  };\n  Social.set(data, {\n    force: true,\n    onCommit: () => {},\n    onCancel: () => {},\n  });\n};\nconst exportForm = () => {\n  const abi = {\n    schema_version: \"0.3.0\",\n    address: props.contractAddress,\n    metadata: {\n      name: \"\",\n      version: \"0.1.0\",\n      authors: [\"\"],\n    },\n    body: {\n      functions: [],\n    },\n  };\n\n  const abiMethod = state.cMethod;\n  abiMethod.forEach((item) => {\n    abi.body.functions.push(item);\n  });\n\n  const data = {\n    widget: {\n      [state.widgetName]: {\n        \"\":\n          \"const user = context.accountId;\\r\\nconst props = \" +\n          JSON.stringify(abi).replaceAll(\"\\\\\", \"\") +\n          \" \\r\\n\\r\\nreturn (\\r\\n  <>\\r\\n    <Widget src={'magicbuilder.near/widget/widget'} props={props} />\\r\\n  </>\\r\\n);\\r\\n\",\n      },\n    },\n  };\n  console.log(\"abi\", abi);\n  Social.set(data, {\n    force: true,\n    onCommit: () => {},\n    onCancel: () => {},\n  });\n};\nreturn (\n  <>\n    <label></label>\n    <button\n      data-bs-toggle=\"modal\"\n      data-bs-target=\"#export\"\n      class=\"btn btn-dark form-control \"\n    >\n      Export\n    </button>\n    <div\n      class=\"modal fade\"\n      id=\"export\"\n      tabindex=\"-1\"\n      aria-labelledby=\"exportLabel\"\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h1 class=\"modal-title fs-5\" id=\"exportLabel\">\n              Choose Method to Export\n            </h1>\n            <button\n              type=\"button\"\n              class=\"btn-close\"\n              data-bs-dismiss=\"modal\"\n              aria-label=\"Close\"\n            ></button>\n          </div>\n          <div class=\"modal-body\">\n            <div class=\"form-group\">\n              <label>Widget Name</label>\n              <input\n                class=\"form-control\"\n                defaultValue={state.widgetName}\n                onChange={(e) => onInputChangeWidgetName(e)}\n              />\n              <small class=\"form-text text-muted\">\n                A new widget configured with the form will be created.\n              </small>\n            </div>\n            {state.cMethod &&\n              state.cMethod.map((functions, fIndex) => (\n                <div class=\"form-check form-switch\">\n                  <input\n                    class=\"form-check-input\"\n                    type=\"checkbox\"\n                    role=\"switch\"\n                    checked={functions.export}\n                    onChange={() => onSwitchChangeArgExport(fIndex)}\n                    id={`flexSwitchCheckDefaultView${fIndex}`}\n                  />\n                  <label\n                    class=\"form-check-label\"\n                    for={`flexSwitchCheckDefault${fIndex}`}\n                  >\n                    {functions.name}\n                  </label>\n                </div>\n              ))}\n          </div>\n          <div class=\"modal-footer\">\n            <button\n              type=\"button\"\n              class=\"btn btn-secondary\"\n              data-bs-dismiss=\"modal\"\n            >\n              Close\n            </button>\n            {props.id && (\n              <button\n                type=\"button\"\n                onClick={saveClient}\n                class=\"btn btn-primary\"\n              >\n                Save Client\n              </button>\n            )}\n\n            <button type=\"button\" onClick={exportForm} class=\"btn btn-primary\">\n              Export\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/magicbuild.near/widget/export-button", "fact_widget_deployments_id": "eeff40e896485691f79c97bb87ca503f", "inserted_timestamp": "2023-10-10T19:45:09.782Z", "modified_timestamp": "2023-10-10T19:45:09.782Z", "__row_index": 75}
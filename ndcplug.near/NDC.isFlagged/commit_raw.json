{"tx_hash": "HwbSFohpjdbYtrX4FvN4yu2qdE5Bh5KdhZAvT9tJQbLE", "action_id_social": "3JGyEq4aGBw14RAJLWeeHUokty1yj6N4aersepfEKWtS-0-widget", "block_id": 101252156, "block_timestamp": "2023-09-16T12:13:57.573Z", "signer_id": "ndcplug.near", "widget_name": "NDC.isFlagged", "source_code": "/**\n * Check is human\n * add a comment\n */\nlet accountId = props.accountId ?? context.accountId;\nconst registryContract = \"registry.i-am-human.near\";\nState.init({\n  accountId: accountId,\n});\nfunction loadFlagged() {\n  console.log(\"Loading flag for this account: \" + state.accountId);\n  const flagged = Near.view(registryContract, \"account_flagged\", {\n    account: state.accountId,\n  });\n  console.log(\"Is flagged: \" + flagged);\n\n  State.update({\n    blacklisted: flagged === \"Blacklisted\",\n    greylisted: flagged !== \"Blacklisted\" && flagged !== \"Verified\",\n    flagged: flagged,\n  });\n  console.log(\"Is \" + state.accountId + \" flagged? \" + state.flagged);\n  return flagged;\n}\n\nfunction getAccountsWithProfile() {\n  const data = Social.keys(\"*/profile\", \"final\");\n\n  if (!data) {\n    return \"Loading\";\n  }\n\n  const accounts = Object.entries(data);\n\n  const allProfiles = [];\n\n  for (let i = 0; i < accounts.length; ++i) {\n    const accountId = accounts[i][0];\n    allProfiles.push(accountId);\n  }\n  return allProfiles;\n}\n\nconst onChangeRecipient = (recipient) => {\n  console.log(\"Recipient : \" + recipient);\n\n  State.update({\n    accountId: recipient,\n  });\n  loadFlagged();\n};\n\nfunction isFlagged(account) {\n  console.log(\"Starting is flagged check : \" + account);\n\n  const view = Near.view(\"registry.i-am-human.near\", \"account_flagged\", {\n    account: `${account}`,\n  });\n  console.log(\"View: \" + view?.[0]?.[1]?.[0]);\n}\n\nconst Main = styled.div`\n  display: grid;\n  gap: 3rem;\n  align-content: center;\n  grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));\n  justify-content: center;\n  margin-top: 5px;\n  width: 100%;\n  padding: 1rem;\n  .button {\n    padding: 0.75em 2em;\n    border-radius: 0.7em;\n    border: 1px solid #0d99ff;\n    transition: all 0.3s;\n    cursor: pointer;\n    color: #fff;\n    background: #0d99ff;\n    &:hover {\n      color: #0d99ff;\n      background: #fff;\n    }\n    @media screen and (max-width: 540px) {\n      padding: 0.5em 2em;\n    }\n  }\n`;\n\nconst Card = styled.div`\n  padding: 1em;\n  border: 1px solid #e5e8eb;\n  gap: 2em;\n  margin: 10px auto;\n  border-radius: 0.7em;\n  & input {\n    display: block;\n    padding: 0.5em;\n    width: 100%;\n    border: 1px solid #e5e8eb;\n    border-radius: 10px;\n    outline: none;\n    background: #f4f5f6;\n    color: #525c76;\n    :focus {\n      box-shadow: none;\n      border: 1px solid #0d99ff;\n    }\n    &::placeholder {\n      color: palevioletred;\n    }\n  }\n`;\n\nreturn (\n  <>\n    <Card>\n      Search NEAR Account\n      <Typeahead\n        id=\"async-example\"\n        className=\"type-ahead\"\n        isLoading={isLoading}\n        labelKey=\"search\"\n        minLength={1}\n        options={getAccountsWithProfile()}\n        onChange={(value) => onChangeRecipient(value)}\n        placeholder={state.accountId}\n      />\n    </Card>\n\n    <div>Are you flagged? {state.flagged}</div>\n\n    <Widget\n      src=\"nearefi.near/widget/ReFi.DAO.memberCard\"\n      props={{ accountId: state.accountId }}\n    />\n  </>\n);\n", "metadata": null, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/ndcplug.near/widget/NDC.isFlagged", "fact_widget_deployments_id": "803a024b614b0e23b273c56b8e76ba28", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
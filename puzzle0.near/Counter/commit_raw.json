{"tx_hash": "4wqZkk85V9SLKm8MJT8bT3mCEjZixtaAM3KPMutBPY27", "action_id_social": "2qgUqa9vY49aWTCMxz5hxis1NF6FdeTAmUxoHZbAj4x7-0-widget", "block_id": 104404707, "block_timestamp": "2023-10-28T18:15:29.870Z", "signer_id": "puzzle0.near", "widget_name": "Counter", "source_code": "const [count, setCount] = useState(0);\nconst [page, setPage] = useState(0);\nconst [payment, setPayment] = useState(0);\n\nlet cost_per_item = 0.05;\n\nconst getTotalRewards = () => {\n  return count * cost_per_item;\n};\n\nconst getBitcoinRewards = () => {\n  return ((count * cost_per_item) / bitcoinPrice()) * 100000000;\n};\n\nfunction bitcoinPrice() {\n  const response = fetch(\n    \"https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd\"\n  );\n  console.log(response);\n  const bitcoinPrice = response.body.bitcoin.usd;\n  return bitcoinPrice;\n}\n\nfunction handleStartNew() {\n  setCount(0); // Reset count to zero when Start New is clicked\n  setPage(1); // Move to the next page after resetting the count\n}\n\nfunction Page() {\n  switch (page) {\n    case 0: {\n      return (\n        <div>\n          <h1>Start A Recycling Session</h1>\n          <button onClick={() => handleStartNew()}>Start New</button>\n        </div>\n      );\n    }\n    case 1: {\n      return (\n        <div>\n          <h1>Recycling for Bitcoin</h1>\n          <p>Insert Can or Bottle</p>\n          <p>Count: {count}</p>\n          <button onClick={() => setCount(count + 1)}>+</button>\n          <button onClick={() => setPage(page - 1)} disabled={page === 0}>\n            Back\n          </button>\n          <button onClick={() => setPage(page + 1)} disabled={count === 0}>\n            Next\n          </button>\n        </div>\n      );\n    }\n    case 2: {\n      return (\n        <div>\n          <h2>Summary + Choose Payment</h2>\n          <p>Recycling Count: {count}</p>\n          <p>Price Per Recycled Item: ${cost_per_item} </p>\n          <p>Bottle Refund Amount: ${getTotalRewards()}</p>\n          <p>Bitcoin Price: ${bitcoinPrice()}</p>\n          <p>BTC Rewards Amount: {getBitcoinRewards()} Satoshis</p>\n          <p>Select Payment Type:</p>\n          <button onClick={() => setPage(page + 1)}>Cash</button>\n          <button onClick={() => setPage(page + 2)}>Bitcoin</button>\n        </div>\n      );\n    }\n    case 3: {\n      return (\n        <div>\n          <h2>Cash</h2>\n          <p>Bottle Refund Amount: ${getTotalRewards()}</p>\n          <p>Printing Receipt</p>\n          <button onClick={() => setPage(0)}>Complete</button>\n        </div>\n      );\n    }\n    case 4: {\n      return (\n        <div>\n          <h2>Bitcoin</h2>\n          <p>BTC Rewards Amount: {getBitcoinRewards()} Satoshis</p>\n          <p>Displaying LNURL</p>\n          <a href=\"https://imgur.com/PnpEJTj\">\n            <img\n              src=\"https://i.imgur.com/PnpEJTjb.png\"\n              title=\"source: imgur.com\"\n            />\n          </a>\n          <p></p>\n          <button onClick={() => setPage(0)}>Print</button>\n        </div>\n      );\n    }\n  }\n}\n\nreturn (\n  <div>\n    <Page />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/puzzle0.near/widget/Counter", "fact_widget_deployments_id": "c52769e3b84965059aac67580ab2e8a6", "inserted_timestamp": "2023-10-28T20:21:02.961Z", "modified_timestamp": "2023-10-28T20:21:02.961Z", "__row_index": 2}
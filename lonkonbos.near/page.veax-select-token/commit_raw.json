{"tx_hash": "BcmmNRgSTv1UHS3P3B5Ew7WNRERhJzeaHZWnM9T9qage", "action_id_social": "DcPz1Z55WmU7J47RSbPhMSvLNFbEFUMGqoAF5rDnZCk4-0-widget", "block_id": 116709600, "block_timestamp": "2024-04-12T20:51:54.141Z", "signer_id": "lonkonbos.near", "widget_name": "page.veax-select-token", "source_code": "const closeIcon = (\r\n  <svg\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    width=\"12\"\r\n    height=\"12\"\r\n    viewBox=\"0 0 12 12\"\r\n    fill=\"none\"\r\n  >\r\n    <path\r\n      d=\"M7.73284 6.00004L11.7359 1.99701C12.0368 1.696 12.0882 1.2593 11.8507 1.0219L10.9779 0.14909C10.7404 -0.0884125 10.3043 -0.0363122 10.0028 0.264491L6.00013 4.26743L1.99719 0.264591C1.69619 -0.036712 1.25948 -0.0884125 1.02198 0.14939L0.149174 1.0223C-0.0882276 1.2594 -0.0368271 1.6961 0.264576 1.99711L4.26761 6.00004L0.264576 10.0033C-0.0363271 10.3041 -0.0884276 10.7405 0.149174 10.978L1.02198 11.8509C1.25948 12.0884 1.69619 12.0369 1.99719 11.736L6.00033 7.73276L10.0029 11.7354C10.3044 12.037 10.7405 12.0884 10.978 11.8509L11.8508 10.978C12.0882 10.7405 12.0368 10.3041 11.736 10.0029L7.73284 6.00004Z\"\r\n      fill=\"white\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst iconsDefault = {\r\n  \"4691937a7508860f876c9c0a2a617e7d9e945d4b.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/woo-wtrue.png\",\r\n  \"wrap.near\": \"https://assets.ref.finance/images/w-NEAR-no-border.png\",\r\n  NEAR: \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCAzNiAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTgiIGN5PSIxOCIgcj0iMTcuNSIgZmlsbD0id2hpdGUiIHN0cm9rZT0iYmxhY2siLz4KPGNpcmNsZSBjeD0iMTgiIGN5PSIxOCIgcj0iMTcuNSIgZmlsbD0id2hpdGUiIHN0cm9rZT0iYmxhY2siLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMC42MDc4IDEyLjUwMjlWMjMuNjE5M0wxNi4yOTIgMTkuMzcyMUwxNi44NjA0IDE5Ljg3MDZMMTIuMDkzOCAyNi41ODQ0QzEwLjMyMjggMjguMjA5MiA3LjE5NzI3IDI3LjEwOTkgNy4xOTcyNyAyNC44NjIyVjExLjEzNzFDNy4xOTcyNyA4LjgxMjI4IDEwLjUwNTggNy43NTMzNCAxMi4yMTMzIDkuNTMxNkwyNS4zODY3IDIzLjI1MDRWMTIuNTkwMkwyMC4yNzEgMTYuMzgxMkwxOS43MDI1IDE1Ljg4MjdMMjMuNzU2NyA5LjYxNTZDMjUuNDQ4OSA3LjgwNDQyIDI4Ljc5NzMgOC44NTM3NiAyOC43OTczIDExLjE5NTNWMjQuNjE2M0MyOC43OTczIDI2Ljk0MTEgMjUuNDg4OCAyOCAyMy43ODEyIDI2LjIyMThMMTAuNjA3OCAxMi41MDI5WiIgZmlsbD0iIzBGMUQyNyIvPgo8L3N2Zz4K\",\r\n\r\n  \"6b175474e89094c44da98b954eedeac495271d0f.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/4943.png\",\r\n  \"berryclub.ek.near\": \"https://assets.ref.finance/images/banana.png\",\r\n  \"dac17f958d2ee523a2206206994597c13d831ec7.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/825.png\",\r\n  \"1f9840a85d5af5bf1d1762f925bdaddc4201f984.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/7083.png\",\r\n  \"514910771af9ca656af840dff83e8264ecf986ca.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/1975.png\",\r\n  \"a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/3408.png\",\r\n  \"2260fac5e5542a773aa44fbcfedf7c193bc2c599.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/3717.png\",\r\n  \"7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/7278.png\",\r\n  \"a0b73e1ff0b80914ab6fe0444e65848c4c34450b.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/3635.png\",\r\n  \"50d1c9771902476076ecfc8b2a83ad6b9355a4c9.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/4195.png\",\r\n  \"4fabb145d64652a948d72533023f6e7a623c7c53.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/4687.png\",\r\n  \"6f259637dcd74c767781e37bc6133cd6a68aa161.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/2502.png\",\r\n  \"6b3595068778dd592e39a122f4f5a5cf09c90fe2.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/6758.png\",\r\n  \"c011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/2586.png\",\r\n  \"c944e90c64b2c07662a292be6244bdf05cda44a7.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/6719.png\",\r\n  \"9f8f72aa9304c8b593d555f12ef6589cc3a579a2.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/1518.png\",\r\n  \"0bc529c00c6401aef6d220be8c6ea1667f6ad93e.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/5864.png\",\r\n  \"c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/2396.png\",\r\n  \"0316eb71485b0ab14103307bf65a021042c6d380.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/6941.png\",\r\n  \"111111111117dc0aa78b770fa6a738034120c302.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/8104.png\",\r\n  \"f5cfbc74057c610c8ef151a439252680ac68c6dc.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/55sGoBm.png\",\r\n  \"de30da39c46104798bb5aa3fe8b9e0e1f348163f.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/10052.png\",\r\n  \"a4ef4b0b23c1fc81d3f9ecf93510e64f58a4a016.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/4222.png\",\r\n  \"token.cheddar.near\": \"https://assets.ref.finance/images/cheddar.png\",\r\n  \"farm.berryclub.ek.near\": \"https://assets.ref.finance/images/cucumber.png\",\r\n  \"d9c2d319cd7e6177336b0a9c93c21cb48d84fb54.factory.bridge.near\":\r\n    \"https://assets.ref.finance/images/HAPI.png\",\r\n};\r\n\r\nconst { show, handleClose, handleSelect } = props;\r\n\r\nconst SearchIcon = (\r\n  <svg\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    width=\"18\"\r\n    height=\"18\"\r\n    viewBox=\"0 0 18 18\"\r\n    fill=\"none\"\r\n  >\r\n    <circle\r\n      cx=\"7.19239\"\r\n      cy=\"7.19238\"\r\n      r=\"5.08579\"\r\n      transform=\"rotate(-45 7.19239 7.19238)\"\r\n      stroke=\"#73818B\"\r\n      stroke-width=\"2\"\r\n    />\r\n    <path\r\n      d=\"M10.7891 10.7886L14.3853 14.3848\"\r\n      stroke=\"#73818B\"\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n    />\r\n  </svg>\r\n);\r\nconst REF_FI_CONTRACT = \"v2.ref-finance.near\";\r\n\r\nconst name = \"asadsa\";\r\n\r\nconst getTokenMeta = (token_id) => {\r\n  return Near.view(token_id, \"ft_metadata\");\r\n};\r\n\r\nconst globalWhiteList = Near.view(REF_FI_CONTRACT, \"get_whitelisted_tokens\");\r\n\r\nif (!globalWhiteList) return <div />;\r\n\r\nconst getTokensMeta = async () => {\r\n  if (!globalWhiteList) return {};\r\n  const metaList = globalWhiteList.map((token) => {\r\n    const metadata = getTokenMeta(token);\r\n\r\n    return {\r\n      ...metadata,\r\n      id: token,\r\n      icon: iconsDefault[token] || metadata.icon,\r\n    };\r\n  });\r\n\r\n  if (metaList)\r\n    return metaList.reduce(\r\n      (acc, cur, i) => {\r\n        return {\r\n          ...acc,\r\n          [globalWhiteList[i]]: {\r\n            ...cur,\r\n          },\r\n        };\r\n      },\r\n      {\r\n        NEAR: {\r\n          id: \"NEAR\",\r\n          name: \"NEAR\",\r\n          icon: iconsDefault[\"NEAR\"],\r\n          symbol: \"NEAR\",\r\n          decimals: 24,\r\n        },\r\n      }\r\n    );\r\n};\r\n\r\nconst tokensMeta = getTokensMeta();\r\n\r\nState.init({\r\n  searchBy: \"\",\r\n});\r\n\r\nconst inputOnChange = (e) => {\r\n  const value = e.target.value;\r\n  State.update({\r\n    searchBy: value,\r\n  });\r\n};\r\n\r\nconst filterFunc = (tokenMeta) => {\r\n  return (\r\n    state.searchBy === \"\" ||\r\n    tokenMeta.symbol.toLowerCase().includes(state.searchBy.toLowerCase())\r\n  );\r\n};\r\n\r\nconst TokenLine = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 8px 0px 8px 16px;\r\n  cusort: pointer;\r\n  :hover {\r\n    background: rgb(23, 41, 46);\r\n  }\r\n`;\r\n\r\nconst ListContainer = styled.div`\r\n  height: 500px;\r\n  overflow: auto;\r\n  ::-webkit-scrollbar {\r\n    width: 4px;\r\n    height: 4px;\r\n    border-radius: 3px;\r\n  }\r\n\r\n  @media (max-width: 736px) {\r\n    height: 60vh;\r\n  }\r\n\r\n  ::-webkit-scrollbar-track {\r\n    box-shadow: inset 0 0 6px rgba(0, 0, 0, 0);\r\n  }\r\n\r\n  ::-webkit-scrollbar-thumb {\r\n    background: #2f4d63;\r\n    border-radius: 2px;\r\n  }\r\n`;\r\n\r\nconst Input = styled.input`\r\n  appearance: none;\r\n  outline: none;\r\n  width: 100%;\r\n  background: none;\r\n  border: none;\r\n  color: rgb(115, 129, 139);\r\n  padding: 8px 0px 8px 4px;\r\n\r\n  ::placeholder {\r\n    color: #7e8a93;\r\n  }\r\n`;\r\n\r\nconst ModalContainer = styled.div`\r\n  width: 325px;\r\n  border-radius: 12px;\r\n  background: rgb(27, 45, 52);\r\n  color: white;\r\n  padding-top: 16px;\r\n  z-index: 999;\r\n  position: fixed;\r\n  top: 15vh;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  padding-bottom: 8px;\r\n`;\r\n\r\nconst Wrapper = styled.div`\r\n  position: fixed;\r\n  height: 100vh;\r\n  width: 100vw;\r\n  left: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  top: 0;\r\n  z-index: 99;\r\n`;\r\n\r\nif (!show) return <div />;\r\nconsole.log(\"tokensMeta\", tokensMeta);\r\nreturn (\r\n  <>\r\n    <Wrapper\r\n      onClick={() => {\r\n        handleClose();\r\n      }}\r\n    ></Wrapper>\r\n    <ModalContainer>\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          justifyContent: \"space-between\",\r\n        }}\r\n        class=\"mx-3\"\r\n      >\r\n        <span>Select Token</span>\r\n\r\n        <span\r\n          style={{\r\n            cursor: \"pointer\",\r\n          }}\r\n          onClick={() => {\r\n            handleClose();\r\n          }}\r\n        >\r\n          {closeIcon}\r\n        </span>\r\n      </div>\r\n\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          border: \"1px solid #2E4449\",\r\n          borderRadius: \"12px\",\r\n          paddingLeft: \"8px\",\r\n          marginTop: \"8px\",\r\n        }}\r\n        class=\"mx-3\"\r\n      >\r\n        {SearchIcon}\r\n        <Input\r\n          class=\"search-token-input\"\r\n          placeholder=\"Search token...\"\r\n          onChange={inputOnChange}\r\n          value={state.searchBy}\r\n        />\r\n      </div>\r\n\r\n      <ListContainer>\r\n        {[\"NEAR\", ...globalWhiteList]\r\n          .filter((token_id) => !!filterFunc(tokensMeta[token_id]))\r\n          .map((token_id) => {\r\n            if (\r\n              token_id == \"token.lonkingnearbackto2024.near\" ||\r\n              token_id == \"NEAR\"\r\n            ) {\r\n              return (\r\n                <TokenLine\r\n                  onClick={(e) => {\r\n                    // e.preventDefault();\r\n\r\n                    handleSelect(tokensMeta[token_id]);\r\n                    handleClose();\r\n                  }}\r\n                >\r\n                  <img\r\n                    style={{\r\n                      borderRadius: \"100%\",\r\n                      height: \"36px\",\r\n                      width: \"36px\",\r\n                      marginRight: \"4px\",\r\n                    }}\r\n                    src={tokensMeta[token_id].icon || iconsDefault[token_id]}\r\n                  />\r\n\r\n                  <div\r\n                    style={{\r\n                      display: \"flex\",\r\n                      flexDirection: \"column\",\r\n                    }}\r\n                  >\r\n                    <span>{tokensMeta[token_id].symbol}</span>\r\n                    <span\r\n                      style={{\r\n                        color: \"#7E8A93\",\r\n                        fontSize: \"10px\",\r\n                      }}\r\n                    >\r\n                      {tokensMeta[token_id].name}\r\n                    </span>\r\n                  </div>\r\n                </TokenLine>\r\n              );\r\n            }\r\n          })}\r\n      </ListContainer>\r\n    </ModalContainer>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/lonkonbos.near/widget/page.veax-select-token", "fact_widget_deployments_id": "cf1f5277591da5b2fe3993283d76c2cf", "inserted_timestamp": "2024-04-12T22:36:04.253Z", "modified_timestamp": "2024-04-12T22:36:04.253Z", "__row_index": 0}
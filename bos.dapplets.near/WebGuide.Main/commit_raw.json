{"tx_hash": "6TfFuMP1Gv1XatsQ6j271YQe5t5sR9afzVuneUSAse6h", "action_id_social": "ArGoqp65kiZ8Ud6zR9yEqS8AwhyLiBp8VGt8HgMvx1at-0-widget", "block_id": 118437934, "block_timestamp": "2024-05-07T13:30:11.463Z", "signer_id": "bos.dapplets.near", "widget_name": "WebGuide.Main", "source_code": "const OverlayTriggerWrapper = styled.div`\n  display: flex;\n  z-index: 500;\n\n  .OverlayTrigger {\n    position: absolute;\n    background: #db504a;\n    border: 1px solid #db504a;\n    width: 6px;\n    height: 49px;\n    right: -6px;\n    top: 10px;\n    border-radius: 0px 4px 4px 0px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-sizing: border-box;\n    z-index: 79;\n  }\n`\n\nconst guideConfig = {\n  chapters: [\n    {\n      id: \"bos.dapplets.near/gateway/MutableWebExtension\",\n      type: 'infobox',\n      if: { id: \"1694995344461894022\" }, // ToDo: should be another trigger\n      showChecked: true,\n      pages: [\n        {\n          id: \"bos.dapplets.near/gateway/MutableWebExtension/Welcome\",\n          title: \"You\u2019re entering Mutable Web\",\n          status: [{ warning: 'Warning message for Page 0' }],\n          content: \"\\nMutable Web is a new web3 paradigm that allows anyone to add custom functionality to existing websites and share them within your community\u2014 no matter who owns the website.\\n\\nBecome the co-owner of any website you are using!\\n\\n### Mutation switch\\n\\n![](https://raw.githubusercontent.com/dapplets/bos-components/main/assets/onboarding-video-001.webp)\\n\\nYou can switch between website mutations created by different communities.\\n\\n[See more examples on our playground](https://twitter.com/MrConCreator)\\n\",\n        },\n      ]\n    },\n    {\n      id: \"bos.dapplets.near/gateway/MutableWebExtensionNotch\",\n      type: 'callout',\n      namespace: \"mweb\",\n      contextType: \"notch\",\n      injectTo: \"hidden\",\n      if: { id: { eq: \"notch\" } },\n      arrowTo: \"context\",\n      pages: [\n        {\n          id: \"bos.dapplets.near/gateway/MutableWebExtensionNotch/Notch\",\n          title: \"it's a mutation switch. Open it.\",\n          status: [{ info: 'Click on dropdown box.' }],\n          content: \"Aenean adipiscing nulla sollicitudin nibh enim. Nulla id vestibulum proin nullam scelerisque id.\",\n        },\n      ]\n    },\n    {\n      id: \"bos.dapplets.near/gateway/MutableWebExtensionDropdown/1\",\n      type: 'callout',\n      namespace: \"mweb\",\n      contextType: \"mutation\",\n      injectTo: \"hidden\",\n      if: { id: { eq: \"bos.dapplets.near/mutation/Sandbox\" } },\n      arrowTo: \"context\",\n      pages: [\n        {\n          id: \"bos.dapplets.near/gateway/MutableWebExtensionDropdown/1/1\",\n          title: \"It's a sandbox story first (1/2)\",\n          status: [],\n          content: \"We are now in a sandbox mutation. Through it, we can suspendisse mattis interdum.\",\n        },\n        {\n          id: \"bos.dapplets.near/gateway/MutableWebExtensionDropdown/1/2\",\n          title: \"It's a sandbox story first (2/2)\",\n          status: [],\n          content: \"Auctor volutpat nisl quis. Scelerisque morbi eget volutpat aliquet vitae curabitur non.\",\n        },\n      ]\n    },\n    {\n      id: \"bos.dapplets.near/gateway/MutableWebExtensionDropdown/2\",\n      type: 'callout',\n      namespace: \"mweb\",\n      contextType: \"notch\",\n      injectTo: \"hidden\",\n      if: { id: { eq: \"mutations-list-block\" } },\n      arrowTo: \"context\",\n      pages: [\n        {\n          id: \"bos.dapplets.near/gateway/MutableWebExtensionDropdown/2/1\",\n          title: \"It's a sandbox story inner\",\n          status: [],\n          content: \"We are now in a sandbox mutation. Through it, we can suspendisse mattis interdum auctor volutpat nisl quis. Scelerisque morbi eget volutpat aliquet vitae curabitur non.\",\n        },\n      ]\n    },\n    {\n      id: \"bos.dapplets.near/gateway/MutableWebExtensionDropdown/3\",\n      type: 'callout',\n      namespace: \"mweb\",\n      contextType: \"notch\",\n      injectTo: \"hidden\",\n      if: { id: { eq: \"mutate-button\" } },\n      arrowTo: \"context\",\n      pages: [\n        {\n          id: \"bos.dapplets.near/gateway/MutableWebExtensionDropdown/3/1\",\n          title: \"It's a sandbox story last\",\n          status: [],\n          content: \"We are now in a sandbox mutation. Through it, we can suspendisse mattis interdum auctor volutpat nisl quis. Scelerisque morbi eget volutpat aliquet vitae curabitur non.\",\n        },\n      ]\n    },\n    {\n      id: \"bos.dapplets.near/app/Tipping/1\",\n      type: 'callout',\n      namespace: \"bos.dapplets.near/parser/twitter\",\n      contextType: \"post\",\n      injectTo: \"avatar\",\n      if: { id: { eq: \"1694995344461894022\" } },\n      arrowTo: \"insPoint\",\n      pages: [\n        {\n          id: \"bos.dapplets.near/app/Tipping/1/1\",\n          status: [],\n          title: \"It's a Tip app\",\n          content: \"Tortor massa massa placerat pulvinar vestibulum. Dapibus in lacus donec laoreet fringilla massa arcu.\",\n        },\n      ],\n    },\n    {\n      id: \"bos.dapplets.near/app/Tipping/2\",\n      type: 'callout',\n      namespace: \"bos.dapplets.near/parser/twitter\",\n      contextType: \"post\",\n      injectTo: \"southPanel\",\n      if: { id: { eq: \"1694995344461894022\" } },\n      insteadOf: {\n        linkId: \"2dec2fe13441c1432d7a881e9cb58659\",\n      },\n      pages: [\n        {\n          id: \"bos.dapplets.near/app/Tipping/2/1\",\n          status: [],\n          title: \"It's a Tip app\",\n          content: \"Tortor massa massa placerat pulvinar vestibulum. Dapibus in lacus donec laoreet fringilla massa arcu.\",\n        },\n      ],\n    },\n    {\n      id: \"bos.dapplets.near/mutation/EarTrigger\",\n      type: 'callout',\n      namespace: \"mweb\",\n      contextType: \"ear-trigger\",\n      injectTo: \"hidden\",\n      if: { id: { eq: \"1694995344461894022\" } },\n      arrowTo: \"context\",\n      pages: [\n        {\n          id: \"bos.dapplets.near/mutation/EarTrigger/1\",\n          status: [],\n          title: \"It's an Ear Trigger\",\n          content: 'Page 2 content',\n        },\n      ],\n    },\n  ],\n}\n\nconst [chapterCounter, setChapterCounter] = useState(0)\nconst [pageCounter, setPageCounter] = useState(0)\n\nconst handleClose = () => {\n  console.log('close')\n}\n\nconst handleChapterDecrement = () => {\n  if (chapterCounter !== 0) {\n    setChapterCounter((val) => val - 1)\n    setPageCounter(\n      guideConfig?.chapters[chapterCounter - 1]?.pages?.length\n        ? guideConfig?.chapters[chapterCounter - 1]?.pages?.length - 1\n        : 0\n    )\n  }\n}\n\nconst handleChapterIncrement = () => {\n  setChapterCounter((val) => Math.min(val + 1, guideConfig?.chapters?.length - 1))\n  setPageCounter(0)\n}\n\nconst handleClickPrev = () => {\n  if (!pageCounter) {\n    handleChapterDecrement()\n  } else {\n    setPageCounter((val) => val - 1)\n  }\n}\n\nconst handleClickNext = () => {\n  if (pageCounter === guideConfig?.chapters[chapterCounter]?.pages.length - 1) {\n    handleChapterIncrement()\n  } else {\n    setPageCounter((val) => val + 1)\n  }\n}\n\nconst CalloutsWrapper = (arrowTo) => ({ children, attachContextRef, attachInsPointRef }) => {\n  const currentChapter = guideConfig?.chapters[chapterCounter]\n  const pages = currentChapter?.pages\n  const currentPage = pages[pageCounter]\n  const status = currentPage?.status.length && Object.entries(currentPage?.status[0])[0] // ToDo: mocked!!!\n\n  const buttons = []\n  if (chapterCounter || pageCounter) {\n    buttons.push({\n      variant: \"secondary\",\n      disabled: false,\n      onClick: handleClickPrev,\n      label: \"Prev\",\n    })\n  }\n  if (chapterCounter === guideConfig?.chapters?.length - 1 && pageCounter === guideConfig?.chapters[chapterCounter]?.pages.length - 1) {\n    buttons.push({\n      variant: \"primary\",\n      disabled: false,\n      onClick: handleClose,\n      label: \"Finish\",\n    })\n  } else (\n    buttons.push({\n      variant: \"primary\",\n      disabled: false,\n      onClick: handleClickNext,\n      label: \"Next\",\n    })\n  )\n\n  return  (\n    <Widget\n      src=\"bos.dapplets.near/widget/WebGuide.OverlayTrigger\"\n      loading={children}\n      props={{\n        type: currentChapter?.type,\n        navi: {\n          currentChapterIndex: chapterCounter,\n          totalChapters: guideConfig?.chapters?.length,\n          currentPageIndex: pageCounter,\n          totalPages: pages.length,\n        },\n        onClose: handleClose,\n        buttons,\n        status: status && {\n          type: status[0],\n          text: status[1],\n        },\n        title: currentPage?.title,\n        content: currentPage?.content,\n        showChecked: currentChapter.showChecked,\n        children:\n          arrowTo === \"context\"\n            ? ({ ref }) => {\n                attachContextRef(ref);\n                return children;\n              }\n            : arrowTo === \"insPoint\"\n            ? ({ ref }) => {\n                attachInsPointRef(ref);\n                return children;\n              }\n            : children,\n      }}\n    />\n  )\n}\n\nconst InfoBoxesWrapper = () => {\n  const currentChapter = guideConfig?.chapters[chapterCounter]\n  const pages = currentChapter?.pages\n  const currentPage = pages[pageCounter]\n  const status = currentPage?.status.length && Object.entries(currentPage?.status[0])[0] // ToDo: mocked!!!\n\n  const buttons = []\n  if (chapterCounter || pageCounter) {\n    buttons.push({\n      variant: \"secondary\",\n      disabled: false,\n      onClick: handleClickPrev,\n      label: \"Prev\",\n    })\n  }\n  if (chapterCounter === guideConfig?.chapters?.length - 1 && pageCounter === guideConfig?.chapters[chapterCounter]?.pages.length - 1) {\n    buttons.push({\n      variant: \"primary\",\n      disabled: false,\n      onClick: handleClose,\n      label: \"Finish\",\n    })\n  } else (\n    buttons.push({\n      variant: \"primary\",\n      disabled: false,\n      onClick: handleClickNext,\n      label: \"Next\",\n    })\n  )\n\n  return (\n    <Widget\n      src=\"bos.dapplets.near/widget/WebGuide.InfoBox\"\n      props={{\n        type: currentPage.type,\n        navi: {\n          currentChapterIndex: chapterCounter,\n          totalChapters: guideConfig?.chapters?.length,\n          currentPageIndex: pageCounter,\n          totalPages: pages.length,\n        },\n        buttons,\n        status: status && {\n          type: status[0],\n          text: status[1],\n        },\n        title: currentPage?.title,\n        content: currentPage?.content,\n        showChecked: currentChapter.showChecked,\n      }}\n    />\n  )\n}\n\nreturn guideConfig?.chapters[chapterCounter]?.type === 'infobox' ? (\n  <OverlayTriggerWrapper>\n    <DappletOverlay>\n      <InfoBoxesWrapper />\n    </DappletOverlay>\n  </OverlayTriggerWrapper>\n  ) : (\n  <MuWebWrapperPortal\n    target={{\n      namespace: guideConfig?.chapters[chapterCounter]?.namespace,\n      contextType: guideConfig?.chapters[chapterCounter]?.contextType,\n      injectTo: guideConfig?.chapters[chapterCounter]?.injectTo,\n      if: guideConfig?.chapters[chapterCounter]?.if,\n      insteadOf: guideConfig?.chapters[chapterCounter]?.insteadOf,\n    }}\n    component={CalloutsWrapper(guideConfig?.chapters[chapterCounter]?.arrowTo)}\n  />\n)\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bos.dapplets.near/widget/WebGuide.Main", "fact_widget_deployments_id": "9d5549f871b52b2244bd17893e25b854", "inserted_timestamp": "2024-05-07T14:39:41.715Z", "modified_timestamp": "2024-05-07T14:39:41.715Z", "__row_index": 3}
{"tx_hash": "FKip5aJmYdUGom9cJKq7Zsi8EUQEDmQcoQn8GaP7Xavw", "action_id_social": "APej4177MQy9YkMw8wu8buk2TY4G5PBB4vRVEp6yjoJK-0-widget", "block_id": 111024701, "block_timestamp": "2024-01-22T08:47:51.451Z", "signer_id": "bos.dapplets.near", "widget_name": "Paywall.Form", "source_code": "const { linkId, CONTRACT_ADDRESS } = props\n\nState.init({\n  img: null,\n  isUpload: false,\n  amount: 1,\n});\n\nconst uploadFileUpdateState = (body) => {\n  asyncFetch(\"https://ipfs.near.social/add\", {\n    method: \"POST\",\n    headers: { Accept: \"application/json\" },\n    body,\n  }).then((res) => {\n    const cid = res.body.cid;\n    State.update({ img: { cid } });\n  });\n};\n\nconst filesOnChange = (files) => {\n  if (files) {\n    State.update({ img: { uploading: true, cid: null } });\n    uploadFileUpdateState(files[0]);\n  }\n};\n\nconst amountOnChange = ({ target }) => {\n  State.update({ amount: target.value });\n};\n\nconst sendOnChange = () => {\n  try {\n    // State.update({ loading: true })\n    Near.call(\n      CONTRACT_ADDRESS,\n      \"add_paid_content\",\n      {\n        link: `https://ipfs.near.social/ipfs/${state.img.cid}`,\n        cost: state.amount,\n        context_id: linkId\n      }\n    );\n    // setTimeout(() => State.update({ loading: false }), 3000)\n  } catch (err) {\n    console.error(err);\n    // State.update({ isUpload: false });\n  }\n};\n\nconst cancelOnChange = () => {\n  State.update({\n    img: null,\n    isUpload: false,\n    amount: 1,\n  });\n};\n\nconst iconBtnUpload = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n  >\n    <path\n      d=\"M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15\"\n      stroke=\"white\"\n      stroke-width=\"2\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n    <path\n      d=\"M17 8L12 3L7 8\"\n      stroke=\"white\"\n      stroke-width=\"2\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n    <path\n      d=\"M12 3V15\"\n      stroke=\"white\"\n      stroke-width=\"2\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n  </svg>\n);\n\nconst WrapperWidget = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: 509px;\n  padding: 10px;\n  height: 247px;\n  border-radius: 16px;\n  border: 1px solid #8899a6;\n  background: #fff;\n  box-sizing: border-box;\n  .ButtonUpload {\n    cursor: pointer;\n    border-radius: 4px;\n    background: #3d7fff;\n    box-sizing: border-box;\n    width: 128px;\n    height: 44px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 6px;\n    color: #fff;\n    font-family: Roboto;\n    font-size: 14px;\n    font-weight: 400;\n    line-height: normal;\n    &:hover {\n      opacity: 0.5;\n    }\n  }\n`;\n\nconst Title = styled.div`\n  color: #222;\n  font-family: Roboto;\n  font-size: 18px;\n  font-weight: 700;\n  line-height: normal;\n  padding-bottom: 10px;\n`;\n\nconst InputsBlock = styled.div`\n  border-radius: 4px;\n  border: 1px solid #c1c6ce;\n  padding: 10px;\n  width: 489px;\n  height: 142px;\n  margin-bottom: 14px;\n  box-sizing: border-box;\n`;\n\nconst UploadBlock = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 14px;\n  box-sizing: border-box;\n`;\n\nconst FileInput = styled.input`\n  border-radius: 4px;\n  background: #e7ecef;\n  display: flex;\n  height: 44px;\n  padding: 10px;\n  width: 331px;\n  font-family: Roboto;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: normal;\n  color: #222;\n  border: none;\n  outline: none;\n  box-sizing: border-box;\n`;\n\nconst BlockAmount = styled.div`\n  border-radius: 4px;\n  border: 1px solid #c1c6ce;\n  background: #fff;\n\n  display: flex;\n  height: 44px;\n  padding: 4px 10px;\n  width: 469px;\n  flex-direction: column;\n  box-sizing: border-box;\n`;\n\nconst LabelAmount = styled.div`\n  color: #919191;\n  font-family: Roboto;\n  font-size: 12px;\n  font-weight: 400;\n  line-height: normal;\n`;\n\nconst ButtonsBlock = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 10px;\n  width: 489px;\n  box-sizing: border-box;\n`;\n\nconst InputAmount = styled.input`\n  color: #222;\n  font-family: Roboto;\n  font-size: 14px;\n  background: #fff;\n  font-weight: 400;\n  line-height: normal;\n  border: none;\n  outline: none;\n  width: 449px;\n  height: 16px;\n  box-sizing: border-box;\n`;\n\nconst ButtonCancel = styled.button`\n  border-radius: 4px;\n  display: flex;\n  background: #c1c6ce;\n  border: none;\n  outline: none;\n  justify-content: center;\n  align-items: center;\n  color: #fff;\n  font-family: Roboto;\n  font-size: 14px;\n  width: 230px;\n  height: 44px;\n  font-weight: 400;\n  line-height: 149%;\n  box-sizing: border-box;\n  &:hover {\n    opacity: 0.3;\n  }\n`;\n\nconst ButtonSend = styled.button`\n  border-radius: 4px;\n  display: flex;\n  background: #3d7fff;\n  border: none;\n  outline: none;\n  justify-content: center;\n  align-items: center;\n  color: #fff;\n  font-family: Roboto;\n  font-size: 14px;\n  width: 230px;\n  height: 44px;\n  font-weight: 400;\n  line-height: 149%;\n  box-sizing: border-box;\n  &:hover {\n    opacity: 0.5;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n  }\n`;\n\nreturn (\n  <>\n    {state.img.cid && state.isUpload ? null : (\n      <WrapperWidget>\n        <Title>Configure your content</Title>\n        <InputsBlock>\n          <UploadBlock>\n            <FileInput readOnly value={state.img.cid ? state.img.cid : \"\"} />\n\n            <Files\n              multiple={false}\n              accepts={[\"image/*\"]}\n              minFileSize={1}\n              clickable\n              className=\"ButtonUpload\"\n              onChange={filesOnChange}\n            >\n              {iconBtnUpload}\n              {state.img?.uploading ? <> Uploading </> : \"Upload image\"}\n            </Files>\n          </UploadBlock>\n\n          <BlockAmount>\n            <LabelAmount>Price (NEAR)</LabelAmount>\n            <InputAmount\n              value={state.amount ? state.amount : \"\"}\n              onChange={amountOnChange}\n            />\n          </BlockAmount>\n        </InputsBlock>\n        <ButtonsBlock>\n          <ButtonCancel onClick={cancelOnChange}>Cancel</ButtonCancel>\n          <ButtonSend\n            onClick={sendOnChange}\n            disabled={!state.img || !state.amount}\n          >\n            Send\n          </ButtonSend>\n        </ButtonsBlock>\n      </WrapperWidget>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bos.dapplets.near/widget/Paywall.Form", "fact_widget_deployments_id": "339345b468f54fcf5a80cd4e3503e35b", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
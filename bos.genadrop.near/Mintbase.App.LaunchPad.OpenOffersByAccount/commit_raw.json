{"tx_hash": "3t96h1uYoHMgn9jc9n47EQtz6gnVTfEGqNifEKEfXyoR", "action_id_social": "CBzRbo8PRnMDbtczsKnmXbVqYW4FD4G4VnDGjaUKJT8z-0-widget", "block_id": 117657323, "block_timestamp": "2024-04-26T10:09:01.207Z", "signer_id": "bos.genadrop.near", "widget_name": "Mintbase.App.LaunchPad.OpenOffersByAccount", "source_code": "const { getOpenOffersByAccount, getTimePassed } = VM.require(\n  \"bos.genadrop.near/widget/Mintbase.utils.sdk\"\n) || {\n  getOpenOffersByAccount: () => <></>,\n  getTimePassed: () => <></>,\n};\nconst accountId = props.accountId || context.accountId;\nconst perPage = 50;\nconst nearLogo =\n  \"https://ipfs.near.social/ipfs/bafkreib2cfbayerbbnoya6z4qcywnizqrbkzt5lbqe32whm2lubw3sywr4\";\nconst _address = (address, _limit) => {\n  const limit = _limit || 20;\n  if (address.length > limit) return address.slice(0, 10) + \"...\";\n  else return address;\n};\nconst YoctoToNear = (offer_priceYocto) => {\n  return new Big(offer_priceYocto || 0)\n    .div(new Big(10).pow(24))\n    .toFixed(2)\n    .toString();\n};\nconst statusColor = {\n  open: { dark: \"#9fed8f\", light: \"#0a7d6c\" },\n  closed: { dark: \"#ed5a5a\", light: \"#d9534f\" },\n};\nconst OpenOffersByAccount = ({ isDarkModeOn }) => {\n  const [page, setPage] = useState(1);\n  const [data, setData] = useState(null);\n  const [showTable, setShowTable] = useState(true);\n  useEffect(() => {\n    getOpenOffersByAccount({\n      account: accountId,\n      limit: perPage,\n      offset: (page - 1) * perPage,\n    })\n      .then(({ data, errors }) => {\n        if (errors) {\n          // handle those errors like a pro\n          console.error(errors);\n        }\n        // do something great with this precious data\n        console.log(\"data\", data);\n        setData(data);\n      })\n      .catch((error) => {\n        // handle errors from fetch itself\n        console.error(error);\n      });\n  }, [limit, offset, page]);\n  const Container = styled.div`\n    background: ${isDarkModeOn ? \"#1f2031\" : \"#fff\"};\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    border-radius: 4px;\n    height: fit-content;\n    flex: 1;\n    width: 100%;\n    @media (max-width: 500px) {\n      width: 100vw;\n      min-width: 100vw;\n      font-size: 12px;\n    }\n    .topic_line {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      width: 100%;\n      padding: 1.5rem;\n      color: ${isDarkModeOn ? \"#fff\" : \"#000\"};\n      border-bottom: 1px solid\n        ${showTable\n          ? isDarkModeOn\n            ? \"rgba(40, 42, 58, 1)\"\n            : \"rgba(210, 212, 218, 1)\"\n          : \"transparent\"};\n      cursor: pointer;\n      i {\n        transition: all 300ms;\n        font-size: 1.5rem;\n      }\n      p {\n        margin: 0;\n        font-size: 16px;\n        font-weight: 600;\n      }\n    }\n    .table_main {\n      display: flex;\n      overflow: auto;\n      flex-direction: column;\n      width: 100%;\n      min-width: 500px;\n      .header {\n        display: grid;\n        grid-template-columns: repeat(7, minmax(150px, 1fr));\n        align-items: center;\n        justify-content: space-between;\n        wrap: nowrap;\n        padding: 0.5rem 0;\n        color: ${isDarkModeOn ? \"#B3B5BD\" : \"#404252\"};\n        margin-bottom: 1rem;\n        font-weight: 500px;\n        div {\n          padding-bottom: 1rem;\n          text-align: center;\n          border-bottom: 2px solid\n            ${isDarkModeOn ? \"rgba(16,18,35,1)\" : \"rgba(210,212,218,1)\"};\n        }\n        & > div:first-child {\n          text-align: left;\n          padding-left: 28px;\n        }\n        ${cursomStyle}\n      }\n      .trx-row {\n        display: grid;\n        grid-template-columns: repeat(7, minmax(150px, 3fr));\n        justify-content: space-between;\n        padding: 1rem 0;\n        border-bottom: 1px solid\n          ${isDarkModeOn ? \"rgba(40, 42, 58, 1)\" : \"rgba(210, 212, 218, 1)\"};\n        div,\n        a,\n        span {\n          text-align: center;\n          margin: auto;\n        }\n        .tab {\n          text-decoration: none;\n          text-align: left;\n          display: flex;\n          align-items: baseline;\n          justify-content: flex-end;\n          text-decoration: none;\n          gap: 0.2rem;\n          border-radius: 0.25rem; /* Assuming default border radius */\n          color: ${isDarkModeOn\n            ? \"#C5D0FF\"\n            : \"#4F58A3\"}; /* Ternary for text color */\n          padding: 8px 12px; /* Assuming Tailwind CSS default spacing unit */\n          font-weight: 500;\n          font-size: 16px;\n          line-height: 18px;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); /* Assuming Tailwind CSS default timing function and duration */\n          white-space: nowrap;\n          &:focus {\n            outline: 2px solid transparent; /* Assuming Tailwind CSS default focus outline */\n            outline-offset: 2px; /* Assuming Tailwind CSS default focus outline offset */\n            box-shadow: 0 0 0 2px\n              ${isDarkModeOn\n                ? \"rgba(59, 130, 246, 0.5)\"\n                : \"rgba(66, 153, 225, 0.5)\"}; /* Ternary for box-shadow */\n            background-color: ${isDarkModeOn\n              ? \"rgba(59, 130, 246, 0.35)\"\n              : \"rgba(66, 153, 225, 0.15)\"}; /* Ternary for background-color */\n          }\n          &:hover {\n            background-color: ${isDarkModeOn\n              ? \"rgba(59, 130, 246, 0.15)\"\n              : \"rgba(66, 153, 225, 0.15)\"}; /* Ternary for background-color */\n          }\n          &.disabled {\n            cursor: not-allowed;\n            background-color: unset;\n            ${\"\" /* set colors to gray colors */};\n            color: ${isDarkModeOn ? \"#B3B5BD\" : \"#777986\"};\n            &:hover {\n              background-color: unset;\n            }\n            &:focus {\n              background-color: unset;\n            }\n          }\n          cursor: pointer;\n          @media (max-width: 768px) {\n            padding: 12px;\n            font-size: 12px;\n            line-height: 14px;\n          }\n        }\n        & > div:first-child {\n          margin: unset;\n          margin: auto auto auto 24px;\n        }\n        .title {\n          display: flex;\n          align-items: center;\n          text-decoration: none;\n          gap: 10px;\n          div {\n            white-space: nowrap;\n            height: 40px;\n            display: flex;\n            color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n            align-items: center;\n            justify-content: center;\n            padding: 10px;\n            border-radius: 2px;\n            transition: all 200ms;\n            :hover {\n              background: ${color};\n              color: white;\n            }\n          }\n          img {\n            object-fit: cover;\n            width: 40px;\n            height: 40px;\n          }\n        }\n        .time {\n          display: flex;\n          align-items: center;\n          gap: 0.5rem;\n          color: ${isDarkModeOn ? \"#fff\" : \"#000\"};\n          white-space: nowrap;\n          i {\n            box-sizing: content-box;\n            color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n            cursor: pointer;\n            border-radius: 2px;\n            transition: all 200ms ease 0s;\n            :hover {\n              fill: white;\n              background: ${color};\n            }\n          }\n        }\n      }\n      .price {\n        display: flex;\n        gap: 4px;\n        align-items: center;\n        font-weight: 600;\n        color: ${isDarkModeOn ? \"#fff\" : \"#000\"};\n        img {\n          width: 14px;\n          filter: invert(${isDarkModeOn ? 1 : 0});\n        }\n      }\n      @media (max-width: 500px) {\n        .header,\n        .trx-row {\n          grid-template-columns: repeat(7, 150px);\n        }\n      }\n    }\n  `;\n  const tableToggleHander = () => {\n    setShowTable((prev) => !prev);\n  };\n  const withdrawOfferHandler = () => null;\n  const offers = data.nft_offers;\n  const totalItems = data.nft_offers_aggregate.aggregate.count;\n  console.log(\"offers\", offers);\n  return (\n    <Container>\n      <div className=\"topic_line\" onClick={tableToggleHander}>\n        <p>Offered To Me</p>\n        <i\n          className={`bi bi-chevron-${showTable ? \"up\" : \"down\"}`}\n          style={{\n            fontSize: \"1.5rem\",\n          }}\n        ></i>\n      </div>\n      {showTable && (\n        <div className=\"table_main\">\n          <div className=\"header\">\n            <div>ID</div>\n            <div>NFT</div>\n            <div>Auction Status</div>\n            <div>Amount</div>\n            <div>To</div>\n            <div>Action</div>\n            <div>Created</div>\n          </div>\n          <div>\n            {offers &&\n              offers.map((offer) => {\n                const hashData = fetch(\n                  `https://${\n                    accountId.endsWith(\".testnet\") ? \"api3-testnet\" : \"api3\"\n                  }.nearblocks.io/v1/search?keyword=${offer.receipt_id}`\n                );\n                const regex = /https?:\\/\\/[^ ]+/;\n                const found = regex.test(offer.nft_token.media);\n                const imageUrl = found\n                  ? offer.nft_token.media\n                  : `${offer.nft_token.base_uri}/${offer.nft_token.media}`;\n                const dateTimeNow = new Date().getTime();\n                const expiresAt = new Date(offer.expires_at).getTime();\n                const withdrawnAt = new Date(offer.withdrawn_at).getTime();\n                const isExpired = expiresAt > dateTimeNow || withdrawnAt;\n                return (\n                  <div className=\"trx-row\" key={offer.token_id}>\n                    <div>\n                      <Link\n                        to={\n                          offer.metadata_id\n                            ? `/bos.genadrop.near/widget/Mintbase.App.Index?page=nftDetails&metadataId=${offer?.token.metadata_id?.replace(\n                                \":\",\n                                \"%3A\"\n                              )}`\n                            : \"#\"\n                        }\n                        target=\"_blank\"\n                        className=\"title tab\"\n                      >\n                        {offer?.token_id ? offer.token_id : \"No ID\"}\n                      </Link>\n                    </div>\n                    <div className=\"title\">\n                      {\" \"}\n                      <img\n                        src={\n                          \"https://image-cache-service-z3w7d7dnea-ew.a.run.app/media?url=\" +\n                          imageUrl\n                        }\n                        alt={offer.nt_token.title}\n                      />\n                      <Link\n                        to={\n                          offer.token.metadata_id\n                            ? `/bos.genadrop.near/widget/Mintbase.App.Index?page=nftDetails&metadataId=${offer?.token.metadata_id?.replace(\n                                \":\",\n                                \"%3A\"\n                              )}`\n                            : \"#\"\n                        }\n                        target=\"_blank\"\n                        className=\"tab\"\n                      >\n                        {offer.nft_token.title\n                          ? offer.nft_token.title.length > 7\n                            ? `${offer.nft_token.title.substring(0, 6)}...`\n                            : offer.nft_token.title\n                          : \"No Title\"}\n                      </Link>\n                    </div>\n                    <div\n                      className={`tab ${\"status\"}`}\n                      style={{\n                        backgroundColor: isDarkModeOn\n                          ? statusColor[\"open\"].dark + \"40\"\n                          : statusColor[\"open\"].light + \"40\",\n                        color: isDarkModeOn\n                          ? statusColor[\"open\"].dark\n                          : statusColor[\"open\"].light,\n                        cursor: \"unset\",\n                      }}\n                    >\n                      Open\n                    </div>\n                    <div>\n                      {\" \"}\n                      {offer.offer_price ? (\n                        <div className=\"price\">\n                          {YoctoToNear(offer.offer_price)}\n                          <img src={nearLogo} alt=\"NEAR\" />\n                        </div>\n                      ) : (\n                        <div className=\"price\">-</div>\n                      )}{\" \"}\n                    </div>\n                    <Widget\n                      src=\"near/widget/AccountProfileOverlay\"\n                      props={{\n                        accountId: offer.listing.listed_by,\n                        children: (\n                          <a\n                            href={\n                              \"https://near.org/near/widget/ProfilePage?accountId=\" +\n                              offer.listing.listed_by\n                            }\n                            className=\"address tab\"\n                            target=\"_blank\"\n                          >\n                            {_address(offer.listing.listed_by)}{\" \"}\n                          </a>\n                        ),\n                      }}\n                    />\n                    <div\n                      className={`tab ${isExpired ? \"disabled\" : \"\"}`}\n                      onClick={withdrawOfferHandler}\n                    >\n                      Withdraw\n                    </div>\n                    <div className=\"time\">\n                      {getTimePassed(offer.offered_at)}\n                      {hashData.body.receipts[0]\n                        ?.originated_from_transaction_hash && (\n                        <a\n                          href={`https://${\n                            accountId.endsWith(\"testnet\")\n                              ? \"testnet.nearblocks\"\n                              : \"nearblocks\"\n                          }.io/txns/${\n                            hashData.body.receipts[0]\n                              ?.originated_from_transaction_hash\n                          }`}\n                          className=\"tab\"\n                          target=\"_blank\"\n                        >\n                          <i class=\"bi bi-box-arrow-up-right\"></i>\n                        </a>\n                      )}\n                    </div>\n                  </div>\n                );\n              })}\n          </div>\n          {!offers.length && (\n            <p className=\"trx-row\">\n              <div>No offers yet</div>\n              <div>-</div>\n              <div>-</div>\n              <div>-</div>\n              <div>-</div>\n              <div>-</div>\n              <div>-</div>\n            </p>\n          )}\n        </div>\n      )}\n      {showTable && (\n        <p className=\"w-100 px-4\">\n          <Widget\n            src=\"bos.genadrop.near/widget/Mintbase.TablePagination\"\n            props={{\n              totalItems,\n              isDarkModeOn,\n              itemsPerPage: offers.length,\n              currentPage: page,\n              onPageChange: (page) => setPage(page),\n            }}\n          />\n        </p>\n      )}\n    </Container>\n  );\n};\nreturn <OpenOffersByAccount {...props} />;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bos.genadrop.near/widget/Mintbase.App.LaunchPad.OpenOffersByAccount", "fact_widget_deployments_id": "1611394cf81e00900172b14cb4557905", "inserted_timestamp": "2024-04-26T11:43:20.585Z", "modified_timestamp": "2024-04-26T11:43:20.585Z", "__row_index": 2}
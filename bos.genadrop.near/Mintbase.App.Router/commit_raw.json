{"tx_hash": "D84MoRQgZHoFTacZ3Z2oFVfhiZ94eyhJYsieDpipf8HB", "action_id_social": "J3wdTvjASxYF3mBGhpN6NEYqZ1UYWVYMHx5LmsT6MEEK-0-widget", "block_id": 114950115, "block_timestamp": "2024-03-18T10:55:34.879Z", "signer_id": "bos.genadrop.near", "widget_name": "Mintbase.App.Router", "source_code": "const { href } = VM.require(\"buildhub.near/widget/lib.url\") || {\n  href: () => \"/\",\n};\n\nconst Content = styled.div`\n  width: 100%;\n  height: 100%;\n`;\n\nfunction findDefaultRoute(routesObject) {\n  const routeKey =\n    routesObject &&\n    Object.keys(routesObject).find((key) => {\n      const route = routesObject[key];\n      return route.default === true;\n    });\n\n  if (routeKey) {\n    return routesObject[routeKey];\n  } else {\n    return null;\n  }\n}\n\nfunction Router({ config, ...passProps }) {\n  const { routes, PageNotFound, debug, param } = config;\n\n  if (!param) param = \"page\";\n\n  const defaultRoute =\n    findDefaultRoute(routes) ??\n    (routes && Object.keys(routes).length && routes[Object.keys(routes)[0]]);\n  const activeRoute =\n    (routes &&\n      routes.hasOwnProperty(passProps[param]) &&\n      routes[passProps[param]]) ||\n    defaultRoute;\n\n  if (!PageNotFound) PageNotFound = () => <p>404 Not Found</p>;\n  if (!activeRoute) {\n    // Handle 404 or default case for unknown routes\n    return <PageNotFound />;\n  }\n\n  // An improvement may be to \"lazy load\", e.g. load all widgets at once and only \"display\" the active one\n  // potentionally add a \"lazy: true\" prop to the route object\n\n  // for each route, if lazy, load the widget and store it in a map\n  // set display for the active route\n\n  // we may want to convert this to a widget for that purpose, to manage state?\n  if (debug) {\n    return (\n      <div key={JSON.stringify(activeRoute)}>\n        <pre>{JSON.stringify(activeRoute, null, 2)}</pre>\n        <pre>{JSON.stringify(props, null, 2)}</pre>\n      </div>\n    );\n  } else {\n    return (\n      <Content key={param + JSON.stringify(activeRoute)}>\n        <Widget\n          src={activeRoute.path}\n          props={{\n            ...activeRoute.init,\n            ...passProps,\n          }}\n          loading={<div style={{ height: \"100%\", width: \"100%\" }} />}\n        />\n      </Content>\n    );\n  }\n}\n\nreturn { Router };\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bos.genadrop.near/widget/Mintbase.App.Router", "fact_widget_deployments_id": "d5b091d61d49904faea7b911fcbb1590", "inserted_timestamp": "2024-03-18T12:29:02.451Z", "modified_timestamp": "2024-03-18T12:29:02.451Z", "__row_index": 1}
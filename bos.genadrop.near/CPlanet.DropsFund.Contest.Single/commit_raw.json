{"tx_hash": "A1dj5BVi5U7PsQLor9Bn972fGjVDVC4AjW5AmfxitExh", "action_id_social": "A1p8TEqz9SYVH4rzxGsdJQPrE5ZhbvtRnwAaFX8shPv4-0-widget", "block_id": 117657192, "block_timestamp": "2024-04-26T10:06:12.377Z", "signer_id": "bos.genadrop.near", "widget_name": "CPlanet.DropsFund.Contest.Single", "source_code": "const checkSvg = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"16\"\n    height=\"12\"\n    viewBox=\"0 0 16 12\"\n    fill=\"none\"\n  >\n    <rect width=\"16\" height=\"12\" rx=\"6\" fill=\"#B0B0B0\" />\n    <path\n      d=\"M5 6.19231L7 8.5L11 3.5\"\n      stroke=\"white\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n  </svg>\n);\nconst Container = styled.div`\n  background: #f8f8f8;\n  min-height: 100vh;\n`;\nconst Root = styled.div`\n  padding: 10px;\n  margin-left: auto;\n  margin-right: auto;\n  max-width: 1400px;\n  width: 100%;\n  padding-top: 40px;\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 30px;\n  @media (max-width: 500px) {\n    flex-direction: column;\n    padding-top: 30px;\n    .left,\n    .right {\n      width: 100%;\n    }\n    .left {\n      .header {\n        h1 {\n          font-size: 28px !important;\n        }\n        span {\n          font-size: 18px !important;\n        }\n      }\n    }\n  }\n  .left {\n    .header {\n      span {\n        color: #808080;\n        leading-trim: both;\n        text-edge: cap;\n        font-family: Helvetica Neue;\n        font-size: 24px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: normal;\n      }\n      h1 {\n        color: var(--Black, #000);\n        leading-trim: both;\n        text-edge: cap;\n        font-family: Helvetica Neue;\n        font-size: 48px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: normal;\n      }\n    }\n  }\n`;\nconst Status = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  .submission {\n    color: #3bd07f;\n    text-align: center;\n    font-family: Helvetica Neue;\n    font-size: 8px;\n    font-style: normal;\n    font-weight: 700;\n    line-height: 150%; /* 12px */\n    display: flex;\n    padding: 2px 10px;\n    justify-content: center;\n    align-items: center;\n    gap: 8px;\n    border-radius: 50px;\n    border: 1px solid #3bd07f;\n    background: #e4fff0;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0);\n  }\n  .closed {\n    color: white;\n    text-align: center;\n    font-family: Helvetica Neue;\n    font-size: 8px;\n    font-style: normal;\n    font-weight: 700;\n    line-height: 150%; /* 12px */\n    display: flex;\n    padding: 2px 10px;\n    justify-content: center;\n    align-items: center;\n    gap: 8px;\n    border-radius: 50px;\n    border: 1px solid #b0b0b0;\n    background: #b0b0b0;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0);\n  }\n  .sum-date {\n    color: #b0b0b0;\n    text-align: center;\n    font-family: Helvetica Neue;\n    font-size: 8px;\n    font-style: normal;\n    font-weight: 700;\n    line-height: 150%; /* 12px */\n    border-radius: 50px;\n    margin-left: 10px;\n    padding: 2px 10px;\n    border: 1px solid #b0b0b0;\n    background: #fff;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0);\n  }\n`;\nconst Username = styled.div`\n  display: flex;\n  flex-direction: row;\n  a {\n    overflow: hidden;\n    color: #b0b0b0;\n    text-overflow: ellipsis;\n    font-family: Helvetica Neue;\n    font-size: 16px;\n    font-style: normal;\n    font-weight: 400;\n    line-height: normal;\n    text-transform: uppercase;\n    margin-bottom: 20px;\n  }\n  svg {\n    margin-left: 5px;\n    margin-top: 3px;\n  }\n`;\nconst Desc = styled.div`\n  p {\n    color: #808080;\n    font-family: Helvetica Neue;\n    font-size: 16px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: 148%; /* 23.68px */\n    letter-spacing: -0.16px;\n  }\n`;\nconst PriceBucket = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: #ccc;\n  width: 100%;\n  padding: 16px 48px 20px 32px;\n  justify-content: space-between;\n  max-width: 1000px;\n  align-items: flex-start;\n  border-radius: 8px;\n  border: 1px solid #b0b0b0;\n  background: #fff;\n  .amountSec:last-child {\n    border-right: none;\n  }\n  .amountSec {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    border-right: 2px solid #b0b0b0;\n    width: 200px;\n    span {\n      color: #b0b0b0;\n      font-family: Helvetica Neue;\n      font-size: 12px;\n      font-style: normal;\n      font-weight: 500;\n      line-height: normal;\n      text-transform: uppercase;\n    }\n    .amount {\n      display: flex;\n      align-items: flex-end;\n      img {\n        width: 20px;\n        height: 20px;\n        margin-bottom: 3px;\n        margin-right: 5px;\n      }\n      .first-span {\n        color: #000;\n        font-family: Helvetica Neue;\n        font-size: 20px;\n        font-style: normal;\n        font-weight: 700;\n        margin: 0;\n        margin-top: 10px;\n        margin-right: 3px;\n        line-height: normal;\n      }\n      .last-span {\n        color: #000;\n        font-family: Helvetica Neue;\n        font-size: 12px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: normal;\n        padding-bottom: 3px;\n        text-transform: uppercase;\n      }\n    }\n  }\n  @media (max-width: 500px) {\n    flex-direction: column;\n    width: 80%;\n    margin-left: auto;\n    margin-right: auto;\n    justify-content: center;\n    align-items: center;\n    .amountSec {\n      border-bottom: 1px solid #b0b0b0;\n      height: 100px;\n      justify-content: center;\n      width: 100% !important;\n      padding-left: 0 !important;\n      padding-right: 0 !important;\n      border-right: none !important;\n    }\n    .amountSec:last-child {\n      border-bottom: none;\n    }\n  }\n`;\nconst contestId = props.contestId;\nconst testContract = props?.status === \"true\" ? true : false;\nconst [userSubmitted, setUserSubmitted] = useState(false);\nif (!contestId) {\n  return (\n    <div>\n      No ContestId Provided, Please Redirect to the Contest Overview page and\n      Select a Contest\n    </div>\n  );\n}\nconst contest = Near.view(\n  testContract ? \"fund-beta.genadrop.near\" : \"contest.genadrop.near\",\n  \"get_contest_detail\",\n  {\n    contest_id: Number(contestId),\n    subscribe: true,\n  }\n);\nif (!contestId && !contest) {\n  return (\n    <div>\n      No ContestId Provided, Please Redirect to the Contest Overview page and\n      Select a Contest\n    </div>\n  );\n}\nconst contestArts = Near.view(\n  testContract ? \"fund-beta.genadrop.near\" : \"contest.genadrop.near\",\n  \"get_contest_arts\",\n  {\n    contest_id: Number(contestId),\n    subscribe: true,\n  }\n);\nif (!contest) {\n  return (\n    <div>\n      No Contest Details Found, Please make sure you're Navigating from a Valid\n      Contest\n    </div>\n  );\n}\nconst formatTime = (time) => {\n  const timestamp = time * 1000; // Convert seconds to milliseconds\n  const date = new Date(timestamp);\n  // Format the date to \"Month day, year\" (e.g., \"Oct 31, 2023\")\n  const options = { month: \"short\", day: \"numeric\", year: \"numeric\" };\n  const formattedDate = date.toLocaleDateString(\"en-US\", options);\n  return formattedDate;\n};\nconst isOpen = contest?.submission_end_time > Date.now() / 1000;\nconst isClosed = contest?.voting_end_time < Date.now() / 1000;\nuseEffect(() => {\n  if (contestArts) {\n    const submitted = contestArts?.some(\n      (data) => data[0] === context.accountId\n    );\n    setUserSubmitted(submitted);\n  }\n}, [contestArts]);\nconst getUsdValue = (price) => {\n  const res = fetch(\n    `https://api.coingecko.com/api/v3/simple/price?ids=near&vs_currencies=usd`\n  );\n  if (res.ok) {\n    const multiplyBy = Object.values(res?.body)[0]?.usd;\n    const value = multiplyBy * price.toFixed(2);\n    return value.toFixed(4) !== \"NaN\" ? `$${value.toFixed(2)}` : 0;\n  }\n};\nconst policy = Near.view(contest?.dao_id, \"get_policy\");\nconst councilMembers =\n  policy &&\n  policy?.roles?.filter(\n    (data) => data?.name === \"council\" || data?.name === \"Council\"\n  )[0]?.kind?.Group;\nreturn (\n  <Container>\n    <Root>\n      <div className=\"left\">\n        <div className=\"header\">\n          <span>\n            {formatTime(contest?.submission_start_time)} -{\" \"}\n            {formatTime(contest?.voting_end_time)}\n          </span>\n          <h1>{contest.title ?? \"No Title\"}</h1>\n        </div>\n        <Status>\n          <p className={isClosed ? \"closed\" : \"submission\"}>\n            {isOpen\n              ? \"SUBMISSION OPEN\"\n              : isClosed\n              ? \"VOTING CLOSED\"\n              : \"VOTING OPEN\"}\n          </p>\n          <p className=\"sum-date\">\n            SUBMISSION FROM ON {formatTime(contest?.submission_start_time)} -{\" \"}\n            {formatTime(contest?.submission_end_time)}\n          </p>\n          <p className=\"sum-date\">\n            VOTING FROM ON {formatTime(contest?.voting_start_time)} -{\" \"}\n            {formatTime(contest?.voting_end_time)}\n          </p>\n        </Status>\n        <Username>\n          <a\n            href={`#/bos.genadrop.near/widget/CPlanet.DAO.Index?daoId=${contest?.dao_id}`}\n          >\n            {contest?.dao_id}\n          </a>\n          {checkSvg}\n        </Username>\n        <Desc>\n          <p>{contest?.description ?? \"-- No Description --\"}</p>\n        </Desc>\n        <PriceBucket>\n          <div className=\"amountSec\">\n            <span>Total Prize</span>\n            <div className=\"amount\">\n              <img\n                src=\"https://ipfs.near.social/ipfs/bafkreierjvmroeb6tnfu3ckrfmet7wpx7k3ubjnc6gcdzauwqkxobnu57e\"\n                alt=\"\"\n              />\n              <p className=\"first-span\">{contest?.prize}</p>\n              <span className=\"last-span\">{getUsdValue(contest?.prize)}</span>\n            </div>\n          </div>\n          <div className=\"amountSec\">\n            <span>Prize per Place</span>\n            <div className=\"amount\">\n              <img\n                src=\"https://ipfs.near.social/ipfs/bafkreierjvmroeb6tnfu3ckrfmet7wpx7k3ubjnc6gcdzauwqkxobnu57e\"\n                alt=\"\"\n              />\n              <p className=\"first-span\">\n                {contest?.places ? contest?.prize / contest.places ?? 0 : 0}\n              </p>\n              <span className=\"last-span\">\n                {getUsdValue(\n                  contest?.places ? contest?.prize / contest.places ?? 0 : 0\n                )}\n              </span>\n            </div>\n          </div>\n          <div className=\"amountSec\">\n            <span>Winners</span>\n            <div className=\"amount\">\n              <p className=\"first-span\">{contest?.winners?.length ?? 0}</p>\n            </div>\n          </div>\n          <div className=\"amountSec\">\n            <span>{isOpen ? \"Submit Before\" : \"Voting Ends At\"}</span>\n            <div className=\"amount\">\n              <Widget\n                src=\"bos.genadrop.near/widget/CPlanet.DropsFund.Contest.Countdown\"\n                props={{\n                  startTime: Date.now(),\n                  endTime:\n                    (isOpen\n                      ? contest?.submission_end_time\n                      : contest?.voting_end_time) * 1000,\n                }}\n              />\n            </div>\n          </div>\n          <div className=\"amountSec\">\n            <span>Entries</span>\n            <div className=\"amount\">\n              <p className=\"first-span\">{contest?.submissions ?? 0}</p>\n            </div>\n          </div>\n        </PriceBucket>\n        <Widget\n          src=\"bos.genadrop.near/widget/CPlanet.DropsFund.Contest.Content\"\n          props={{\n            usersArts: contestArts,\n            isOpen,\n            contestName: contest?.title,\n            winners: contest.winners,\n            daoId: contest.dao_id,\n            testContract,\n            isClosed,\n            councilMembers: councilMembers,\n            userSubmitted,\n            contestId,\n          }}\n        />\n      </div>\n      <div className=\"right\">\n        <Widget\n          src=\"bos.genadrop.near/widget/CPlanet.DropsFund.Contest.Rules\"\n          props={{\n            isClosed,\n            isOpen,\n            testContract,\n            winners: contest.winners,\n            usersArts: contestArts,\n            contestId,\n            userSubmitted,\n          }}\n        />\n      </div>\n    </Root>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bos.genadrop.near/widget/CPlanet.DropsFund.Contest.Single", "fact_widget_deployments_id": "e31136c242477e14527d1aebb12df277", "inserted_timestamp": "2024-04-26T11:43:20.585Z", "modified_timestamp": "2024-04-26T11:43:20.585Z", "__row_index": 10}
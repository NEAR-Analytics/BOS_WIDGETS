{"tx_hash": "DfxdWCtL9VJX1Arr4fTbD5eanA2iNKzzunGKxgLbEYj7", "action_id_social": "H397UEciVfstQKERjHgzwVGsCD8C13sZnXkx1L5rsFCS-0-widget", "block_id": 109391182, "block_timestamp": "2024-01-02T08:54:09.550Z", "signer_id": "bos.genadrop.near", "widget_name": "CPlanet.DropsFund.Contest.Single", "source_code": "const checkSvg = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"16\"\n    height=\"12\"\n    viewBox=\"0 0 16 12\"\n    fill=\"none\"\n  >\n    <rect width=\"16\" height=\"12\" rx=\"6\" fill=\"#B0B0B0\" />\n    <path\n      d=\"M5 6.19231L7 8.5L11 3.5\"\n      stroke=\"white\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n  </svg>\n);\n\nconst Container = styled.div`\n  background: #f8f8f8;\n  min-height: 100vh;\n`;\n\nconst Root = styled.div`\n  padding: 10px;\n  margin-left: auto;\n  margin-right: auto;\n  max-width: 1400px;\n  width: 100%;\n  margin-top: 40px;\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  gap: 30px;\n  @media (max-width: 500px) {\n    flex-direction: column;\n    margin-top: 30px;\n    .left,\n    .right {\n      width: 100%;\n    }\n    .left {\n      .header {\n        h1 {\n          font-size: 28px !important;\n        }\n        span {\n          font-size: 18px !important;\n        }\n      }\n    }\n  }\n  .left {\n    .header {\n      span {\n        color: #808080;\n        leading-trim: both;\n        text-edge: cap;\n        font-family: Helvetica Neue;\n        font-size: 24px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: normal;\n      }\n      h1 {\n        color: var(--Black, #000);\n        leading-trim: both;\n        text-edge: cap;\n        font-family: Helvetica Neue;\n        font-size: 48px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: normal;\n      }\n    }\n  }\n`;\n\nconst Status = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  .submission {\n    color: #3bd07f;\n    text-align: center;\n    font-family: Helvetica Neue;\n    font-size: 8px;\n    font-style: normal;\n    font-weight: 700;\n    line-height: 150%; /* 12px */\n    display: flex;\n    padding: 2px 10px;\n    justify-content: center;\n    align-items: center;\n    gap: 8px;\n    border-radius: 50px;\n    border: 1px solid #3bd07f;\n    background: #e4fff0;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0);\n  }\n  .closed {\n    color: white;\n    text-align: center;\n    font-family: Helvetica Neue;\n    font-size: 8px;\n    font-style: normal;\n    font-weight: 700;\n    line-height: 150%; /* 12px */\n    display: flex;\n    padding: 2px 10px;\n    justify-content: center;\n    align-items: center;\n    gap: 8px;\n    border-radius: 50px;\n    border: 1px solid #b0b0b0;\n    background: #b0b0b0;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0);\n  }\n  .sum-date {\n    color: #b0b0b0;\n    text-align: center;\n    font-family: Helvetica Neue;\n    font-size: 8px;\n    font-style: normal;\n    font-weight: 700;\n    line-height: 150%; /* 12px */\n    border-radius: 50px;\n    margin-left: 10px;\n    padding: 2px 10px;\n    border: 1px solid #b0b0b0;\n    background: #fff;\n    box-shadow: 0px 0px 4px 0px rgba(0, 0, 0, 0);\n  }\n`;\n\nconst Username = styled.div`\n  display: flex;\n  flex-direction: row;\n  a {\n    overflow: hidden;\n    color: #b0b0b0;\n    text-overflow: ellipsis;\n    font-family: Helvetica Neue;\n    font-size: 16px;\n    font-style: normal;\n    font-weight: 400; \n    line-height: normal;\n    text-transform: uppercase;\n    margin-bottom: 20px;\n  }\n  svg {\n    margin-left: 5px;\n    margin-top: 3px;\n  }\n`;\n\nconst Desc = styled.div`\n  p {\n    color: #808080;\n    font-family: Helvetica Neue;\n    font-size: 16px;\n    font-style: normal;\n    font-weight: 500;\n    line-height: 148%; /* 23.68px */\n    letter-spacing: -0.16px;\n  }\n`;\n\nconst PriceBucket = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: #ccc;\n  width: 100%;\n  padding: 16px 48px 20px 32px;\n  justify-content: space-between;\n  max-width: 1000px;\n  align-items: flex-start;\n  border-radius: 8px;\n  border: 1px solid #b0b0b0;\n  background: #fff;\n  .amountSec:last-child {\n    border-right: none;\n  }\n  .amountSec {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    border-right: 2px solid #b0b0b0;\n    width: 200px;\n    span {\n      color: #b0b0b0;\n      font-family: Helvetica Neue;\n      font-size: 12px;\n      font-style: normal;\n      font-weight: 500;\n      line-height: normal;\n      text-transform: uppercase;\n    }\n    .amount {\n      display: flex;\n      align-items: flex-end;\n      img {\n        width: 20px;\n        height: 20px;\n        margin-bottom: 3px;\n        margin-right: 5px;\n      }\n      .first-span {\n        color: #000;\n        font-family: Helvetica Neue;\n        font-size: 20px;\n        font-style: normal;\n        font-weight: 700;\n        margin: 0;\n        margin-top: 10px;\n        margin-right: 3px;\n        line-height: normal;\n      }\n      .last-span {\n        color: #000;\n        font-family: Helvetica Neue;\n        font-size: 12px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: normal;\n        padding-bottom: 3px;\n        text-transform: uppercase;\n      }\n    }\n  }\n  @media (max-width: 500px) {\n    flex-direction: column;\n    width: 80%;\n    margin-left: auto;\n    margin-right: auto;\n    justify-content: center;\n    align-items: center;\n    .amountSec {\n      border-bottom: 1px solid #b0b0b0;\n      height: 100px;\n      justify-content: center;\n      width: 100% !important;\n      padding-left: 0 !important;\n      padding-right: 0 !important;\n      border-right: none !important;\n    }\n    .amountSec:last-child {\n      border-bottom: none;\n    }\n  }\n`;\n\nconst contestId = props.contestId;\nconst [userSubmitted, setUserSubmitted] = useState(false);\n\nconst contest = Near.view(\"fund-v2.genadrop.near\", \"get_contest_detail\", {\n  contest_id: Number(contestId),\n  subscribe: true,\n});\n\nconsole.log(contest)\n\nconst contestArts = Near.view(\"fund-v2.genadrop.near\", \"get_contest_arts\", {\n  contest_id: Number(contestId),\n  subscribe: true,\n});\n\nconst formatTime = (time) => {\n  const timestamp = time * 1000; // Convert seconds to milliseconds\n  const date = new Date(timestamp);\n\n  // Format the date to \"Month day, year\" (e.g., \"Oct 31, 2023\")\n  const options = { month: \"short\", day: \"numeric\", year: \"numeric\" };\n  const formattedDate = date.toLocaleDateString(\"en-US\", options);\n\n  return formattedDate;\n};\n\nconst isOpen = contest?.submission_end_time > Date.now() / 1000;\nconst isClosed = contest?.voting_end_time < Date.now() / 1000;\n\nuseEffect(() => {\n  if (contestArts) {\n    const submitted = contestArts?.some(\n      (data) => data[0] === context.accountId\n    );\n    setUserSubmitted(submitted);\n  }\n}, [contestArts]);\n\n\nconst getUsdValue = (price) => {\n  const res = fetch(\n    `https://api.coingecko.com/api/v3/simple/price?ids=near&vs_currencies=usd`\n  );\n  if (res.ok) {\n    const multiplyBy = Object.values(res?.body)[0]?.usd;\n    const value = multiplyBy * price.toFixed(2);\n    return value.toFixed(4) !== \"NaN\" ? `$${value.toFixed(2)}` : 0;\n  }\n};\n\n\nreturn (\n  <Container>\n    <Root>\n      <div className=\"left\">\n        <div className=\"header\">\n          <span>\n            {formatTime(contest?.submission_start_time)} -{\" \"}\n            {formatTime(contest?.voting_end_time)}\n          </span>\n          <h1>{contest.title ?? \"Lorem Ipsum Contest\"}</h1>\n        </div>\n        <Status>\n          <p className={isClosed ? \"closed\" : \"submission\"}>\n            {isOpen\n              ? \"SUBMISSION OPEN\"\n              : isClosed\n              ? \"VOTING CLOSED\"\n              : \"VOTING OPEN\"}\n          </p>\n          <p className=\"sum-date\">\n            SUBMISSION FROM ON {formatTime(contest?.submission_start_time)} -{\" \"}\n            {formatTime(contest?.submission_end_time)}\n          </p>\n          <p className=\"sum-date\">\n            VOTING FROM ON {formatTime(contest?.voting_start_time)} -{\" \"}\n            {formatTime(contest?.voting_end_time)}\n          </p>\n        </Status>\n        <Username>\n          <a href={`#/bos.genadrop.near/widget/CPlanet.DAO.Index?daoId=${contest?.dao_id}`}>{contest?.dao_id}</a>\n          {checkSvg}\n        </Username>\n        <Desc>\n          <p>{contest?.description ?? \"-- No Description --\"}</p>\n        </Desc>\n        <PriceBucket>\n          <div className=\"amountSec\">\n            <span>Total Prize</span>\n            <div className=\"amount\">\n              <img\n                src=\"https://ipfs.near.social/ipfs/bafkreierjvmroeb6tnfu3ckrfmet7wpx7k3ubjnc6gcdzauwqkxobnu57e\"\n                alt=\"\"\n              />\n              <p className=\"first-span\">{contest?.prize}</p>\n              <span className=\"last-span\">{getUsdValue(contest?.prize)}</span>\n            </div>\n          </div>\n          <div className=\"amountSec\">\n            <span>Prize per winner</span>\n            <div className=\"amount\">\n              <img\n                src=\"https://ipfs.near.social/ipfs/bafkreierjvmroeb6tnfu3ckrfmet7wpx7k3ubjnc6gcdzauwqkxobnu57e\"\n                alt=\"\"\n              />\n              <p className=\"first-span\">1000</p>\n              <span className=\"last-span\">$1686.01</span>\n            </div>\n          </div>\n          <div className=\"amountSec\">\n            <span>Winners</span>\n            <div className=\"amount\">\n              <p className=\"first-span\">{contest?.winners?.length ?? 0}</p>\n            </div>\n          </div>\n          <div className=\"amountSec\">\n            <span>{isOpen ? \"Submit Before\" : \"Voting Ends At\"}</span>\n            <div className=\"amount\">\n              <Widget\n                src=\"bos.genadrop.near/widget/CPlanet.DropsFund.Contest.Countdown\"\n                props={{\n                  startTime: Date.now(),\n                  endTime:\n                    (isOpen\n                      ? contest?.submission_end_time\n                      : contest?.voting_end_time) * 1000,\n                }}\n              />\n            </div>\n          </div>\n          <div className=\"amountSec\">\n            <span>Entries</span>\n            <div className=\"amount\">\n              <p className=\"first-span\">{contest?.submissions ?? 0}</p>\n            </div>\n          </div>\n        </PriceBucket>\n        <Widget\n          src=\"bos.genadrop.near/widget/CPlanet.DropsFund.Contest.Content\"\n          props={{\n            usersArts: contestArts,\n            isOpen,\n            winners: contest.winners,\n            isClosed,\n            userSubmitted,\n            contestId,\n          }}\n        />\n      </div>\n      <div className=\"right\">\n        <Widget\n          src=\"bos.genadrop.near/widget/CPlanet.DropsFund.Contest.Rules\"\n          props={{\n            isClosed,\n            isOpen,\n            winners: contest.winners,\n            usersArts: contestArts,\n            contestId,\n            userSubmitted,\n          }}\n        />\n      </div>\n    </Root>\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bos.genadrop.near/widget/CPlanet.DropsFund.Contest.Single", "fact_widget_deployments_id": "b3426478ceb2c0ba7d54ac09d20a562a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 9}
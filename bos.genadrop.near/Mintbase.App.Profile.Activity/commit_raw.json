{"tx_hash": "A9gUdjtqYGgAx7mzZMrCWfHzoX7mWABH7mLFwZhiUyQA", "action_id_social": "A2coecr48byEFfzhpnpacByM6NU3Sa1N9EXqBwYuPFTr-0-widget", "block_id": 116102608, "block_timestamp": "2024-04-04T08:36:32.081Z", "signer_id": "bos.genadrop.near", "widget_name": "Mintbase.App.Profile.Activity", "source_code": "const cursomStyle = props.cursomStyle || \"\";\nconst perPage = props.perPage || 50; // need to be less than 50\nconst color = props.color || \"#c2cdfd\";\nconst { getInputLabelFontType } = VM.require(\n  \"bos.genadrop.near/widget/Mintbase.components\"\n);\n\nconst { isDarkModeOn, accountId } = props;\n\nconst [data, setData] = useState(null);\n\nconst nearLogo =\n  \"https://ipfs.near.social/ipfs/bafkreib2cfbayerbbnoya6z4qcywnizqrbkzt5lbqe32whm2lubw3sywr4\";\nconst [page, setPage] = useState(0);\n\nconst _address = (address, _limit) => {\n  const limit = _limit || 20;\n  if (address.length > limit) return address.slice(0, 10) + \"...\";\n  else return address;\n};\nconst YoctoToNear = (amountYocto) => {\n  return new Big(amountYocto || 0).div(new Big(10).pow(24)).toString();\n};\n\nconst { getTimePassed } = VM.require(\n  \"bos.genadrop.near/widget/Mintbase.utils.sdk\"\n);\n\nconst fetchMyActivity = (user, offset, limit) => {\n  return asyncFetch(\"https://graph.mintbase.xyz\", {\n    method: \"POST\",\n    headers: {\n      \"mb-api-key\": \"anon\",\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      query: `query GetActivityByUser {\n        mb_views_nft_activities_aggregate(\n          order_by: {timestamp: desc}\n          where: {action_sender: {_eq: \"${user}\"}}\n        ) {\n          aggregate {\n            count\n          }\n        }\n        mb_views_nft_activities(\n          order_by: {timestamp: desc}\n          where: {action_sender: {_eq: \"${user}\"}}\n          offset: ${offset}\n          limit: ${limit}\n        ) {\n          kind\n          description\n          media\n          title\n          timestamp\n          nft_contract_id\n          action_sender\n          receipt_id\n          action_receiver\n          token_id\n          price\n          currency\n          nft_contract {\n            name\n            id\n            base_uri\n          }\n          metadata_id\n        }\n      }\n  `,\n    }),\n  });\n};\n\nuseEffect(() => {\n  fetchMyActivity(accountId || \"jgodwill.near\", 0, 100).then((data) => {\n    setData(data);\n  });\n}, []);\nconst nft_activities = data?.body?.data?.mb_views_nft_activities;\nif (!nft_activities) return \"Loading ...\";\n\nconst Root = styled.div`\n  width: 100%;\n  overflow: hidden;\n`;\n\nconst Container = styled.div`\n  background: ${isDarkModeOn ? \"#1f2031\" : \"#fff\"};\n  display: flex;\n  flex-direction: column;\n  overflow-x: scroll; /* Prevent horizontal overflow */\n  margin: 10px;\n  border-radius: 4px;\n\n  @media (max-width: 500px) {\n    width: 100vw;\n    font-size: 12px;\n  }\n\n  .topic_line {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 2rem;\n    color: ${isDarkModeOn ? \"#fff\" : \"#000\"};\n    margin-bottom: 1rem;\n    border-bottom: 1px solid ${isDarkModeOn ? \"#D2D4DA3a\" : \"#282A3A3a\"};\n    p {\n      margin: 0;\n      font-size: 16px;\n      font-weight: 600;\n    }\n  }\n\n  .header {\n    display: grid;\n    grid-template-columns: repeat(6, minmax(0, 1fr));\n    align-items: center;\n    justify-content: space-between;\n    padding: 0.5rem 0;\n    color: ${isDarkModeOn ? \"#B3B5BD\" : \"#404252\"};\n    margin-bottom: 1rem;\n\n    ${getInputLabelFontType(\"big\")}\n    font-weight: 500px;\n    div {\n      padding-bottom: 1rem;\n      text-align: center;\n      border-bottom: 2px solid ${isDarkModeOn ? \"#374151\" : \"#E5E7EB\"};\n    }\n    ${cursomStyle}\n  }\n\n  .trx-row {\n    display: grid;\n    grid-template-columns: repeat(6, minmax(0, 3fr));\n    width: 100%;\n    justify-content: space-between;\n    gap: 1rem;\n    padding: 1rem 0;\n    border-bottom: 1px solid ${color}5a;\n    &:last-of-type {\n      border-bottom-color: transparent;\n    }\n\n    a {\n      text-decoration: none;\n    }\n    div,\n    a,\n    span {\n      text-align: center;\n      margin: auto;\n    }\n    div:first-child {\n      margin: unset;\n      margin: auto auto auto 24px;\n    }\n    .address {\n      color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n      height: 40px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 10px;\n      border-radius: 2px;\n      transition: all 200ms;\n      :hover {\n        background: ${color};\n        color: white;\n      }\n    }\n    .title {\n      display: flex;\n      align-items: center;\n      text-decoration: none;\n      gap: 10px;\n      div {\n        white-space: nowrap;\n        height: 40px;\n        display: flex;\n        color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n        align-items: center;\n        justify-content: center;\n        padding: 10px;\n        border-radius: 2px;\n        transition: all 200ms;\n        :hover {\n          background: ${color};\n          color: white;\n        }\n      }\n      img {\n        object-fit: cover;\n        width: 40px;\n        height: 40px;\n      }\n    }\n    .kind {\n      width: fit-content;\n      height: fit-content;\n      font-size: 12px;\n      font-weight: bold;\n      letter-spacing: 0.9;\n      padding: 4px;\n      border-radius: 2px;\n      text-transform: uppercase;\n    }\n\n    .time {\n      display: flex;\n      align-items: center;\n      gap: 1rem;\n      color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n      svg {\n        box-sizing: content-box;\n        height: 14px;\n        color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n        cursor: pointer;\n        padding: 10px;\n        border-radius: 2px;\n        transition: all 200ms ease 0s;\n        :hover {\n          fill: white;\n          background: ${color};\n        }\n      }\n    }\n  }\n\n  .price {\n    display: flex;\n    gap: 4px;\n    align-items: center;\n    font-weight: 600;\n    color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n    img {\n      width: 14px;\n    }\n  }\n\n  @media (max-width: 500px) {\n    .header,\n    .trx-row {\n      grid-template-columns: repeat(6, 150px);\n    }\n  }\n`;\n\nconst Trx = styled.div``;\nconst kindColor = {\n  list: \"#8c4fe5\",\n  unlist: \"#8c4fe5\",\n  sale: \"#0a7d6c\",\n  transfer: \"#4f58a3\",\n  make_offer: \"#4f58a3\",\n  mint: \"#000000\",\n};\n// const hanldeRoute = (receipt) => {\n//   asyncFetch(\"https://api.nearblocks.io/v1/search?keyword=\" + receipt).then(\n//     (data) => {\n//       const txnHash =\n//         \"https://nearblocks.io/txns/\" +\n//         data.body.receipts[0]?.originated_from_transaction_hash;\n//       console.log(txnHash);\n//       clipboard.writeText(txnHash);\n//     }\n//   );\n// };\nreturn (\n  <Root>\n    <Container>\n      <div className=\"topic_line\">\n        <p>Transactions</p>\n      </div>\n      <div className=\"header\">\n        <div>Event</div>\n        <div>Store</div>\n        <div>From</div>\n        <div>To</div>\n        <div> Price</div>\n        <div>Date</div>\n      </div>\n      <div>\n        {nft_activities\n          .slice(page * perPage, (page + 1) * perPage)\n          .map((activity) => {\n            const hashData = fetch(\n              \"https://api.nearblocks.io/v1/search?keyword=\" +\n                activity.receipt_id\n            );\n            return (\n              <div className=\"trx-row\" key={activity.receipt_id}>\n                <div\n                  style={{\n                    background: kindColor[activity.kind] + \"40\",\n                    color: isDarkModeOn ? \"#fff\" : kindColor[activity.kind],\n                  }}\n                  className=\"kind\"\n                >\n                  {activity.kind}\n                </div>\n                <a\n                  href={\n                    activity.metadata_id\n                      ? `https://mintbase.xyz/meta/${activity?.metadata_id?.replace(\n                          \":\",\n                          \"%3A\"\n                        )}`\n                      : \"#\"\n                  }\n                  target=\"_blank\"\n                  className=\"title\"\n                >\n                  {\" \"}\n                  <img\n                    src={\n                      \"https://image-cache-service-z3w7d7dnea-ew.a.run.app/media?url=\" +\n                      activity.media\n                    }\n                    alt={activity.title}\n                  />\n                  {activity?.title && (\n                    <div>{activity.title.substring(0, 6)}...</div>\n                  )}\n                </a>\n                <Widget\n                  src=\"near/widget/AccountProfileOverlay\"\n                  props={{\n                    accountId: activity.action_sender,\n                    children: (\n                      <a\n                        href={\n                          \"https://near.org/near/widget/ProfilePage?accountId=\" +\n                          activity.action_sender\n                        }\n                        className=\"address\"\n                        target=\"_blank\"\n                      >\n                        {_address(activity.action_sender)}{\" \"}\n                      </a>\n                    ),\n                  }}\n                />\n                <Widget\n                  src=\"near/widget/AccountProfileOverlay\"\n                  props={{\n                    accountId: activity.action_receiver,\n                    children: (\n                      <a\n                        href={\n                          \"https://near.org/near/widget/ProfilePage?accountId=\" +\n                          activity.action_receiver\n                        }\n                        className=\"address\"\n                        target=\"_blank\"\n                      >\n                        {_address(activity.action_receiver)}{\" \"}\n                      </a>\n                    ),\n                  }}\n                />\n\n                <div>\n                  {\" \"}\n                  {activity.price ? (\n                    <div className=\"price\">\n                      {YoctoToNear(activity.price)}\n                      <img src={nearLogo} alt=\"NEAR\" />\n                    </div>\n                  ) : (\n                    <div className=\"price\">-</div>\n                  )}{\" \"}\n                </div>\n                <div className=\"time\">\n                  {getTimePassed(activity.timestamp)}\n                  {hashData.body.receipts[0]\n                    ?.originated_from_transaction_hash && (\n                    <a\n                      href={\n                        \"https://nearblocks.io/txns/\" +\n                        hashData.body.receipts[0]\n                          ?.originated_from_transaction_hash\n                      }\n                      target=\"_blank\"\n                    >\n                      <svg\n                        viewBox=\"0 0 512 512\"\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                      >\n                        <path d=\"m432 320h-32a16 16 0 0 0 -16 16v112h-320v-320h144a16 16 0 0 0 16-16v-32a16 16 0 0 0 -16-16h-160a48 48 0 0 0 -48 48v352a48 48 0 0 0 48 48h352a48 48 0 0 0 48-48v-128a16 16 0 0 0 -16-16zm56-320h-128c-21.37 0-32.05 25.91-17 41l35.73 35.73-243.73 243.64a24 24 0 0 0 0 34l22.67 22.63a24 24 0 0 0 34 0l243.61-243.68 35.72 35.68c15 15 41 4.5 41-17v-128a24 24 0 0 0 -24-24z\" />\n                      </svg>\n                    </a>\n                  )}\n                </div>\n              </div>\n            );\n          })}\n      </div>\n    </Container>\n  </Root>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bos.genadrop.near/widget/Mintbase.App.Profile.Activity", "fact_widget_deployments_id": "4d101c71fb5ddb93afc0528f87a3e091", "inserted_timestamp": "2024-04-04T10:37:54.677Z", "modified_timestamp": "2024-04-04T10:37:54.677Z", "__row_index": 0}
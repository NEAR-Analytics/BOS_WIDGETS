{"tx_hash": "7gpk5etwDV47NAAZVhiN7yiHc2Lp5XC1BZGdejrTcXC5", "action_id_social": "FEe7fUU1S22KgnbKXqzhN7XD9ULPFiLqiGq5LFa6a6sW-0-widget", "block_id": 118114416, "block_timestamp": "2024-05-02T20:48:49.264Z", "signer_id": "bos.genadrop.near", "widget_name": "Mintbase.App.ContractProfilePage.Activity", "source_code": "const cursomStyle = props.cursomStyle || \"\";\nconst perPage = props.perPage || 100; // need to be less than 50\nconst color = props.color || \"#c2cdfd\";\nconst { getInputLabelFontType } = VM.require(\n  \"bos.genadrop.near/widget/Mintbase.components\"\n);\nconst { isDarkModeOn, contract } = props;\nconst [page, setPage] = useState(1);\nconst [data, setData] = useState(null);\nconst nearLogo =\n  \"https://ipfs.near.social/ipfs/bafkreib2cfbayerbbnoya6z4qcywnizqrbkzt5lbqe32whm2lubw3sywr4\";\nconst _address = (address, _limit) => {\n  const limit = _limit || 20;\n  if (address.length > limit) return address.slice(0, 10) + \"...\";\n  else return address;\n};\nconst YoctoToNear = (amountYocto) => {\n  return new Big(amountYocto || 0).div(new Big(10).pow(24)).toString();\n};\nconst { getTimePassed, getActivityByContract } = VM.require(\n  \"bos.genadrop.near/widget/Mintbase.utils.sdk\"\n) || {\n  getTimePassed: () => {},\n  getActivityByContract: () => {},\n};\nuseEffect(() => {\n  getActivityByContract({\n    contract,\n    limit: perPage,\n    offset: (page - 1) * perPage,\n  })\n    .then(({ data, errors }) => {\n      if (errors) {\n        // handle those errors like a pro\n        console.error(errors);\n      }\n      // do something great with this precious data\n      console.log(data);\n      setData(data);\n    })\n    .catch((error) => {\n      // handle errors from fetch itself\n      console.error(error);\n    });\n}, [limit, offset, page, contract]);\nconst nft_activities = data?.activities;\nconst totalItems = data?.totalItems?.aggregate?.count;\nif (!nft_activities) return \"Loading ...\";\nconst Root = styled.div`\n  width: 100%;\n  overflow: hidden;\n`;\nconst Container = styled.div`\n  background: ${isDarkModeOn ? \"#1f2031\" : \"#fff\"};\n  display: flex;\n  flex-direction: column;\n  overflow-x: scroll; /* Prevent horizontal overflow */\n  margin: 10px;\n  border-radius: 4px;\n  @media (max-width: 500px) {\n    width: 100vw;\n    font-size: 12px;\n  }\n  .topic_line {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 2rem;\n    color: ${isDarkModeOn ? \"#fff\" : \"#000\"};\n    margin-bottom: 1rem;\n    border-bottom: 1px solid ${isDarkModeOn ? \"#D2D4DA3a\" : \"#282A3A3a\"};\n    p {\n      margin: 0;\n      font-size: 16px;\n      font-weight: 600;\n    }\n  }\n  .header {\n    display: grid;\n    grid-template-columns: repeat(6, minmax(0, 1fr));\n    align-items: center;\n    justify-content: space-between;\n    padding: 0.5rem 0;\n    color: ${isDarkModeOn ? \"#B3B5BD\" : \"#404252\"};\n    margin-bottom: 1rem;\n    ${getInputLabelFontType(\"big\")}\n    font-weight: 500px;\n    div {\n      padding-bottom: 1rem;\n      text-align: center;\n      border-bottom: 2px solid ${isDarkModeOn ? \"#374151\" : \"#E5E7EB\"};\n    }\n    ${cursomStyle}\n  }\n  .trx-row {\n    display: grid;\n    grid-template-columns: repeat(6, minmax(0, 3fr));\n    width: 100%;\n    justify-content: space-between;\n    gap: 1rem;\n    padding: 1rem 0;\n    border-bottom: 1px solid ${color}5a;\n    &:last-of-type {\n      border-bottom-color: transparent;\n    }\n    a {\n      text-decoration: none;\n    }\n    div,\n    a,\n    span {\n      text-align: center;\n      margin: auto;\n    }\n    div:first-child {\n      margin: unset;\n      margin: auto auto auto 24px;\n    }\n    .address {\n      color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n      height: 40px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 10px;\n      border-radius: 2px;\n      transition: all 200ms;\n      :hover {\n        background: ${color};\n        color: white;\n      }\n    }\n    .title {\n      display: flex;\n      align-items: center;\n      text-decoration: none;\n      gap: 10px;\n      div {\n        white-space: nowrap;\n        height: 40px;\n        display: flex;\n        color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n        align-items: center;\n        justify-content: center;\n        padding: 10px;\n        border-radius: 2px;\n        transition: all 200ms;\n        :hover {\n          background: ${color};\n          color: white;\n        }\n      }\n      img {\n        object-fit: cover;\n        width: 40px;\n        height: 40px;\n      }\n    }\n    .kind {\n      width: fit-content;\n      height: fit-content;\n      font-size: 12px;\n      font-weight: bold;\n      letter-spacing: 0.9;\n      padding: 4px;\n      border-radius: 2px;\n      text-transform: uppercase;\n    }\n    .time {\n      display: flex;\n      align-items: center;\n      gap: 0.5rem;\n      color: ${isDarkModeOn ? \"#fff\" : \"#000\"};\n      i {\n        box-sizing: content-box;\n        color: ${isDarkModeOn ? \"#c2cdfd\" : \"#4e58a2\"};\n        cursor: pointer;\n        border-radius: 2px;\n        transition: all 200ms ease 0s;\n        :hover {\n          fill: white;\n          background: ${color};\n        }\n      }\n    }\n  }\n  .price {\n    display: flex;\n    gap: 4px;\n    align-items: center;\n    font-weight: 600;\n    color: ${isDarkModeOn ? \"#fff\" : \"#000\"};\n    img {\n      width: 14px;\n      filter: invert(${isDarkModeOn ? 1 : 0});\n    }\n  }\n  @media (max-width: 500px) {\n    .header,\n    .trx-row {\n      grid-template-columns: repeat(6, 150px);\n    }\n  }\n  .tab {\n    text-decoration: none;\n    text-align: left;\n    display: flex;\n    align-items: baseline;\n    justify-content: flex-end;\n    text-decoration: none;\n    gap: 0.2rem;\n    border-radius: 0.25rem; /* Assuming default border radius */\n    color: ${isDarkModeOn ? \"#C5D0FF\" : \"#4F58A3\"}; /* Ternary for text color */\n    padding: 8px 12px; /* Assuming Tailwind CSS default spacing unit */\n    font-weight: 500;\n    font-size: 16px;\n    line-height: 18px;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); /* Assuming Tailwind CSS default timing function and duration */\n    white-space: nowrap;\n    &:focus {\n      outline: 2px solid transparent; /* Assuming Tailwind CSS default focus outline */\n      outline-offset: 2px; /* Assuming Tailwind CSS default focus outline offset */\n      box-shadow: 0 0 0 2px\n        ${isDarkModeOn ? \"rgba(59, 130, 246, 0.5)\" : \"rgba(66, 153, 225, 0.5)\"}; /* Ternary for box-shadow */\n      background-color: ${isDarkModeOn\n        ? \"rgba(59, 130, 246, 0.35)\"\n        : \"rgba(66, 153, 225, 0.15)\"}; /* Ternary for background-color */\n    }\n    &:hover {\n      background-color: ${isDarkModeOn\n        ? \"rgba(59, 130, 246, 0.15)\"\n        : \"rgba(66, 153, 225, 0.15)\"}; /* Ternary for background-color */\n    }\n    cursor: pointer;\n    @media (max-width: 768px) {\n      padding: 12px;\n      font-size: 12px;\n      line-height: 14px;\n    }\n  }\n`;\nconst Trx = styled.div``;\nconst kindColor = {\n  list: \"#8c4fe5\",\n  unlist: \"#8c4fe5\",\n  sale: \"#0a7d6c\",\n  transfer: \"#4f58a3\",\n  make_offer: \"#4f58a3\",\n  mint: \"#000000\",\n};\n// const hanldeRoute = (receipt) => {\n//   asyncFetch(\"https://api.nearblocks.io/v1/search?keyword=\" + receipt).then(\n//     (data) => {\n//       const txnHash =\n//         \"https://nearblocks.io/txns/\" +\n//         data.body.receipts[0]?.originated_from_transaction_hash;\n//       console.log(txnHash);\n//       clipboard.writeText(txnHash);\n//     }\n//   );\n// };\nreturn (\n  <Root>\n    <Container>\n      <div className=\"topic_line\">\n        <p>Transactions</p>\n      </div>\n      <div className=\"header\">\n        <div>Event</div>\n        <div>Store</div>\n        <div>From</div>\n        <div>To</div>\n        <div> Price</div>\n        <div>Date</div>\n      </div>\n      <div>\n        {nft_activities.map((activity) => {\n          const hashData = fetch(\n            `https://${\n              contract.endsWith(\".testnet\") ? \"api3-testnet\" : \"api3\"\n            }.nearblocks.io/v1/search?keyword=${activity.receipt_id}`\n          );\n          const regex = /https?:\\/\\/[^ ]+/;\n          const found = regex.test(activity.media);\n          const imageUrl = found\n            ? activity.media\n            : `${activity.base_uri}/${activity.media}`;\n          return (\n            <div className=\"trx-row\" key={activity.receipt_id}>\n              <div\n                style={{\n                  background: kindColor[activity.kind] + \"40\",\n                  color: isDarkModeOn ? \"#fff\" : kindColor[activity.kind],\n                }}\n                className=\"kind\"\n              >\n                {activity.kind}\n              </div>\n              <div className=\"title\">\n                {\" \"}\n                <img\n                  src={\n                    \"https://image-cache-service-z3w7d7dnea-ew.a.run.app/media?url=\" +\n                    imageUrl\n                  }\n                  alt={activity.title}\n                />\n                <Link\n                  to={\n                    activity.metadata_id\n                      ? `/bos.genadrop.near/widget/Mintbase.App.Index?page=nftDetails&metadataId=${activity?.metadata_id?.replace(\n                          \":\",\n                          \"%3A\"\n                        )}`\n                      : \"#\"\n                  }\n                  target=\"_blank\"\n                  className=\"tab\"\n                >\n                  {activity.title\n                    ? activity.title.length > 7\n                      ? `${activity.title.substring(0, 6)}...`\n                      : activity.title\n                    : \"No Title\"}\n                </Link>\n              </div>\n              <Widget\n                src=\"near/widget/AccountProfileOverlay\"\n                props={{\n                  accountId: activity.action_sender,\n                  children: (\n                    <a\n                      href={\n                        \"https://near.org/near/widget/ProfilePage?accountId=\" +\n                        activity.action_sender\n                      }\n                      className=\"tab\"\n                      target=\"_blank\"\n                    >\n                      {_address(activity.action_sender)}{\" \"}\n                    </a>\n                  ),\n                }}\n              />\n              <Widget\n                src=\"near/widget/AccountProfileOverlay\"\n                props={{\n                  accountId: activity.action_receiver,\n                  children: (\n                    <a\n                      href={\n                        \"https://near.org/near/widget/ProfilePage?accountId=\" +\n                        activity.action_receiver\n                      }\n                      className=\"tab\"\n                      target=\"_blank\"\n                    >\n                      {_address(activity.action_receiver)}{\" \"}\n                    </a>\n                  ),\n                }}\n              />\n              <div>\n                {\" \"}\n                {activity.price ? (\n                  <div className=\"price\">\n                    {YoctoToNear(activity.price)}\n                    <img src={nearLogo} alt=\"NEAR\" />\n                  </div>\n                ) : (\n                  <div className=\"price\">-</div>\n                )}{\" \"}\n              </div>\n              <div className=\"time\">\n                {getTimePassed(activity.timestamp)}\n                {hashData.body.receipts[0]\n                  ?.originated_from_transaction_hash && (\n                  <a\n                    href={`https://${\n                      contract.endsWith(\"testnet\")\n                        ? \"testnet.nearblocks\"\n                        : \"nearblocks\"\n                    }.io/txns/${\n                      hashData.body.receipts[0]\n                        ?.originated_from_transaction_hash\n                    }`}\n                    target=\"_blank\"\n                    className=\"tab\"\n                  >\n                    <i class=\"bi bi-box-arrow-up-right\"></i>\n                  </a>\n                )}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n      <p className=\"w-100 px-4\">\n        <Widget\n          src=\"bos.genadrop.near/widget/Mintbase.TablePagination\"\n          props={{\n            totalItems,\n            isDarkModeOn,\n            itemsPerPage: perPage,\n            currentPage: page,\n            onPageChange: (page) => setPage(page),\n          }}\n        />\n      </p>\n    </Container>\n  </Root>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bos.genadrop.near/widget/Mintbase.App.ContractProfilePage.Activity", "fact_widget_deployments_id": "3aa4c8b5a7772b0986c032a0097a62e1", "inserted_timestamp": "2024-05-02T22:39:31.622Z", "modified_timestamp": "2024-05-02T22:39:31.622Z", "__row_index": 0}
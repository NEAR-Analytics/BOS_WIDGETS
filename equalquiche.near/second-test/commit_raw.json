{"tx_hash": "6Zry79fpggXoS918LoMHhHPaVgeNsoEuuX16i4Eh8gyK", "action_id_social": "H2p6mFzqbVqUe2cKDL82Vp2zApRxt68y9dEYHrTdHCrg-0-widget", "block_id": 107154742, "block_timestamp": "2023-12-04T18:46:53.446Z", "signer_id": "equalquiche.near", "widget_name": "second-test", "source_code": "const contract = \"guest-book.near\";\nconst total_messages = Near.view(contract, \"totalMessages\", {});\nconst messages = Near.view(contract, \"getMessages\", {\n  from_index: total_messages - 10,\n}).reverse();\nconsole.log(messages);\n\nState.init({\n  newMessage: \"\",\n});\n\nconst addNewMessage = () => {\n  if (state.newMessage.trim() == \"\") {\n    return;\n  }\n\n  Near.call(contract, \"addMessage\", {\n    text: state.newMessage,\n  });\n};\n\nreturn (\n  <div class=\"p-3 mb-2 bg-dark text-white\">\n    <h3 class=\"text-center\">Guest book (BOS + NEAR)</h3>\n    <br />\n    {context.accountId ? (\n      <div class=\"border rounded border-white p-3 text-center\">\n        <h4>New message</h4>\n        <div class=\"row\">\n          <div>\n            <input\n              placeholder=\"Type here...\"\n              onChange={(e) => State.update({ newMessage: e.target.value })}\n            />\n          </div>\n        </div>\n        <button\n          class=\"btn btn-outline-primary mt-2\"\n          onClick={async () => {\n            addNewMessage();\n          }}\n        >\n          Save\n        </button>\n      </div>\n    ) : (\n      <p class=\"text-center p-3- mb-2 bg-danger text-white\">\n        Sign in to save a message\n      </p>\n    )}\n    <br />\n    <div class=\"border rounded border-white p-3 text-center\">\n      <h4>Message list</h4>\n      <table class=\"table table-dark table-stripped\">\n        <thead class=\"thead-borderless\">\n          <tr class=\"p-3 mb-2 bg-primary text-white text-center\">\n            <th class=\"table-info\">Account</th>\n            <th class=\"table-info\">Message</th>\n          </tr>\n        </thead>\n        <tbody>\n          {messages.map((data, key) => {\n            return (\n              <tr class=\"text-center\">\n                <td class=\"table-primary\">{data.sender}</td>\n                <td class=\"table-secondary\">{data.text}</td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/equalquiche.near/widget/second-test", "fact_widget_deployments_id": "74a6579ed55f33e7fe0c4e9948de710d", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
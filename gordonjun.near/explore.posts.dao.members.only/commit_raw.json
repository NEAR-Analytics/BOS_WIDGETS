{"tx_hash": "BPwQLnz1QgYtxZaBxVSeK4jHatM4iJ89tmpTxBSrgAbe", "action_id_social": "H5dNcrHeSXLScXszsGF89hxTavUPAsMrbtaxuJfUyHAQ-0-widget", "block_id": 100308024, "block_timestamp": "2023-09-03T14:32:37.154Z", "signer_id": "gordonjun.near", "widget_name": "explore.posts.dao.members.only", "source_code": "State.init({\n  selectedTab: Storage.privateGet(\"selectedTab\") || \"all\",\n});\n\nconst daoId = props.daoId ?? \"bbclan.near\";\n\nconst domains = [\"dev\", \"gov\", \"edu\", \"art\", \"fun\"];\n\nconst hashtags = [\"near\", \"bos\"];\n\nconst previousSelectedTab = Storage.privateGet(\"selectedTab\");\n\nif (previousSelectedTab && previousSelectedTab !== state.selectedTab) {\n  State.update({\n    selectedTab: previousSelectedTab,\n  });\n}\n\nlet daoFollowers = Social.keys(`*/graph/follow/${daoId}`, \"final\", {\n  return_type: \"BlockHeight\",\n  values_only: true,\n});\n\nlet daoFollowersAccounts = Object.keys(daoFollowers || {});\n\nconst isMember = daoFollowersAccounts.includes(context.accountId);\n\nlet accounts = undefined;\n\nif (isMember) {\n  if (state.selectedTab === \"following\" && context.accountId) {\n    const graph = Social.keys(`${context.accountId}/graph/follow/*`, \"final\");\n    if (graph !== null) {\n      daoFollowers = Object.entries(daoFollowers || {}).map(\n        ([accountId]) => accountId\n      );\n      const followings = Object.entries(graph || {}).map(\n        ([accountId]) => accountId\n      );\n      const daoFollowings = daoFollowers.filter((accountId) =>\n        followings.includes(accountId)\n      );\n      accounts = Object.keys(daoFollowings || {});\n    } else {\n      accounts = [];\n    }\n  } else {\n    accounts = daoFollowersAccounts;\n  }\n}\n\nfunction selectTab(selectedTab) {\n  Storage.privateSet(\"selectedTab\", selectedTab);\n  State.update({ selectedTab });\n}\n\nconst H2 = styled.h2`\n  font-size: 19px;\n  line-height: 22px;\n  color: #11181c;\n  margin: 0 0 24px;\n  padding: 0 24px;\n\n  @media (max-width: 1200px) {\n    display: none;\n  }\n`;\n\nconst Content = styled.div`\n  @media (max-width: 1200px) {\n    > div:first-child {\n      border-top: none;\n    }\n  }\n`;\n\nconst HeaderWrapper = styled.div`\n  border-bottom: 1px solid #eceef0;\n`;\n\nconst FilterWrapper = styled.div`\n  padding: 24px 24px 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n\n  @media (max-width: 1200px) {\n    padding: 12px;\n  }\n`;\n\nconst PillSelect = styled.div`\n  display: inline-flex;\n  align-items: center;\n\n  @media (max-width: 600px) {\n    width: 100%;\n\n    button {\n      flex: 1;\n    }\n  }\n`;\n\nconst PillSelectButton = styled.button`\n  display: block;\n  position: relative;\n  border: 1px solid #e6e8eb;\n  border-right: none;\n  padding: 3px 24px;\n  border-radius: 0;\n  font-size: 12px;\n  line-height: 18px;\n  color: ${(p) => (p.selected ? \"#fff\" : \"#687076\")};\n  background: ${(p) => (p.selected ? \"#006ADC !important\" : \"#FBFCFD\")};\n  font-weight: 600;\n  transition: all 200ms;\n\n  &:hover {\n    background: #ecedee;\n    text-decoration: none;\n  }\n\n  &:focus {\n    outline: none;\n    border-color: #006adc !important;\n    box-shadow: 0 0 0 1px #006adc;\n    z-index: 5;\n  }\n\n  &:first-child {\n    border-radius: 6px 0 0 6px;\n  }\n  &:last-child {\n    border-radius: 0 6px 6px 0;\n    border-right: 1px solid #e6e8eb;\n  }\n`;\n\nconst FeedWrapper = styled.div`\n  .post {\n    padding-left: 24px;\n    padding-right: 24px;\n\n    @media (max-width: 1200px) {\n      padding-left: 12px;\n      padding-right: 12px;\n    }\n  }\n`;\n\nconst ChatroomWrapper = styled.div`\n  padding: 24px 24px 0;\n  flex-direction: row;\n`;\n\nconst Text = styled.p`\n  font-family: \"FK Grotesk\", sans-serif;\n  font-size: ${(p) => p.size ?? \"14px\"};\n  line-height: ${(p) => p.lineHeight ?? \"1.5\"};\n  font-weight: ${(p) => p.weight ?? \"400\"};\n  color: ${(p) => p.color ?? \"#000\"};\n  margin: 0;\n  max-width: 670px;\n\n  @media (max-width: 768px) {\n    font-size: 16px;\n  }\n`;\n\nconst TextLarge = styled.p`\n  font-family: \"FK Grotesk\", sans-serif;\n  font-size: ${(p) => p.size ?? \"18px\"};\n  line-height: ${(p) => p.lineHeight ?? \"1.5\"};\n  font-weight: ${(p) => p.weight ?? \"400\"};\n  color: ${(p) => p.color ?? \"#000\"};\n  margin: 0;\n  max-width: 670px;\n\n  @media (max-width: 768px) {\n    font-size: 16px;\n  }\n`;\n\nconst Container = styled.div`\n  display: flex;\n  max-width: 1080px;\n  margin: 0 auto;\n  gap: var(--section-gap);\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  padding: var(--section-gap) 24px;\n\n  @media (max-width: 768px) {\n    padding: var(--section-gap) 12px;\n  }\n`;\n\nconst Flex = styled.div`\n  gap: 8px;\n  align-items: center;\n  flex-direction: column;\n  flex-wrap: \"nowrap\";\n  text-align: center;\n\n  @media (max-width: 998px) {\n    flex-direction: column;\n    gap: var(--section-gap);\n  }\n`;\n\nreturn (\n  <>\n    {isMember ? (\n      <Content>\n        <HeaderWrapper>\n          <h2 className=\"mb-3\">adventures</h2>\n        </HeaderWrapper>\n        <br />\n        <Widget src=\"gordonjun.near/widget/adventures.menu\" />\n        <br />\n        <br />\n\n        <HeaderWrapper>\n          <h2 className=\"mb-3\">apps</h2>\n        </HeaderWrapper>\n        <Widget\n          src=\"gordonjun.near/widget/dev.search.dao.members.only\"\n          props={{ daoId: daoId }}\n        />\n        <br />\n        <br />\n\n        <HeaderWrapper>\n          <h2 className=\"mb-3\">post</h2>\n        </HeaderWrapper>\n        <Widget src=\"hack.near/widget/create.posts\" props={{ domains }} />\n        <br />\n\n        <HeaderWrapper>\n          <h2 className=\"mb-3\">explore</h2>\n          <div className=\"mt-3 mb-3\">\n            <Text>check out what the other bbclan members are up to</Text>\n          </div>\n        </HeaderWrapper>\n\n        <FilterWrapper>\n          <PillSelect>\n            <PillSelectButton\n              type=\"button\"\n              onClick={() => selectTab(\"all\")}\n              selected={state.selectedTab === \"all\"}\n            >\n              all\n            </PillSelectButton>\n\n            <PillSelectButton\n              type=\"button\"\n              onClick={() => selectTab(\"following\")}\n              selected={state.selectedTab === \"following\"}\n            >\n              following\n            </PillSelectButton>\n          </PillSelect>\n          <div className=\"d-inline-flex gap-2\">\n            <Typeahead\n              options={hashtags}\n              multiple\n              onChange={(value) => {\n                State.update({ hashtags: value });\n              }}\n              placeholder=\"hashtag filter\"\n            />\n            <Typeahead\n              options={domains}\n              multiple\n              onChange={(value) => {\n                State.update({ choose: value });\n              }}\n              placeholder=\"domain filter\"\n            />\n          </div>\n        </FilterWrapper>\n\n        <FeedWrapper>\n          <Widget\n            src=\"hack.near/widget/view.posts\"\n            props={{\n              accounts,\n              domains: state.choose,\n              hashtags: state.hashtags,\n            }}\n          />\n        </FeedWrapper>\n        <br />\n\n        <HeaderWrapper>\n          <h2 className=\"mt-3 mb-3\">gather</h2>\n          <div className=\"mt-3 mb-3\">\n            <Text>a chatroom just for bbclan members</Text>\n          </div>\n        </HeaderWrapper>\n        <ChatroomWrapper>\n          <Widget\n            src=\"gordonjun.near/widget/bbclanChatRoom\"\n            props={{ isMember, room }}\n          />\n        </ChatroomWrapper>\n        <Container>\n          <Flex>\n            <img\n              src=\"https://media.tenor.com/QQ6iIPq9emoAAAAC/warm-snow.gif\"\n              alt=\"Footer GIF\"\n              style={{ maxWidth: \"100%\", height: \"auto\" }}\n            />\n          </Flex>\n        </Container>\n      </Content>\n    ) : (\n      <Content>\n        <Flex>\n          <div className=\"mt-3\">\n            <TextLarge style={{ maxWidth: \"600px\" }}>\n              Please follow bbclan's page to post, explore chat and gather with\n              bbclan members.\n            </TextLarge>\n          </div>\n        </Flex>\n        <Container>\n          <Flex>\n            <img\n              src=\"https://media.tenor.com/lQGKG4-u7pQAAAAi/sumikko-gurashi.gif\"\n              alt=\"Footer GIF\"\n              style={{ maxWidth: \"100%\", height: \"auto\" }}\n            />\n          </Flex>\n        </Container>\n      </Content>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/gordonjun.near/widget/explore.posts.dao.members.only", "fact_widget_deployments_id": "2d6df78a113e72e1940a1bc995987937", "inserted_timestamp": "2023-09-03T16:30:10.664Z", "modified_timestamp": "2023-09-03T16:30:10.664Z", "__row_index": 0}
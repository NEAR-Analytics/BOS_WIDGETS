{"tx_hash": "FWBBdvr7b9XnGrzFmxZTjxzUJFZ2gBDtzWirjMMescTG", "action_id_social": "BkEYr6qP2ZiNknph5RCtY8qiBpZ78XyG6ybhNMpfQ6Eo-0-widget", "block_id": 99876076, "block_timestamp": "2023-08-28T20:16:57.535Z", "signer_id": "chloe.near", "widget_name": "dao.create.post", "source_code": "// Initialize state and variables\nconst accountId = context.accountId;\n\nif (!accountId) {\n  return \"Please sign in with NEAR wallet to edit your profile\";\n}\n\nlet daoId = \"research-collective.sputnik-dao.near\";\nlet profile = Social.getr(`${daoId}/profile`);\n\nif (profile === null) {\n  return \"Loading\";\n}\n\nState.init({\n  profile,\n});\n\nconst Wrapper = styled.div`\n  --padding: 24px;\n  position: relative;\n\n  @media (max-width: 1200px) {\n    --padding: 12px;\n  }\n`;\n\n// Function to handle the proposal for updating the DAO profile\nconst handleProfileUpdateProposal = () => {\n  const profile_update_args = JSON.stringify({\n    data: {\n      [daoId]: {\n        profile: {\n          main: JSON.stringify(state.profile),\n        },\n      },\n    },\n  });\n\n  const proposal_update_args = Buffer.from(\n    profile_update_args,\n    \"utf-8\"\n  ).toString(\"base64\");\n\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"Update DAO profile on NEAR Social\",\n          kind: {\n            FunctionCall: {\n              receiver_id: \"social.near\",\n              actions: [\n                {\n                  method_name: \"set\",\n                  args: proposal_update_args,\n                  deposit: \"10000000000000000000000\", // 0.1 NEAR\n                  gas: \"219000000000000\", // As per your usual setting\n                },\n              ],\n            },\n          },\n        },\n      },\n      deposit: \"10000000000000000000000\", // 0.1 NEAR\n      gas: \"219000000000000\", // As per your usual setting\n    },\n  ]);\n};\n\n// Main JSX component\nreturn (\n  <Wrapper>\n    <div className=\"row\">\n      <div className=\"col-lg-6\">\n        <div>\n          <h4>Edit profile of @{daoId}</h4>\n        </div>\n        <div className=\"mb-2\">\n          <Widget\n            src=\"near/widget/MetadataEditor\"\n            props={{\n              initialMetadata: profile,\n              onChange: (profile) => State.update({ profile }),\n              // other options\n            }}\n          />\n        </div>\n        <div className=\"mb-2\">\n          <button onClick={handleProfileUpdateProposal}>Save profile</button>\n          <a\n            className=\"btn btn-outline-primary ms-2\"\n            href={`#/near/widget/ProfilePage?accountId=${daoId}`}\n          >\n            View profile\n          </a>\n        </div>\n      </div>\n      <div className=\"col-lg-6\">\n        <div>\n          <Widget\n            src=\"near/widget/ProfilePage\"\n            props={{ daoId, profile: state.profile }}\n          />\n        </div>\n      </div>\n    </div>\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/chloe.near/widget/dao.create.post", "fact_widget_deployments_id": "6836a74b8f1f0c390a819222f40bd5f6", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 5}
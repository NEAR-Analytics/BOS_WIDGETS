{"tx_hash": "2tiKSri9Jwn2kk84EHMBD8YgStbJiHrKMknYmGnw6Un7", "action_id_social": "2gvJez2MBv8JAPgSxVNgGqZEbB1msBATRA1Y8WV2pE5t-0-widget", "block_id": 107165444, "block_timestamp": "2023-12-04T22:37:28.852Z", "signer_id": "sourcescan.near", "widget_name": "SourceScan.Contracts.Approved", "source_code": "const useNetwork = (mainnet, testnet) => {\n  return context.networkId === \"mainnet\" ? mainnet : testnet;\n};\n\nState.init({\n  verifierId:\n    props.verifierId || useNetwork(\"sourcescan.near\", \"sourcescan.testnet\"),\n  ownerId: useNetwork(\"sourcescan.near\", \"sourcescan.testnet\"),\n  value: null,\n  error: false,\n});\n\nconst compareCodeHash = () => {\n  const options = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      jsonrpc: \"2.0\",\n      id: \"dontcare\",\n      method: \"query\",\n      params: {\n        request_type: \"view_code\",\n        finality: \"final\",\n        account_id: props.accountId,\n      },\n    }),\n  };\n  asyncFetch(props.rpcUrl, options)\n    .then((rpc_res) => {\n      Near.asyncView(state.verifierId, \"get_contract\", {\n        account_id: props.accountId,\n      })\n        .then((res) => {\n          if (rpc_res.body.result.hash === res.code_hash) {\n            State.update({ value: true });\n          } else {\n            State.update({ value: false });\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n};\n\ncompareCodeHash();\n\nreturn (\n  <>\n    {state.value === null ? (\n      <Widget src={`${props.ownerId}/widget/SourceScan.Common.Spinner`} />\n    ) : state.value === true ? (\n      <Widget\n        src={`${state.ownerId}/widget/SourceScan.Common.Icons.CheckIcon`}\n        props={{\n          width: \"20px\",\n          height: \"20px\",\n          tooltip: { placement: props.placement, label: \"Approved\" },\n        }}\n      />\n    ) : (\n      <Widget\n        src={`${state.ownerId}/widget/SourceScan.Common.Icons.CrossIcon`}\n        props={{\n          width: \"20px\",\n          height: \"20px\",\n          tooltip: {\n            placement: props.placement,\n            label: state.error ? \"Error\" : \"Not approved\",\n          },\n        }}\n      />\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sourcescan.near/widget/SourceScan.Contracts.Approved", "fact_widget_deployments_id": "d5b93f53e83257262fcaaff9b5155f94", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
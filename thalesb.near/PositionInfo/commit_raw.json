{"tx_hash": "3aqzycTuetwo4S8ow9ENhjPWdUmbS7psvFeRSHUZieB1", "action_id_social": "2xb7sZNiNWhC44J7QSBLAdtGmNqeAf2Hzb4w9VXtYKbW-0-widget", "block_id": 112322029, "block_timestamp": "2024-02-07T17:21:39.247Z", "signer_id": "thalesb.near", "widget_name": "PositionInfo", "source_code": "State.init({\n  address: undefined,\n  position,\n});\n\nconst InfoSection = styled.div`\n  color: white;\n  margin-top: ${(props) => props.marginTop || 0}px;\n`;\n\nconst InfoRow = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 0;\n  border-bottom: 1px solid #333;\n\n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst InfoLabel = styled.span`\n  color: #fff;\n`;\n\nconst InfoValue = styled.span`\n  color: white;\n`;\n\nconst abi = fetch(\n  \"https://docs.compound.finance/public/files/comet-interface-abi-98f438b.json\"\n);\n\nif (!abi) return \"Loading...\";\n\nconst { contractData, position } = props;\n\nconst { getCollateralsWithLiquidationData } = VM.require(\n  \"thalesb.near/widget/compound-requests\"\n);\n\nuseEffect(() => {\n  if (Ethers.provider()) {\n    Ethers.provider()\n      .send(\"eth_requestAccounts\", [])\n      .then((accounts) => {\n        State.update({ address: accounts[0] });\n      });\n  }\n}, [Ethers]);\n\nconst positionData = useCache(\n  () => {\n    if (!contractData) return Promise.resolve({});\n\n    return getCollateralsWithLiquidationData({\n      cometAddress: props.contractData.cometAddress,\n      rpcUrl: props.contractData.httpRpcUrl,\n      userAddress: props.contractData.userAddress,\n    });\n  },\n  \"getCollateralsWithLiquidationData\",\n  {\n    subscribe: false,\n  }\n);\n\nuseEffect(() => {\n  if (!contractData) {\n    State.update({ position });\n  } else {\n    State.update({ position: positionData });\n  }\n}, [position, positionData]);\n\nreturn (\n  <InfoSection>\n    <InfoRow>\n      <InfoLabel>Collateral value</InfoLabel>\n      <InfoValue>\n        {Number(state.position.collateralValueUsd || 0).toFixed(4)}\n      </InfoValue>\n    </InfoRow>\n    <InfoRow>\n      <InfoLabel>Liquidation point</InfoLabel>\n      <InfoValue>\n        {Number(state.position.liquidationPoint || 0).toFixed(4)}\n      </InfoValue>\n    </InfoRow>\n    <InfoRow>\n      <InfoLabel>Borrow capacity</InfoLabel>\n      <InfoValue>\n        {Number(\n          state.position.borrowCapacityBase + state.position.borrowedInBase || 0\n        ).toFixed(4)}\n      </InfoValue>\n    </InfoRow>\n    <InfoRow>\n      <InfoLabel>Available to borrow</InfoLabel>\n      <InfoValue>\n        {Number(state.position.borrowCapacityBase || 0).toFixed(4)}\n      </InfoValue>\n    </InfoRow>\n  </InfoSection>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/thalesb.near/widget/PositionInfo", "fact_widget_deployments_id": "284a53a841983415826f3541cd7320db", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
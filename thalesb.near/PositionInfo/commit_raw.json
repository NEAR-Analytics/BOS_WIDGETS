{"tx_hash": "A38PWeK1pv85hzQRrEyFbBz2NRZrfSHGf7Lrjzf362r4", "action_id_social": "CZGRnoQgjz6j6fD8cK875vKvGPHdjxhkGQVhJ2djGoKS-0-widget", "block_id": 112275463, "block_timestamp": "2024-02-07T02:17:08.307Z", "signer_id": "thalesb.near", "widget_name": "PositionInfo", "source_code": "State.init({\n  address: undefined,\n  position,\n});\n\nconst { getUserPosition } = VM.require(\"thalesb.near/widget/compound-requests\");\n\nconst InfoSection = styled.div`\n  color: white;\n  margin-top: ${(props) => props.marginTop || 0}px;\n`;\n\nconst InfoRow = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 0;\n  border-bottom: 1px solid #333;\n\n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst InfoLabel = styled.span`\n  color: #fff;\n`;\n\nconst InfoValue = styled.span`\n  color: white;\n`;\n\nconst abi = fetch(\n  \"https://docs.compound.finance/public/files/comet-interface-abi-98f438b.json\"\n);\n\nif (!abi) return \"Loading...\";\n\nconst contractInfo = {\n  address: props.cometAddress,\n  baseAddress: props.baseTokenAddress,\n};\n\nuseEffect(() => {\n  if (Ethers.provider()) {\n    Ethers.provider()\n      .send(\"eth_requestAccounts\", [])\n      .then((accounts) => {\n        State.update({ address: accounts[0] });\n      });\n  }\n}, [Ethers]);\n\nuseEffect(() => {\n  if (!state.address) return;\n\n  getUserPosition({\n    userAddress: state.address,\n    cometAddress: contractInfo.address,\n    rpcUrl: props.httpRpcUrl,\n  }).then((position) => {\n    State.update({ position });\n  });\n}, [state.address]);\n\nreturn (\n  <InfoSection>\n    <InfoRow>\n      <InfoLabel>Collateral value</InfoLabel>\n      <InfoValue>\n        {Number(state.position.collateralValueUsd || 0).toFixed(4)}\n      </InfoValue>\n    </InfoRow>\n    <InfoRow>\n      <InfoLabel>Liquidation point</InfoLabel>\n      <InfoValue>0.0000</InfoValue>\n    </InfoRow>\n    <InfoRow>\n      <InfoLabel>Borrow capacity</InfoLabel>\n      <InfoValue>\n        {Number(\n          state.position.borrowCapacityBase + state.position.borrowedInBase || 0\n        ).toFixed(4)}\n      </InfoValue>\n    </InfoRow>\n    <InfoRow>\n      <InfoLabel>Available to borrow</InfoLabel>\n      <InfoValue>\n        {Number(state.position.borrowCapacityBase || 0).toFixed(4)}\n      </InfoValue>\n    </InfoRow>\n  </InfoSection>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/thalesb.near/widget/PositionInfo", "fact_widget_deployments_id": "af6beb33dc71f5bd6536930605a23a5b", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "71kynAi9ienfUfgpXnUcYDaGbi5ePHDnSLZ8AXzoFtX1", "action_id_social": "F4RbqW388xqMdB53Rh3GoAdUDgakffuEvH9xDcMPJmDp-0-widget", "block_id": 97061193, "block_timestamp": "2023-07-22T10:14:58.045Z", "signer_id": "astro.sking.near", "widget_name": "DAO.Proposals.MultiVoteSubmit", "source_code": "const daoId = props.daoId;\nconst onHideMultiSelect = props.onHideMultiSelect;\n\nState.init({\n  openModal: false,\n  page: 0,\n});\n\nconst STORAGE_KEY = \"proposalsMultiVote\";\nconst STORAGE_SRC = \"astro.sking.near/widget/DAO.Proposals.Card.MultiVote\";\nconst STORAGE = Storage.get(STORAGE_KEY, STORAGE_SRC);\n\nconsole.log(STORAGE);\n\nif (STORAGE === null) return \"\";\n\nif (Object.keys(STORAGE[daoId] || {}).length < 1) {\n  return \"\";\n}\n\nconst proposal_ids = Object.keys(STORAGE[daoId]).map((id) => parseInt(id));\n\n\nconst handleSubmit = () => {\n  const calls = [];\n  Object.keys(STORAGE[daoId]).forEach((id) => {\n    let vote = STORAGE[daoId][id];\n    switch (`${vote}`) {\n      case \"0\":\n        vote = \"VoteApprove\";\n        break;\n      case \"1\":\n        vote = \"VoteReject\";\n        break;\n      case \"2\":\n        vote = \"VoteRemove\";\n        break;\n      default:\n        console.error(\"Invalid vote\");\n        break;\n    }\n    calls.push({\n      contractName: daoId,\n      methodName: \"act_proposal\",\n      args: {\n        id: parseInt(id),\n        action: vote,\n      },\n      gas: 200000000000000,\n    });\n  });\n  return Near.call(calls);\n};\n\nlet Wrapper = styled.div`\n  position: fixed;\n  bottom: 12px;\n  left: 50%;\n  transform: translateX(-50%);\n  min-width: 500px;\n  max-width: 100vw;\n  background-color: #fff;\n`;\n\nreturn (\n  <Wrapper className=\"ndc-card p-4\">\n    <h4>Voting on multiple proposals</h4>\n    <p>\n      Proposals:{\" \"}\n      {Object.keys(STORAGE[daoId])\n        .map((id) => parseInt(id))\n        .reverse()\n        .join(\", \")}\n    </p>\n    <div className=\"d-flex justify-content-end mt-4 gap-3\">\n      <Widget\n        src=\"nui.sking.near/widget/Input.Button\"\n        props={{\n          children: \"Cancel\",\n          onClick: () => {\n            onHideMultiSelect();\n          },\n          variant: \"secondary outline\",\n          className: \"me-auto\",\n        }}\n      />\n      <Widget\n        src=\"nui.sking.near/widget/Input.Button\"\n        props={{\n          children: \"Clear\",\n          onClick: () => {\n            Storage.set(STORAGE_KEY, {});\n          },\n          variant: \"secondary outline\",\n        }}\n      />\n      <Widget\n        src=\"nui.sking.near/widget/Input.Button\"\n        props={{\n          children: \"Submit\",\n          onClick: () => {\n            handleSubmit();\n          },\n          variant: \"secondary\",\n        }}\n      />\n    </div>\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/astro.sking.near/widget/DAO.Proposals.MultiVoteSubmit", "fact_widget_deployments_id": "301f9e719ea8ca061a06e22380176935", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
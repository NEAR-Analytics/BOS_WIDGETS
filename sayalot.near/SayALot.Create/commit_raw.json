{"tx_hash": "6CtDvxhyEXimQTViRQPs4kKhDsgvwkr88menCGic2iFc", "action_id_social": "tt9jyaef4bx2gJ6Z7abyX4n3QCLuTBehcpiyCfpDP9B-0-widget", "block_id": 99921844, "block_timestamp": "2023-08-29T10:41:07.246Z", "signer_id": "sayalot.near", "widget_name": "SayALot.Create", "source_code": "const {\n  isTest,\n  addressForArticles,\n  authorForWidget,\n  stateUpdate,\n  initialBody,\n  initialCreateState,\n  editArticleData,\n  callLibs,\n  widgets,\n  handleFilterArticles,\n  handleEditArticle,\n  handlerStateUpdate,\n} = props;\n\nconst libSrcArray = [\n  \"f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/SayALot.lib.article\",\n];\n\nconst errTextNoBody = \"ERROR: no article Body\",\n  errTextNoId = \"ERROR: no article Id\",\n  errTextDublicatedId = \"ERROR: there is article with such name\";\n\nState.init(initialCreateState);\n\nfunction createStateUpdate(obj) {\n  State.update(obj);\n}\n\nconst tagsArray = state.tags;\n\nconst accountId = context.accountId;\n\nfunction getRealArticleId() {\n  if (editArticleData) {\n    return (\n      editArticleData.realArticleId ??\n      `${editArticleData.author}-${editArticleData.timeCreate}`\n    );\n  } else {\n    return `${accountId}-${Date.now()}`;\n  }\n}\n\nconst getArticleData = () => {\n  const args = {\n    articleId: editArticleData.articleId ?? state.articleId,\n    author: editArticleData.author ?? accountId,\n    lastEditor: accountId,\n    timeLastEdit: Date.now(),\n    timeCreate: editArticleData.timeCreate ?? Date.now(),\n    body: state.articleBody,\n    version: editArticleData ? editArticleData.version + 1 : 0,\n    navigation_id: null,\n    tags: tagsArray,\n    realArticleId: getRealArticleId(),\n  };\n  return args;\n};\n\nfunction onCommit() {\n  State.update({ showCreatedArticle: true });\n}\n\nfunction onCancel() {\n  State.update({ createdArticle: undefined });\n}\n\nfunction createArticleListener() {\n  const article = getArticleData();\n  const newLibCalls = [...state.libCalls];\n  newLibCalls.push({\n    functionName: \"createArticle\",\n    key: \"createdArticle\",\n    props: {\n      article,\n      onCommit,\n      onCancel,\n    },\n  });\n  State.update({ libCalls: newLibCalls });\n}\n\nconst Button = styled.button` \n  margin: 0px 1rem; \n  display: inline-block; \n  text-align: center; \n  vertical-align: middle; \n  cursor: pointer; \n  user-select: none; \n  transition: color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out; \n \n  border: 2px solid transparent; \n  font-weight: 500; \n  padding: 0.3rem 0.5rem; \n  background-color: #010A2D; \n  border-radius: 12px; \n  color: white; \n  text-decoration: none;   \n \n  &:hover { \n    color: #010A2D; \n    background-color: white; \n  } \n`;\n\nconst CreationContainer = styled.div`\n  background-color: rgb(230, 230, 230);\n  border-radius: 20px;\n  padding: 1rem 0;\n  position: relative;\n`;\n\nconst SecondContainer = styled.div`\n  margin: 0 auto;\n  width: 90%;\n  min-width: 360px;\n  background-color: white;\n  padding: 1rem;\n  border-radius: 20px;\n`;\n\nreturn (\n  <>\n    {state.createdArticle && state.showCreatedArticle ? (\n      <Widget\n        src={widgets.oneArticle}\n        props={{\n          widgets,\n          isTest,\n          handleFilterArticles,\n          articleToRenderData: state.createdArticle,\n          authorForWidget,\n          handleEditArticle,\n        }}\n      />\n    ) : (\n      <CreationContainer className=\"container-fluid\">\n        {\n          //   state.saveComplete && (\n          //   <a\n          //     style={{\n          //       position: \"absolute\",\n          //       top: \"0\",\n          //       height: \"100%\",\n          //       width: \"100%\",\n          //       backdropFilter: \"blur(5px)\",\n          //     }}\n          //     href={\n          //       isTest\n          //         ? `https://near.social/#/${authorForWidget}/widget/SayALot_OneArticle?articleId=${state.articleId}&lastEditor=${accountId}&isTest=${isTest}&blockHeight=now`\n          //         : `https://near.social/#/${authorForWidget}/widget/SayALot_OneArticle?articleId=${state.articleId}&lastEditor=${accountId}&blockHeight=now`\n          //     }\n          //   >\n          //     <div\n          //       style={{\n          //         width: \"50%\",\n          //         margin: \"0 auto\",\n          //         position: \"relative\",\n          //         top: \"40vh\",\n          //       }}\n          //     >\n          //       <h3\n          //         style={{\n          //           textAlign: \"center\",\n          //           color: \"black\",\n          //           backgroundColor: \"rgb(230, 230, 230)\",\n          //           zIndex: \"2\",\n          //         }}\n          //         className=\"rounded-pill p-3\"\n          //       >\n          //         Click to continue\n          //       </h3>\n          //     </div>\n          //   </a>\n          // )\n        }\n        <SecondContainer>\n          <h1 className=\"mb-3\">\n            {editArticleData ? \"Edit Article\" : \"Create Article\"}\n          </h1>\n          <div>\n            <div>\n              <Widget\n                src={\"rubycop.near/widget/NDC.StyledComponents\"}\n                props={{\n                  Button: {\n                    className: \"primary dark\",\n                    disable: state.articleId > 0 || state.articleBody > 0,\n                    text: editArticleData ? \"Save edition\" : \"Save article\",\n                    onClick: createArticleListener,\n                    icon: <i className=\"bi bi-check2\"></i>,\n                  },\n                }}\n              />\n\n              {\n                //   <Button\n                //   type=\"submit\"\n                //   disable={state.articleId > 0 || state.articleBody > 0}\n                //   onClick={saveHandler}\n                // >\n                //   {state.saving && (\n                //     <div\n                //       className=\"spinner-border text-secondary\"\n                //       style={{ height: \"1rem\", width: \"1rem\" }}\n                //       role=\"status\"\n                //     >\n                //       <span className=\"sr-only\" title=\"Loading...\"></span>\n                //     </div>\n                //   )}\n                //   Save Article\n                // </Button>\n              }\n            </div>\n            <div className=\"d-flex flex-column pt-3\">\n              <label for=\"inputArticleId\">\n                Input article id (case-sensitive, without spaces):\n              </label>\n              <label for=\"inputArticleId\" className=\"small text-danger\">\n                {state.errorId}\n              </label>\n              <Widget\n                src={`f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/fasterTextInput`}\n                props={{\n                  firstText: state.articleId,\n                  stateUpdate: (obj) => State.update(obj),\n                  filterText: (e) => e.target.value.replace(/\\s+/g, \"\"),\n                  editable: editArticleData,\n                }}\n              />\n            </div>\n            <div className=\"d-flex flex-column pt-3\">\n              <Widget\n                src={`${authorForWidget}/widget/TagsEditor`}\n                props={{\n                  initialTagsObject: state.tags,\n                  placeholder: \"Input tags\",\n                  setTagsObject: (tags) => {\n                    state.tags = Object.keys(tags);\n                    State.update();\n                  },\n                }}\n              />\n            </div>\n            <div className=\"d-flex flex-column pt-3\">\n              <label for=\"textareaArticleBody\">\n                Input article body (in makrdown format):\n              </label>\n              <label for=\"textareaArticleBody\" className=\"small text-danger\">\n                {state.errorBody}\n              </label>\n              <div className=\"d-flex gap-2\" style={{ minHeight: \"300px\" }}>\n                <div className=\"w-50\">\n                  <Widget\n                    src=\"mob.near/widget/MarkdownEditorIframe\"\n                    props={{\n                      initialText: initialBody,\n                      onChange: (articleBody) => State.update({ articleBody }),\n                    }}\n                  />\n                </div>\n                <div className=\"w-50\">\n                  <Widget\n                    src=\"mob.near/widget/SocialMarkdown\"\n                    props={{ text: state.articleBody }}\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </SecondContainer>\n        <div style={{ display: \"none\" }}>\n          {callLibs(libSrcArray, createStateUpdate, state.libCalls)}\n        </div>\n      </CreationContainer>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sayalot.near/widget/SayALot.Create", "fact_widget_deployments_id": "caa918e504196532fccc51cfae72390d", "inserted_timestamp": "2023-08-29T12:19:41.157Z", "modified_timestamp": "2023-08-29T12:19:41.157Z", "__row_index": 80}
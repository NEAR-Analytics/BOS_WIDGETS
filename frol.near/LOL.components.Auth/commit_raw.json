{"tx_hash": "Bkuuu7AP1pGYYjS7JBnA6Ny43XqaQJyxiafYEmRcs9FE", "action_id_social": "4niN7TQS2TdRP7AMM4veiZEndwuy2XvYB5iBBzbpSBsY-0-widget", "block_id": 98644130, "block_timestamp": "2023-08-12T14:42:22.585Z", "signer_id": "frol.near", "widget_name": "LOL.components.Auth", "source_code": "State.init({\n  mode: null,\n  form: {},\n});\n\nconst onTextChange = (event) => {\n  State.update({\n    form: { ...state.form, [event.target.id]: event.target.value },\n  });\n};\n\nconst createNewAccount = () => {\n  State.update({ isLoading: true });\n  asyncFetch(\"https://coins.summerschool.lol/create-new-account\", {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      ...state.form,\n      new_account_id: `${state.form.new_account_id}.near`,\n    }),\n  }).then((data) => {\n    if (data.ok) {\n      State.update({\n        isLoading: false,\n        mode: \"CREATE_NEW_ACCOUNT_SUCCESS\",\n      });\n    } else {\n      State.update({\n        isLoading: false,\n        formError: `\u0422\u0440\u0430\u043f\u0438\u043b\u0430\u0441\u044c \u043f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u0456 \u0430\u043a\u0430\u0443\u043d\u0442\u0443! \u041f\u0435\u0440\u0435\u0432\u0456\u0440\u0442\u0435 \u0449\u043e \u0430\u043a\u0430\u0443\u043d\u0442\u0443 \u0437 \u0442\u0430\u043a\u0438\u043c \u043f\u0441\u0435\u0432\u0434\u043e\u043d\u0456\u043c\u043e\u043c \u0449\u0435 \u043d\u0435 \u0456\u0441\u043d\u0443\u0454, \u043f\u0430\u0440\u043e\u043b\u044c \u0432\u0432\u0435\u0434\u0435\u043d\u043e \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e \u0456 \u043f\u0443\u0431\u043b\u0456\u0447\u043d\u0438\u0439 \u043a\u043b\u044e\u0447 \u0432\u0456\u0434\u043f\u043e\u0432\u0456\u0434\u0430\u0454 \u0444\u043e\u0440\u043c\u0430\u0442\u0443 \"ed25519:...\" (${JSON.stringify(\n          data\n        )})`,\n      });\n    }\n  });\n};\n\nconst linkExistingAccount = () => {\n  State.update({ isLoading: true });\n  asyncFetch(\"https://coins.summerschool.lol/link-existing-account\", {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      ...state.form,\n      existing_account_id: context.accountId,\n    }),\n  }).then((data) => {\n    if (data.ok) {\n      State.update({\n        isLoading: false,\n        mode: \"LINK_EXISTING_ACCOUNT_SUCCESS\",\n      });\n    } else {\n      State.update({\n        isLoading: false,\n        formError: `\u0422\u0440\u0430\u043f\u0438\u043b\u0430\u0441\u044c \u043f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0454\u0441\u0442\u0440\u0430\u0446\u0456\u0457 \u0430\u043a\u0430\u0443\u043d\u0442\u0443! \u041f\u0435\u0440\u0435\u0432\u0456\u0440\u0442\u0435 \u0449\u043e \u043f\u0430\u0440\u043e\u043b\u044c \u0432\u0432\u0435\u0434\u0435\u043d\u043e \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\" (${JSON.stringify(\n          data\n        )})`,\n      });\n    }\n  });\n};\n\nif (state.mode === null) {\n  return (\n    <>\n      {!context.accountId ? (\n        <>\n          <div>\n            \u0423\u0432\u0456\u0439\u0434\u0456\u0442\u044c \u0443 \u0441\u0432\u0456\u0439 NEAR \u0430\u043a\u0430\u0443\u043d\u0442 \u0447\u0435\u0440\u0435\u0437 \u043a\u043d\u043e\u043f\u043a\u0443 \"Sign In\", \u0449\u043e \u0437\u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0443\n            \u043f\u0440\u0430\u0432\u043e\u043c\u0443 \u0432\u0435\u0440\u0445\u043d\u044c\u043e\u043c\u0443 \u043a\u0443\u0442\u0456.\n          </div>\n          \u0430\u0431\u043e\n        </>\n      ) : null}\n      <div>\n        <button onClick={() => State.update({ mode: \"CREATE_NEW_ACCOUNT\" })}>\n          \u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u043d\u043e\u0432\u0438\u0439 \u0430\u043a\u0430\u0443\u043d\u0442 NEAR\n        </button>\n      </div>\n      \u0430\u0431\u043e\n      <div>\n        <button onClick={() => State.update({ mode: \"LINK_EXISTING_ACCOUNT\" })}>\n          \u0423\u0432\u0456\u0439\u0442\u0438 \u0443 \u041b\u041e\u041b \u0437 \u043c\u043e\u0457\u043c \u0456\u0441\u043d\u0443\u044e\u0447\u0438\u043c \u0430\u043a\u0430\u0443\u043d\u0442\u043e\u043c NEAR\n        </button>\n      </div>\n    </>\n  );\n} else if (state.mode === \"CREATE_NEW_ACCOUNT\") {\n  return (\n    <>\n      <h2>\u0412\u0456\u0442\u0430\u0454\u043c\u043e \u0443 \u041b\u041e\u041b!</h2>\n      <div>\n        <label>\n          \u041f\u0441\u0435\u0432\u0434\u043e\u043d\u0456\u043c (NEAR account ID):{\" \"}\n          <input type=\"text\" id=\"new_account_id\" onChange={onTextChange} />\n          {state.form.new_account_id\n            ? `\u0406\u043c\u02bc\u044f \u0432\u0430\u0448\u043e\u0433\u043e \u0430\u043a\u0430\u0443\u043d\u0442\u0430 \u0431\u0443\u0434\u0435 ${state.form.new_account_id}.near`\n            : null}\n        </label>\n      </div>\n      <div>\n        <label>\n          \u0421\u0435\u043a\u0440\u0435\u0442\u043d\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c \u0449\u043e \u0431\u0443\u0432 \u043d\u0430\u0434\u0456\u0441\u043b\u0430\u043d\u0438\u0439 \u043d\u0430 \u0435\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443 \u043f\u043e\u0448\u0442\u0443:{\" \"}\n          <input type=\"password\" id=\"password\" onChange={onTextChange} />\n        </label>\n      </div>\n      <div>\n        <label>\n          \u0417\u0433\u0435\u043d\u0435\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u0440\u0443 \u043a\u0440\u0438\u043f\u0442\u043e\u0433\u0440\u0430\u0444\u0456\u0447\u043d\u0438\u0445 \u043a\u043b\u044e\u0447\u0456\u0432 ed25519 (\u043d\u0430\u043f\u0440\u0438\u043a\u043b\u0430\u0434,{\" \"}\n          <a href=\"https://near.github.io/near-seed-phrase/\" target=\"_blank\">\n            \u0442\u0443\u0442\n          </a>\n          ), \u043d\u0430\u0434\u0456\u0439\u043d\u043e \u0437\u0431\u0435\u0440\u0435\u0436\u0456\u0442\u044c \u043c\u043d\u0435\u043c\u043e\u043d\u0456\u0447\u043d\u0443 \u0444\u0440\u0430\u0437\u0443 (Seed Phrase) \u0434\u043b\u044f \u0432\u0456\u0434\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044f\n          \u043a\u043b\u044e\u0447\u0430 \u0443 \u043c\u0430\u0439\u0431\u0443\u0442\u043d\u044c\u043e\u043c\u0443, \u0442\u0430 \u0432\u0432\u0435\u0434\u0456\u0442\u044c \u041f\u0423\u0411\u041b\u0406\u0427\u041d\u0418\u0419 \u043a\u043b\u044e\u0447 (Public Key) \u0443 \u0444\u043e\u0440\u043c\u0430\u0442\u0456\n          \"ed25519:...\":{\" \"}\n          <input type=\"text\" id=\"new_public_key\" onChange={onTextChange} />\n        </label>\n      </div>\n      <div>\n        <label>\n          {state.formError ? <b>{state.formError}</b> : null}\n          <button\n            onClick={createNewAccount}\n            disabled={\n              state.isLoading ||\n              !(\n                state.form.new_account_id &&\n                state.form.password &&\n                state.form.new_public_key\n              )\n            }\n          >\n            \u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u043d\u043e\u0432\u0438\u0439 \u0430\u043a\u0430\u0443\u043d\u0442\n          </button>\n          {state.isLoading\n            ? \"\u0412\u0430\u0448 \u0437\u0430\u043f\u0438\u0442 \u043e\u0431\u0440\u043e\u0431\u043b\u044f\u0454\u0442\u044c\u0441\u044f, \u0446\u0435 \u043c\u043e\u0436\u0435 \u0437\u0430\u0439\u043c\u0430\u0442\u0438 \u0434\u043e 10 \u0441\u0435\u043a\u0443\u043d\u0434, \u0437\u0430\u0447\u0435\u043a\u0430\u0439\u0442\u0435...\"\n            : null}\n        </label>\n      </div>\n    </>\n  );\n} else if (state.mode === \"CREATE_NEW_ACCOUNT_SUCCESS\") {\n  return (\n    <>\n      <h2>\u0412\u0456\u0442\u0430\u0454\u043c\u043e \u0443 \u041b\u041e\u041b!</h2>\n      <p>{`NEAR \u0430\u043a\u0430\u0443\u043d\u0442 ${state.form.new_account_id}.near \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043e!`}</p>\n      <p>\n        \u0422\u0435\u043f\u0435\u0440 \u0443\u0432\u0456\u0439\u0434\u0456\u0442\u044c \u0443 \u0441\u0432\u0456\u0439 \u0430\u043a\u0430\u0443\u043d\u0442 \u0447\u0435\u0440\u0435\u0437 \u043a\u043d\u043e\u043f\u043a\u0443 \"Sign In\", \u0449\u043e \u0437\u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0443\n        \u043f\u0440\u0430\u0432\u043e\u043c\u0443 \u0432\u0435\u0440\u0445\u043d\u044c\u043e\u043c\u0443 \u043a\u0443\u0442\u0456.\n      </p>\n    </>\n  );\n} else if (state.mode === \"LINK_EXISTING_ACCOUNT\") {\n  if (context.accountId) {\n    return (\n      <>\n        <h2>\u0412\u0456\u0442\u0430\u0454\u043c\u043e \u0443 \u041b\u041e\u041b!</h2>\n        <div>\n          <label>\n            \u041f\u0441\u0435\u0432\u0434\u043e\u043d\u0456\u043c (NEAR account ID), \u0449\u043e \u0431\u0443\u0434\u0435 \u0437\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u043e \u0443 \u041b\u041e\u041b:{\" \"}\n            {context.accountId}\n          </label>\n        </div>\n        <div>\n          <label>\n            \u0421\u0435\u043a\u0440\u0435\u0442\u043d\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c \u0449\u043e \u0431\u0443\u0432 \u043d\u0430\u0434\u0456\u0441\u043b\u0430\u043d\u0438\u0439 \u043d\u0430 \u0435\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443 \u043f\u043e\u0448\u0442\u0443:{\" \"}\n            <input type=\"password\" id=\"password\" onChange={onTextChange} />\n          </label>\n        </div>\n        <div>\n          <label>\n            {state.formError ? <b>{state.formError}</b> : null}\n            <button\n              onClick={linkExistingAccount}\n              disabled={state.isLoading || !state.form.password}\n            >\n              \u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u0443\u0432\u0430\u0442\u0438 \u043c\u0456\u0439 NEAR \u0430\u043a\u0430\u0443\u043d\u0442 \u0443 \u041b\u041e\u041b\n            </button>\n            {state.isLoading\n              ? \"\u0412\u0430\u0448 \u0437\u0430\u043f\u0438\u0442 \u043e\u0431\u0440\u043e\u0431\u043b\u044f\u0454\u0442\u044c\u0441\u044f, \u0446\u0435 \u043c\u043e\u0436\u0435 \u0437\u0430\u0439\u043c\u0430\u0442\u0438 \u0434\u043e 10 \u0441\u0435\u043a\u0443\u043d\u0434, \u0437\u0430\u0447\u0435\u043a\u0430\u0439\u0442\u0435...\"\n              : null}\n          </label>\n        </div>\n      </>\n    );\n  } else if (state.mode === \"LINK_EXISTING_ACCOUNT_SUCCESS\") {\n    return (\n      <>\n        <h2>\u0412\u0456\u0442\u0430\u0454\u043c\u043e \u0443 \u041b\u041e\u041b!</h2>\n        <p>\n          {`NEAR \u0430\u043a\u0430\u0443\u043d\u0442 ${state.form.existing_account_id}.near \u0443\u0441\u043f\u0456\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u043e!`}\n        </p>\n        <p>\n          \u0422\u0435\u043f\u0435\u0440 \u0443\u0432\u0456\u0439\u0434\u0456\u0442\u044c \u0443 \u0441\u0432\u0456\u0439 \u0430\u043a\u0430\u0443\u043d\u0442 \u0447\u0435\u0440\u0435\u0437 \u043a\u043d\u043e\u043f\u043a\u0443 \"Sign In\", \u0449\u043e \u0437\u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0443\n          \u043f\u0440\u0430\u0432\u043e\u043c\u0443 \u0432\u0435\u0440\u0445\u043d\u044c\u043e\u043c\u0443 \u043a\u0443\u0442\u0456.\n        </p>\n      </>\n    );\n  } else {\n    return (\n      <h3>\n        \u0421\u043f\u043e\u0447\u0430\u0442\u043a\u0443 \u0443\u0432\u0456\u0439\u0434\u0456\u0442\u044c \u0443 \u0441\u0432\u0456\u0439 NEAR \u0430\u043a\u0430\u0443\u043d\u0442 \u0447\u0435\u0440\u0435\u0437 \u043a\u043d\u043e\u043f\u043a\u0443 \"Sign In\", \u0449\u043e\n        \u0437\u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0443 \u043f\u0440\u0430\u0432\u043e\u043c\u0443 \u0432\u0435\u0440\u0445\u043d\u044c\u043e\u043c\u0443 \u043a\u0443\u0442\u0456, \u0430\u0431\u043e \u043e\u043d\u043e\u0432\u0456\u0442\u044c \u0441\u0442\u043e\u0440\u0456\u043d\u043a\u0443 \u0456 \u043f\u0435\u0440\u0435\u0439\u0434\u0456\u0442\u044c\n        \u0434\u043e \u0441\u0442\u0432\u043e\u0440\u0435\u043d\u043d\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0430\u043a\u0430\u0443\u043d\u0442\u0443.\n      </h3>\n    );\n  }\n}\n", "metadata": {"platform": "jutsu.ai"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/frol.near/widget/LOL.components.Auth", "fact_widget_deployments_id": "f4a1c348061b8411a8b5703fed3c4676", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
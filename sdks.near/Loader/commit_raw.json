{"tx_hash": "7UtdtewCvF3fh94jqX7km6HoLCrTrBhohh3V73e47AqB", "action_id_social": "DJNWkzjJNAJNMbaZJVhDd1haz2718gbvgsYbYzR8fwAr-0-widget", "block_id": 110302174, "block_timestamp": "2024-01-13T11:52:09.747Z", "signer_id": "sdks.near", "widget_name": "Loader", "source_code": "let TYPES = {};\nconst TYPE_LIBRARY = \"@\";\nconst TYPE_IMAGE = \"img:\";\nconst TYPE_JSON = \"json:\";\nconst TYPE_URL = \"url:\";\nTYPES[TYPE_LIBRARY] = \"libs\";\nTYPES[TYPE_IMAGE] = \"images\";\nTYPES[TYPE_JSON] = \"data\";\nTYPES[TYPE_URL] = \"links\";\n\nlet loaders = {};\nloaders[TYPES[TYPE_LIBRARY]] = {\n    string: (account, dependency) => {\n    let result = {};\n    result[dependency.split(\".\").pop()] = VM.require(\n      `${account}/widget/${dependency}`\n    );\n    return result;\n  },\n  object: (account, dependencies) => {\n    let result = {};\n\n    if (Array.isArray(dependencies)) {\n      dependencies.map(\n        (dependency) =>\n          (result[dependency.split(\".\").pop()] = VM.require(\n            `${account}/widget/${dependency}`\n          ))\n      );\n    } else {\n      Object.keys(dependencies).map((containerName) =>\n        dependencies[containerName].map(\n          (dependency) =>\n            (result[dependency.split(\".\").pop()] = VM.require(\n              `${account}/widget/${dependency}`\n            ))\n        )\n      );\n    }\n\n    return result;\n  },\n  void: () => {},\n};\n\nloaders[TYPES[TYPE_IMAGE]] = {\n    string: (account, value) => value,\n    void: () => {},\n};\n\nloaders[TYPES[TYPE_URL]] = loaders[TYPES[TYPE_IMAGE]];\nloaders[TYPES[TYPE_JSON]] = {\n    string: (account, text) => JSON.parse(text),\n  object: (account, data) => data,\n  void: () => {},\n};\n\nconst getType = (type) => (type in TYPES ? TYPES[type] : null);\nconst getScope = (namespace) =>\n  namespace[0] in TYPES\n    ? namespace[0]\n    : namespace.substring(0, namespace.indexOf(\":\") + 1) in TYPES\n    ? namespace.substring(0, namespace.indexOf(\":\") + 1)\n    : null;\nconst getAccount = (scope, namespace) =>\n  `${namespace.substring(scope.length, namespace.indexOf(\"/\"))}.near`;\nconst getPath = (namespace) =>\n  namespace.substring(namespace.indexOf(\"/\") + 1, namespace.length);\nconst parseRequest = (namespace) => [\n  getAccount(getScope(namespace), namespace),\n  getType(getScope(namespace)),\n  getPath(namespace),\n];\nconst getManifest = (account) => VM.require(`${account}/widget/Manifest`);\nconst getResource = (manifest, resourceType) =>\n  resourceType in manifest ? manifest[resourceType] : {};\nconst getDependencies = (resource, path) =>\n  path.split(\"/\").reduce((path, nextPath) => (path || {})[nextPath], resource);\nconst loadDependencies = (account, loaderName, dependencies) =>\n  loaders[loaderName || TYPES[TYPE_LIBRARY]][typeof dependencies !== \"undefined\" ? typeof dependencies : \"void\"](\n    account,\n    dependencies\n  );\nconst load = (account, resourceType, path) =>\n  loadDependencies(\n    account,\n    resourceType,\n    getDependencies(getResource(getManifest(account) || {}, resourceType), path)\n  );\n\nreturn (namespace) => load(...parseRequest(namespace));\n", "metadata": {"description": "$Loader is a library that allows injecting dependencies from your or other users' account into components in a seamlessly way.\n\nTo start using it, just simply place this code in the top of your component:\n```\nconst $ = VM.require(\"sdks.near/widget/Loader\");\n```\n\n## How does it work?\nWhen you work with libraries, you need a way to keep your dependencies structured in a way that can be easily accessed by you or anyone that is building with it. To do so, you need a way to define what's the library structure and the components that compose it, and that's where the `Manifest` file comes in.\n\n## Manifest\nThe `Manifest` file is a JavaScript object component that needs to be placed at the root level of your account. This way, you can expose the libraries you have available and its structure, so `$Loader` is able to inject them on-demand.\n\nExample\n```\nreturn {\n  libs: {\n    \"eth-signer\": \"SDKs.EthereumSigner.Main\",\n    lens: {\n      definitions: [\"SDKs.Lens.Constants\", \"SDKs.Lens.Interfaces\"],\n      api: [\"SDKs.Lens.API.AuthAPI\", \"SDKs.Lens.API.HealthAPI\"],\n      queries: [\"SDKs.Lens.Queries.Auth\", \"SDKs.Lens.Queries.Health\"],\n      sdk: [\"SDKs.Lens.Main\"],\n    },\n    \"light-client\": [\"SDKs.LightClient\"],\n  },\n};\n```\n\nThis `Manifest` exposes the `eth-signer`, `lens` and `light-client` libraries.\n\n# Types\n`$Loader` library is not only meant to be able to load only dependencies, but also can support different types of data. For that reason, the `Manifest` object schema looks the following way:\n- `libs`: Here you can define the structure of your libraries\n- `images`: Here you can define images in your preferred way (IPFS URL, base64, NEAR Social's FS...)\n- `links`: Here you can define links to other websites or components that are commonly accessed by other people. This way you can ensure everyone has the same link, even if you change it!\n- `data`: Here you can define JavaScript objects with static data that can be later leveraged in a dApp\n\n## Dependency injection\nIn order to inject resources to your component, you just have to pass `$Loader` the namespace of the resource you want to load. Namespaces have the following format:\n`<scope><account>/<resource>`\nNote that the account name does not include the `.near` fragment\n\nExample\n```\n// Loading $Loader\nconst $ = VM.require(\"sdks.near/widget/Loader\");\n\n// Importing libraries from skds.near\nconst { EthereumSigner } = $(\"@sdks/eth-signer\");\nconst { AuthAPI, HealthAPI } = $(\"@sdks/lens/api\");\n```\n\nIn the example, we load the `EthereumSigner`, `AuthAPI` and `HealthAPI` from the `sdks.near` account.\n\n# Namespace structure\n- `<scope>`: It supports the following scopes\n  - `@` - Library scope. Loads the dependencies under the `libs` index from the `Manifest` file\n  - `img:` - Images scope. Loads the dependencies under the `images` index from the `Manifest` file\n  - `url:` - Links scope. Loads the dependencies under the `links` index from the `Manifest` file\n  - `json:` - JSON scope. Loads the dependencies under the `data` index from the `Manifest` file\n- `<account>`: The NEAR account you want to load the resource from, without including the `.near`\n- `<resource>`: The name of the library. This name is the index of the `libs` object first level from the `Manifest` file", "image": {}, "name": "$Loader"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sdks.near/widget/Loader", "fact_widget_deployments_id": "bd39628dbbe93a0dc6b19587a5c3f20c", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 13}
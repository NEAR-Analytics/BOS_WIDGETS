{"tx_hash": "47p7MsW4CaMuRL37E7Xw6HSb7fAESuZb12PNEacFbRmi", "action_id_social": "FYUQ5VYzpP7Njr1o2ADcVH533XtTZdXdj7J1kyYNoBuU-0-widget", "block_id": 110976258, "block_timestamp": "2024-01-21T16:57:54.007Z", "signer_id": "sdks.near", "widget_name": "Abstracts.ExternalDependency", "source_code": "return (props) => {\n  const code = `\n        <script>\n            const ping = () => {\n                window.top.postMessage(\"ping\", \"*\");\n            }\n        </script>\n        <script type=\"text/javascript\" src=\"https://unpkg.com/${props.adapter.package}\"></script>\n        <script type=\"text/javascript\">\n\n            if (${props.adapter.name}) {\n                ping();\n            }\n        \n            const getPackageMethod = (instruction, package) => {\n                return instruction.split(\".\").reduce((path, nextPath) => (path || {})[nextPath], package);\n            };\n        \n            window.addEventListener(\"message\", (e) => {\n              if (e.data.instruction) {\n                 let value = Array.isArray(e.data.value) ? e.data.value : [e.data.value];\n                 let result = getPackageMethod(e.data.instruction, ${props.adapter.name})(...value);\n                 let parseResult = (result) => {\n                    if (e.data.returnType == \"object\" || e.data.returnType == \"array\") {\n                        return JSON.stringify(result);\n                    }\n        \n                    if (e.data.returnType == \"string\") {\n                        return result.toString();\n                    }\n\n                    if (e.data.returnType == \"number\") {\n                        return result;\n                    }\n\n                    if (e.data.returnType == \"dom\") {\n                        return result;\n                    }\n                 }\n        \n                 window.top.postMessage({\n                    index: e.data.index,\n                    instruction: e.data.instruction,\n                    returnType: e.data.returnType,\n                    result: parseResult(result)\n                 }, \"*\");\n              }\n            })\n        </script>\n   `;\n\n  return (\n    <iframe\n      srcDoc={code}\n      style={{ display: \"none\" }}\n      message={props.adapter.getRequest()}\n      onMessage={(data) =>\n        data == \"ping\"\n          ? props.adapter.setAsReady()\n          : props.adapter.setResponse(data)\n      }\n    />\n  );\n};\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sdks.near/widget/Abstracts.ExternalDependency", "fact_widget_deployments_id": "97916af4532dbc2cb24950ce5a7f26c1", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 9}
{"tx_hash": "wWZrEJiHftf6L6LMxP6UsVJX7QtACFkrg6ioiaYTHK9", "action_id_social": "7hZNMPvWUBkiZeyZyF9ry8gUJmoovSv8giMvUm3xgURz-0-widget", "block_id": 111236170, "block_timestamp": "2024-01-24T22:57:25.071Z", "signer_id": "sdks.near", "widget_name": "Abstracts.ExternalDependencyAdapter", "source_code": "const $ = VM.require(\"sdks.near/widget/Loader\");\nconst { StatefulDependency } = $(\"@sdks/abstracts\");\n\nreturn (Store, status, name) => {\n  const API = {\n    ...StatefulDependency(Store, status, name),\n    instruction: \"\",\n    responses: {},\n    value: \"\",\n    init: (name) => {\n      API.initDependency({\n        ongoingRequest: {},\n        responses: {},\n      });\n\n      return API;\n    },\n    getRequest: () => {\n      return API.get(\"ongoingRequest\");\n    },\n    createRequest: (instruction, value, returnType) => {\n      return {\n        index: API.get(\"responses\")[instruction]\n          ? Object.keys(API.get(\"responses\")[instruction]).length\n          : 0,\n        instruction,\n        value,\n        returnType: returnType || \"string\",\n      };\n    },\n    request: (request) => {\n      API.set(\"ongoingRequest\", request);\n\n      return new Promise((resolve, reject) => {\n        let responses = API.get(\"responses\");\n\n        if (request.index == 0) {\n          responses[request.instruction] = {};\n        }\n\n        responses[request.instruction][request.index] = { resolve };\n        API.set(\"responses\", responses);\n      });\n    },\n    setResponse: (response) => {\n      let parsedResponse = API.parseResponse(response);\n      API.notify(\n        parsedResponse.instruction,\n        parsedResponse.index,\n        parsedResponse.result\n      );\n\n      let responses = API.get(\"responses\");\n      responses[parsedResponse.instruction][parsedResponse.index] =\n        parsedResponse;\n\n      API.set(\"responses\", responses);\n    },\n    parseResponse: (response) => {\n      return {\n        ...response,\n        result:\n          response.returnType == \"string\" || response.returnType == \"canvas\"\n            ? response.result\n            : JSON.parse(response.result),\n      };\n    },\n    notify: (instruction, index, result) => API.get(\"responses\")[instruction][index].resolve(result),\n    isReady: () => API.get(\"ready\"),\n    setAsReady: () => API.set(\"ready\", true),\n  };\n\n  return API.init();\n};\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sdks.near/widget/Abstracts.ExternalDependencyAdapter", "fact_widget_deployments_id": "3a218c9ff0dfd9e44b7e67fe2a02ee05", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 12}
{"tx_hash": "7ukvvh51YHteiyE4cuWKPEQ71vSobAAWkVMBeBq364DW", "action_id_social": "6sq1ckAkTBq1WyfmiHBjEhi6hjKMoetCPQHW6WgbufTn-0-widget", "block_id": 117561679, "block_timestamp": "2024-04-25T02:15:41.555Z", "signer_id": "flowscience.near", "widget_name": "getAttestation", "source_code": "// Example attestation UID: 0xff5dc0cdc3de27dfe6a4352c596c0f97b1f99c51a67bbae142ce315e34969dcd\n\nconst { easRenderAttestation } = VM.require(\n  \"flowscience.near/widget/easRenderAttestation\"\n);\n\nconst user = Ethers.send(\"eth_requestAccounts\", [])[0];\n\nif (!user) return <Web3Connect connectLabel=\"Connect\" />;\n\n{\n  /*\nconst chain = Ethers.provider()\n  .getNetwork()\n  .{then}((chainIdData) => {\n    console.log(chainIdData.chainId);\n  });\n*/\n}\n\nconst abi = fetch(\n  \"https://raw.githubusercontent.com/ethereum-attestation-service/eas-contracts/master/deployments/optimism/EAS.json\"\n);\nconst provider = new ethers.providers.JsonRpcProvider(\n  \"https://optimism.drpc.org\"\n);\nconst signer = provider.getSigner(user);\n// console.log(\"chain:\", chain);\n// console.log(\"signer:\", signer);\n\nconst contractAddress = \"0x4200000000000000000000000000000000000021\";\nconst parsedAbi = JSON.parse(abi.body);\nconst contract = new ethers.Contract(contractAddress, parsedAbi.abi, signer);\n//console.log(contract);\nconst [attestation, setAttestation] = useState(null);\nconst [error, setError] = useState(\"\");\nconst [uid, setUid] = useState(\"\");\nconst [showTooltip, setShowTooltip] = useState(false);\n\nfunction getAttestation() {\n  if (typeof uid !== \"string\" || uid.trim() === \"\") {\n    console.error(\"UID must be a non-empty string.\");\n    setError(\"UID must be provided.\");\n    return;\n  }\n\n  contract\n    .getAttestation(uid)\n    .then((result) => {\n      const [\n        uid,\n        schema,\n        time,\n        expirationTime,\n        revocationTime,\n        refUID,\n        recipient,\n        attester,\n        revocable,\n        data,\n      ] = result;\n      const mappedAttestation = {\n        uid,\n        schema,\n        time: time.toNumber(),\n        expirationTime: expirationTime.toNumber(),\n        revocationTime: revocationTime.toNumber(),\n        refUID,\n        recipient,\n        attester,\n        revocable,\n        data,\n      };\n      setAttestation(mappedAttestation);\n      setError(\"\");\n    })\n    .catch((error) => {\n      console.error(\"error fetching attestation:\", error);\n      setError(\"Failed to retrieve data. Please try with a verified uid.\");\n    });\n}\n\nconst handleShowTooltip = () => {\n  setShowTooltip(true);\n};\n\nconst handleHideTooltip = () => {\n  setTimeout(() => {\n    setShowTooltip(false);\n  }, 3000); // 3000 milliseconds = 3 seconds\n};\n\nconst tooltip = (\n  <Tooltip\n    id=\"tooltip\"\n    className=\"p-3 border bg-light\"\n    style={{ backgroundColor: \"lightgrey\" }}\n  >\n    <a\n      href=\"https://optimism.easscan.org/attestations\"\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n    >\n      Find Attestations on Optimism.\n    </a>\n  </Tooltip>\n);\n\nreturn (\n  <>\n    <div className=\"m-2\">\n      <h3>Get Attestation</h3>\n      <input\n        type=\"text\"\n        placeholder=\"input UID\"\n        value={uid}\n        onChange={(e) => setUid(e.target.value)}\n      />\n    </div>\n    <div className=\"m-2\">\n      <OverlayTrigger\n        className=\"p-3 border bg-light\"\n        placement=\"right\"\n        overlay={tooltip}\n        show={showTooltip}\n        onToggle={(nextShow) =>\n          nextShow ? handleShowTooltip() : handleHideTooltip()\n        }\n      >\n        <button className=\"btn btn-primary m-1\" onClick={getAttestation}>\n          Get Attestation\n        </button>\n      </OverlayTrigger>\n      <p className=\"m-1\">{error}</p>\n    </div>\n    <div>\n      {attestation && (\n        <div className=\"App\">\n          <easRenderAttestation attestation={attestation} />\n        </div>\n      )}\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/flowscience.near/widget/getAttestation", "fact_widget_deployments_id": "fd4396c6542019b6ac89fa868aaf8ea9", "inserted_timestamp": "2024-04-25T04:04:00.243Z", "modified_timestamp": "2024-04-25T04:04:00.243Z", "__row_index": 0}
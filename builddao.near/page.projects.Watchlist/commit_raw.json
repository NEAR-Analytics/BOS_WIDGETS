{"tx_hash": "Z32Sv46hT4VsudVzovYVy29ZzQMXnXJWCQN3D4Y5TbU", "action_id_social": "2k1jzsAuWKUMmypyvQREhYZ8tbSdEYgdNg5z2zgd3HhJ-0-widget", "block_id": 121158209, "block_timestamp": "2024-06-14T16:44:44.261Z", "signer_id": "builddao.near", "widget_name": "page.projects.Watchlist", "source_code": "if (!context.accountId) {\n  return (\n    <Widget\n      src=\"builddao.near/widget/components.LoginAction\"\n      loading=\"\"\n      props={{\n        text: \"Please log in in order to see watchlist projects!\",\n      }}\n    />\n  );\n}\nconst { fetchProjects } = VM.require(\"builddao.near/widget/lib.projects\") || {\n  fetchProjects: () => [],\n};\nconst stars = Social.getr(\n  `${context.accountId}/graph/star/*/project`,\n  \"final\",\n  {\n    withBlockHeight: true,\n  }\n);\nconst StorageKey = \"order\";\nconst order = Storage.privateGet(StorageKey);\nconst starredProjects = useMemo(() => {\n  if (stars === null || order === null) {\n    return [];\n  }\n  const starredApps = new Map();\n  const path = [];\n  const buildSrc = (node) => {\n    if (node.hasOwnProperty(\"\")) {\n      starredApps.set(path.join(\"/\"), node[\":block\"]);\n    }\n    Object.entries(node).forEach(([key, value]) => {\n      if (typeof value === \"object\") {\n        path.push(key);\n        buildSrc(value);\n        path.pop();\n      }\n    });\n  };\n  buildSrc(stars ?? {}, [], starredApps);\n  let apps = [...starredApps.entries()];\n  apps.sort((a, b) => b[1] - a[1]);\n  apps = apps.map((a) => a[0]);\n  apps.sort((a, b) => (order?.[a] || 0) - (order?.[b] || 0));\n  Storage.privateSet(\n    StorageKey,\n    Object.fromEntries(apps.map((a, i) => [a, i + 1]))\n  );\n  return apps;\n}, [stars, order]);\nconst starredProjectIds = starredProjects.map(\n  (project) => project.split(\"/\")[2]\n);\nconst projects = fetchProjects().filter((project) =>\n  starredProjectIds.includes(project.projectID)\n);\nreturn (\n  <Widget\n    src=\"builddao.near/widget/page.projects.MainViewContainer\"\n    loading=\"\"\n    props={{\n      description: \"Keep track of projects on your watch list.\",\n      heading: \"Watchlist\",\n      projects: projects,\n    }}\n  />\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/builddao.near/widget/page.projects.Watchlist", "fact_widget_deployments_id": "bd48f29c8a0fc04127a73a4353c2c9cf", "inserted_timestamp": "2024-06-14T17:55:46.860Z", "modified_timestamp": "2024-06-14T17:55:46.860Z", "__row_index": 0}
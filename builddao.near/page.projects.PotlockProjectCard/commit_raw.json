{"tx_hash": "7Y7zyMDjSX67qEpZypVJEQykLFi3YgyzKh9CweWiAk5K", "action_id_social": "748YHusYUGWR4WUgW78Ha5pNXS6ryPtAH8xEE5JbYEem-0-widget", "block_id": 121980118, "block_timestamp": "2024-06-25T17:49:48.231Z", "signer_id": "builddao.near", "widget_name": "page.projects.PotlockProjectCard", "source_code": "const { potId, potDetail, payoutDetails, projects } = props;\nconst { nearToUsd, ipfsUrlFromCid, yoctosToNear, yoctosToUsdWithFallback } =\n  VM.require(\"potlock.near/widget/utils\") || {\n    ipfsUrlFromCid: () => \"\",\n    yoctosToNear: () => \"\",\n    yoctosToUsdWithFallback: () => \"\",\n    nearToUsd: 1,\n  };\nconst { _address } = VM.require(\n  \"potlock.near/widget/Components.DonorsUtils\"\n) || {\n  _address: (address) => address,\n};\nconst { ownerId, NADA_BOT_URL, SUPPORTED_FTS } = VM.require(\n  \"potlock.near/widget/constants\"\n) || {\n  ownerId: \"\",\n  NADA_BOT_URL: \"\",\n  SUPPORTED_FTS: {},\n};\nconst { getTagsFromSocialProfileData } = VM.require(\n  \"potlock.near/widget/utils\"\n) || {\n  getTagsFromSocialProfileData: () => [],\n};\nconst PotSDK = VM.require(\"potlock.near/widget/SDK.pot\") || {\n  getDonationsForProject: () => {},\n};\nlet DonateSDK =\n  VM.require(\"potlock.near/widget/SDK.donate\") ||\n  (() => ({\n    getDonationsForRecipient: () => {},\n  }));\nDonateSDK = DonateSDK({ env: \"production\" });\nconst Card = styled.div`\n  display: flex;\n  flex-direction: column;\n  max-width: 500px;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  border-radius: 12px;\n  background: var(--bg-color, #23242b);\n  color: var(--text-color, #fff);\n  margin-left: auto;\n  margin-right: auto;\n  transition: all 300ms;\n  &:hover {\n    transform: translateY(-0.5rem);\n  }\n  cursor: pointer;\n`;\nconst HeaderContainer = styled.div`\n  padding-left: 16px;\n  &:hover {\n    text-decoration: none;\n    cursor: pointer;\n  }\n  @media screen and (max-width: 768px) {\n    border-radius: 0;\n  }\n`;\nconst backgroundStyleHeightPx = 168;\nconst BackgroundImageContainer = styled.div`\n  svg {\n    position: absolute;\n    top: ${backgroundStyleHeightPx / 2}px;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    opacity: 0; // Start with the image invisible\n    transition: opacity 0.3s;\n    z-index: 2; // Ensure the image is on top\n    pointer-events: none;\n  }\n`;\nconst ProfileImageContainer = styled.div`\n  transform: translateY(138px);\n  width: 40px;\n  height: 40px;\n  position: absolute;\n  img {\n    width: 40px;\n    height: 40px;\n  }\n  &:hover {\n    cursor: pointer;\n    &:after {\n      background-color: rgba(\n        45.9,\n        45.9,\n        45.9,\n        0.4\n      ); // Dark overlay with 40% opacity on hover\n    }\n    svg {\n      opacity: 1; // Make the image visible on hover\n    }\n  }\n`;\nconst Info = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-top: 176px;\n  padding: 16px 24px;\n  gap: 16px;\n  flex: 1;\n`;\nconst Title = styled.div`\n  font-size: 16px;\n  font-weight: 600;\n  width: 100%;\n`;\nconst SubTitle = styled.div`\n  font-size: 14px;\n  font-weight: 400;\n  word-wrap: break-word;\n`;\nconst DonationsInfoContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 24px;\n  width: 100%;\n  border-top: 1px #f0f0f0 solid;\n`;\nconst DonationsInfoItem = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  align-items: center;\n`;\nconst Amount = styled.div`\n  font-size: 17px;\n  font-weight: 600;\n  line-height: 24px;\n`;\nconst AmountDescriptor = styled.div`\n  font-size: 11px;\n  font-weight: 400;\n  word-wrap: break-word;\n  text-transform: uppercase;\n  line-height: 16px;\n  letter-spacing: 1.1px;\n`;\nconst Tags = styled.div`\n  display: flex;\n  gap: 8px;\n  flex-wrap: wrap;\n`;\nconst Tag = styled.span`\n  box-shadow: 0px -0.699999988079071px 0px rgba(123, 123, 123, 0.36) inset;\n  padding: 4px 8px;\n  border-radius: 4px;\n  border: 1px solid rgba(123, 123, 123, 0.36);\n`;\n// Skeleton\nconst loadingSkeleton = styled.keyframes`\n  0% {\n    opacity: 0.8;\n  }\n  50% {\n    opacity: 0.3;\n  }\n  100% {\n    opacity: 0.6;\n  }\n`;\nconst CardSkeletonContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 447px;\n  width: 100%;\n  max-width: 400px;\n  border-radius: 12px;\n  background: var(--bg-color, #23242b);\n  color: var(--text-color, #fff);\n  margin-left: auto;\n  margin-right: auto;\n  overflow: hidden;\n  animation-name: ${loadingSkeleton};\n  animation-duration: 1s;\n  animation-iteration-count: infinite;\n`;\nconst HeaderSkeleton = styled.div`\n  display: block;\n  width: 100%;\n  height: 168px;\n  background: #eee;\n`;\nconst ProfileImageSkeleton = styled.div`\n  background: #e0e0e0;\n  margin-left: 32px;\n  transform: translateY(148px);\n  width: 40px;\n  height: 40px;\n  position: absolute;\n  border-radius: 999px;\n`;\nconst TitleSkeleton = styled.div`\n  width: 120px;\n  height: 24px;\n  background: #eee;\n  margin-left: 24px;\n  margin-top: 24px;\n`;\nconst DescriptionSkeleton = styled.div`\n  width: 83%;\n  height: 48px;\n  background: #eee;\n  margin-left: 24px;\n  margin-top: 24px;\n`;\nconst TagSkeleton = styled.div`\n  background: #eee;\n  border-radius: 4px;\n  height: 34px;\n  width: 110px;\n  margin: 24px;\n`;\nconst FooterItemSkeleton = styled.div`\n  width: 150px;\n  height: 40px;\n  background: #eee;\n  @media screen and (max-width: 390px) {\n    width: 100px;\n  }\n`;\nconst DonationsInfoContainerSkeleton = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 24px;\n  width: 100%;\n  border-top: 1px #f0f0f0 solid;\n`;\nconst DonationsInfoItemSkeleton = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  align-items: center;\n`;\nconst CardSkeleton = () => (\n  <CardSkeletonContainer>\n    <HeaderSkeleton />\n    <ProfileImageSkeleton />\n    <TitleSkeleton />\n    <DescriptionSkeleton />\n    <TagSkeleton />\n    <DonationsInfoContainerSkeleton>\n      <DonationsInfoItemSkeleton>\n        <FooterItemSkeleton />\n      </DonationsInfoItemSkeleton>\n      <DonationsInfoItemSkeleton>\n        <FooterItemSkeleton />\n      </DonationsInfoItemSkeleton>\n    </DonationsInfoContainerSkeleton>\n  </CardSkeletonContainer>\n);\nconst projectId = props.project.id || props.projectId;\nconst profile = Social.getr(`${projectId}/profile`);\nif (profile === null) return <CardSkeleton />;\nconst MAX_DESCRIPTION_LENGTH = 80;\nconst { name, description, plCategories } = profile;\nconst donationsForProject = potId\n  ? PotSDK.getDonationsForProject(potId, projectId)\n  : DonateSDK.getDonationsForRecipient(projectId);\nif (donationsForProject === null) return <CardSkeleton />;\nconst [totalAmountNear, totalDonors] = useMemo(() => {\n  if (!donationsForProject) return [\"0\", 0];\n  const donors = [];\n  let totalDonationAmountNear = new Big(0);\n  for (const donation of donationsForProject) {\n    if (!donors.includes(donation.donor_id)) {\n      donors.push(donation.donor_id);\n    }\n    if (\n      donation.ft_id === \"near\" ||\n      donation.base_currency === \"near\" ||\n      potId\n    ) {\n      totalDonationAmountNear = totalDonationAmountNear.plus(\n        new Big(donation.total_amount)\n      );\n    }\n  }\n  return [totalDonationAmountNear.toString(), donors.length];\n}, [donationsForProject]);\nconst getImageSrc = (image) => {\n  const defaultImageUrl =\n    \"https://ipfs.near.social/ipfs/bafkreih4i6kftb34wpdzcuvgafozxz6tk6u4f5kcr2gwvtvxikvwriteci\";\n  if (!image) return defaultImageUrl;\n  const { url, ipfs_cid } = image;\n  if (ipfs_cid) {\n    return ipfsUrlFromCid(ipfs_cid);\n  } else if (url) {\n    return url;\n  }\n  return defaultImageUrl;\n};\nconst backgroundImageStyle = {\n  objectFit: \"cover\",\n  left: 0,\n  top: 0,\n  height: \"168px\",\n  borderRadius: \"6px 6px 0px 0px\",\n  pointerEvents: \"none\",\n};\nconst profileImageStyle = {\n  width: \"40px\",\n  height: \"40px\",\n  position: \"absolute\",\n  bottom: \"-10px\",\n  left: \"14px\",\n  pointerEvents: \"none\",\n};\nconst tags = getTagsFromSocialProfileData(profile);\nreturn (\n  <div\n    data-testid=\"potlock-card\"\n    onClick={() => props.setShowCreateModalProjectId(projectId)}\n  >\n    <Card>\n      <HeaderContainer className=\"pt-0 position-relative\">\n        <BackgroundImageContainer>\n          {profile.backgroundImage?.nft ? (\n            <Widget\n              src=\"mob.near/widget/Image\"\n              props={{\n                image: profile.backgroundImage,\n                alt: \"background\",\n                className: \"position-absolute w-100\",\n                style: backgroundImageStyle,\n                fallbackUrl:\n                  \"https://ipfs.near.social/ipfs/bafkreih4i6kftb34wpdzcuvgafozxz6tk6u4f5kcr2gwvtvxikvwriteci\",\n              }}\n            />\n          ) : (\n            <img\n              className=\"position-absolute w-100\"\n              style={backgroundImageStyle}\n              src={getImageSrc(profile.backgroundImage)}\n              alt=\"background\"\n            />\n          )}\n        </BackgroundImageContainer>\n        <ProfileImageContainer class=\"profile-picture d-inline-block\">\n          {profile.image?.nft ? (\n            <Widget\n              src=\"mob.near/widget/Image\"\n              props={{\n                image: profile.image,\n                alt: \"avatar\",\n                className: \"rounded-circle w-100 img-thumbnail d-block\",\n                style: profileImageStyle,\n                fallbackUrl:\n                  \"https://ipfs.near.social/ipfs/bafkreih4i6kftb34wpdzcuvgafozxz6tk6u4f5kcr2gwvtvxikvwriteci\",\n              }}\n            />\n          ) : (\n            <img\n              className=\"rounded-circle w-100 img-thumbnail d-block\"\n              style={profileImageStyle}\n              src={getImageSrc(profile.image)}\n              alt=\"avatar\"\n            />\n          )}\n        </ProfileImageContainer>\n      </HeaderContainer>\n      <Info>\n        <Title>{_address(name, 30) || _address(projectId, 30)}</Title>\n        <SubTitle>\n          {description.length > MAX_DESCRIPTION_LENGTH\n            ? description.slice(0, MAX_DESCRIPTION_LENGTH) + \"...\"\n            : description}\n        </SubTitle>\n        {!tags.length ? (\n          \"No tags\"\n        ) : (\n          <Tags>\n            {tags.map((tag, tagIndex) => (\n              <Tag key={tagIndex}>{tag}</Tag>\n            ))}\n          </Tags>\n        )}\n      </Info>\n      <DonationsInfoContainer>\n        <DonationsInfoItem>\n          <Amount>\n            {totalAmountNear\n              ? yoctosToUsdWithFallback(totalAmountNear, true)\n              : \"-\"}\n          </Amount>\n          <AmountDescriptor>Raised</AmountDescriptor>\n        </DonationsInfoItem>\n      </DonationsInfoContainer>\n    </Card>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/builddao.near/widget/page.projects.PotlockProjectCard", "fact_widget_deployments_id": "2ec51e3e4ccdd45c640bf60154f5c485", "inserted_timestamp": "2024-06-25T18:55:22.973Z", "modified_timestamp": "2024-06-25T18:55:22.973Z", "__row_index": 1}
{"tx_hash": "784SHXHYUMV63XsBdR6EbEbPsPahM5qwoteEc3oMExK4", "action_id_social": "HmbqDFt2iJKZsEJhZ324baMEtKUgEdvQ6hCekxzi11Z4-0-widget", "block_id": 121157771, "block_timestamp": "2024-06-14T16:36:18.780Z", "signer_id": "builddao.near", "widget_name": "page.proposals.create.Index", "source_code": "const { daos } = VM.require(\"builddao.near/widget/lib.daos\") || {\n  daos: [],\n};\nif (!daos) {\n  return \"\";\n}\nconst options = daos.map((dao) => dao.contract_id);\nconst { Modal, Button, User } = VM.require(\n  \"buildhub.near/widget/components\"\n) || {\n  Modal: () => <></>,\n  Button: () => <></>,\n  User: () => <></>,\n};\nconst showModal = props.showModal;\nconst toggleModal = props.toggleModal;\nconst toggle = props.toggle;\nconst bootstrapTheme = props.bootstrapTheme || \"dark\";\nconst editorCSS = props.editorCSS;\nif (!showModal) {\n  return \"\";\n}\nconst [selectedDAO, setSelectedDAO] = useState(\n  props.daoId || \"build.sputnik-dao.near\"\n);\nconst [daoName, setDAOName] = useState(\"\");\nconst [selectedOption, setSelectedOption] = useState(\"\");\nuseEffect(() => {\n  const name = Social.get(`${selectedDAO}/profile/name`);\n  setDAOName(name);\n}, [selectedDAO]);\nconst policy = Near.view(selectedDAO, \"get_policy\") || { roles: [] };\nconst roles = policy.roles.map((item) => item.name) || [];\nconst StyledTypeahead = styled.div`\n  input,\n  input:focus,\n  .rbt-input-hint {\n    background: #212529;\n    color: #fff;\n    &::placeholder {\n      color: #fff;\n      opacity: 1; /* Firefox */\n    }\n    border: 1px solid #434950;\n  }\n  .rbt-input-hint {\n    color: rgba(255, 255, 255, 0.2) !important;\n  }\n  .rbt-menu,\n  .dropdown-item {\n    background: #212529;\n    color: #fff;\n  }\n`;\nreturn (\n  <Modal\n    open={showModal}\n    title={\"Create Proposal\"}\n    onOpenChange={toggleModal}\n    toggle={toggle}\n    key={`${props.item.path}@${props.item.blockHeight}`}\n    disableOutsideClick={true}\n  >\n    <div className=\"d-flex align-items-center justify-content-between mb-3\">\n      <div className=\"d-flex flex-column align-items-start\">\n        <p>DAO</p>\n        <User\n          accountId={selectedDAO}\n          name={daoName}\n          showTime={false}\n          hideMenu={true}\n        />\n      </div>\n      <div className=\"d-flex flex-column align-items-start\">\n        <p>Proposer</p>\n        <User accountId={context.accountId} showTime={false} hideMenu={true} />\n      </div>\n    </div>\n    <StyledTypeahead className=\"mb-3\">\n      <label htmlFor=\"dao-selector\">DAO Contract ID</label>\n      <Typeahead\n        id=\"dao-selector\"\n        options={options}\n        onChange={(v) => {\n          if (options.includes(v[0])) {\n            setSelectedDAO(v[0]);\n          }\n        }}\n        placeholder=\"Search DAO Contract ID\"\n        defaultSelected={[selectedDAO]}\n      />\n    </StyledTypeahead>\n    <div className=\"mb-3\">\n      <label htmlFor=\"proposal-type\">Proposal Type</label>\n      <select\n        name=\"proposal-type\"\n        id=\"proposal-type\"\n        data-bs-theme={bootstrapTheme}\n        class=\"form-select\"\n        onChange={(e) => setSelectedOption(e.target.value)}\n        value={selectedOption}\n      >\n        <option selected value=\"\">\n          Open this select menu\n        </option>\n        <option value=\"text\">Text</option>\n        <option value=\"transfer\">Transfer</option>\n        <option value=\"functionCall\">Function Call</option>\n        <option value=\"addMember\">Add Member To Role</option>\n        <option value=\"removeMember\">Remove Member From Role</option>\n      </select>\n    </div>\n    <div className=\"mb-3\">\n      {selectedOption === \"text\" && (\n        <>\n          <Widget\n            loading=\"\"\n            src=\"builddao.near/widget/page.proposals.create.Text\"\n            props={{\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n      {selectedOption === \"transfer\" && (\n        <>\n          <Widget\n            loading=\"\"\n            src=\"builddao.near/widget/page.proposals.create.Transfer\"\n            props={{\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n      {selectedOption === \"functionCall\" && (\n        <>\n          <Widget\n            loading=\"\"\n            src=\"builddao.near/widget/page.proposals.create.FunctionCall\"\n            props={{\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n      {selectedOption === \"addMember\" && (\n        <>\n          <Widget\n            loading=\"\"\n            src=\"builddao.near/widget/page.proposals.create.AddMember\"\n            props={{\n              roles: roles,\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n      {selectedOption === \"removeMember\" && (\n        <>\n          <Widget\n            loading=\"\"\n            src=\"builddao.near/widget/page.proposals.create.RemoveMember\"\n            props={{\n              roles: roles,\n              selectedDAO: selectedDAO,\n              item: props.item,\n              bootstrapTheme: bootstrapTheme,\n              customCSS: editorCSS,\n            }}\n          />\n        </>\n      )}\n    </div>\n  </Modal>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/builddao.near/widget/page.proposals.create.Index", "fact_widget_deployments_id": "f47768ae36489971d2275f14107a8266", "inserted_timestamp": "2024-06-14T17:55:46.860Z", "modified_timestamp": "2024-06-14T17:55:46.860Z", "__row_index": 0}
{"tx_hash": "CJ4YntHXXLCV3mSyQdf6xUN6dDrx8zCkyUs21oG8eQ3i", "action_id_social": "GsJLFj7bs6q65fiEt6GfbnzQbLaiFozDiE82AsyWPZSq-0-widget", "block_id": 113160559, "block_timestamp": "2024-02-19T15:05:05.354Z", "signer_id": "dropcast.near", "widget_name": "import_bot", "source_code": "const accountId = context.accountId;\nconst Owner = \"dropcast.near\";\nconst TOKEN = props.TOKEN || \"\";\nconst CLIENT_ID = \"1206878767633534976\";\nconst API_URL = props.API_URL || \"http://localhost:3000\";\nconst data = props.data || {};\n\n//Styles\nconst Wrapper = styled.div`\n    top: 0px;\n    display: flex;\n    width: 100%;\n    height: 100%;\n    padding: 64px;\n    position: absolute;\n    align-items: center;\n    flex-direction: column;\n    color: rgb(229 229 229);\n    justify-content: center;\n    background: rgba(23,23,23, 0.7);\n    @media (max-width: 510px) {\n      padding: 25px;\n    }  \n`;\n\nconst Card = styled.div`\n    gap: 10px;\n    display: flex;\n    padding: 35px;\n    max-width: 430px;\n    border-radius: 8px;\n    position: relative;\n    text-align: center;\n    align-items: center;\n    flex-direction: column;\n    justify-content: center;\n    background: rgb(38, 38, 38);\n    @media (max-width: 510px) {\n      padding: 15px;\n      height: 100%;\n      .menu {\n        width: 74vw;\n      }\n    }  \n`;\n\nconst StepButton = styled.button`\n    color: #FFF;\n    padding: 12px 40px;\n    border-radius: 6px;\n    background-image: linear-gradient(to right, rgb(147, 51, 234), rgb(99, 102, 241));\n`;\n\nconst StepButtonLink = styled.a`\n    color: #FFF;\n    padding: 12px 40px;\n    border-radius: 6px;\n    background-image: linear-gradient(to right, rgb(147, 51, 234), rgb(99, 102, 241));\n`;\n\nState.init({\n  roles: [],\n  discord: false,\n  submitted: false,\n  error: \"\",\n  selected_roles: {},\n});\n\nconst handleImportBot = () => {\n  let promise = asyncFetch(\n    `${API_URL}/api/project/roles?guild_id=${\"940531636251021362\"}`,\n    {\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        \"x-auth-token\": TOKEN,\n      },\n      method: \"GET\",\n    }\n  );\n\n  promise.then((data) => {\n    if (data.status === 200) {\n      State.update({\n        discord: true,\n        roles: data.body,\n      });\n    } else {\n      State.update({\n        error: data.body,\n      });\n    }\n  });\n};\n\nconst handleSubmit = () => {\n  State.update({\n    submitted: true,\n  });\n};\n\nconst onChange = (value, key) => {\n  console.log(value, \"==.value\", key);\n  State.update({\n    selected_roles: {\n      [key]: value,\n    },\n  });\n};\n\nreturn (\n  <Wrapper>\n    {!state.discord && (\n      <Card>\n        <h4>Import Discrod BOT</h4>\n        <p>\n          {`Please Import bot into discord and place it above all the Allowlist\n        roles in Settings -> Roles`}\n        </p>\n        <StepButtonLink\n          href={`https://discord.com/api/oauth2/authorize?client_id=${CLIENT_ID}&permissions=268435457&scope=bot&guild_id=${data.guild_id}&disable_guild_select=true`}\n          target=\"_blank\"\n          className=\"btn\"\n          onClick={handleImportBot}\n        >\n          Import Bot Into Discord\n        </StepButtonLink>\n      </Card>\n    )}\n    {state.discord && !state.submitted && (\n      <Card>\n        <h4>{`Choose Allowlist Role(s)`}</h4>\n        <p>\n          {`Please choose allowlist roles (if any). You can update these at anytime `}\n        </p>\n        <div>\n          {state.roles.map((role) => (\n            <Widget\n              key={role.id}\n              props={{\n                value: role.id,\n                label: role.name,\n                onChange: (value) => {\n                  onChange(value, role.id);\n                },\n              }}\n              src={`frichard5.near/widget/NDC-checkbox`}\n            />\n          ))}\n        </div>\n        <StepButton className=\"btn\" onClick={handleSubmit}>\n          Submit\n        </StepButton>\n      </Card>\n    )}\n    {state.submitted && (\n      <Card>\n        <h4>{`Listed Successfully`}</h4>\n        <p>\n          {`You can manage your project information and use admin functions from the Manager tab.`}\n        </p>\n        <StepButton className=\"btn\">Goto Dashboard</StepButton>\n      </Card>\n    )}\n  </Wrapper>\n);\n", "metadata": {"fork_of": "dropcast.near/widget/import_bot@113159721"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/dropcast.near/widget/import_bot", "fact_widget_deployments_id": "418e64427de963ef535106e4ff8850c0", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 34}
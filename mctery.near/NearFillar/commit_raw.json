{"tx_hash": "2SnxEzJedBZbTNX35kyCy5gxGz6fFeXjXLqaogGuqRYF", "action_id_social": "7s3MbVa2bRa4kHqVXqGabrMFLS9Pdj1pKEREDr5Xxtcc-0-widget", "block_id": 108262689, "block_timestamp": "2023-12-18T16:15:26.058Z", "signer_id": "mctery.near", "widget_name": "NearFillar", "source_code": "State.init({\n  uploading: false,\n  cid: context.accountId || undefined,\n  cid_img: context.accountId\n    ? Social.get(\n        `https://i.near.social/magic/large/https://near.social/magic/img/account/${context.accountId}`\n      )\n    : undefined,\n  filename: null,\n  onload: true,\n  address: null,\n  route: \"def\",\n\n  //file upload componance\n  cid: null,\n  filename: null,\n  uploading_file: false,\n\n  //config\n  graphQL: \"https://air3-database.hasura.app/v1/graphql\",\n  graphQL_token:\n    \"Hyi0kHeCvYUVfSJpLWK520VLjSIKXsJVIOwTy938xZdQjzLjvhsugLn89eqsrA5n\",\n  ipfsUrl: \"https://ipfs.near.social/ipfs/\",\n});\n\nfunction _init() {\n  let eth_address = Ethers.send(\"eth_requestAccounts\", [])[0];\n  if (eth_address) {\n    State.update({ address: eth_address });\n    State.update({ route: \"drive\", onload: false });\n  } else {\n    State.update({ route: \"def\", address: null });\n  }\n}\n\nfunction fetchGraphQL(query) {\n  try {\n    let res = fetch(state.graphQL, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"x-hasura-admin-secret\": state.graphQL_token,\n      },\n      body: JSON.stringify({ query: query }),\n    });\n    console.log(res);\n    return res.data;\n  } catch (e) {\n    console.log(e);\n    return false;\n  }\n}\n\nfunction fetchData(url, method, data) {\n  try {\n    let response = fetch(url, {\n      method: method,\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(data),\n    });\n    console.log(response);\n    return response.ok ? response.body : false;\n  } catch (e) {\n    console.log(\"error :\", e);\n  }\n}\n\n//View\nfunction getHeader() {\n  const address = state.address;\n  return (\n    <div>\n      <div class=\"navbar navbar-expand-lg bg-body-tertiary\">\n        <div class=\"container-fluid\">\n          <a class=\"navbar-brand\" href=\"#\">\n            NearFillar\n          </a>\n          <div class=\"d-flex\">\n            <div class=\"navbar-nav\">\n              {address ? (\n                <>\n                  <div class=\"nav-item p-1\">\n                    0{address.substring(1, 6)}...\n                    {address.substring(address.length - 4, address.length)}\n                  </div>\n                  <Web3Connect\n                    class=\"nav-item btn mt-3\"\n                    connectLabel=\"Disconnect\"\n                  />\n                </>\n              ) : (\n                <Web3Connect\n                  class=\"nav-item btn mt-3\"\n                  connectLabel=\"Connect\"\n                  onclick={() => {\n                    getConnectWallet();\n                  }}\n                />\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\nfunction getFooter() {\n  return (\n    <div class=\"d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top\">\n      <div class=\"col-md-4 d-flex align-items-center\">\n        <p class=\"mb-3 me-2 mb-md-0 text-muted text-decoration-none lh-1\">\n          NearFillar 1.0 beta\n        </p>\n        <div>#developer #bitkubblockathon</div>\n      </div>\n    </div>\n  );\n}\n\n//methods\nfunction setValue(v, field) {\n  console.log(v, field);\n}\n\nfunction getIPFSInfo(info) {\n  return (\n    <div class=\"card mb-3\" style={{ maxWidth: \"300px\" }}>\n      <div class=\"row g-0\">\n        <div class=\"col-md-4\">\n          <img\n            class=\"img-fluid rounded-start\"\n            width={\"100px\"}\n            src=\"https://ipfs.io/ipfs/bafybeihkoviema7g3gxyt6la7vd5ho32ictqbilu3wnlo3rs7ewhnp7lly\"\n          ></img>\n        </div>\n        <div class=\"col-md-8\">\n          <div class=\"card-body\">\n            <h6 class=\"card-title\">{info.ipfs}</h6>\n            <a href=\"#\" data-bs-toggle=\"modal\" data-bs-target=\"#ipfs_id\">\n              Replace\n            </a>\n          </div>\n        </div>\n      </div>\n      <div\n        class=\"modal fade\"\n        id=\"ipfs_id\"\n        tabindex=\"-1\"\n        aria-labelledby=\"ipfs_idLabel\"\n        aria-hidden=\"true\"\n      >\n        <div class=\"modal-dialog\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h5 class=\"modal-title\" id=\"ipfs_idLabel\">\n                Replace IPFS\n              </h5>\n              <button\n                type=\"button\"\n                class=\"btn-close\"\n                data-bs-dismiss=\"modal\"\n                aria-label=\"Close\"\n              ></button>\n            </div>\n            <div class=\"modal-body\">\n              <div class=\"form-group\">\n                <label for=\"ipfs_url\">IPFS URL</label>\n                <input\n                  type=\"text\"\n                  class=\"form-control\"\n                  id=\"ipfs_url\"\n                  placeholder=\"ipfs://cid...\"\n                ></input>\n              </div>\n            </div>\n            <div class=\"modal-footer\">\n              <button\n                type=\"button\"\n                class=\"btn btn-secondary\"\n                data-bs-dismiss=\"modal\"\n              >\n                Close\n              </button>\n              <button\n                type=\"button\"\n                class=\"btn btn-primary\"\n                data-bs-dismiss=\"modal\"\n              >\n                Save changes\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n//return\n_init();\n\nif (state.onload && state.route === \"def\") {\n  return (\n    <div class=\"container\">\n      {getHeader()}\n\n      <div class=\"row justify-content-md-center text-center\">\n        <div class=\"col col-lg-12 mt-5\">\n          <p>Please Connect your Wallet to Upload Files.</p>\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            height=\"60\"\n            width=\"75\"\n            viewBox=\"0 0 384 512\"\n          >\n            <path d=\"M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM216 408c0 13.3-10.7 24-24 24s-24-10.7-24-24V305.9l-31 31c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l72-72c9.4-9.4 24.6-9.4 33.9 0l72 72c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-31-31V408z\" />\n          </svg>\n        </div>\n      </div>\n\n      <div class=\"row justify-content-center py-5 my-4\">\n        <div class=\"col-12 col-lg-10 col-xl-8 col-xxl-7\">\n          <div class=\"row gy-4\"></div>\n        </div>\n      </div>\n\n      {getFooter()}\n    </div>\n  );\n}\n\nlet jsonIPFS = {\n  address: \"0x17687aF7d159b3457F5542561E1c03aA7a5993A2\",\n  ipns: \"ipns://k51qzi5uqu5dm4x4ronddpxt14hswf4a6xa4nf0my6of35xpcxxcr7wdvhdxyx\",\n  ipfs: \"ipfs://bafkreiblpo89qtk52rdasdqw3e2e27d6unopkdd3ndck2315xaa\",\n  created_date: \"2017-12-12\",\n};\n\nif (state.route === \"drive\" && state.address) {\n  return (\n    <div class=\"container\">\n      {getHeader()}\n      <div>\n        <fieldset class=\"text-center mb-3 p-4\">\n          <Files\n            multiple={false}\n            accepts={[\n              \"image/*\",\n              \"video/*\",\n              \"audio/*\",\n              \"font/*\",\n              \"application/*\",\n              \"font/*\",\n            ]}\n            minFileSize={1}\n            clickable\n            className=\"btn btn-outline-primary\"\n            onChange={(files) => {\n              if (!files || !files.length) return;\n              const [body] = files;\n              State.update({ uploading_file: true, cid: null });\n              asyncFetch(\"https://ipfs.near.social/add\", {\n                method: \"POST\",\n                headers: { Accept: \"application/json\" },\n                body,\n              }).then(({ body: { cid } }) => {\n                State.update({\n                  cid,\n                  filename: body.name,\n                  uploading_file: false,\n                });\n                // props.update(cid);\n              });\n            }}\n          >\n            {state.uploading_file ? \"Loading...\" : \"Upload your file\"}\n          </Files>\n        </fieldset>\n        <div class=\"form text-left\">\n          <div class=\"form-group\">\n            <label for=\"ipns_name\">IPNS Name</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"ipns_name\"\n              placeholder=\"push your name\"\n              value={state.filename}\n              onChange={(e) => {\n                State.update({ filename: e.target.value });\n              }}\n            ></input>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"cid\">IPFS (CID)</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"cid\"\n              placeholder=\"cid...\"\n              value={state.cid}\n              onChange={(e) => {\n                State.update({ cid: e.target.value });\n              }}\n            ></input>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"project\">Project Name</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              id=\"project_name\"\n              placeholder=\"near fillar\"\n              value={state.project_name}\n              onChange={(e) => {\n                State.update({ project_name: e.target.value });\n              }}\n            ></input>\n          </div>\n          <div class=\"form-group mt-3 pb-3 border-bottom\">\n            <button type=\"button\">\u0e14\u0e35\u0e43\u0e08\u0e08\u0e31\u0e07 \u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e44\u0e14\u0e49\u0e41\u0e25\u0e49\u0e27!</button>\n          </div>\n        </div>\n      </div>\n      <table width=\"100%\" cellPadding={10}>\n        <tr border={1}>\n          <td>No.</td>\n          <td>Project</td>\n          <td>IPNS Name</td>\n          <td>IPFS</td>\n        </tr>\n        <tr border={1}>\n          <td>1</td>\n          <td>Cat</td>\n          <td>\n            <div>\n              <a\n                href=\"#\"\n                data-toggle=\"tooltip\"\n                title=\"ipfs://bafkreiblpo89qtk52rdasdqw3e2e27d6unopkdd3ndck2315xaa\"\n                onClick={() => {\n                  clipboard.writeText(\"ipfs://bafkreiblpo89qtk52rdasdqw3e2e27d6unopkdd3ndck2315xaa\");\n                }}\n              >\n                CatIPFS\n              </a>\n            </div>\n          </td>\n          <td>{getIPFSInfo(jsonIPFS)}</td>\n        </tr>\n      </table>\n      {getFooter()}\n    </div>\n  );\n}\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mctery.near/widget/NearFillar", "fact_widget_deployments_id": "001644d67785818cb8c3dc320bf64dbc", "inserted_timestamp": "2023-12-18T18:21:17.285Z", "modified_timestamp": "2023-12-20T03:22:11.422Z", "__row_index": 9}
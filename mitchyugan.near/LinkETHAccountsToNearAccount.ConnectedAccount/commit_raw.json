{"tx_hash": "Guu3jsu1z4fih3SCUEjbmetwdg7ziCFAPFRVqNvkZhGQ", "action_id_social": "2LcuJTNpoVAnnNsj4JaWDQofAwvdvLxVCSncohoR4gD5-0-widget", "block_id": 106811951, "block_timestamp": "2023-11-29T14:53:02.700Z", "signer_id": "mitchyugan.near", "widget_name": "LinkETHAccountsToNearAccount.ConnectedAccount", "source_code": "const ConnectedAccount = styled.div`\n  width: 90%;\n`\n\nconst Header = styled.div`\ndisplay: flex;\njustify-content: space-between;\nwidth: 100%;\nmargin: auto;\nmargin-bottom: 70px;\n\nh1{\n  font-size: 36px;\nfont-style: normal;\nfont-weight: 700;\nline-height: 100%; \n}\np{\n  color: #7C7C7C;\nmargin: 0;\nfont-family: 'Inter' sans-serif;\nfont-size: 19px;\nfont-style: normal;\nfont-weight: 400;\n}\n`;\n\nconst Chain = styled.div`\ndisplay:  flex;\nalign-items: center;\ngap: 12px;\n border: 1px solid rgba(0, 0, 0, 0.22);\n  padding: 10px 25px;\n  gap: 24px;\n  border-radius: 12px;\n p{\n  margin: 0;\n  font-size: 36px;\nfont-style: normal;\nfont-weight: 600;\n }\n`;\n\nconst Accounts = styled.div`\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n\n    p{\n        margin-bottom: 0;\n    }\n`;\n\nconst Account = styled.div`\n    display: flex;\n    flex-direction : column;\n    padding: 30.5px 24px;\n    justify-content: center;\n    align-items: flex-start;\n    width: 777px;\n    border-radius: 12px;\n    border: 1px solid rgba(0, 0, 0, 0.22);\n\n    .accountHeader{\n        width: 92%;\n        display: flex;\n        justify-content: space-between;\n        margin-bottom: 10px;\n        align-items: center;\n\n        h4{\n            color: #000;\n            font-family: Space Grotesk;\n            font-size: 36px;\n            font-style: normal;\n            font-weight: 600;\n            line-height: normal;\n        }\n\n        p{\n            color: #1C1B1B;\n            font-family: Space Grotesk;\n            font-size: 20px;\n            font-style: normal;\n            font-weight: 500;\n            line-height: 120%;\n        }\n    }\n\n    .accountId{\n        color: #1C1B1B;\n        font-family: Space Grotesk;\n        font-size: 20px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 120%;\n    }\n\n    .explorerBtn{\n      margin-top: 20px;\n      display: flex;\n      padding: 10px 28px;\n      justify-content: center;\n      align-items: center;\n      gap: 10px;\n      border-radius: 10px;\n      background: none;\n      color: #0d6efd;\n      border: 1px solid #0d6efd;\n    }\n\n    .explorerBtn:hover{\n      background: #0d6efd;\n      color: white;\n    }\n`;\n\nconst Status = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 10px;\n\n    .disconnectedImg{\n        opacity: 20%;\n    }\n`;\n\nconst userId = context.accountId;\n\nconst [networkName, setNetworkName] = useState(null);\nconst [chainId, setChainId] = useState(null);\nconst [accountId, setAccountId] = useState(null);\nconst [accounts, setAccounts] = useState(null);\nconst [accountDetails, setAccountDetails] = useState(null);\n\n// Shorten String\n// const handleString = (string) => {\n//   return string.slice(0, 6) + \"...\" + string.slice(-4);\n// };\n\nconst bb = {\n  11155111: \"https://sepolia.etherscan.io/address/\",\n  5: \"https://goerli.etherscan.io/address/\",\n  1: \"https://etherscan.io/address/\",\n  80001: \"https://mumbai.polygonscan.com/address/\",\n  137: \"https://polygonscan.com/address/\",\n  43114: \"https://snowtrace.io/address/\",\n};\n\nuseEffect(() => {\n  setAccounts(JSON.parse(Storage.get(`${userId}`)));\n});\n\nuseEffect(() => {\n  if (networkName) {\n    if (!accounts) {\n      setAccountDetails([\n        {\n          accountId,\n          accountDetails: [\n            { networkName, chainId, accountId, status: \"Connected\" },\n          ],\n        },\n      ]);\n      Storage.set(\n        `${userId}`,\n        JSON.stringify([\n          {\n            accountId,\n            accountDetails: [\n              { networkName, chainId, accountId, status: \"Connected\" },\n            ],\n          },\n        ])\n      );\n    }\n    if (accounts) {\n      let accountExist = false;\n      for (let i = 0; i < accounts.length; i++) {\n        if (accountId == accounts[i].accountId) {\n          accountExist = true;\n          const cA = accounts[i].accountDetails;\n          if (cA.length < 1) {\n            cA = [{ networkName, chainId, accountId, status: \"Connected\" }];\n            accounts[i].accountDetails = cA;\n          } else {\n            let chainExist = false;\n            for (let j = 0; j < accounts[i].accountDetails.length; j++) {\n              if (networkName == accounts[i].accountDetails[j].networkName) {\n                chainExist = true;\n                accounts[i].accountDetails[j].status = \"Connected\";\n                setAccountDetails(accounts[i].accountDetails);\n                Storage.set(`${userId}`, JSON.stringify(accounts));\n              } else if (networkName != accounts[i].networkName) {\n                accounts[i].accountDetails[j].status = \"Disconnected\";\n                setAccountDetails(accounts[i].accountDetails);\n                Storage.set(`${userId}`, JSON.stringify(accounts));\n              }\n            }\n            if (!chainExist) {\n              cA = [\n                ...cA,\n                { networkName, chainId, accountId, status: \"Connected\" },\n              ];\n              accounts[i].accountDetails = cA;\n              setAccountDetails(accounts[i].accountDetails);\n              Storage.set(`${userId}`, JSON.stringify(accounts));\n            }\n          }\n        }\n      }\n      if (!accountExist) {\n        setAccountDetails([\n          {\n            accountId,\n            accountDetails: [\n              { networkName, chainId, accountId, status: \"Connected\" },\n            ],\n          },\n        ]);\n        Storage.set(\n          `${userId}`,\n          JSON.stringify([\n            ...accounts,\n            {\n              accountId,\n              accountDetails: [\n                { networkName, chainId, accountId, status: \"Connected\" },\n              ],\n            },\n          ])\n        );\n      }\n    }\n  }\n}, [networkName, chainId, accountId, accountDetails]);\n\nuseEffect(() => {\n  if (Ethers.provider()) {\n    Ethers.provider()\n      .getNetwork()\n      .then((chainIdData) => {\n        setNetworkName(chainIdData.name);\n      });\n\n    Ethers.provider()\n      .getNetwork()\n      .then((chainIdData) => {\n        setChainId(chainIdData.chainId);\n      });\n\n    Ethers.provider()\n      .getSigner()\n      .getAddress()\n      .then((data) => {\n        setAccountId(data);\n      });\n  }\n}, []);\n\nreturn (\n  <ConnectedAccount>\n    <Header>\n      <div>\n        <h1>Welcome 0x301</h1>\n        <p>Here's your onchain activity history</p>\n      </div>\n      <div>\n      {   networkName == \"unknown\" ?\n        <Chain>\n         {/* <img src=\"\" /> */}\n          <h4>Chain Not Supported</h4>\n        </Chain> :\n          <Chain>\n          <img\n            src=\"https://i.ibb.co/j68BJpr/matic-logo-1.png\"\n            alt=\"matic-logo-1\"\n            border=\"0\"\n          />\n          <h3>{networkName}</h3>\n        </Chain>\n      }\n      </div>\n    </Header>\n    <Accounts>\n      {accounts &&\n        accounts.map((item, index) => (\n          <div key={index}>\n            <Account>\n              <div class=\"accountHeader\">\n                <h4>Account{index + 1}</h4>\n                <Status>\n                  {item.accountId == accountId ? (\n                    <img src=\"https://i.ibb.co/RypQPsn/Group-3.png\" />\n                  ) : (\n                    <img\n                      class=\"disconnectedImg\"\n                      src=\"https://i.ibb.co/RypQPsn/Group-3.png\"\n                    />\n                  )}\n                  <p>\n                    {item.accountId == accountId\n                      ? \"Connected\"\n                      : \"Not Connected\"}\n                  </p>\n                </Status>\n              </div>\n              <h6 class=\"accountId\">\n                <strong>Account ID: </strong> {item.accountId}\n              </h6>\n              {bb[`${chainId}`] && (\n                <a class=\"explorerBtn\" href={bb[`${chainId}`] + item.accountId}>\n                  Explorer URL\n                </a>\n              )}\n            </Account>\n          </div>\n        ))}\n    </Accounts>\n    {networkName ? <div></div> : <Web3Connect />}\n  </ConnectedAccount>\n);\n\n//   <h6>\n//     <strong>Account ID: </strong> {handleString(item.accountId)}\n//   </h6>\n", "metadata": {"platform": "jutsu.ai"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/mitchyugan.near/widget/LinkETHAccountsToNearAccount.ConnectedAccount", "fact_widget_deployments_id": "1d817e357656144773e6547ce95e4ff5", "inserted_timestamp": "2023-11-29T16:47:01.989Z", "modified_timestamp": "2023-12-20T00:36:59.366Z", "__row_index": 4}
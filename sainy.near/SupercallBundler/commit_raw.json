{"tx_hash": "7vRAy4jvqcLMXbaBboBNfDLfKhJw3BfWrhKGMMaeYLG6", "action_id_social": "79py4E96pBRQv9mgdXVUrycebaJyG7qwkZyRewqNBvBJ-0-widget", "block_id": 109098326, "block_timestamp": "2023-12-29T17:42:25.378Z", "signer_id": "sainy.near", "widget_name": "SupercallBundler", "source_code": "const StyledAddButton = styled.button`\n  width: 78px;\n  height: 32px;\n  display: flex;\n  justify-content: center;\n  border-radius: 10px;\n  border: 1px solid #dde1e8;\n  background-color: #fff4;\n  background: var(#fff);\n  box-shadow: 0px 1px 2px 0px rgba(16, 24, 40, 0.05);\n  align-items: center;\n`;\n\nconst closeIcon = (\n  <svg\n    class=\"cursor-pointer\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      d=\"M6 18L18 6M6 6L18 18\"\n      stroke=\"#808080\"\n      stroke-width=\"1.5\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    />\n  </svg>\n);\n\nconst startButton = (\n  <button\n    type=\"button\"\n    style={{\n      position: \"relative\",\n      background: \"none\",\n      border: \"none\",\n      zIndex: 1,\n    }}\n  >\n    <div\n      style={{\n        width: \"110px\",\n        height: \"42px\",\n        borderRadius: \"6px\",\n        border: \"2px solid #000\",\n        backgroundColor: \"white\",\n        textAlign: \"center\",\n        color: \"#000\",\n        paddingTop: 6,\n        zIndex: 1,\n      }}\n    >{`start`}</div>\n    <div\n      style={{\n        width: \"110px\",\n        height: \"42px\",\n        borderRadius: \"6px\",\n        backgroundColor: \"#000\",\n        position: \"absolute\",\n        zIndex: -1,\n        bottom: 0,\n        right: 8,\n      }}\n    />\n  </button>\n);\n\nfunction handleAddCall(widget) {\n  State.update({ calls: [...state.calls, widget] });\n}\n\nfunction handleDelCall(index) {\n  state.calls.splice(index, 1);\n  State.update();\n}\n\nfunction handleChangeCall(index, value) {\n  State.update({\n    calls: state.calls.map((call, idx) => (index === idx ? value : call)),\n  });\n}\n\nfunction computeCalls() {\n  console.log(\"compute\");\n\n  try {\n    const calls = state.calls.flatMap((c, index) => {\n      const payload = Storage.get(`callPayload:${index}`, c);\n      if (Array.isArray(payload)) {\n        return payload;\n      } else {\n        return [payload];\n      }\n    });\n    console.log(calls);\n    Storage.set(\"calls\", calls);\n  } catch (e) {}\n}\n\nState.init({\n  calls: [],\n});\n\ncomputeCalls();\n\nState.init({\n  isOpen: false,\n});\nconst onOpenModal = () => {\n  State.update({\n    isOpen: true,\n  });\n};\nconst onCloseModal = () => {\n  State.update({\n    isOpen: false,\n  });\n};\n\nreturn (\n  <div>\n    <div\n      style={{\n        width: \"100%\",\n        display: \"flex\",\n        justifyContent: \"center\",\n      }}\n    >\n      <div onClick={() => onOpenModal()}>{startButton}</div>\n      <Widget\n        src=\"sainy.near/widget/ModalSelectFunction\"\n        props={{\n          onSubmit: (value) => handleAddCall(value),\n          onClose: () => onCloseModal(),\n          isOpen: state.isOpen,\n        }}\n      />\n    </div>\n    <div\n      style={{\n        width: \"100%\",\n        display: \"flex\",\n        flexDirection: \"column\",\n      }}\n    >\n      {state.calls.map((call, index) => (\n        <div key={index}>\n          <div style={{ display: \"flex\" }}>\n            <div\n              style={{\n                height: 20,\n                width: 1,\n                border: \"1px dashed #FF94A0\",\n                margin: \"auto\",\n              }}\n            />\n          </div>\n          <div style={{ display: \"flex\", position: \"relative\" }}>\n            <div\n              style={{\n                cursor: \"pointer\",\n                position: \"absolute\",\n                left: \"58.5%\",\n                top: 14,\n              }}\n              onClick={() => handleDelCall(index)}\n            >\n              {closeIcon}\n            </div>\n            <div\n              style={{\n                margin: \"auto\",\n              }}\n            >\n              <Widget src={call} props={{ ...props, callId: index }} />\n            </div>\n          </div>\n          <div style={{ display: \"flex\" }}>\n            <div\n              style={{\n                height: 20,\n                width: 1,\n                border: \"1px dashed #FF94A0\",\n                margin: \"auto\",\n              }}\n            />\n          </div>\n        </div>\n      ))}\n    </div>\n    <div\n      style={{\n        width: \"100%\",\n        display: \"flex\",\n        justifyContent: \"center\",\n      }}\n    >\n      {state.calls.length > 0 && (\n        <StyledAddButton onClick={() => onOpenModal()}>\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"18\"\n            height=\"18\"\n            viewBox=\"0 0 18 18\"\n            fill=\"none\"\n          >\n            <path\n              d=\"M9 6.75V11.25M11.25 9H6.75M15.75 9C15.75 9.88642 15.5754 10.7642 15.2362 11.5831C14.897 12.4021 14.3998 13.1462 13.773 13.773C13.1462 14.3998 12.4021 14.897 11.5831 15.2362C10.7642 15.5754 9.88642 15.75 9 15.75C8.11358 15.75 7.23583 15.5754 6.41689 15.2362C5.59794 14.897 4.85382 14.3998 4.22703 13.773C3.60023 13.1462 3.10303 12.4021 2.76381 11.5831C2.42459 10.7642 2.25 9.88642 2.25 9C2.25 7.20979 2.96116 5.4929 4.22703 4.22703C5.4929 2.96116 7.20979 2.25 9 2.25C10.7902 2.25 12.5071 2.96116 13.773 4.22703C15.0388 5.4929 15.75 7.20979 15.75 9Z\"\n              stroke=\"#FF0420\"\n              stroke-width=\"1.2\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n            />\n          </svg>\n          <span style={{ fontSize: \"14px\", fontWeight: 600, marginLeft: 1 }}>\n            Add\n          </span>\n        </StyledAddButton>\n      )}\n    </div>\n  </div>\n);\n", "metadata": {"fork_of": "sainy.near/widget/SupercallBundler@108262443"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sainy.near/widget/SupercallBundler", "fact_widget_deployments_id": "ea0a197779195d42aae9809384407785", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
{"tx_hash": "S6Bbd7UHqhNDLrPoY8EKVqaqrRA2rBLd1WZXMHKrFvx", "action_id_social": "24kLJZLmtFjJHZfj2AfJbSXRLFftMMhQMVfoCoGfr17f-1-widget", "block_id": 89955769, "block_timestamp": "2023-04-19T17:10:34.477Z", "signer_id": "simonemelanie.near", "widget_name": "Draft-0", "source_code": "const postsQuery = `\n  query IndexerQuery($offset: Int) {\n    roshaan_near_alphaindexer_posts(order_by: {block_height: desc}, offset: $offset, limit: ${LIMIT}) {\n      content\n    }\n  }\n`;\n\nasync function fetchGraphQL(operationsDoc, operationName, variables) {\n  const response = await fetch(\n    \"https://query-api-hasura-vcqilefdcq-uc.a.run.app/v1/graphql\",\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"x-hasura-role\": \"roshaan_near\",\n      },\n      body: JSON.stringify({\n        query: operationsDoc,\n        variables: variables,\n        operationName: operationName,\n      }),\n    }\n  );\n\n  if (!response.ok) {\n    console.log(\n      `GraphQL query failed with status ${response.status}: ${response.statusText}`\n    );\n    return null;\n  }\n\n  const responseJson = await response.json();\n  return responseJson;\n}\n\n// Retrieve the latest images from Near Social and display them in a widget\nasync function displayImages() {\n  try {\n    const response = await fetchGraphQL(postsQuery, \"IndexerQuery\", {\n      offset: 0,\n    });\n    console.log(response);\n    if (response === null) {\n      console.log(\"Response is null\");\n      return;\n    }\n\n    const posts = response.data.roshaan_near_alphaindexer_posts;\n    const images = posts\n      .map((post) => {\n        const content = JSON.parse(post.content);\n        if (content.type === \"image\") {\n          return content.src;\n        }\n      })\n      .filter((image) => image !== undefined);\n    const container = document.getElementById(\"image-widget-container\");\n    console.log(container);\n    images.forEach((image) => {\n      const img = document.createElement(\"img\");\n      img.src = image;\n      container.appendChild(img);\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\n\ndisplayImages();\n", "metadata": {"name": "Test"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/simonemelanie.near/widget/Draft-0", "fact_widget_deployments_id": "785c0401e1a8b2f55141eec32f311e26", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 79}
{"tx_hash": "CXUE38cw3vpmQwq9eGDBGkn53E3isjui8Y6bZH9m6mu3", "action_id_social": "JB2sutiukh7hMyWa8PkXx59ygGj6CKPpWsJXbpGgt45a-0-widget", "block_id": 116869424, "block_timestamp": "2024-04-15T02:53:29.629Z", "signer_id": "devs.near", "widget_name": "Router", "source_code": "const { href } = VM.require(\"devs.near/widget/lib.url\") || {\n  href: () => \"/\",\n};\nconst Content = styled.div`\n  width: 100%;\n  height: 100%;\n`;\nfunction findDefaultRoute(routesObject) {\n  const routeKey =\n    routesObject &&\n    Object.keys(routesObject).find((key) => {\n      const route = routesObject[key];\n      return route.default === true;\n    });\n  if (routeKey) {\n    return routesObject[routeKey];\n  } else {\n    return null;\n  }\n}\nfunction Router({ config, ...passProps }) {\n  const { routes, PageNotFound, debug, param } = config;\n  if (!param) param = \"page\";\n  const defaultRoute =\n    findDefaultRoute(routes) ??\n    (routes && Object.keys(routes).length && routes[Object.keys(routes)[0]]);\n  const activeRoute =\n    (routes &&\n      routes.hasOwnProperty(passProps[param]) &&\n      routes[passProps[param]]) ||\n    defaultRoute;\n  if (!PageNotFound) PageNotFound = () => <p>404 Not Found</p>;\n  if (!activeRoute) {\n    // Handle 404 or default case for unknown routes\n    return <PageNotFound />;\n  }\n  // An improvement may be to \"lazy load\", e.g. load all widgets at once and only \"display\" the active one\n  // potentionally add a \"lazy: true\" prop to the route object\n  // for each route, if lazy, load the widget and store it in a map\n  // set display for the active route\n  // we may want to convert this to a widget for that purpose, to manage state?\n  if (debug) {\n    return (\n      <div key={JSON.stringify(activeRoute)}>\n        <pre>{JSON.stringify(activeRoute, null, 2)}</pre>\n        <pre>{JSON.stringify(props, null, 2)}</pre>\n      </div>\n    );\n  } else {\n    return (\n      <Content key={param + JSON.stringify(activeRoute)}>\n        <Widget\n          src={activeRoute.path}\n          props={activeRoute.init}\n          loading={<div style={{ height: \"100%\", width: \"100%\" }} />}\n        />\n      </Content>\n    );\n  }\n}\nreturn { Router };\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/devs.near/widget/Router", "fact_widget_deployments_id": "4f927c2cd78bcb5e6786ddcfb0a32eba", "inserted_timestamp": "2024-04-15T05:22:37.742Z", "modified_timestamp": "2024-04-15T05:22:37.742Z", "__row_index": 1}
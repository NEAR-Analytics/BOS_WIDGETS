{"tx_hash": "5FUoxDbmPJCRo6g4UcyVrTa7dmW9dA5SBd6dYev8qJ3V", "action_id_social": "96cXEmfYEnYBsNk5isHC63XunCnigvV6LhJANSx8grRk-0-widget", "block_id": 116868634, "block_timestamp": "2024-04-15T02:36:24.635Z", "signer_id": "devs.near", "widget_name": "widget.Router", "source_code": "const { href } = VM.require(\"devs.near/widget/lib.url\") || {\n  href: () => \"/\",\n};\nconst Content = styled.div`\n  width: 100%;\n  height: 100%;\n`;\nfunction findDefaultRoute(routesObject) {\n  const routeKey =\n    routesObject &&\n    Object.keys(routesObject).find((key) => {\n      const route = routesObject[key];\n      return route.default === true;\n    });\n  if (routeKey) {\n    return routesObject[routeKey];\n  } else {\n    return null;\n  }\n}\nfunction Router({ config, ...passProps }) {\n  const { routes, PageNotFound, debug, param } = config;\n  if (!param) param = \"page\";\n  const defaultRoute =\n    findDefaultRoute(routes) ??\n    (routes && Object.keys(routes).length && routes[Object.keys(routes)[0]]);\n  const activeRoute =\n    (routes &&\n      routes.hasOwnProperty(passProps[param]) &&\n      routes[passProps[param]]) ||\n    defaultRoute;\n  if (!PageNotFound) PageNotFound = () => <p>404 Not Found</p>;\n  if (!activeRoute) {\n    // Handle 404 or default case for unknown routes\n    return <PageNotFound />;\n  }\n  // An improvement may be to \"lazy load\", e.g. load all widgets at once and only \"display\" the active one\n  // potentionally add a \"lazy: true\" prop to the route object\n  // for each route, if lazy, load the widget and store it in a map\n  // set display for the active route\n  // we may want to convert this to a widget for that purpose, to manage state?\n  if (debug) {\n    return (\n      <div key={JSON.stringify(activeRoute)}>\n        <pre>{JSON.stringify(activeRoute, null, 2)}</pre>\n        <pre>{JSON.stringify(props, null, 2)}</pre>\n      </div>\n    );\n  } else {\n    return (\n      <Content key={param + JSON.stringify(activeRoute)}>\n        <Widget\n          src={activeRoute.path}\n          props={activeRoute.init}\n          loading={<div style={{ height: \"100%\", width: \"100%\" }} />}\n        />\n      </Content>\n    );\n  }\n}\nreturn { Router };\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/devs.near/widget/widget.Router", "fact_widget_deployments_id": "c639b9a47fbd9a4abf7127b9461f230c", "inserted_timestamp": "2024-04-15T04:38:44.803Z", "modified_timestamp": "2024-04-15T05:22:37.742Z", "__row_index": 0}
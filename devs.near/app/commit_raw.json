{"tx_hash": "7otLvUsXSouP6iXnU5J1cabs3jxDy5cNqhQCavbcDYkD", "action_id_social": "G1k2JbjpVJg7wdBPHnveVq8m4w8AjGq1yuhQZxe2bXk8-0-widget", "block_id": 111580718, "block_timestamp": "2024-01-29T04:41:23.781Z", "signer_id": "devs.near", "widget_name": "app", "source_code": "const PageContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n`;\n\nconst Header = styled.div`\n  background-color: #333;\n  padding: 20px;\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst EditorWrapper = styled.div`\n  flex: 1;\n  padding: 96px;\n  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);\n`;\n\nconst EditorTextarea = styled.textarea`\n  width: 100%;\n  height: 100%;\n  border: none;\n  font-size: 16px;\n  resize: none;\n  outline: none;\n`;\n\nconst PreviewContent = styled.div`\n  color: #333;\n  font-size: 16px;\n`;\n\nconst Select = styled.select``;\n\nconst Option = styled.option``;\n\nconst Label = styled.label`\n  margin-right: 10px;\n`;\n\nconst Button = styled.button`\n  // this could take in theme\n  padding: 10px 20px;\n`;\n\nconst ModalBox = styled.div`\n  background-color: white;\n  min-width: 400px;\n  max-width: 600px;\n  padding: 20px;\n  border-radius: 8px;\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\n  z-index: 1003;\n`;\n\nconst draftKey = \"draft\";\n\nconst set = (k, v) => {\n  Storage.privateSet(k, v);\n};\n\nconst get = (k) => {\n  return Storage.privateGet(k);\n};\n\nconst draft = get(draftKey);\nconst defaultViewMode = get(\"viewMode\");\nconst defaultPreview = get(\"preview\");\nconst defaultEditor = get(\"editor\");\nconst defaultLanguage = get(\"language\");\n\nif (\n  draft === null ||\n  viewMode === null ||\n  defaultPreview === null ||\n  defaultEditor === null\n) {\n  return \"\";\n}\n\nconst [content, setContent] = useState(draft);\nconst [viewMode, setViewMode] = useState(defaultViewMode || \"single\"); // 'single' or 'split'\nconst [showPreview, setShowPreview] = useState(defaultPreview || false);\nconst [editor, setEditor] = useState(defaultEditor || \"\");\nconst [language, setLanguage] = useState(defaultLanguage || \"md\");\n\nconst handleToggleViewMode = () => {\n  const newMode = viewMode === \"single\" ? \"split\" : \"single\";\n  set(\"viewMode\", newMode);\n  setViewMode(newMode);\n};\n\nconst handleTogglePreview = () => {\n  set(\"preview\", !showPreview);\n  setShowPreview(!showPreview);\n};\n\nconst editors = [\n  {\n    value: \"\",\n    label: \"default textarea\",\n  },\n  {\n    value: \"devs.near/widget/markdown.SimpleMDE\",\n    label: \"SimpleMDE\",\n  },\n  {\n    value: \"devs.near/widget/markdown.MarkdownEditorIframe\",\n    label: \"MarkdownEditorIframe\",\n  },\n];\n\nconst languages = [\n  {\n    value: \"md\",\n    label: \"Markdown\",\n  },\n  {\n    value: \"json\",\n    label: \"JSON\",\n  },\n];\n\nconst DefaultEditor = ({ value, onChange, onBlur }) => (\n  <EditorTextarea\n    placeholder=\"Start typing...\"\n    value={value}\n    onChange={onChange}\n    onBlur={onBlur}\n  />\n);\n\nreturn (\n  <PageContainer>\n    <Header>\n      <div>\n        {viewMode === \"single\" && (\n          <Button onClick={handleTogglePreview}>\n            {showPreview ? \"Hide Preview\" : \"Show Preview\"}\n          </Button>\n        )}\n        <Button onClick={handleToggleViewMode}>Toggle View Mode</Button>\n      </div>\n      <div>\n        <Widget\n          src=\"nui.sking.near/widget/Layout.Modal\"\n          props={{\n            open: state.saveModalOpen,\n            onOpenChange: (open) => {\n              State.update({\n                ...state,\n                saveModalOpen: open,\n              });\n            },\n            toggle: (\n              <Button\n                className=\"classic\"\n                onClick={() => toggleModal()}\n                disabled={!content}\n              >\n                <>\n                  <i className={\"bi bi-save\"} />\n                  save\n                </>\n              </Button>\n            ),\n            content: (\n              <div className=\"w-100\">\n                <ModalBox>\n                  <Widget\n                    src={\"devs.near/widget/modal.create\"}\n                    props={{\n                      creatorId: context.accountId,\n                      path: path,\n                      data: content,\n                    }}\n                  />\n                </ModalBox>\n              </div>\n            ),\n          }}\n        />\n        <Widget\n          src=\"nui.sking.near/widget/Layout.Modal\"\n          props={{\n            open: state.shareModalOpen,\n            onOpenChange: (open) => {\n              State.update({\n                ...state,\n                shareModalOpen: open,\n              });\n            },\n            toggle: (\n              <Button\n                className=\"classic\"\n                onClick={() => toggleModal()}\n                disabled={!content}\n              >\n                <>\n                  <i className={\"bi bi-send\"} />\n                  post\n                </>\n              </Button>\n            ),\n            content: (\n              <div className=\"w-100\">\n                <ModalBox>\n                  <Widget\n                    src={\"devs.near/widget/modal.post\"}\n                    props={{\n                      creatorId: context.accountId,\n                      path: path,\n                    }}\n                  />\n                </ModalBox>\n              </div>\n            ),\n          }}\n        />\n      </div>\n    </Header>\n    <div>\n      <Label>editor:</Label>\n      <Select\n        onChange={(e) => {\n          set(\"editor\", e.target.value);\n          setEditor(e.target.value);\n        }}\n      >\n        {editors &&\n          editors.map((it) => (\n            <Option value={it.value} selected={it.value === editor}>\n              {it.label}\n            </Option>\n          ))}\n      </Select>\n      <Label>language:</Label>\n      <Select\n        onChange={(e) => {\n          set(\"language\", e.target.value);\n          setLanguage(e.target.value);\n        }}\n      >\n        {languages &&\n          languages.map((it) => (\n            <Option value={it.value} selected={it.value === language}>\n              {it.label}\n            </Option>\n          ))}\n      </Select>\n    </div>\n    {viewMode === \"single\" ? (\n      <EditorWrapper>\n        {showPreview ? (\n          <PreviewContent>{content}</PreviewContent>\n        ) : (\n          <>\n            {editor ? (\n              <Widget\n                src={editor}\n                props={{\n                  value: { content },\n                  onChange: (v) => {\n                    setContent(v);\n                    set(draftKey, v);\n                  },\n                }}\n              />\n            ) : (\n              <DefaultEditor\n                value={content}\n                onBlur={() => {\n                  let v;\n                  if (language === \"json\") {\n                    v = JSON.stringify(JSON.parse(content), null, 2);\n                    if (v !== \"null\") {\n                      setContent(v);\n                      set(draftKey, v);\n                    }\n                  }\n                }}\n                onChange={(e) => {\n                  let v = e.target.value;\n                  setContent(v);\n                  Storage.privateSet(draftKey, v);\n                }}\n              />\n            )}\n          </>\n        )}\n      </EditorWrapper>\n    ) : (\n      <div style={{ display: \"flex\", height: \"100%\" }}>\n        <EditorWrapper>\n          <EditorTextarea\n            placeholder=\"Start typing...\"\n            value={content}\n            onChange={(e) => setContent(e.target.value)}\n          />\n        </EditorWrapper>\n        <EditorWrapper>\n          <PreviewContent>{content}</PreviewContent>\n        </EditorWrapper>\n      </div>\n    )}\n  </PageContainer>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/devs.near/widget/app", "fact_widget_deployments_id": "e6cb5c7db5266fa811221474318b4a2e", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 21}
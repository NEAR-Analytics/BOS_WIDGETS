{"tx_hash": "8sU7ZevajsWpLP46E5giRKYMtnvLJkGEs6Yq3MpS2PiA", "action_id_social": "ETN8K2aK2bUAD5vHac42AkRTEKL9JZDgwr6PvLEXFzse-0-widget", "block_id": 108230253, "block_timestamp": "2023-12-18T06:30:53.940Z", "signer_id": "donationhubv2.near", "widget_name": "donate", "source_code": "/**\n * Require a project link\n */\nconst donationHubContractAccountId =\n  props.donationHubContractAccountId || \"donationhubv2.near\".split(\"/\", 1)[0];\n\n/* END_INCLUDE: \"core/lib/autocomplete\" */\n\nconst DRAFT_STATE_STORAGE_KEY = \"DRAFT_STATE\";\nconst parentId = props.parentId ?? null;\nconst postId = props.postId ?? null;\nconst mode = props.mode ?? \"Create\";\n\nconst referralLabels = props.referral ? [`${props.referral}`] : [];\nconst labelStrings = (props.labels ? props.labels.split(\",\") : []).concat(\n  referralLabels\n);\n\ninitState({\n  seekingFunding: false,\n  selectedElements: [],\n\n  name: props.name ?? \"\",\n  description: props.description ?? \"\",\n  amount: props.amount ?? \"\",\n  token: props.token ?? \"USDT\",\n  supervisor: props.supervisor ?? \"kanapitch.near\",\n  chain: \"\",\n  bitkub_address: props.bitkub_address ?? \"\",\n  jfin_address: props.jfin_address ?? \"\",\n  eth_address: props.eth_address ?? \"\",\n  postId: props.id ?? 0,\n});\n\n// This must be outside onClick, because Near.view returns null at first, and when the view call finished, it returns true/false.\n// If checking this inside onClick, it will give `null` and we cannot tell the result is true or false.\nconst onSubmit = () => {\n  //Storage.privateSet(DRAFT_STATE_STORAGE_KEY, JSON.stringify(state));\n\n  let body = {\n    description: generateDescription(\n      state.description,\n      state.amount,\n      state.token,\n      state.supervisor\n    ),\n  };\n\n  if (!context.accountId) return;\n\n  let txn = [];\n  if (mode == \"Create\") {\n    txn.push({\n      contractName: donationHubContractAccountId,\n      methodName: \"add_post\",\n      args: {\n        name: state.name,\n        description: body.description,\n      },\n      //   deposit: Big(10).pow(21).mul(3),\n      //   gas: Big(10).pow(12).mul(100),\n    });\n  }\n  Near.call(txn);\n};\n\nconst donate = (\n  <div class=\"d-flex flex-column mb-2\">\n    <div className=\"col-lg-6  mb-2\">\n      Chain-Currency\n      <select\n        onChange={(event) =>\n          State.update({ token: event.target.value, chain: event.target.value })\n        }\n        class=\"form-select\"\n        aria-label=\"Default select\"\n      >\n        <option selected value=\"ETH\">\n          ETH\n        </option>\n        <option value=\"KUB\">KUB</option>\n        <option value=\"JFIN\">JFIN</option>\n      </select>\n    </div>\n    <div className=\"col-lg-6 mb-2\">\n      Donated amount <span class=\"text-muted fw-normal\">(Numbers Only)</span>\n      <input\n        type=\"number\"\n        step=\"0.000001\"\n        value={state.donate_amount !== null ? state.donate_amount : \"\"}\n        min={0}\n        onChange={(event) => {\n          const newValue = event.target.value;\n          // Ensure the input is a valid number\n          if (/^\\d*\\.?\\d{0,18}$/.test(newValue)) {\n            State.update({\n              donate_amount: newValue,\n            });\n          }\n        }}\n      />\n    </div>\n  </div>\n);\n\nreturn (\n  <div class=\"bg-light d-flex flex-column flex-grow-1\">\n    <div class=\"mx-5 mb-5\">\n      {props.transactionHashes ? (\n        <>\n          Succesfull submission. Back to{\" \"}\n          <a\n            style={{\n              color: \"#3252A6\",\n            }}\n            className=\"fw-bold\"\n          >\n            feed\n          </a>\n        </>\n      ) : (\n        <>\n          <p>{state.seekingFunding}</p>\n          <div class=\"card border-light\">\n            <div class=\"card-body\">\n              <h1 class=\"card-title fw-bold fs-1\">Donation</h1>\n\n              {state.warning && (\n                <div\n                  class=\"alert alert-warning alert-dismissible fade show\"\n                  role=\"alert\"\n                >\n                  {state.warning}\n                  <button\n                    type=\"button\"\n                    class=\"btn-close\"\n                    data-bs-dismiss=\"alert\"\n                    aria-label=\"Close\"\n                    onClick={() => State.update({ warning: \"\" })}\n                  ></button>\n                </div>\n              )}\n              <div className=\"row\">{donate}</div>\n              <button\n                style={{\n                  width: \"7rem\",\n                  backgroundColor: \"#0C7283\",\n                  color: \"#f3f3f3\",\n                }}\n                className=\"btn btn-light mb-2 p-3\"\n                onClick={onSubmit}\n              >\n                Donate\n              </button>\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/donationhubv2.near/widget/donate", "fact_widget_deployments_id": "fbe8f9c02c8105ba82a4e26ebb3d7016", "inserted_timestamp": "2023-12-18T08:52:15.197Z", "modified_timestamp": "2023-12-20T03:22:11.422Z", "__row_index": 0}
{"tx_hash": "EXEPjLX91UWNweobM7xLgfcAKNTsdcuSoF5q24gFMtyJ", "action_id_social": "Ch1GU1ZbNEL5a4TmmhxKed6rZHDpZSKkhL9fQLceY1JX-0-widget", "block_id": 108020512, "block_timestamp": "2023-12-15T16:52:42.579Z", "signer_id": "keypom-marketplace.near", "widget_name": "Cart.Checkout", "source_code": "const ownerId = \"potlock.near\";\n\nconst IPFS_BASE_URL = \"https://nftstorage.link/ipfs/\";\nconst TRASH_ICON_URL =\n  IPFS_BASE_URL + \"bafkreicwtubzlywmtvoxc4tqjfturyi5oqxtbpezceosiw3juv2d4uf7om\";\n\nconst Container = styled.div`\n  background: #fafafa;\n  display: flex;\n  flex-direction: row;\n  height: 100%;\n  min-height: 100vh;\n`;\n\nconst SuccessContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  //   justify-content: center;\n  width: 100%;\n  padding: 24px;\n  gap: 24px;\n`;\n\n// const ButtonsContainer = styled.div`\n//   display: flex;\n//   flex-direction: row;\n//   gap: 24px;\n//   width: 50%;\n//   align-items: center;\n//   justify-content: center;\n// `;\n\nconst ColumnLeft = styled.div`\n  display: flex;\n  flex-direction: column;\n  //   background: #fafafa;\n  width: 55%;\n  //   background: pink;\n  padding: 48px 40px 48px 64px;\n  gap: 48px;\n`;\n\nconst ColumnRight = styled.div`\n  //   background: yellow;\n  flex: 1;\n  padding: 152px 148px 152px 84px;\n  border-left: 1px #c7c7c7 solid;\n`;\n\nconst Title = styled.div`\n  color: #2e2e2e;\n  font-size: 48px;\n  font-family: Lora;\n  font-weight: 500;\n  line-height: 56px;\n  word-wrap: break-word;\n  //   margin-bottom: 64px;\n`;\n\nconst Icon = styled.img`\n  width: 20px;\n  height: 20px;\n`;\n\nconst ActionsContainer = styled.div`\n  width: 100%;\n  padding: 16px;\n  background: white;\n  border: 1px solid #dbdbdb;\n  box-shadow: 0px -2px 0px #dbdbdb inset;\n  border-radius: 6px;\n  overflow: hidden;\n  justify-content: flex-start;\n  align-items: center;\n  display: inline-flex;\n  gap: 24px;\n`;\n\nconst InnerContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  gap: 12px;\n`;\n\nconst SubTitle = styled.div`\n  color: #2e2e2e;\n  font-weight: 600;\n  font-size: 14px;\n`;\n\nconst ItemContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  height: 200px;\n  background: white;\n  border: 1px solid #dbdbdb;\n  box-shadow: 0px -2px 0px #dbdbdb inset;\n  border-radius: 6px;\n  overflow: hidden;\n  justify-content: flex-start;\n  align-items: flex-start;\n  display: inline-flex;\n`;\n\nconst ItemLeft = styled.div`\n  height: 100%;\n  padding: 24px 16px;\n  border-right: 1px solid #dbdbdb;\n`;\n\nconst ItemRight = styled.div`\n  padding: 24px 24px 24px 16px;\n`;\n\nconst ImageContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 32px;\n`;\n\nconst DetailsContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nState.init({\n  selectedProjectIds: [],\n  masterSelectorSelected: false,\n});\n\nconst allSelected =\n  state.selectedProjectIds.length !== 0 &&\n  state.selectedProjectIds.length === Object.keys(props.cart).length;\n\nreturn (\n  <div>\n    <Container>\n      {props.checkoutSuccess ? (\n        <SuccessContainer>\n          <Title>Thanks for donating!</Title>\n          {/* <ButtonsContainer> */}\n          <Widget\n            src={`${ownerId}/widget/Buttons.NavigationButton`}\n            props={{\n              href: `https://nearblocks.io/txns/${props.checkoutSuccessTxHash}`,\n              target: \"_blank\",\n              type: \"secondary\",\n              text: \"View transaction\",\n              disabled: !props.checkoutSuccessTxHash,\n              style: {\n                width: \"300px\",\n              },\n            }}\n          />\n          <Widget\n            src={`${ownerId}/widget/Buttons.NavigationButton`}\n            props={{\n              href: `?tab=projects`,\n              type: \"primary\",\n              text: \"Explore events\",\n              style: {\n                width: \"300px\",\n              },\n            }}\n          />\n          {/* </ButtonsContainer> */}\n        </SuccessContainer>\n      ) : (\n        <>\n          <ColumnLeft>\n            <Title>Donation Cart</Title>\n            <ActionsContainer>\n              <InnerContainer>\n                <Widget\n                  src={`${ownerId}/widget/Inputs.Checkbox`}\n                  props={{\n                    id: \"masterSelector\",\n                    disabled: Object.keys(props.cart).length === 0,\n                    checked: state.masterSelectorSelected,\n                    onClick: (e) => {\n                      // if allSelected, then deselect all\n                      // if not allSelected, then select all\n                      const selectedProjectIds = Object.keys(props.cart).filter((_) => {\n                        if (allSelected) {\n                          return false;\n                        }\n                        return true;\n                      });\n                      State.update({\n                        selectedProjectIds,\n                        masterSelectorSelected: !allSelected,\n                      });\n                    },\n                  }}\n                />\n                <SubTitle>Select all</SubTitle>\n              </InnerContainer>\n              <InnerContainer\n                style={{ cursor: \"pointer\" }}\n                onClick={() => {\n                  // doesn't do anything if nothing selected\n                  if (state.selectedProjectIds.length === 0) return;\n                  // delete selected projects\n                  props.removeProjectsFromCart(state.selectedProjectIds);\n                  // uncheck box\n                  State.update({ selectedProjectIds: [], masterSelectorSelected: false });\n                }}\n              >\n                <Icon\n                  src={TRASH_ICON_URL}\n                  //   onClick={() => {\n                  //     // doesn't do anything if nothing selected\n                  //     if (state.selectedProjectIds.length === 0) return;\n                  //     // delete selected projects\n                  //     props.removeProjectsFromCart(state.selectedProjectIds);\n                  //     // uncheck box\n                  //     State.update({ selectedProjectIds: [], masterSelectorSelected: false });\n                  //   }}\n                />\n                <SubTitle>Delete</SubTitle>\n              </InnerContainer>\n            </ActionsContainer>\n            {Object.keys(props.cart).length === 0 ? (\n              <div>No items in cart</div>\n            ) : (\n              Object.keys(props.cart).map((projectId) => {\n                const checked = state.selectedProjectIds.includes(projectId);\n                return (\n                  <Widget\n                    src={`${ownerId}/widget/Cart.CheckoutItem`}\n                    props={{\n                      ...props,\n                      projectId,\n                      checked,\n                      handleCheckboxClick: (e) => {\n                        // if selected, then deselect\n                        // else, select\n                        let selectedProjectIds = state.selectedProjectIds;\n                        if (checked) {\n                          selectedProjectIds = selectedProjectIds.filter((id) => id !== projectId);\n                        } else {\n                          selectedProjectIds.push(projectId);\n                        }\n                        const updatedState = {\n                          selectedProjectIds,\n                        };\n                        if (\n                          selectedProjectIds.length !== 0 &&\n                          selectedProjectIds.length !== Object.keys(props.cart).length\n                        ) {\n                          updatedState.masterSelectorSelected = false;\n                        }\n                        State.update(updatedState);\n                      },\n                    }}\n                  />\n                );\n              })\n            )}\n          </ColumnLeft>\n          <ColumnRight>\n            <Widget\n              src={`${ownerId}/widget/Cart.BreakdownSummary`}\n              props={{\n                ...props,\n              }}\n            />\n          </ColumnRight>\n        </>\n      )}\n    </Container>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/keypom-marketplace.near/widget/Cart.Checkout", "fact_widget_deployments_id": "95a6b2e103f018afd648e21093a4bd26", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 22}
{"tx_hash": "Bx8cgMSznGdymki6QFt5awEfVBsG5tfhdhjtmariCnWS", "action_id_social": "5vdGmb2JB72R7Yewp23hmDACPDky2v517uE2MbcLbMiY-0-widget", "block_id": 108021230, "block_timestamp": "2023-12-15T17:05:25.420Z", "signer_id": "keypom-marketplace.near", "widget_name": "Project.ListEventsPage", "source_code": "\nconst ownerId = \"keypom-marketplace.testnet\";\nconst registryId = \"registry.potlock.near\"; // TODO: update when registry is deployed\n\nconst keypomRegistryId = 'testing-nearcon-keypom.testnet'\nconst eventRegistryId = 'dev-1699521073288-13420165222235'\n\n// const keypomRegistryId = 'testing-nearcon-keypom.testnet'\n\nconst IPFS_NEAR_BASE_URL = \"https://ipfs.near.social/ipfs/\";\nconst KEYPOM_HERO_BANNER_URL = IPFS_NEAR_BASE_URL + \"bafkreidjlppcmkzudgtytcgrblnvuqo2in6637ugrmcfladdiqa3kebnyu\"\n\nconst IPFS_BASE_URL = \"https://nftstorage.link/ipfs/\";\nconst DEFAULT_BANNER_IMAGE_URL =\n  IPFS_BASE_URL + \"bafkreih4i6kftb34wpdzcuvgafozxz6tk6u4f5kcr2gwvtvxikvwriteci\";\nconst DEFAULT_PROFILE_IMAGE_URL =\n  IPFS_BASE_URL + \"bafkreibwq2ucyui3wmkyowtzau6txgbsp6zizy4l2s5hkymsyv6tc75j3u\";\n\nconst getImageUrlFromSocialImage = (image) => {\n  if (image.url) {\n    return image.url;\n  } else if (image.ipfs_cid) {\n    return IPFS_BASE_URL + image.ipfs_cid;\n  }\n};\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n`;\n\nconst HeroOuter = styled.div`\n  padding: 136px 64px;\n`;\n\nconst HeroInner = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-between;\n`;\n\nconst SectionHeader = styled.div`\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  align-items: center;\n  margin-bottom: 24px;\n  padding: 96px 64px 24px 64px;\n`;\n\nconst SectionTitle = styled.div`\n  font-size: 24px;\n  font-weight: 600;\n  color: #2e2e2e;\n  font-family: Mona-Sans;\n`;\n\nconst ProjectsCount = styled.div`\n  color: #7b7b7b;\n  font-size: 24px;\n  font-weight: 400;\n  margin-left: 32px;\n`;\n\nconst ProjectsContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  // padding: 0px 64px 96px 64px;\n  // background: #fafafa;\n`;\n\nconst HeroContainer = styled.div`\n  width: 100%;\n  min-height: 700px;\n  position: relative;\n`;\n\nconst Hero = styled.img`\n  width: 100%;\n  height: 100%;\n  display: block;\n`;\n\nconst CATEGORY_MAPPINGS = {\n  \"social-impact\": \"Social Impact\",\n  \"non-profit\": \"NonProfit\",\n  climate: \"Climate\",\n  \"public-good\": \"Public Good\",\n  \"de-sci\": \"DeSci\",\n  \"open-source\": \"Open Source\",\n  community: \"Community\",\n  education: \"Education\",\n};\n\nconst drops = Near.view(keypomRegistryId, \"get_drops_for_funder\", { account_id: \"minqi.testnet\" });\nconst tickets = Near.view(eventRegistryId, \"view_keypom_contract\", { account_id: \"minqi.testnet\" })\n\n\nconst eventById = Near.view(eventRegistryId, \"get_event_information\", { event_id: \"moon-party\" })\nlet events = Near.view(eventRegistryId, \"get_events\", {}) // will be a vector array\n\nconsole.log('events ---------')\nconsole.log(events)\nconsole.log(events[0].name)\n\nconsole.log('drops  ---------')\nconsole.log(drops)\n\nconsole.log('get_event_info --------- ' + eventById)\nconsole.log(eventById)\n\n\nif (!state.registeredEvents) {\n  let drops = Near.view(keypomRegistryId, \"get_drops_for_funder\", { account_id: \"minqi.testnet\" })\n\n  console.log(\"BREAK -----------------\")\n\n  let tickets = Near.view(eventRegistryId, \"view_keypom_contract\", { account_id: \"minqi.testnet\" })\n  console.log('marketplace contract')\n  console.log(tickets)\n\n\n  let profileImageUrl = DEFAULT_PROFILE_IMAGE_URL;\n  if (profileData.image) {\n    const imageUrl = getImageUrlFromSocialImage(profileData.image);\n    if (imageUrl) profileImageUrl = imageUrl;\n  }\n\n  // get banner image URL\n  let bannerImageUrl = DEFAULT_BANNER_IMAGE_URL;\n  if (profileData.backgroundImage) {\n    const imageUrl = getImageUrlFromSocialImage(profileData.backgroundImage);\n    if (imageUrl) bannerImageUrl = imageUrl;\n  }\n\n  State.update({\n    registeredEvents: formattted,\n  });\n}\n\nreturn (\n  <>\n    <ProjectsContainer>\n      <SectionHeader>\n        <SectionTitle>All events</SectionTitle>\n        <ProjectsCount>Events Count {events.length}</ProjectsCount>\n        <h1>{console.log('event', events[0])}</h1>\n      </SectionHeader>\n\n      \n      <Widget\n        src={`${ownerId}/widget/Project.ListEvents`}\n        props={{\n          events,\n          renderItem: (events) => (\n            // <div>hello event {events.name} abc</div>\n\n            <Widget\n              src={`${ownerId}/widget/Project.CardEvent`}\n              props={{\n                events,\n                ...props,\n              }}\n            />\n          ),\n        }}\n      />\n      {/*<Widget\n        src={`${ownerId}/widget/Project.ListDrops`}\n        props={{\n          drops,\n          renderItem: (drop) => (\n            <Widget\n              src={`${ownerId}/widget/Project.CardDrop`}\n              props={{\n                project,\n                ...props,\n              }}\n            />\n          ),\n        }}\n      />*/}\n\n    </ProjectsContainer>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/keypom-marketplace.near/widget/Project.ListEventsPage", "fact_widget_deployments_id": "9fc237153ca18943170649c434d205d2", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 3}
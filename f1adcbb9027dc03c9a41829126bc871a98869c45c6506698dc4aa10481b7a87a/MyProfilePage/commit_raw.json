{"tx_hash": "3SF9CSKtm5bYcpJtdQZY5779CSkeWMxRvqAYrT4oA43h", "action_id_social": "AdAep9L67ztoDMiNdXnUVBQde6Lo4ehLuMUKPX1rycG5-0-widget", "block_id": 101482750, "block_timestamp": "2023-09-19T15:08:55.412Z", "signer_id": "f1adcbb9027dc03c9a41829126bc871a98869c45c6506698dc4aa10481b7a87a", "widget_name": "MyProfilePage", "source_code": "// styled components\nconst Banner = styled.div`\n    width : 100%;\n    text-align : center;\n    margin-bottom : 1rem;\n\n    img {\n        width : 100%;\n        height : 100%;\n    }\n`;\n\nconst FlexBoxRow = styled.div`\n    display : flex;\n`;\n\nconst FlexBoxColumn = styled.div`\n    display : flex;\n    position : relative;\n    flex-direction: column;\n    justify-content: center;\n    height : 20vh;\n\n        .name-icon {\n        position : absolute;\n        top : 0rem;\n        left : 0.5rem;\n    }\n`;\n\nconst Avatar = styled.div`\n    display : flex;\n    justify-content : flex-start;\n    margin-left : 1rem;\n    height : 20vh;\n    margin : 0.5rem 0.5rem;\n\n    .avatar {\n        width : 10rem;\n    }\n`;\n\nconst Name = styled.div`\n\n    font-size : 1rem;\n\n    .name {\n        height : 5vh;\n    }\n\n    .wallet {\n        font-size : 1rem;\n        color : #687076;\n        overflow-wrap: break-word;\n        height : 5vh;\n    }\n\n`;\n\nconst PostContainer = styled.div`\nmargin-top : 5rem;\npadding : 1rem 1rem;\nwidth : 50%;\noverflow-wrap: break-word;\n\n\n`;\n\nconst SocialWidgetContainer = styled.div`\nmargin-top : 5rem;\npadding : 1rem 1rem;\nwidth : 50%;\noverflow-wrap: break-word;\n\n`;\n\n// fetch data\nconst account_id = context.accountId ?? props.accountId;\nconst profileData = Social.getr(`${account_id}/profile`);\n\nState.init({\n  isInit: false,\n  posts: [],\n});\n\nconst getMyPosts = () => {\n  asyncFetch(\n    \"https://queryapi-hasura-graphql-24ktefolwq-ew.a.run.app/v1/graphql\",\n    {\n      method: \"POST\",\n      headers: { \"x-hasura-role\": \"nearpavel_near\" },\n      body: JSON.stringify({\n        query: `query MyPosts {\n          nearpavel_near_social_posts_posts(where: {account_id: {_eq: \"${account_id}\"}}, order_by: {block_timestamp: desc}) {\n          account_id\n          block_height\n          block_timestamp\n          content\n          receipt_id\n        }\n      }`,\n      }),\n    }\n  ).then((postRes) => {\n    if (postRes.body.errors === undefined) {\n      State.update({\n        isInit: true,\n        posts: postRes.body.data.nearpavel_near_social_posts_posts,\n      });\n    }\n  });\n};\n\nif (state.isInit === false) {\n  getMyPosts();\n}\n\nconst Post = state.posts.map((post, index) => {\n  const content = JSON.parse(post.content);\n  const block_timestamp = new Date(post.block_timestamp / 1000000);\n  const { year, month, day, hours, minutes, seconds } = {\n    year: block_timestamp.getFullYear(),\n    month: (block_timestamp.getMonth() + 1).toString().padStart(2, \"0\"),\n    day: block_timestamp.getDate().toString().padStart(2, \"0\"),\n    hours: block_timestamp.getHours().toString().padStart(2, \"0\"),\n    minutes: block_timestamp.getMinutes().toString().padStart(2, \"0\"),\n  };\n\n  return (\n    <>\n      <div style={{ padding: \"1rem 2ren\" }}>\n        <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n          <h2 style={{ fontSize: \"1rem\" }}>No.{state.posts.length - index}</h2>\n          <h3 style={{ fontSize: \"1rem\", fontStyle: \"italic\" }}>\n            {year}-{month}-{day} {hours}:{minutes}\n          </h3>\n        </div>\n        <div\n          style={{\n            padding: \"1rem 1rem 0 1rem\",\n            border: \"solid 0.1rem #53D8D9\", // aqua green\n            borderRadius: \"0.5rem\",\n            borderWidth: \"0 0 0 0.5rem\",\n          }}\n        >\n          <Markdown text={content.text} />\n        </div>\n      </div>\n      <hr style={{ color: \"#53D8D9\" }} />\n    </>\n  );\n});\n\nconst data = Social.getr(`${account_id}/widget/*`, \"final\", {\n  subscribe: true,\n});\n\nconst widgetEntries =\n  data === undefined || data === null ? [] : Object.entries(data);\n\nconst widgets = widgetEntries.map(([title]) => {\n  return (\n    <div\n      style={{\n        padding: \"1rem 1rem\",\n        width: \"100%\",\n      }}\n    >\n      <div\n        style={{\n          display: \"flex\",\n        }}\n      >\n        <a\n          href={`/near/widget/ComponentDetailsPage?src=${account_id}/widget/${title}`}\n          style={{\n            padding: \"1rem\",\n            border: \"dotted 1px #53D8D9\",\n            backgroundColor: \"#fff\",\n            color: \"#0d6efd\",\n            fontSize: \"1rem\",\n            fontWeight: \"bold\",\n          }}\n        >\n          Click Here\n        </a>\n        <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n          <a\n            href={`/${account_id}/widget/${title}`}\n            style={{\n              padding: \"0 0 0 15px\",\n              overflow: \"hidden\",\n              whiteSpace: \"nowrap\",\n              textOverflow: \"ellipsis\",\n              fontSize: \"2em\",\n              fontWeight: \"bold\",\n              color: \"#000\",\n              wordBreak: \"break-all\",\n            }}\n          >\n            <h1 style={{ fontSize: \"1rem\" }}>{title}</h1>\n          </a>\n          <a\n            href={`/near/widget/ProfilePage?accountId=${account_id}`}\n            style={{\n              padding: \"0 0 0 14px\",\n              overflow: \"hidden\",\n              whiteSpace: \"nowrap\",\n              textOverflow: \"ellipsis\",\n              fontSize: \"1.3em\",\n              color: \"#888\",\n              wordBreak: \"break-all\",\n            }}\n          >\n            <h1 style={{ fontSize: \"1rem\" }}>@{account_id}</h1>\n          </a>\n        </div>\n      </div>\n      <hr style={{ color: \"#53D8D9\" }} />\n    </div>\n  );\n});\n\nreturn (\n  <>\n    <Banner>\n      <img\n        className=\"avatar\"\n        src={`https://ipfs.near.social/ipfs/${profileData.backgroundImage.ipfs_cid}`}\n      />\n    </Banner>\n    <FlexBoxRow>\n      <div style={{ width: \"30%\" }}>\n        <Avatar>\n          <img\n            className=\"avatar\"\n            src={`https://ipfs.near.social/ipfs/${profileData.image.ipfs_cid}`}\n          />\n        </Avatar>\n      </div>\n      <div style={{ width: \"70%\" }}>\n        <FlexBoxColumn>\n          <Name>\n            <div className=\"name\">\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                height=\"0.8rem\"\n                style={{ paddingRight: \"0.5rem\" }}\n                viewBox=\"0 0 448 512\"\n              >\n                <path d=\"M304 128a80 80 0 1 0 -160 0 80 80 0 1 0 160 0zM96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM49.3 464H398.7c-8.9-63.3-63.3-112-129-112H178.3c-65.7 0-120.1 48.7-129 112zM0 482.3C0 383.8 79.8 304 178.3 304h91.4C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3z\" />\n              </svg>\n              {profileData.name}\n            </div>\n            <div className=\"wallet\">@{account_id}</div>\n          </Name>\n        </FlexBoxColumn>\n      </div>\n    </FlexBoxRow>\n    <FlexBoxRow>\n      <PostContainer>\n        <div>\n          {state.isInit === false ? (\n            <FlexBoxRow>\n              <h1 style={{ fontSize: \"1rem\" }}>Load Your Posts...</h1>\n            </FlexBoxRow>\n          ) : (\n            <div>\n              <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n                <h1 style={{ fontSize: \"1rem\" }}>\n                  <span\n                    style={{\n                      fontSize: \"1.5rem\",\n                      color: \"blue\",\n                      marginRight: \"0.5rem\",\n                    }}\n                  >\n                    {Post.length}\n                  </span>\n                  posts\n                </h1>\n                <button onClick={getMyPosts} style={{ fontSize: \"1rem\" }}>\n                  Load Posts\n                </button>\n              </div>\n              <hr style={{ color: \"#53D8D9\" }} />\n              {Post.length === 0 ? <h1>Can not found your post</h1> : Post}\n            </div>\n          )}\n        </div>\n      </PostContainer>\n\n      <SocialWidgetContainer>\n        <div>\n          <h1 style={{ fontSize: \"1rem\" }}>\n            <span\n              style={{\n                fontSize: \"1.5rem\",\n                color: \"blue\",\n                marginRight: \"0.5rem\",\n              }}\n            >\n              {widgetEntries.length}\n            </span>\n            widgets\n          </h1>\n          <hr style={{ color: \"#53D8D9\" }} />\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n            }}\n          >\n            {widgets}\n          </div>\n        </div>\n      </SocialWidgetContainer>\n    </FlexBoxRow>\n  </>\n);\n", "metadata": {"platform": "jutsu.ai"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/f1adcbb9027dc03c9a41829126bc871a98869c45c6506698dc4aa10481b7a87a/widget/MyProfilePage", "fact_widget_deployments_id": "a7f81aa92fb80673bca5f7989839eee8", "inserted_timestamp": "2023-09-19T17:17:40.798Z", "modified_timestamp": "2023-09-19T17:17:40.798Z", "__row_index": 0}
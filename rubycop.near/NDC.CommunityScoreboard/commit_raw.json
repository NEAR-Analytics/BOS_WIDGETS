{"tx_hash": "QqUtZqCLiygWzSG4r13mWYnqmhXRkgVzYYE77Davn5d", "action_id_social": "DHtzEmEHiKWUwPBpszQALwjDKYE1PiKbxFACyQxqwsRQ-0-widget", "block_id": 100157791, "block_timestamp": "2023-09-01T13:39:16.337Z", "signer_id": "rubycop.near", "widget_name": "NDC.CommunityScoreboard", "source_code": "State.init({\n  data: [],\n  community: \"\",\n});\n\nasyncFetch(`https://scoreboard-ophc7vkxsq-uc.a.run.app/scoreboard`, {\n  method: \"GET\",\n  headers: {\n    Accept: \"application/json\",\n    \"Content-Type\": \"application/json\",\n  },\n}).then((res) => {\n  if (res.body) State.update({ data: res.body.data });\n});\n\nconst Loader = () => (\n  <span\n    className=\"spinner-grow spinner-grow-sm me-1\"\n    role=\"status\"\n    aria-hidden=\"true\"\n  />\n);\n\nconst UserName = styled.div`\n  color: inherit !important;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 14px;\n  padding-top: 2px;\n  width: 200px;\n`;\n\nconst Tag = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 8px;\n  border: 1px solid #4ba6ee;\n  color: #4ba6ee;\n  border-radius: 100px;\n  font-weight: 500;\n  font-size: 11px;\n`;\n\nconst H3 = styled.h3`\n  text-transform: capitalize;\n`;\n\nif (state.data.length === 0)\n  return (\n    <>\n      <Loader /> Fetching data ...\n    </>\n  );\n\nconst communityData = state.data.filter(\n  (i) => i[\"community-name\"] === state.community\n);\n\nconst getCommunities = () => {\n  const data = state.data.map((item) => item[\"community-name\"]);\n  return [...new Set(data)].sort((a, b) => a - b);\n};\n\nconst groupBy = (data, type) =>\n  data.reduce((group, item) => {\n    group[type] = group[type] ?? [];\n    group[type].push(item[type]);\n\n    return group;\n  }, {});\n\nreturn (\n  <div className=\"d-flex justify-content-center w-100\">\n    <div className=\"w-50\">\n      <h1>NDC Community users</h1>\n      <div className=\"my-2\">\n        <Widget\n          src={\"near/widget/Select\"}\n          props={{\n            label: \"Select community\",\n            value: state.community,\n            onChange: (item) => State.update({ community: item.text }),\n            options: getCommunities().map((community) => {\n              return {\n                text: community,\n                value: community,\n              };\n            }),\n          }}\n        />\n      </div>\n\n      {communityData.length > 0 && (\n        <>\n          <div className=\"d-flex justify-content-between align-items-center\">\n            <H3>\n              <b>{state.community}</b>\n            </H3>\n            <Tag>{communityData[0][\"community-vertical\"]}</Tag>\n          </div>\n          <small>Rank: -</small>\n          <br />\n          <small>Total users: {communityData.length}</small>\n          <hr className=\"mt-3 mb-4\" />\n\n          {communityData\n            .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))\n            .map((user) => (\n              <div className=\"d-flex justify-content-between align-items-center p-1\">\n                <Widget\n                  src=\"near/widget/AccountProfileOverlay\"\n                  props={{\n                    accountId: user.account,\n                    children: (\n                      <div className=\"d-flex justify-items-center\">\n                        <Widget\n                          src=\"mob.near/widget/ProfileImage\"\n                          props={{\n                            accountId: user.account,\n                            imageClassName: \"rounded-circle w-100 h-100\",\n                            style: {\n                              width: \"24px\",\n                              height: \"24px\",\n                              marginRight: 5,\n                            },\n                          }}\n                        />\n                        <UserName>{user.account}</UserName>\n                      </div>\n                    ),\n                  }}\n                />\n\n                <small className=\"text-secondary\">\n                  {new Date(user.created_at).toLocaleDateString(\"en-US\", {\n                    day: \"2-digit\",\n                    month: \"short\",\n                  })}\n                  &middot;\n                  {new Date(user.created_at).toLocaleTimeString(\"en-US\", {\n                    hour: \"2-digit\",\n                  })}\n                </small>\n              </div>\n            ))}\n        </>\n      )}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/rubycop.near/widget/NDC.CommunityScoreboard", "fact_widget_deployments_id": "e3270b30d4d433efd3fc6388f060195b", "inserted_timestamp": "2023-09-01T15:35:31.022Z", "modified_timestamp": "2023-09-01T15:35:31.022Z", "__row_index": 3}
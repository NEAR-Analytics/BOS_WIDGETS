{"tx_hash": "HBdf2NM5fQsoKL9WiutJha8rKzSNpowcn4YTzpqwG4QL", "action_id_social": "69zLy32a8BsKvxQiwcTST8mRM2TL7wPPL2vXzQVb5Jq3-0-widget", "block_id": 96681332, "block_timestamp": "2023-07-17T11:26:43.238Z", "signer_id": "rubycop.near", "widget_name": "NDC.Nomination.Card", "source_code": "const data = props;\n\nState.init({\n  verified: false,\n  start: true,\n  voted: false,\n  shareText: \"Copy link to the clipboard\",\n});\n\nconst nominationContract = \"nominations-v1.gwg-testing.near\";\nconst registryContract = \"registry-v1.gwg-testing.near\";\nconst apiKey = \"36f2b87a-7ee6-40d8-80b9-5e68e587a5b5\";\n\nconst widgets = {\n  styledComponents: \"rubycop.near/widget/NDC.StyledComponents\",\n};\n\nconst isHuman = Near.view(registryContract, \"is_human\", {\n  account: context.accountId,\n});\n\nState.update({ verified: isHuman[0][1].length > 0 });\n\nconst httpRequestOpt = {\n  headers: { \"x-api-key\": apiKey },\n};\n\nfunction getVerifiedHuman() {\n  asyncFetch(\n    `https://api.pikespeak.ai/nominations/is-upvoted-by?candidate=${data.indexerData.nominee}&upvoter=${context.accountId}`,\n    httpRequestOpt\n  ).then((res) => {\n    State.update({ voted: res.body });\n  });\n}\n\nif (state.start) {\n  getVerifiedHuman();\n  State.update({ start: false });\n}\n\nfunction handleUpVote() {\n  Near.call(\n    nominationContract,\n    state.voted ? \"remove_upvote\" : \"upvote\",\n    {\n      candidate: data.indexerData.nominee,\n    },\n    300000000000000,\n    state.voted ? 0 : 1000000000000000000000\n  );\n}\n\nfunction handleShare() {\n  console.log(copied);\n  State.update({ shareText: \"Copied\" });\n  clipboard.writeText(\n    \"https://near.org/#/yairnava.near/widget/NDC.Nomination.Candidate.Container?house=\" +\n      data.indexerData.house +\n      \"&candidate=\" +\n      data.indexerData.nominee\n  );\n}\n\nfunction getComponentURL() {\n  const url =\n    \"https%3A%2F%2Fnear.org%2F%23%2Fyairnava.near%2Fwidget%2FNDC.Nomination.Candidate.Container%3Fhouse%3D\" +\n    data.indexerData.house +\n    \"%26candidate%3D\" +\n    data.indexerData.nominee;\n  return url;\n}\n\nconst Card = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 16px;\n  gap: 16px;\n  width: 358px;\n  background: #f8f8f9;\n  border-radius: 10px;\n`;\nconst HeaderCard = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  gap: 12px;\n  width: 326px;\n  height: 53px;\n`;\nconst ProfilePicture = styled.img`\n  width: 40px;\n  height: 40px;\n  border-radius: 20px;\n`;\nconst HeaderContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 4px;\n  width: 190px;\n  height: 53px;\n\n  flex-grow: 1;\n`;\nconst HeaderTag = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 8px;\n  height: 18px;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  border-radius: 100px;\n`;\nconst HeaderTagP = styled.p`\n  height: 10px;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 11px;\n  display: flex;\n  align-items: center;\n  color: white;\n  margin: 0;\n`;\nconst HeaderContentText = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  width: 228px;\n`;\nconst NominationName = styled.p`\n  width: 90%;\n  font-weight: 500;\n  font-size: 14px;\n  margin: 0;\n  align-items: center;\n  color: #000000;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\nconst NominationUser = styled.p`\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  margin: 0px;\n  line-height: 120%;\n  display: flex;\n  align-items: center;\n  color: #828688;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\nconst UpvoteButtonDisabled = styled.button`\n  display: flex;\n  padding: 2px 12px;\n  align-items: center;\n  gap: 6px;\n  border-radius: 4px;\n  background: var(--buttons-disable, #c3cace);\n  cursor: default !important;\n`;\n\nconst UpvoteButton = styled.button`\n  padding: 6px 12px;\n  border-radius: 8px;\n  background: #fff;\n  font-size: 14px;\n  font-weight: 500;\n  line-height: 24px;\n  color: ${(props) => (props.disabled ? \"#C3CACE\" : \"#9333EA\")};\n  border: 1px solid #9333ea;\n  border-color: ${(props) => (props.disabled ? \"#C3CACE\" : \"\")};\n`;\n\nconst UpvoteCount = styled.p`\n  font-size: 12px;\n  font-weight: 500;\n  line-height: 24px;\n  margin: 0px;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;\nconst Icon = styled.img`\n  width: 17px;\n  height: 17px;\n`;\nconst CollapseCandidate = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 12px;\n  background: #ffffff;\n  border-radius: 6px;\n`;\nconst CollapseCandidateContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 5px;\n`;\nconst CollapseCandidateText = styled.p`\n  width: 274px;\n  font-style: normal;\n  font-weight: 700;\n  font-size: 12px;\n  line-height: 120%;\n  margin: 0px;\n  margin-bottom: 3px;\n  color: #000000;\n`;\nconst DownArrow = styled.img`\n  width: 16px;\n  height: 16px;\n`;\nconst CandidateTagContainer = styled.div`\n  gap: 4px;\n`;\nconst CandidateTag = styled.div`\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 8px;\n  background: linear-gradient(\n    90deg,\n    rgba(147, 51, 234, 0.1) 0%,\n    rgba(79, 70, 229, 0.1) 100%\n  );\n  border-radius: 100px;\n`;\nconst CandidateTagText = styled.p`\n  height: 12px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  max-width: 200px;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 11px;\n  line-height: 120%;\n  margin: 0px;\n  color: #9333ea;\n`;\nconst KeyIssues = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  padding: 12px;\n  gap: 12px;\n  background: #ffffff;\n  border-radius: 6px;\n`;\nconst KeyIssuesContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 12px;\n  width: 302px;\n`;\nconst KeyIssuesHeader = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 12px;\n`;\nconst KeyIssuesTitle = styled.p`\n  font-style: normal;\n  font-weight: 700;\n  font-size: 12px;\n  line-height: 120%;\n  margin-bottom: 0;\n`;\nconst KeyIssuesContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  padding: 0px;\n  gap: 8px;\n  overflow-y: scroll;\n  height: 250px;\n`;\nconst KeyIssueTitle = styled.p`\n  font-weight: 500;\n  font-size: 11px;\n  margin-bottom: 0px;\n  width: 302px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n`;\nconst KeyIssueDescription = styled.p`\n  font-weight: 400;\n  font-size: 11px;\n  margin-bottom: 0;\n`;\nconst KeyIssueSeparator = styled.div`\n  height: 1px;\n  margin: 7px 0 2px 0;\n  background: rgba(208, 214, 217, 0.40);\n`;\nconst LowerSection = styled.div`\n  display: flex;\n  width: 326px;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  gap: 8px;\n`;\nconst LowerSectionContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  gap: 8px;\n  align-self: stretch;\n`;\nconst ButtonsLowerSection = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  width: 326px;\n  height: 28px;\n`;\nconst TextLowerSectionContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  gap: 4px;\n  width: 239px;\n  height: 24px;\n\n  flex-grow: 1;\n`;\nconst ClockIcon = styled.img`\n  width: 12px;\n  height: 12px;\n`;\nconst TimestampText = styled.p`\n  width: 150px;\n  height: 20px;\n  font-style: italic;\n  font-weight: 300;\n  font-size: 11px;\n  line-height: 14px;\n  margin: 0px;\n  display: flex;\n  align-items: center;\n  color: #000000;\n`;\nconst CommentsCounter = styled.p`\n  width: 96px;\n  height: 24px;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 24px;\n  margin: 0px;\n  text-align: right;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;\nconst ButtonsContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0px;\n  gap: 4px;\n  width: 87px;\n  height: 28px;\n`;\nconst TagSection = styled.div`\n  display: flex;\n  align-items: flex-start;\n  gap: 4px;\n  flex-wrap: wrap;\n  max-height: 20px;\n  overflow: hidden;\n`;\nconst Tag = styled.div`\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 4px 8px;\n  gap: 10px;\n  height: 20px;\n  border-radius: 80px;\n  background-image: linear-gradient(#eae5f7, #eae5f7),\n    radial-gradient(circle at top left, #9333ea 0%, #4f46e5 100%);\n  background-origin: border-box;\n  background-clip: padding-box, border-box;\n  border-radius: 100px;\n`;\nconst TagText = styled.p`\n  height: 12px;\n  font-style: normal;\n  font-weight: 500;\n  font-size: 11px;\n  margin: 0px;\n  line-height: 120%;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;\nconst CommentButtonDisabled = styled.button`\n  display: flex;\n  padding: 2px 12px;\n  align-items: center;\n  gap: 6px;\n  border-radius: 4px;\n  b\n  background: var(--buttons-disable, #c3cace);\n  cursor: default !important;\n`;\nconst CommentButtonDiv = styled.button`\n  display: flex;\n  padding: 2px 12px;\n  align-items: center;\n  gap: 6px;\n  b\n  border-radius: 80px;\n  background-image: linear-gradient(#f8f8f9, #f8f8f9),\n    radial-gradient(circle at top left, #9333ea 0%, #4f46e5 100%);\n  background-origin: border-box;\n  background-clip: padding-box, border-box;\n  border-radius: 4px;\n`;\nconst CommentButtonCounter = styled.p`\n  font-size: 12px;\n  font-weight: 500;\n  line-height: 24px;\n  margin: 0px;\n  background: linear-gradient(90deg, #9333ea 0%, #4f46e5 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;\nconst CommentButtonIcon = styled.img`\n  width: 14px;\n  height: 14px;\n`;\n\nconst DropdownContainer = styled.div`\n  position: relative;\n  display: inline-block;\n`;\n\nconst Dropbtn = styled.button`\n  background-color: #4caf50;\n  color: white;\n  padding: 16px;\n  font-size: 16px;\n`;\n\nconst DropdownContent = styled.div`\n  display: none;\n  font-size: 13px;\n  flex-direction: column;\n  align-items: flex-start;\n  position: absolute;\n  border-radius: 8px;\n  background: #ffffff;\n  width: 200px;\n  gap: 9px;\n  box-shadow: 0px 0px 30px 0px rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  z-index: 1;\n  padding: 8px;\n`;\n\nconst Element = styled.div`\n  display: flex;\n  cursor: pointer;\n  justify-content: center;\n  width: 100%;\n  &:hover {\n    border-radius: 6px;\n    background: #f8f8f9;\n  }\n`;\n\nconst ShareLink = styled.a`\n  color: black;\n  padding: 12px 16px;\n  text-decoration: none;\n  display: block;\n  text-align: start;\n`;\n\nconst ShareIcon = styled.img`\n  width: 20px;\n`;\n\nconst DropdownContainerHover = styled.div`\n  width: fit-content;\n  float: right;\n  &:hover ${DropdownContent} {\n    display: flex;\n  }\n`;\n\nconst Separation = styled.div`\n    margin-top: -196px;\n    width: 200px;\n    position: absolute;\n  }\n`;\n\nconst canUpvote =\n  state.verified && context.accountId != data.indexerData.nominee;\n\nconst getShortUserName = (userId) => {\n  if (userId.length === 64) return `${userId.slice(0, 4)}..${userId.slice(-4)}`;\n  const name = userId.slice(0, -5); // truncate .near\n\n  return name.length > 12 ? `${name.slice(0, 9)}...` : name;\n};\n\nconst trimText = (text, limit) => {\n  const _limit = limit ?? 200;\n  const ending = text.length > _limit ? \"...\" : \"\";\n  const trimmed = text.slice(0, limit ?? 200);\n\n  return `${trimmed}${ending}`;\n};\n\nconst keyIssues = [\n  {\n    title:\n      \"Involvement in the NEAR ecosystem, qualifications to be a candidate and reasons for being voted\",\n    desc: data.nominationData.HAYInvolve,\n  },\n  {\n    title: \"Strategy to develop the NEAR ecosystem\",\n    desc: data.nominationData.WIYStrategy,\n  },\n  {\n    title: \"Key Issue 1\",\n    desc: data.nominationData.Key_Issue_1,\n  },\n  {\n    title: \"Key Issue 2\",\n    desc: data.nominationData.Key_Issue_2,\n  },\n  {\n    title: \"Key Issue 3\",\n    desc: data.nominationData.Key_Issue_3,\n  },\n  {\n    title: \"Other Platform\",\n    desc: data.nominationData.addition_platform,\n  },\n];\n\nreturn (\n  <Card>\n    {state.showModal && (\n      <Widget\n        src={`dokxo.near/widget/CommentCard`}\n        props={{\n          candidateOrReplay: true,\n          username: data.indexerData.nominee,\n          onClickConfirm: () => State.update({ showModal: false }),\n          onClickCancel: () => State.update({ showModal: false }),\n        }}\n      />\n    )}\n    <HeaderCard>\n      <ProfilePicture\n        src={\n          data.imgURL\n            ? data.imgURL\n            : \"https://apricot-straight-eagle-592.mypinata.cloud/ipfs/QmZBPPMKLdZG2zVpYaf9rcbtNfAp7c3BtsvzxzBb9pNihm?_gl=1*6avmrp*rs_ga*MzkyOTE0Mjc4LjE2ODY4NjgxODc.*rs_ga_5RMPXG14TE*MTY4NjkzMzM2NC4zLjEuMTY4NjkzMzM4Ni4zOC4wLjA.\"\n        }\n        alt=\"pic\"\n      ></ProfilePicture>\n      <HeaderContent>\n        <HeaderTag>\n          <HeaderTagP>\n            {data.indexerData.house == \"HouseOfMerit\"\n              ? \"House of Merit\"\n              : data.indexerData.house == \"CouncilOfAdvisors\"\n              ? \"Council of Advisors\"\n              : \"Transparency Commission\"}\n          </HeaderTagP>\n        </HeaderTag>\n        <HeaderContentText>\n          <NominationName>{data.profileData.name}</NominationName>\n          <NominationUser>\n            {getShortUserName(data.nominationData.profileAccount)}\n          </NominationUser>\n        </HeaderContentText>\n      </HeaderContent>\n      {canUpvote && (\n        <Widget\n          src={widgets.styledComponents}\n          props={{\n            Button: {\n              text: `+${data.upVoteData.upvotes ?? 0}`,\n              size: \"sm\",\n              className: \"secondary dark\",\n              onClick: handleUpVote,\n              icon: <i className=\"bi bi-hand-thumbs-up\"></i>,\n            },\n          }}\n        />\n      )}\n    </HeaderCard>\n    <CollapseCandidate className=\"w-100\">\n      <CollapseCandidateContent>\n        <CollapseCandidateText>Candidate Affiliations</CollapseCandidateText>\n        <CandidateTagContainer className=\"w-100 d-flex flex-wrap\">\n          {JSON.parse(data.nominationData.afiliation).map((data) => {\n            return (\n              <CandidateTag>\n                <CandidateTagText>{data.company_name}</CandidateTagText>\n              </CandidateTag>\n            );\n          })}\n        </CandidateTagContainer>\n      </CollapseCandidateContent>\n    </CollapseCandidate>\n    <KeyIssues>\n      <KeyIssuesContent>\n        <KeyIssuesHeader>\n          <KeyIssuesTitle>Key issues</KeyIssuesTitle>\n        </KeyIssuesHeader>\n        <KeyIssuesContainer>\n          {keyIssues.map((issue, i) => (\n            <div key={i}>\n              <KeyIssueTitle>{issue.title}</KeyIssueTitle>\n              <KeyIssueDescription className=\"text-secondary\">\n                {trimText(issue.desc)}\n              </KeyIssueDescription>\n              <KeyIssueSeparator />\n            </div>\n          ))}\n        </KeyIssuesContainer>\n      </KeyIssuesContent>\n    </KeyIssues>\n    <LowerSection>\n      <LowerSectionContainer>\n        <ButtonsLowerSection>\n          <TextLowerSectionContainer>\n            <i className=\"bi bi-clock\"></i>\n            {data.indexerData.timestamp && (\n              <TimestampText>\n                {new Date(data.indexerData.timestamp).toDateString()} by{\" \"}\n                <b>{data.indexerData.nominee}</b>\n              </TimestampText>\n            )}\n          </TextLowerSectionContainer>\n          <Widget\n            src={widgets.styledComponents}\n            props={{\n              Button: {\n                text: `+${data.upVoteData.comments.length ?? 0}`,\n                disabled: !state.verified,\n                size: \"sm\",\n                className: \"secondary dark\",\n                onClick: () => {\n                  !data.preview ? State.update({ showModal: true }) : \"\";\n                },\n                icon: <i className=\"bi bi-chat-square-text-fill\"></i>,\n              },\n            }}\n          />\n        </ButtonsLowerSection>\n        <div className=\"d-flex w-100 justify-content-between align-items-center\">\n          <TagSection>\n            {data.nominationData.tags\n              .trim()\n              .split(\",\")\n              .map((data) => (\n                <>\n                  {data !== \"\" && (\n                    <Tag>\n                      <TagText>{data}</TagText>\n                    </Tag>\n                  )}\n                </>\n              ))}\n          </TagSection>\n\n          {!data.preview && (\n            <div className=\"d-flex gap-2\">\n              <Widget\n                src={widgets.styledComponents}\n                props={{\n                  Link: {\n                    text: \"View\",\n                    size: \"sm\",\n                    className: \"secondary dark\",\n                    href: `#/yairnava.near/widget/NDC.Nomination.Candidate.Container?house=${data.indexerData.house}&candidate=${data.indexerData.nominee}`,\n                  },\n                }}\n              />\n              <DropdownContainerHover>\n                <Widget\n                  src={widgets.styledComponents}\n                  props={{\n                    Button: {\n                      text: \"Share\",\n                      size: \"sm\",\n                      onClick: handleShare,\n                      icon: <i className=\"bi bi-share-fill\"></i>,\n                    },\n                  }}\n                />\n                <Separation>\n                  <DropdownContent>\n                    <Element onClick={handleShare}>\n                      <OverlayTrigger\n                        placement={top}\n                        overlay={<Tooltip>{state.shareText}</Tooltip>}\n                      >\n                        <ShareLink\n                          style={{\n                            width: \"132px\",\n                            \"text-decoration\": \"none\",\n                            color: \"black\",\n                          }}\n                        >\n                          Share as a Link\n                        </ShareLink>\n                      </OverlayTrigger>\n                      <ShareIcon src=\"https://emerald-related-swordtail-341.mypinata.cloud/ipfs/QmV7qjDVv5dhsMJF1hRqCzeVNEHervtSURQmyBqWLdvtq3\" />\n                    </Element>\n                    <Element>\n                      <ShareLink\n                        target=\"_blank\"\n                        href={\n                          \"https://twitter.com/intent/tweet?text=Please%20checkout%20this%20NDC%20Candidate%20and%20Support%20the%20NDC%20Election!%20&url=\" +\n                          getComponentURL()\n                        }\n                        style={{\n                          width: \"132px\",\n                          \"text-decoration\": \"none\",\n                          color: \"black\",\n                        }}\n                      >\n                        Share on Twitter\n                      </ShareLink>\n                      <ShareIcon src=\"https://emerald-related-swordtail-341.mypinata.cloud/ipfs/QmTXndeq7DWFW8gwsmhLBXTd4KzCeKr2Q6GgMwUA8fmfoJ\" />\n                    </Element>\n                    <Element>\n                      <ShareLink\n                        href={\n                          \"mailto:?subject=Please%20checkout%20this%20NDC%20Candidate%20and%20Support%20the%20NDC%20Election&body=Support%20the%20NDC%20Election!%20\" +\n                          getComponentURL()\n                        }\n                        style={{\n                          width: \"132px\",\n                          \"text-decoration\": \"none\",\n                          color: \"black\",\n                        }}\n                      >\n                        Share by Email\n                      </ShareLink>\n                      <ShareIcon src=\"https://emerald-related-swordtail-341.mypinata.cloud/ipfs/QmdDa1om9dWr49n7ozBsGhQfNrkQ3FxYWCtKRtNwHkuz3Q\" />\n                    </Element>\n                  </DropdownContent>\n                </Separation>\n              </DropdownContainerHover>\n            </div>\n          )}\n        </div>\n      </LowerSectionContainer>\n    </LowerSection>\n  </Card>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/rubycop.near/widget/NDC.Nomination.Card", "fact_widget_deployments_id": "7af96b561dea86fb25863306aa98aafa", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 87}
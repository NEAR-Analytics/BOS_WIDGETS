{"tx_hash": "2nmZgxUxiqknE3N126EVAg1a4jc9mH7hdhDsjUSBspmi", "action_id_social": "C8wKuEQESPYt936fr8eGFEkG8kL4psS6mCsCnyPJMGp2-0-widget", "block_id": 98714229, "block_timestamp": "2023-08-13T13:43:39.790Z", "signer_id": "rubycop.near", "widget_name": "Common.Compose", "source_code": "const { handleChange, rows, placeholder, type, withoutSeparator } = props;\n\nState.init({\n  text: props.initialText || \"\",\n});\n\nconst onSelect = (id) => {\n  let text = id;\n\n  if (!withoutSeparator) {\n    text = state.text.replace(/[\\s]{0,1}@[^\\s]*$/, \"\");\n    text = `${text} @${id}`.trim() + \" \";\n  }\n  State.update({ text, showAccountAutocomplete: false });\n\n  if (handleChange) handleChange(text);\n};\n\nconst onChange = (text) => {\n  const showAccountAutocomplete = withoutSeparator\n    ? true\n    : /@[\\w][^\\s]*$/.test(text);\n  State.update({ text, showAccountAutocomplete });\n\n  if (handleChange) handleChange(text);\n};\n\nconst Input = styled.input`\n  padding: 8px 10px;\n  width: 100%;\n  background: #ffffff;\n  border: 1px solid #d0d6d9;\n  border-radius: 8px;\n  font-size: 14px;\n  color: #828688;\n`;\n\nconst Textarea = styled.textarea`\n  padding: 8px 10px;\n  width: 100%;\n  background: #ffffff;\n  border: 1px solid #d0d6d9;\n  border-radius: 8px;\n  font-size: 14px;\n  color: #828688;\n`;\n\nconst InputField = () => {\n  return type === \"input\" ? (\n    <Input\n      value={state.text || \"\"}\n      onInput={(event) => onChange(event.target.value)}\n      onKeyUp={(event) => {\n        if (event.key === \"Escape\")\n          State.update({ showAccountAutocomplete: false });\n      }}\n      placeholder={placeholder ?? \"\"}\n    />\n  ) : (\n    <Textarea\n      value={state.text || \"\"}\n      onInput={(event) => onChange(event.target.value)}\n      onKeyUp={(event) => {\n        if (event.key === \"Escape\")\n          State.update({ showAccountAutocomplete: false });\n      }}\n      rows={rows ?? 5}\n      placeholder={placeholder ?? \"\"}\n    />\n  );\n};\n\nreturn (\n  <>\n    <InputField />\n    {state.showAccountAutocomplete && (\n      <div className=\"pt-1 w-100 overflow-hidden\">\n        <Widget\n          src=\"rubycop.near/widget/AccountAutocomplete\"\n          props={{\n            term: withoutSeparator\n              ? state.text\n              : state.text.split(separator).pop(),\n            onSelect: onSelect,\n            onClose: () => State.update({ showAccountAutocomplete: false }),\n          }}\n        />\n      </div>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/rubycop.near/widget/Common.Compose", "fact_widget_deployments_id": "0e167279989a587c934b46d5d0c01a1a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 18}
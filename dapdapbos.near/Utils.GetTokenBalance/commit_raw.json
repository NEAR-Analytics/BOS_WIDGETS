{"tx_hash": "DDatfinb8UhUaxNwxiE5Jruyz9kqEQuq6izTWnbwwgF7", "action_id_social": "3d6mTCxb7vuZxf44XVzK7BB1XmNzFAEF52uKuUytuwdU-0-widget", "block_id": 112144546, "block_timestamp": "2024-02-05T07:25:57.406Z", "signer_id": "dapdapbos.near", "widget_name": "Utils.GetTokenBalance", "source_code": "const { tokenAddress, owner, updateTokenBalance, place } = props;\n\nconst ABI = [\n  {\n    constant: true,\n    inputs: [{ name: \"_owner\", type: \"address\" }],\n    name: \"balanceOf\",\n    outputs: [{ name: \"\", type: \"uint256\" }],\n    payable: false,\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n  {\n    constant: true,\n    inputs: [],\n    name: \"decimals\",\n    outputs: [{ name: \"\", type: \"uint8\" }],\n    payable: false,\n    stateMutability: \"view\",\n    type: \"function\",\n  },\n];\n\nfunction getTokenBalance(_tokenAddress, _owner) {\n  const TokenContract = new ethers.Contract(\n    _tokenAddress,\n    ABI,\n    Ethers.provider()\n  );\n\n  TokenContract.balanceOf(_owner)\n    .then((balanceRaw) => {\n      console.log(\"BALANCE:\", _tokenAddress, balanceRaw.toString());\n      TokenContract.decimals().then((decimals) => {\n        const bal = Big(\n          ethers.utils.formatUnits(balanceRaw, decimals)\n        ).toFixed();\n\n        updateTokenBalance(bal);\n      });\n    })\n    .catch((err) => {\n      console.info(\"getTokenBal_error:\", err);\n    });\n}\n\n// if you need fresh the balance,you only need fresh the render func.\nif (tokenAddress && owner) {\n  getTokenBalance(tokenAddress, owner);\n}\n\nreturn \"\";\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/dapdapbos.near/widget/Utils.GetTokenBalance", "fact_widget_deployments_id": "605ac597994aaf6fef5d6c845161aa95", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 1}
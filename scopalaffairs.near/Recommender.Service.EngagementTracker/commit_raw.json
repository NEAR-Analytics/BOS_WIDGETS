{"tx_hash": "6FMnVVpqzVzEWAi7LmY3ZFp4DGheaY6abVA4mfb54zLC", "action_id_social": "8hvfiW1MJc9wmGYdWJ8LdUsQYgAfgvTp35TaKpfPzjDp-0-widget", "block_id": 103118547, "block_timestamp": "2023-10-11T09:56:59.226Z", "signer_id": "scopalaffairs.near", "widget_name": "Recommender.Service.EngagementTracker", "source_code": "// const dataplane = \"https://neardanieossax.dataplane.rudderstack.com\"; //test\nconst dataplane = \"https://near.dataplane.rudderstack.com\"; //prod\nconst uri = \"/v1/track\";\nconst api_url = `${dataplane}${uri}`;\n// const auth = \"Basic MlVvMlBYSE9UdzJjUWRucThJUWJQTG9DOG5mOg==\"; //test\nconst auth = \"Basic MlVub3dMd2lXRnc3YzM1QU11RUVkREVJa2RvOg==\"; //prod\n\nconst generateAnonId = (length) => {\n  const characters =\n    \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n  let result = \"\";\n\n  for (let i = 0; i < length; i++) {\n    const randomIndex = Math.floor(Math.random() * characters.length);\n    result += characters.charAt(randomIndex);\n  }\n  return result;\n};\n\nconst trackEngagement = () => {\n  const payload = {\n    anonymousId: generateAnonId(24),\n    channel: \"web\",\n    context: props.fromContext,\n    type: \"track\",\n    originalTimestamp: new Date().toISOString(),\n    sentAt: new Date().toISOString(),\n    event: props.event,\n    properties: {\n      accountId: props.accountId,\n      accountIdRank: props.accountIdRank,\n    },\n  };\n\n  asyncFetch(api_url, {\n    body: JSON.stringify(payload),\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: auth,\n    },\n    method: \"POST\",\n  })\n    .then((response) => response.json())\n    .then((data) => console.log(data))\n    .catch((error) => console.log(error));\n};\n\nprops.onClick ? trackEngagement(props) : null;\n\nreturn <>{props.children}</>;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/scopalaffairs.near/widget/Recommender.Service.EngagementTracker", "fact_widget_deployments_id": "fc4d1c165704b7960d81f3ecfef2bf5a", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "Dk9THkLnpmTCQ7NCmrnu5fV9aeQNm6YZoxpT4cE2zVrN", "action_id_social": "H5AsEy5NV5ekrQFvTzgGvVKMbRr58GQQNToUCixm3DzG-0-widget", "block_id": 99045415, "block_timestamp": "2023-08-17T22:48:44.145Z", "signer_id": "rngtickets.near", "widget_name": "kp-ticket-handler", "source_code": "const kpContract = \"v2.keypom.near\";\nlet have_pk = false;\nlet curUse;\nif (\n  props.key != undefined &&\n  props.key != \"\" &&\n  props.pk != undefined &&\n  props.pk != \"\"\n) {\n  have_pk = true;\n  curUse = Near.view(kpContract, \"get_key_information\", {\n    key: props.key,\n  }).cur_key_use;\n  if (curUse == undefined) {\n    curUse = 0;\n  }\n}\n\nState.init({\n  keyUse: curUse,\n  contract: kpContract,\n  havePk: have_pk,\n});\n\nState.update({\n  keyUse: curUse,\n});\n\n// rendering stuff\nif (state.keyUse == 1) {\n  // QR code\n  return (\n    <>\n      <Widget\n        src=\"rngtickets.near/widget/kp-ticket2\"\n        props={{ key: props.key, pk: props.pk }}\n      />\n    </>\n  );\n} else if (state.keyUse == 2) {\n  return (\n    <div className=\"content\">\n      <h1>You're all set! Enjoy the event</h1>\n      <a\n        href={`https://app.mynearwallet.com/linkdrop/${state.contract}/${props.pk}`}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        <button className=\"onboard_button\">Claim your POAP</button>\n      </a>\n    </div>\n  );\n} else if (state.keyUse == 0 && !state.havePk) {\n  // Event Landing Page\n  return (\n    <div className=\"content\">\n      <h1>NEAR Toronto: Rooftop Rendezvous\ud83e\udda9</h1>\n      <p>\n        Welcome to the \ud83e\udda9NEAR Toronto: Rooftop Rendezvous\ud83e\udda9, a chill community\n        event that concludes the Blockchain Futurist Conference. Join us as we\n        celebrate the intersection of innovation, technology, and community,\n        immersed in a social atmosphere filled with great people and creativity\n        (more info below).\n      </p>\n      <p>\n        In collaboration with: NEAR Foundation, TENAMINT, Seahorse Social, KPW\n        Comms, Proof of Vibes, Marma J Foundation, NEAR Foundation, Music Feast,\n        GDS Consulting, Brothers Grimm Ultra Premium Vodka, CreativesDAO.\n      </p>\n    </div>\n  );\n} else if (state.keyUse == 0) {\n  // Key has been depleted, show resources for NEAR\n  return (\n    <div className=\"content\">\n      <h1>Now that you have a wallet...</h1>\n      <a\n        href={\"https://near.org/learn\"}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        <button className=\"onboard_button\">\n          Continue your journey into NEAR\n        </button>\n      </a>\n    </div>\n  );\n} else {\n  return (\n    <div>\n      <div style={{ textAlign: \"center\" }}>\n        Please visit drops page or enter key info in URL props\n      </div>{\" \"}\n    </div>\n  );\n}\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/rngtickets.near/widget/kp-ticket-handler", "fact_widget_deployments_id": "4c5bfc375adb7d4bacd91e66b5c0fe04", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 5}
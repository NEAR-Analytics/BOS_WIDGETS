{"tx_hash": "6Yq4zboirWpfdgVoGg8E6YTh6N81VuxUnQZck4hpGHv2", "action_id_social": "DwnroXMwhae5sFVKsJzVS8yPnsPKBXYdkwfyoxACeon5-0-widget", "block_id": 101722962, "block_timestamp": "2023-09-22T20:10:28.803Z", "signer_id": "saidulbadhon.near", "widget_name": "ProfilePage.Contributions.Data", "source_code": "const accountId = props.accountId || context.accountId;\r\n\r\nif (!accountId) return \"Login or send accountId in the props\";\r\n\r\nconst profile = Social.getr(`${accountId}/profile`);\r\n\r\nconst allWidgetsHistoryChangesBlocks = Social.keys(\r\n  `${accountId}/widget/*`,\r\n  \"final\",\r\n  {\r\n    return_type: \"History\",\r\n  }\r\n);\r\n\r\nconsole.log(\r\n  \"allWidgetsHistoryChangesBlocks : \",\r\n  allWidgetsHistoryChangesBlocks\r\n);\r\n\r\nif (allWidgetsHistoryChangesBlocks === null) return \"Loading...\";\r\n\r\nconst widget = allWidgetsHistoryChangesBlocks[accountId].widget;\r\n\r\nconst totalCommits = Object.keys(widget)\r\n  .map((key) => widget[key])\r\n  .flat()\r\n  .map((blockHeight) => {\r\n    const xs = Near.block(blockHeight);\r\n\r\n    const timeMs = parseFloat(xs.header.timestamp_nanosec) / 1e6;\r\n\r\n    return new Date(timeMs).toLocaleDateString();\r\n  });\r\n\r\nconst checkOccurrence = (array, element) => {\r\n  let counter = 0;\r\n  for (let i = 0; i <= array.length; i++) {\r\n    if (array[i] == element) {\r\n      counter++;\r\n    }\r\n  }\r\n  return counter;\r\n};\r\n\r\nconst generate = () => {\r\n  const dataArray = [];\r\n\r\n  // Get the current date\r\n  const currentDate = new Date();\r\n\r\n  // Loop through the last 365 days\r\n  for (let i = 0; i < 365; i++) {\r\n    // Calculate the date for the current iteration (going back in time)\r\n    const date = new Date();\r\n    date.setDate(currentDate.getDate() - i);\r\n\r\n    const value = checkOccurrence(totalCommits, date.toLocaleDateString());\r\n\r\n    // Create a new object with the date and value and add it to the array\r\n    dataArray.unshift({ date: date.toLocaleDateString(), count: value });\r\n  }\r\n\r\n  return dataArray;\r\n};\r\n\r\n// const generate = () => {\r\n//   // Create an empty array to hold the objects\r\n//   const dataArray = [] || [{ empty: true }];\r\n\r\n//   // Loop through each day of 2023\r\n//   for (let i = 0; i < 365; i++) {\r\n//     // Create a new date object for the current day\r\n//     const date = new Date(2023, 0, i + 1);\r\n\r\n//     const value = checkOccurrence(totalCommits, date.toLocaleDateString());\r\n\r\n//     // Create a new object with the date and value and add it to the array\r\n//     dataArray.push({ date: date.toLocaleDateString(), count: value });\r\n//   }\r\n\r\n//   return dataArray;\r\n// };\r\n\r\n// const array = generate();\r\n\r\nreturn (\r\n  <div id=\"Getting-Contributions\" onClick={() => props.responce(generate())} />\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/saidulbadhon.near/widget/ProfilePage.Contributions.Data", "fact_widget_deployments_id": "41187bdaf18bf7b51fe9c3a5c028c8ea", "inserted_timestamp": "2023-09-22T22:17:58.079Z", "modified_timestamp": "2023-09-22T22:17:58.079Z", "__row_index": 8}
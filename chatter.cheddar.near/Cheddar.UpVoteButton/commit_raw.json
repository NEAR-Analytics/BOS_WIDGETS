{"tx_hash": "2WLcjLR56bpKuJ4aAm1pv6187w6NEuxc6LnBnbP6qeif", "action_id_social": "4A7WWi6mUK3oDJxRpwrFy31nv3wmEUmun6jHTKjZGhvC-0-widget", "block_id": 120922335, "block_timestamp": "2024-06-11T10:21:55.551Z", "signer_id": "chatter.cheddar.near", "widget_name": "Cheddar.UpVoteButton", "source_code": "//Cheddar.UpVoteButton\nconst { createUpVote, deleteUpVote } = VM.require(\n    'chatter.cheddar.near/widget/lib.upVotes'\n) || { createUpVote: () => {}, deleteUpVote: () => {} }\nconst { getConfig } = VM.require(\n    'chatter.cheddar.near/widget/config.CommunityVoice'\n) || { getConfig: () => {} }\n\nconst {\n    isTest,\n    authorForWidget,\n    reactedElementData,\n    widgets,\n    disabled,\n    upVotes: articleUpVotes,\n    baseActions,\n    loadUpVotes,\n    loadingUpVotes,\n    setLoadingUpVotes,\n    setUpVotes,\n} = props\n\nconst data = reactedElementData\n\nlet userVote = articleUpVotes\n    ? articleUpVotes.find((vote) => vote.accountId === context.accountId)\n    : undefined\n\nfunction getUpVoteButtonClass() {\n    if (userVote) {\n        return 'primary'\n    } else {\n        return 'primary outline'\n    }\n}\n\nfunction onCommitUpVotes() {\n    setLoadingUpVotes(true)\n    setUpVotes([])\n    setTimeout(() => {\n        loadUpVotes()\n    }, 3000)\n}\n\nfunction onCancelUpVotes() {\n    setLoadingUpVotes(false)\n}\n\nfunction handleUpVote() {\n    userVote\n        ? deleteUpVote(\n              getConfig(isTest),\n              userVote.value.metadata.articleId,\n              userVote.value.metadata.id,\n              onCommitUpVotes,\n              onCancelUpVotes\n          )\n        : createUpVote(\n              getConfig(isTest),\n              data.value.metadata.id,\n              data.value.metadata.author,\n              onCommitUpVotes,\n              onCancelUpVotes\n          )\n}\n\nconst IconContainer = styled.div`\n    transform: rotate(-90deg);\n`\n\nconst Icon = styled.i`\n    margin: 0px !important;\n`\n\nconst CallLibrary = styled.div`\n    display: none;\n`\n\nconst SpinnerContainer = styled.div`\n    height: 1.3rem;\n    width: 1.3rem;\n    margintop: 2px;\n`\n\nreturn (\n    <>\n        <div\n            title={\n                (disabled || !canLoggedUserVote) &&\n                \"You can't vote since you don't have any SBT\"\n            }\n        >\n            {loadingUpVotes ? (\n                <Widget\n                    src={\n                        widgets.views.standardWidgets.newStyledComponents.Input\n                            .Button\n                    }\n                    props={{\n                        children: (\n                            <div className=\"d-flex\">\n                                <SpinnerContainer\n                                    className=\"spinner-border text-secondary\"\n                                    role=\"status\"\n                                >\n                                    <span\n                                        className=\"sr-only\"\n                                        title=\"Loading...\"\n                                    ></span>\n                                </SpinnerContainer>\n                            </div>\n                        ),\n                        size: 'sm',\n                    }}\n                />\n            ) : (\n                <Widget\n                    src={\n                        widgets.views.standardWidgets.newStyledComponents.Input\n                            .Button\n                    }\n                    props={{\n                        children: (\n                            <div className=\"d-flex\">\n                                <span>{`+${articleUpVotes.length}`}</span>\n                                <IconContainer>\n                                    <Icon\n                                        className={`bi bi-fast-forward-fill ${\n                                            !disabled && 'text-success'\n                                        }`}\n                                    ></Icon>\n                                </IconContainer>\n                            </div>\n                        ),\n                        disabled: disabled,\n                        className: `${getUpVoteButtonClass()}`,\n                        size: 'sm',\n                        onClick: handleUpVote,\n                    }}\n                />\n            )}\n        </div>\n    </>\n)\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/chatter.cheddar.near/widget/Cheddar.UpVoteButton", "fact_widget_deployments_id": "fd333ce6655cbb79330970c4b4ef65fd", "inserted_timestamp": "2024-06-11T11:04:37.842Z", "modified_timestamp": "2024-06-11T12:05:37.054Z", "__row_index": 0}
{"tx_hash": "4CGXM3zqqaciyAAd57MPunnW5GEi6ApKsP88tHooigEp", "action_id_social": "EpccLTjXpyEqa2GX41SkAg1SsL3Dx3zJHTSSkoaN9wVj-0-widget", "block_id": 97626094, "block_timestamp": "2023-07-29T18:20:13.916Z", "signer_id": "devgovgigs.petersalomonsen.near", "widget_name": "gigs-board.pages.Post", "source_code": "/* INCLUDE: \"common.jsx\" */\nconst nearDevGovGigsContractAccountId =\n  props.nearDevGovGigsContractAccountId ||\n  (context.widgetSrc ?? \"devgovgigs.near\").split(\"/\", 1)[0];\n\nconst nearDevGovGigsWidgetsAccountId =\n  props.nearDevGovGigsWidgetsAccountId ||\n  (context.widgetSrc ?? \"devgovgigs.near\").split(\"/\", 1)[0];\n\nfunction widget(widgetName, widgetProps, key) {\n  widgetProps = {\n    ...widgetProps,\n    nearDevGovGigsContractAccountId: props.nearDevGovGigsContractAccountId,\n    nearDevGovGigsWidgetsAccountId: props.nearDevGovGigsWidgetsAccountId,\n    referral: props.referral,\n  };\n\n  return (\n    <Widget\n      src={`${nearDevGovGigsWidgetsAccountId}/widget/gigs-board.${widgetName}`}\n      props={widgetProps}\n      key={key}\n    />\n  );\n}\n\nfunction href(widgetName, linkProps) {\n  linkProps = { ...linkProps };\n\n  if (props.nearDevGovGigsContractAccountId) {\n    linkProps.nearDevGovGigsContractAccountId =\n      props.nearDevGovGigsContractAccountId;\n  }\n\n  if (props.nearDevGovGigsWidgetsAccountId) {\n    linkProps.nearDevGovGigsWidgetsAccountId =\n      props.nearDevGovGigsWidgetsAccountId;\n  }\n\n  if (props.referral) {\n    linkProps.referral = props.referral;\n  }\n\n  const linkPropsQuery = Object.entries(linkProps)\n    .filter(([_key, nullable]) => (nullable ?? null) !== null)\n    .map(([key, value]) => `${key}=${value}`)\n    .join(\"&\");\n\n  return `/#/${nearDevGovGigsWidgetsAccountId}/widget/gigs-board.pages.${widgetName}${\n    linkPropsQuery ? \"?\" : \"\"\n  }${linkPropsQuery}`;\n}\n/* END_INCLUDE: \"common.jsx\" */\n\n/* INCLUDE: \"core/lib/draftstate\" */\nconst DRAFT_STATE_STORAGE_KEY = \"POST_DRAFT_STATE\";\nlet is_edit_or_add_post_transaction = false;\nlet transaction_method_name;\n\nif (props.transactionHashes) {\n  const transaction = fetch(\"https://rpc.mainnet.near.org\", {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      jsonrpc: \"2.0\",\n      id: \"dontcare\",\n      method: \"tx\",\n      params: [props.transactionHashes, context.accountId],\n    }),\n  });\n  transaction_method_name =\n    transaction?.body?.result?.transaction?.actions[0].FunctionCall.method_name;\n\n  is_edit_or_add_post_transaction =\n    transaction_method_name == \"add_post\" ||\n    transaction_method_name == \"edit_post\";\n\n  if (is_edit_or_add_post_transaction) {\n    Storage.privateSet(DRAFT_STATE_STORAGE_KEY, undefined);\n  }\n}\n\nconst onDraftStateChange = (draftState) =>\n  Storage.privateSet(DRAFT_STATE_STORAGE_KEY, JSON.stringify(draftState));\nlet draftState;\ntry {\n  draftState = JSON.parse(Storage.privateGet(DRAFT_STATE_STORAGE_KEY));\n} catch (e) {}\n/* END_INCLUDE: \"core/lib/draftstate\" */\n\nif (is_edit_or_add_post_transaction) {\n  return (\n    <p class=\"text-secondary\">\n      Post {transaction_method_name == \"edit_post\" ? \"edited\" : \"added\"}{\" \"}\n      successfully. Back to{\" \"}\n      <a\n        style={{\n          color: \"#3252A6\",\n        }}\n        className=\"fw-bold\"\n        href={href(\"Post\", { id: props.id })}\n      >\n        post\n      </a>\n    </p>\n  );\n} else {\n  return widget(\"components.layout.Page\", {\n    children: widget(\"entity.post.Post\", {\n      id: props.id,\n      timestamp: props.timestamp,\n      compareTimestamp: props.compareTimestamp,\n      onDraftStateChange,\n      draftState,\n    }),\n  });\n}\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/devgovgigs.petersalomonsen.near/widget/gigs-board.pages.Post", "fact_widget_deployments_id": "732f601268e633492d36dc722236cc3b", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 0}
{"tx_hash": "69Ta4jLbCUEx2JFqg944eUXLhRFrdmZvLkQGh73Azqeo", "action_id_social": "R3G5oHFFcz5QR9BKy3VomKY7FuCytx26dJeZ83ntA4Y-0-widget", "block_id": 103066851, "block_timestamp": "2023-10-10T17:38:20.804Z", "signer_id": "kurodenjiro.near", "widget_name": "abi2form-home", "source_code": "State.init({ clientName: \"\", clientContract: \"\", clientList: [], error });\r\nconst onInputChangeClientName = ({ target }) => {\r\n  State.update({ clientName: target.value });\r\n};\r\nconst onInputChangeClientContract = ({ target }) => {\r\n  State.update({ clientContract: target.value });\r\n};\r\n\r\nconst loadData = () => {\r\n  const clientList = Social.get(`${context.accountId}/magicbuild/clientlist`);\r\n  if (clientList) {\r\n    const clientListData = JSON.parse(clientList);\r\n    clientListData.forEach((item, index) => {\r\n      const abiRes = Social.get(\r\n        `${context.accountId}/magicbuild/client/${item.id}/abi`\r\n      );\r\n      if (abiRes) {\r\n        const abi = JSON.parse(abiRes);\r\n        clientListData[index].abi = abi;\r\n      }\r\n    });\r\n    State.update({ clientList: clientListData });\r\n  }\r\n};\r\nloadData();\r\nconst saveClient = () => {\r\n  State.update({ error: null });\r\n  //check contract\r\n  asyncFetch(`https://rpc.near.org/`, {\r\n    body: JSON.stringify({\r\n      method: \"query\",\r\n      params: {\r\n        request_type: \"view_code\",\r\n        account_id: state.clientContract,\r\n        finality: \"final\",\r\n      },\r\n      id: 154,\r\n      jsonrpc: \"2.0\",\r\n    }),\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    method: \"POST\",\r\n  }).then((res) => {\r\n    if (res.body.result.code_base64) {\r\n      const data = state.clientList;\r\n      const clientData = {\r\n        id: Date.now(),\r\n        name: state.clientName,\r\n        address: state.clientContract,\r\n        archived: false,\r\n        abi: null,\r\n      };\r\n      data.push(clientData);\r\n      const saveData = {\r\n        magicbuild: {\r\n          clientlist: data,\r\n        },\r\n      };\r\n      Social.set(saveData, {\r\n        force: true,\r\n        onCommit: () => {},\r\n        onCancel: () => {},\r\n      });\r\n    } else {\r\n      State.update({\r\n        error: \"Account Id This contract has not been deployed yet!\",\r\n      });\r\n    }\r\n  });\r\n};\r\nconst Wrapper = styled.div`\r\n.nav-pills .nav-link.active, .nav-pills .show>.nav-link {\r\n  color: #fff;\r\n    background-color: #000000;\r\n}\r\n.nav-link {\r\n  color: #000000;\r\n}\r\n`;\r\nreturn (\r\n  <Wrapper>\r\n    <div class=\"container\">\r\n      <div class=\"row\">\r\n        <div class=\"col-md-2\">\r\n          <div\r\n            class=\"side-bar\"\r\n            data-bs-scroll=\"true\"\r\n            tabindex=\"-1\"\r\n            id=\"offcanvas\"\r\n            aria-labelledby=\"offcanvas\"\r\n          >\r\n            <div class=\"offcanvas-body p-0\">\r\n              <div>\r\n                <ul\r\n                  class=\"nav flex-column nav-pills  navbar-dark \"\r\n                  id=\"pills-tab\"\r\n                  role=\"tablist\"\r\n                >\r\n                  <li class=\"mb-1\">\r\n                    <div class=\" small fw-bold text-uppercase px-3\"></div>\r\n                  </li>\r\n                  <li class=\"nav-item\" role=\"presentation\">\r\n                    <span\r\n                      class=\"nav-link px-3 active\"\r\n                      id=\"pills-tab-home\"\r\n                      data-bs-toggle=\"pill\"\r\n                      data-bs-target=\"#pills-home\"\r\n                      type=\"button\"\r\n                      role=\"tab\"\r\n                      aria-controls=\"pills-home\"\r\n                      aria-selected=\"true\"\r\n                    >\r\n                      <span class=\"fw-bold\">\ud83e\ude84 Magic Build</span>\r\n                    </span>\r\n                  </li>\r\n                  <li>\r\n                    <hr />\r\n                  </li>\r\n                  <li class=\"mb-1\">\r\n                    <div class=\"small fw-bold text-uppercase d-flex  px-3 align-items-center justify-content-between\">\r\n                      <span>Client</span>\r\n                      {state.clientList.length > 0 && (\r\n                        <button\r\n                          type=\"button\"\r\n                          class=\"btn btn-sm\"\r\n                          data-bs-toggle=\"modal\"\r\n                          data-bs-target=\"#createClient\"\r\n                        >\r\n                          Add\r\n                          <i class=\"bi bi-file-earmark-plus\"></i>\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                    <div\r\n                      class=\"modal fade\"\r\n                      id=\"createClient\"\r\n                      tabindex=\"-1\"\r\n                      aria-labelledby=\"createClientLabel\"\r\n                      aria-hidden=\"true\"\r\n                    >\r\n                      <div class=\"modal-dialog\">\r\n                        <div class=\"modal-content\">\r\n                          <div class=\"modal-header\">\r\n                            <h1 class=\"modal-title fs-5\" id=\"createClientLabel\">\r\n                              Create Client\r\n                            </h1>\r\n                            <button\r\n                              type=\"button\"\r\n                              class=\"btn-close\"\r\n                              data-bs-dismiss=\"modal\"\r\n                              aria-label=\"Close\"\r\n                            ></button>\r\n                          </div>\r\n                          <div class=\"modal-body\">\r\n                            <div class=\"form-group\">\r\n                              <label>Name</label>\r\n                              <input\r\n                                class=\"form-control\"\r\n                                onChange={(e) => onInputChangeClientName(e)}\r\n                              />\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                              <label>Address</label>\r\n                              <input\r\n                                class=\"form-control\"\r\n                                onChange={(e) => onInputChangeClientContract(e)}\r\n                              />\r\n                            </div>\r\n                            {!state.error && (\r\n                              <p class=\"text-danger\" role=\"alert\">\r\n                                <small class=\"form-text text-muted\">\r\n                                  A new Client will be created.\r\n                                </small>\r\n                              </p>\r\n                            )}\r\n\r\n                            {state.error && (\r\n                              <p class=\"text-danger\" role=\"alert\">\r\n                                {state.error}\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n                          <div class=\"modal-footer\">\r\n                            <button\r\n                              type=\"button\"\r\n                              class=\"btn btn-secondary\"\r\n                              data-bs-dismiss=\"modal\"\r\n                            >\r\n                              Close\r\n                            </button>\r\n                            <button\r\n                              type=\"button\"\r\n                              onClick={saveClient}\r\n                              class=\"btn btn-primary\"\r\n                            >\r\n                              Create\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </li>\r\n                  {state.clientList.length == 0 && (\r\n                    <button\r\n                      type=\"button\"\r\n                      class=\"btn btn-dark btn-sm\"\r\n                      data-bs-toggle=\"modal\"\r\n                      data-bs-target=\"#createClient\"\r\n                    >\r\n                      Create Your First Client\r\n                      <i class=\"bi bi-file-earmark-plus\"></i>\r\n                    </button>\r\n                  )}\r\n                  {state.clientList &&\r\n                    state.clientList.map((client, index) => {\r\n                      if (client.archived == false) {\r\n                        return (\r\n                          <li role=\"presentation\">\r\n                            <span\r\n                              class=\"nav-link px-3\"\r\n                              id={`pills-tab-${client.id}`}\r\n                              data-bs-toggle=\"pill\"\r\n                              data-bs-target={`#pills-${client.id}`}\r\n                              type=\"button\"\r\n                              role=\"tab\"\r\n                              aria-controls={`#pills-${client.id}`}\r\n                              aria-selected=\"true\"\r\n                            >\r\n                              <span class=\"fw-bold\">\u2728{client.name}</span>\r\n                            </span>\r\n                          </li>\r\n                        );\r\n                      }\r\n                    })}\r\n                  {state.clientList.length > 0 && (\r\n                    <li>\r\n                      <a\r\n                        class=\"nav-link px-3 sidebar-link\"\r\n                        data-bs-toggle=\"collapse\"\r\n                        href=\"#collapseArchive\"\r\n                        role=\"button\"\r\n                        aria-expanded=\"false\"\r\n                        aria-controls=\"collapseArchive\"\r\n                      >\r\n                        <span class=\"fw-bold\">\ud83d\udce6Archive</span>\r\n                        <span class=\"right-icon ms-auto\">\r\n                          <i class=\"bi bi-chevron-down\"></i>\r\n                        </span>\r\n                      </a>\r\n\r\n                      <div class=\"collapse\" id=\"collapseArchive\">\r\n                        <div>\r\n                          <ul class=\"navbar-nav ps-3\">\r\n                            {state.clientList &&\r\n                              state.clientList.map((client, index) => {\r\n                                if (client.archived == true) {\r\n                                  return (\r\n                                    <li>\r\n                                      <a\r\n                                        href=\"#\"\r\n                                        class=\"nav-link px-3\"\r\n                                        id={`pills-tab-${client.id}`}\r\n                                        data-bs-toggle=\"pill\"\r\n                                        data-bs-target={`#pills-${client.id}`}\r\n                                        type=\"button\"\r\n                                        role=\"tab\"\r\n                                        aria-controls={`#pills-${client.id}`}\r\n                                        aria-selected=\"true\"\r\n                                      >\r\n                                        <span class=\"fw-bold\">\r\n                                          \u2728{client.name}\r\n                                        </span>\r\n                                      </a>\r\n                                    </li>\r\n                                  );\r\n                                }\r\n                              })}\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n                  )}\r\n\r\n                  <li>\r\n                    <hr />\r\n                  </li>\r\n                  <li class=\"mb-3\">\r\n                    <div class=\" small fw-bold text-uppercase px-3\">Addons</div>\r\n                  </li>\r\n                  <li>\r\n                    <a href=\"#\" class=\"nav-link px-3\">\r\n                      <span class=\"me-2\">\r\n                        <i class=\"bi bi-activity\"></i>\r\n                      </span>\r\n                      <span class=\"fw-bold\">Activity</span>\r\n                    </a>\r\n                  </li>\r\n                  <li>\r\n                    <a href=\"#\" class=\"nav-link px-3\">\r\n                      <span class=\"me-2\">\r\n                        <i class=\"bi bi-clipboard2-data\"></i>\r\n                      </span>\r\n                      <span class=\"fw-bold\">Data</span>\r\n                    </a>\r\n                  </li>\r\n                  <li>\r\n                    <hr />\r\n                  </li>\r\n                  <li class=\"nav-item\" role=\"presentation\">\r\n                    <span\r\n                      class=\"nav-link active\"\r\n                      id=\"pills-tab-help\"\r\n                      data-bs-toggle=\"pill\"\r\n                      data-bs-target=\"#pills-help\"\r\n                      type=\"button\"\r\n                      role=\"tab\"\r\n                      aria-controls=\"pills-help\"\r\n                      aria-selected=\"true\"\r\n                      class=\"nav-link px-3 \"\r\n                    >\r\n                      {\" \"}\r\n                      <label class=\"custom-control-label\" for=\"darkSwitch\">\r\n                        <span class=\"fw-bold\">\ud83d\udedf Help</span>\r\n                      </label>\r\n                    </span>\r\n                  </li>\r\n\r\n                  <li>\r\n                    <hr />\r\n                  </li>\r\n                  <li>\r\n                    <a\r\n                      href=\"https://www.minorityprogrammers.com/\"\r\n                      class=\"nav-link px-3\"\r\n                    >\r\n                      \u2139 Built with \u2764\ufe0f by\r\n                      <span class=\"fw-bold\">Minority Programmers</span>\r\n                    </a>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-md-10\">\r\n          <div class=\"tab-content\" id=\"pills-tabContent\">\r\n            <div\r\n              class=\"tab-pane fade show active\"\r\n              id={`pills-home`}\r\n              role=\"tabpanel\"\r\n              aria-labelledby={`pills-tab-home`}\r\n              tabindex=\"0\"\r\n            >\r\n              <Widget src={\"kurodenjiro.near/widget/abi2form-landingpage\"} />\r\n            </div>\r\n            <div\r\n              class=\"tab-pane fade\"\r\n              id={`pills-help`}\r\n              role=\"tabpanel\"\r\n              aria-labelledby={`pills-tab-help`}\r\n              tabindex=\"0\"\r\n            ></div>\r\n            {state.clientList &&\r\n              state.clientList.map((client, index) => (\r\n                <div\r\n                  class=\"tab-pane fade \"\r\n                  id={`pills-${client.id}`}\r\n                  role=\"tabpanel\"\r\n                  aria-labelledby={`pills-tab-${client.id}`}\r\n                  tabindex=\"0\"\r\n                >\r\n                  <Widget\r\n                    src={\"kurodenjiro.near/widget/abi2form-builder\"}\r\n                    props={client}\r\n                  />\r\n                </div>\r\n              ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </Wrapper>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/kurodenjiro.near/widget/abi2form-home", "fact_widget_deployments_id": "9c2c91f97a0457ded4a0945061628dd4", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
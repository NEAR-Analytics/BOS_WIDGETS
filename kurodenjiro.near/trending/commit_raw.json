{"tx_hash": "Cr5MgQt8g6eRKPWZK9qKC7nhbNMqQ92gc9mx6sjqiGUp", "action_id_social": "Ak6UQc7y9WjFSoggxQ1DwGB5fymSq9fgN9HoXuehBB1P-0-widget", "block_id": 107143423, "block_timestamp": "2023-12-04T14:51:59.384Z", "signer_id": "kurodenjiro.near", "widget_name": "trending", "source_code": "const findHashtags = (str) => {\r\n  const regexp = /\\B\\#\\w\\w+\\b/g;\r\n  let match;\r\n  let tags = [];\r\n  while ((match = regexp.exec(str)) !== null) {\r\n    tags.push(match[0]);\r\n  }\r\n  return tags;\r\n};\r\nconst respBlock = fetch(\"https://api.nearblocks.io/v1/stats\");\r\n\r\n// 1 days\r\nconst newBlock1Days = Math.round(\r\n  parseInt(respBlock.body.stats[0].block) -\r\n    (1 * 24 * 3600) / parseInt(respBlock.body.stats[0].avg_block_time)\r\n);\r\n\r\nlet BlockHeightPost1Days = [];\r\nconst getBlockHeight1daysPost = Social.index(\"post\", \"main\", {\r\n  from: newBlock1Days,\r\n  limit: 99999,\r\n});\r\ngetBlockHeight1daysPost.forEach((item) => {\r\n  BlockHeightPost1Days.push({\r\n    accountId: item.accountId,\r\n    blockHeight: item.blockHeight,\r\n  });\r\n});\r\n\r\nlet post1days = [];\r\nBlockHeightPost1Days.forEach((item) => {\r\n  const post = Social.get(`${item.accountId}/post/main`, item.blockHeight);\r\n  if (post) {\r\n    post1days.push(JSON.parse(post).text);\r\n  }\r\n});\r\n\r\nlet tagCount1Days = {};\r\npost1days.forEach((item) => {\r\n  const tags = findHashtags(item);\r\n  if (tags.length > 0) {\r\n    tags.forEach((tag) => {\r\n      if (tagCount1Days[tag]) {\r\n        tagCount1Days[tag] = tagCount1Days[tag] + 1;\r\n      } else {\r\n        tagCount1Days[tag] = 1;\r\n      }\r\n    });\r\n  }\r\n});\r\nlet entries1days = Object.entries(tagCount1Days);\r\nlet post1daySorted = entries1days.sort((b, a) => a[1] - b[1]);\r\n\r\nreturn (\r\n  <>\r\n    <div>\r\n      <b> Trending :</b>\r\n      <br></br>\r\n      {post1daySorted &&\r\n        post1daySorted\r\n          .filter((item, index) => index <= 20)\r\n          .map((item) => (\r\n            <a href={`https://near.social/?hashtag=${item[0]}`}>\r\n              {item[0]}-{item[1]}\r\n            </a>\r\n          ))}\r\n    </div>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/kurodenjiro.near/widget/trending", "fact_widget_deployments_id": "3194430dedb27bbbc87723e4debb0c38", "inserted_timestamp": "2023-12-04T16:48:14.637Z", "modified_timestamp": "2023-12-20T03:22:11.422Z", "__row_index": 5}
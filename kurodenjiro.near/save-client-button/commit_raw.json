{"tx_hash": "Fg9foZceXE8i9Ho7xLaebbU7YXoa7re9ogsJxyjWXzbt", "action_id_social": "Eki146unTWS3JpzYuDW2LZQoCy9jeZfQSStxqR8Vk7gS-0-widget", "block_id": 103934799, "block_timestamp": "2023-10-22T05:44:36.560Z", "signer_id": "kurodenjiro.near", "widget_name": "save-client-button", "source_code": "State.init({ clientName: \"\", clientContract: \"\", clientList: [], error });\r\nconst onInputChangeClientName = ({ target }) => {\r\n  State.update({ clientName: target.value });\r\n};\r\nconst onInputChangeClientContract = ({ target }) => {\r\n  State.update({ error: null });\r\n  State.update({ clientContract: target.value });\r\n};\r\nconst saveClient = () => {\r\n  if (state.clientName.length < 5) {\r\n    State.update({\r\n      error: \"Name requires more than 5 characters\",\r\n    });\r\n  } else {\r\n    asyncFetch(\"https://rpc.near.org/\", {\r\n      body: JSON.stringify({\r\n        method: \"query\",\r\n        params: {\r\n          request_type: \"view_code\",\r\n          account_id: state.clientContract,\r\n          finality: \"final\",\r\n        },\r\n        id: 154,\r\n        jsonrpc: \"2.0\",\r\n      }),\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n    }).then((res) => {\r\n      if (res.body.result.code_base64) {\r\n        const data = state.clientList;\r\n        const clientData = {\r\n          id: Date.now(),\r\n          name: state.clientName,\r\n          address: state.clientContract,\r\n          archived: false,\r\n          abi: null,\r\n        };\r\n        data.push(clientData);\r\n        const saveData = {\r\n          magicbuild: {\r\n            clientlist: data,\r\n          },\r\n        };\r\n        Social.set(saveData, {\r\n          force: true,\r\n          onCommit: () => {},\r\n          onCancel: () => {},\r\n        });\r\n      } else {\r\n        State.update({\r\n          error:\r\n            \"Unable to save Account ID because the contract has not been deployed yet!\",\r\n        });\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\nreturn (\r\n  <>\r\n    <label></label>\r\n    <button\r\n      data-bs-toggle=\"modal\"\r\n      data-bs-target=\"#createClient\"\r\n      class=\"btn btn-dark form-control \"\r\n    >\r\n      Save Client\r\n    </button>\r\n    <div\r\n      class=\"modal fade\"\r\n      id=\"createClient\"\r\n      tabindex=\"-1\"\r\n      aria-labelledby=\"createClientLabel\"\r\n      aria-hidden=\"true\"\r\n    >\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h1 class=\"modal-title fs-5\" id=\"createClientLabel\">\r\n              Create Client\r\n            </h1>\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn-close\"\r\n              data-bs-dismiss=\"modal\"\r\n              aria-label=\"Close\"\r\n            ></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"form-group\">\r\n              <label>Name</label>\r\n              <input\r\n                class=\"form-control\"\r\n                onChange={(e) => onInputChangeClientName(e)}\r\n              />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label>Address</label>\r\n              <input\r\n                class=\"form-control\"\r\n                onChange={(e) => onInputChangeClientContract(e)}\r\n              />\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label>Chain</label>\r\n              <select class=\"form-control\">\r\n                <option selected>Near Chain</option>\r\n                <option disabled>Ethereum Chain</option>\r\n                <option disabled>AVAX Chain</option>\r\n              </select>\r\n            </div>\r\n            {!state.error && (\r\n              <small class=\"form-text text-muted\">\r\n                A new Client will be created.\r\n              </small>\r\n            )}\r\n\r\n            {state.error && (\r\n              <p class=\"text-danger\" role=\"alert\">\r\n                {state.error}\r\n              </p>\r\n            )}\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-secondary\"\r\n              data-bs-dismiss=\"modal\"\r\n            >\r\n              Close\r\n            </button>\r\n            <button type=\"button\" onClick={saveClient} class=\"btn btn-primary\">\r\n              Create\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/kurodenjiro.near/widget/save-client-button", "fact_widget_deployments_id": "e2c1401120e1b4cb96fc0b2f690f0820", "inserted_timestamp": "2023-10-22T07:40:39.263Z", "modified_timestamp": "2023-10-22T07:40:39.263Z", "__row_index": 44}
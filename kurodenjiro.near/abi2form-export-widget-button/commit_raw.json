{"tx_hash": "AqtvFHyav9DdrQtgsy3Dsug1XHuv9nSyE8A4wxL65B4a", "action_id_social": "CewmZc3sFz4UpgVGY7aKC7TNsjGc52Ph3BNWrx3ujcur-0-widget", "block_id": 103065418, "block_timestamp": "2023-10-10T17:11:18.490Z", "signer_id": "kurodenjiro.near", "widget_name": "abi2form-export-widget-button", "source_code": "State.init({ cMethod: props.cMethod, widgetName: \"abi2form-widget-form\" });\r\nconst onSwitchChangeArgExport = (fIndex) => {\r\n  const abiMethod = state.cMethod;\r\n  abiMethod[fIndex].export = !abiMethod[fIndex].export;\r\n  State.update({ cMethod: abiMethod });\r\n};\r\nconst onInputChangeWidgetName = ({ target }) => {\r\n  State.update({ widgetName: target.value.replaceAll(\" \", \"-\") });\r\n};\r\nconst saveClient = () => {\r\n  const abi = {\r\n    schema_version: \"0.3.0\",\r\n    address: props.contractAddress,\r\n    metadata: {\r\n      name: \"\",\r\n      version: \"0.1.0\",\r\n      authors: [\"\"],\r\n    },\r\n    body: {\r\n      functions: [],\r\n    },\r\n  };\r\n\r\n  const abiMethod = state.cMethod;\r\n  abiMethod.forEach((item) => {\r\n    abi.body.functions.push(item);\r\n  });\r\n\r\n  const data = {\r\n    magicbuild: {\r\n      client: {\r\n        [props.id]: {\r\n          abi: JSON.stringify(abi),\r\n        },\r\n      },\r\n    },\r\n  };\r\n  Social.set(data, {\r\n    force: true,\r\n    onCommit: () => {},\r\n    onCancel: () => {},\r\n  });\r\n};\r\nconst exportForm = () => {\r\n  const abi = {\r\n    schema_version: \"0.3.0\",\r\n    address: props.contractAddress,\r\n    metadata: {\r\n      name: \"\",\r\n      version: \"0.1.0\",\r\n      authors: [\"\"],\r\n    },\r\n    body: {\r\n      functions: [],\r\n    },\r\n  };\r\n\r\n  const abiMethod = state.cMethod;\r\n  abiMethod.forEach((item) => {\r\n    abi.body.functions.push(item);\r\n  });\r\n\r\n  const data = {\r\n    widget: {\r\n      [state.widgetName]: {\r\n        \"\":\r\n          \"const user = context.accountId;\\r\\nconst props = \" +\r\n          JSON.stringify(abi).replaceAll(\"\\\\\", \"\") +\r\n          \" \\r\\n\\r\\nreturn (\\r\\n  <>\\r\\n    <Widget src={'kurodenjiro.near/widget/abi2form-widget'} props={props} />\\r\\n  </>\\r\\n);\\r\\n\",\r\n      },\r\n    },\r\n  };\r\n  console.log(\"abi\", abi);\r\n  Social.set(data, {\r\n    force: true,\r\n    onCommit: () => {},\r\n    onCancel: () => {},\r\n  });\r\n};\r\nreturn (\r\n  <>\r\n    <label></label>\r\n    <button\r\n      data-bs-toggle=\"modal\"\r\n      data-bs-target=\"#export\"\r\n      class=\"btn btn-dark form-control \"\r\n    >\r\n      Export\r\n    </button>\r\n    <div\r\n      class=\"modal fade\"\r\n      id=\"export\"\r\n      tabindex=\"-1\"\r\n      aria-labelledby=\"exportLabel\"\r\n      aria-hidden=\"true\"\r\n    >\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h1 class=\"modal-title fs-5\" id=\"exportLabel\">\r\n              Choose Method to Export\r\n            </h1>\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn-close\"\r\n              data-bs-dismiss=\"modal\"\r\n              aria-label=\"Close\"\r\n            ></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"form-group\">\r\n              <label>Widget Name</label>\r\n              <input\r\n                class=\"form-control\"\r\n                defaultValue={state.widgetName}\r\n                onChange={(e) => onInputChangeWidgetName(e)}\r\n              />\r\n              <small class=\"form-text text-muted\">\r\n                A new widget configured with the form will be created.\r\n              </small>\r\n            </div>\r\n            {state.cMethod &&\r\n              state.cMethod.map((functions, fIndex) => (\r\n                <div class=\"form-check form-switch\">\r\n                  <input\r\n                    class=\"form-check-input\"\r\n                    type=\"checkbox\"\r\n                    role=\"switch\"\r\n                    checked={functions.export}\r\n                    onChange={() => onSwitchChangeArgExport(fIndex)}\r\n                    id={`flexSwitchCheckDefaultView${fIndex}`}\r\n                  />\r\n                  <label\r\n                    class=\"form-check-label\"\r\n                    for={`flexSwitchCheckDefault${fIndex}`}\r\n                  >\r\n                    {functions.name}\r\n                  </label>\r\n                </div>\r\n              ))}\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-secondary\"\r\n              data-bs-dismiss=\"modal\"\r\n            >\r\n              Close\r\n            </button>\r\n            {props.id && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={saveClient}\r\n                class=\"btn btn-primary\"\r\n              >\r\n                Save Client\r\n              </button>\r\n            )}\r\n\r\n            <button type=\"button\" onClick={exportForm} class=\"btn btn-primary\">\r\n              Export\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/kurodenjiro.near/widget/abi2form-export-widget-button", "fact_widget_deployments_id": "8f0974e96ffacbd2ee6cc34a3087babf", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
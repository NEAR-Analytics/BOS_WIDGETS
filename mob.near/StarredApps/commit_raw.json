{"tx_hash": "G5c99GYGMaFimzGxutbSCHFbfpNLP1QgnELyXRvgQLfC", "action_id_social": "HEteNMAvRPGcFfuUYtbMNWSMWqfCRsPeQVSrVwDtXS2c-0-widget", "block_id": 104069411, "block_timestamp": "2023-10-24T01:18:34.641Z", "signer_id": "mob.near", "widget_name": "StarredApps", "source_code": "const accountId = props.accountId ?? context.accountId;\n\nconst stars = Social.index(\n  \"store\",\n  {\n    type: \"star\",\n    accountId,\n  },\n  {\n    accountId,\n  }\n);\n\nconst StorageKey = \"order\";\nconst order = Storage.privateGet(StorageKey);\n\nconst apps = useMemo(() => {\n  if (!stars || order === null) {\n    return [];\n  }\n  const starredApps = new Set();\n  stars.forEach(({ value }) => {\n    if (value.item.type !== \"social\") {\n      return;\n    }\n    const widgetSrc = value.item.path;\n    if (value.type === \"star\") {\n      starredApps.add(widgetSrc);\n    } else if (value.type === \"unstar\") {\n      starredApps.delete(widgetSrc);\n    }\n  });\n  const apps = [...starredApps.keys()];\n  apps.reverse();\n  apps.sort((a, b) => {\n    (order?.[a] || 0) - (order?.[b] || 0);\n  });\n  Storage.privateSet(\n    StorageKey,\n    Object.fromEntries(apps.map((a, i) => [a, i + 1]))\n  );\n  return apps;\n}, [stars, order]);\n\nconst renderItem = (widgetSrc) => {\n  const [accountId, _, widgetName] = widgetSrc.split(\"/\");\n  return (\n    <a\n      href={`/${widgetSrc}`}\n      className=\"text-decoration-none\"\n      key={widgetSrc}\n      onClick={() => {\n        order[widgetSrc] = -1;\n        Storage.privateSet(StorageKey, order);\n        console.log(\"saving order\", order);\n      }}\n    >\n      <Widget\n        loading={\n          <div\n            className=\"placeholder d-inline-block rounded-3\"\n            style={{ width: \"3em\", height: \"3em\" }}\n          />\n        }\n        src=\"mob.near/widget/WidgetImage\"\n        props={{\n          tooltip: true,\n          accountId,\n          widgetName,\n        }}\n      />\n    </a>\n  );\n};\n\nreturn (\n  <div>\n    <h5>Starred Apps</h5>\n    <div className=\"d-flex flex-wrap gap-1 my-3 placeholder-glow\">\n      {apps.slice(0, props.limit ? parseInt(props.limit) : 24).map(renderItem)}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mob.near/widget/StarredApps", "fact_widget_deployments_id": "fb33305fd0db69f353927fe3a9dc3a61", "inserted_timestamp": "2023-10-24T03:04:24.384Z", "modified_timestamp": "2023-10-24T03:04:24.384Z", "__row_index": 8}
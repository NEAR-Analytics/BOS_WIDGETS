{"tx_hash": "GcMdayRjqQUiHSA1ZrXQFzRMSEAq6XBUVyfmca9waNZG", "action_id_social": "3jBPZ7NFb2wFK8EqNxwg56nmbEWiWR4qT15xLdHyu2sA-0-widget", "block_id": 98804665, "block_timestamp": "2023-08-14T19:01:14.624Z", "signer_id": "mob.near", "widget_name": "N.RepostButton", "source_code": "const item = props.item;\n\nif (!item) {\n  return \"\";\n}\n\nconst reposts = Social.index(\"repost\", item);\n\nconst dataLoading = reposts === null;\n\nconst repostsByUsers = Object.fromEntries(\n  (reposts || [])\n    .filter((repost) => repost.value.type === \"repost\")\n    .map((repost) => [repost.accountId, repost])\n);\n\nif (state.hasRepost === true) {\n  repostsByUsers[context.accountId] = {\n    accountId: context.accountId,\n  };\n}\n\nconst accountsWithReposts = Object.keys(repostsByUsers);\nconst repostCount = accountsWithReposts.length;\nconst hasRepost = context.accountId && !!repostsByUsers[context.accountId];\n\nconst RepostButton = styled.button`\n  border: 0 !important;\n  display: inline-flex;\n  align-items: center;\n  justify-content: left;\n  border-radius: 50%;\n  width: 35px;\n  height: 35px;\n  background: inherit;\n  opacity: 0.3;\n  &:hover {\n    opacity: 1;\n    color: rgb(0, 184, 124);\n    background: rgb(0, 184, 124, 0.1);\n  }\n  svg {\n    margin-top: -4px;\n  }\n  .count {\n    margin-left: 8px;\n  }\n`;\n\nconst repostClick = () => {\n  if (state.loading) {\n    return;\n  }\n  State.update({\n    loading: true,\n  });\n  const reposts = [\n    {\n      key: \"main\",\n      value: {\n        type: \"repost\",\n        item,\n      },\n    },\n  ];\n  if (!hasRepost) {\n    reposts.push({\n      key: item,\n      value: {\n        type: \"repost\",\n      },\n    });\n  }\n  const data = {\n    index: {\n      repost: JSON.stringify(reposts),\n    },\n  };\n\n  if (!hasRepost && props.notifyAccountId) {\n    data.index.notify = JSON.stringify({\n      key: props.notifyAccountId,\n      value: {\n        type: \"repost\",\n        item,\n      },\n    });\n  }\n  Social.set(data, {\n    onCommit: () => State.update({ loading: false, hasRepost: true }),\n    onCancel: () => State.update({ loading: false }),\n  });\n};\n\nconst title = \"Repost\";\n\nconst repostSvg = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    fill=\"currentColor\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth=\"0.5\"\n  >\n    <path\n      fill-rule=\"evenodd\"\n      d=\"M4.854 1.146a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L4 2.707V12.5A2.5 2.5 0 0 0 6.5 15h8a.5.5 0 0 0 0-1h-8A1.5 1.5 0 0 1 5 12.5V2.707l3.146 3.147a.5.5 0 1 0 .708-.708l-4-4z\"\n      transform=\"rotate(180, 12, 12), translate(0, 4)\"\n    />\n    <path\n      fill-rule=\"evenodd\"\n      d=\"M4.854 1.146a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L4 2.707V12.5A2.5 2.5 0 0 0 6.5 15h8a.5.5 0 0 0 0-1h-8A1.5 1.5 0 0 1 5 12.5V2.707l3.146 3.147a.5.5 0 1 0 .708-.708l-4-4z\"\n      transform=\"translate(0, 4)\"\n    />\n  </svg>\n);\n\nreturn (\n  <div className=\"d-inline-flex align-items-center\">\n    <RepostButton\n      disabled={state.loading || dataLoading || !context.accountId}\n      title={title}\n      onClick={repostClick}\n    >\n      <span className={hasRepost ? \"reposted\" : \"\"}>{repostSvg}</span>\n      <span className=\"count\">{repostCount || \"\"}</span>\n    </RepostButton>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mob.near/widget/N.RepostButton", "fact_widget_deployments_id": "22cd7454658871d31ed7791e1e6390a1", "inserted_timestamp": "2023-08-14T20:28:26.494Z", "modified_timestamp": "2023-08-14T20:28:26.494Z", "__row_index": 2}
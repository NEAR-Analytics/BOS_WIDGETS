{"tx_hash": "A1subKFyvafee4A9TyH5EFcUKaNwL3ubA7CTXZ6MEmr2", "action_id_social": "BeyCu8RV7Qw466gxqGRbQtV7ygcuuMbwX35KuToQnDsa-0-widget", "block_id": 102240127, "block_timestamp": "2023-09-29T17:54:56.609Z", "signer_id": "mob.near", "widget_name": "N.Group", "source_code": "const groupId = props.groupId;\n\nconst data = fetch(\"https://graph.mintbase.xyz\", {\n  method: \"POST\",\n  headers: {\n    \"mb-api-key\": \"omni-site\",\n    \"Content-Type\": \"application/json\",\n    \"x-hasura-role\": \"anonymous\",\n  },\n  body: JSON.stringify({\n    query: `\nquery Owners {\n  mb_views_nft_tokens(\n    where: {\n      nft_contract_id: {_eq: \"${groupId}\"},\n      burned_timestamp: {_is_null: true}\n    }\n    distinct_on: owner\n  ) {\n    owner\n  }\n}\n`,\n  }),\n});\n\nconst nftMetadata = Near.view(groupId, \"nft_metadata\");\n\nif (!data.ok || !nftMetadata) {\n  return;\n}\n\nconst owners = data.body.data.mb_views_nft_tokens.map((o) => o.owner);\nconst isMember = owners.includes(context.accountId);\n\nconst Wrapper = styled.div`\n`;\n\nconst indexKey = `nft:${groupId}`;\n\nreturn (\n  <Wrapper>\n    <div>\n      <h4>Group: {nftMetadata.name}</h4>\n      <div>\n        <img src={nftMetadata.icon} style={{ maxHeight: \"20em\" }} />\n      </div>\n      Members: {owners.length}\n      {props.debug && <pre>{JSON.stringify(nftMetadata, null, 2)}</pre>}\n    </div>\n    {context.accountId &&\n      (isMember ? (\n        <Widget\n          key=\"compose\"\n          loading=\"\"\n          src=\"mob.near/widget/MainPage.N.Compose\"\n          props={{ indexKey, groupId }}\n        />\n      ) : (\n        \"Only members can post\"\n      ))}\n    <Widget\n      src=\"mob.near/widget/MainPage.N.Feed\"\n      props={{\n        accounts: owners,\n        indexKey,\n        groupId,\n        commentAccounts: owners,\n        permissions: {\n          disableRepost: !isMember,\n          disableComment: !isMember,\n        },\n      }}\n    />\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mob.near/widget/N.Group", "fact_widget_deployments_id": "37223c30feeb3da37e577b17d4ad3669", "inserted_timestamp": "2023-09-29T19:45:15.258Z", "modified_timestamp": "2023-09-29T19:45:15.258Z", "__row_index": 9}
{"tx_hash": "37iT25yYJWrt1x5AJ6PJhwHYAWjEj9qqfVZ3VDfypvCd", "action_id_social": "3pqj7rRJR8xgisZcdWzKbjt4oEeUsUqpWpPxc1QqFMG2-0-widget", "block_id": 104423566, "block_timestamp": "2023-10-29T00:02:48.270Z", "signer_id": "mob.near", "widget_name": "Near.FM.Edit", "source_code": "const [suffix, setSuffix] = useState(\"\");\nconst [longURL, setLongURL] = useState(\"\");\nconst [loading, setLoading] = useState(false);\nconst [metadata, setMetadata] = useState(false);\n\nfunction resetMetadata() {\n  setMetadata({\n    title: \"\",\n    description: \"\",\n    image: \"\",\n  });\n}\n\nuseEffect(() => {\n  if (longURL) {\n    setLoading(true);\n    asyncFetch(`https://near.fm/api/og?url=${longURL}`, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      responseType: \"json\",\n    })\n      .then(({ body }) => {\n        setMetadata({\n          title: body.title || \"\",\n          description: body.description || \"\",\n          image: body.image || \"\",\n        });\n      })\n      .catch((e) => {\n        console.error(\"Failed to load metadata for the URL\", e);\n        resetMetadata();\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  }\n}, [longURL]);\n\nreturn (\n  <div className=\"container mt-5\">\n    <div className=\"mb-3\">\n      <label className=\"form-label\">Short URL</label>\n      <div className=\"input-group\">\n        <span className=\"input-group-text\">\n          https://{context.accountId}.fm/\n        </span>\n        <input\n          type=\"text\"\n          placeholder=\"welcome-to-near\"\n          className=\"form-control\"\n          value={suffix}\n          onChange={(e) => setSuffix(e.target.value)}\n        />\n      </div>\n    </div>\n\n    {suffix && (\n      <div className=\"mb-3\">\n        <label className=\"form-label\">Long URL</label>\n        <input\n          type=\"url\"\n          className=\"form-control\"\n          value={longURL}\n          onChange={(e) => setLongURL(e.target.value)}\n        />\n      </div>\n    )}\n\n    {longURL && (\n      <div>\n        <div className=\"mb-3\">\n          <label className=\"form-label\">Title</label>\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            disabled={loading}\n            value={metadata.title}\n            onChange={(e) =>\n              setMetadata({ ...metadata, title: e.target.value })\n            }\n          />\n        </div>\n        <div className=\"mb-3\">\n          <label className=\"form-label\">Description</label>\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            disabled={loading}\n            value={metadata.description}\n            onChange={(e) =>\n              setMetadata({ ...metadata, description: e.target.value })\n            }\n          />\n        </div>\n        <div className=\"mb-3\">\n          <label className=\"form-label\">Image URL</label>\n          <input\n            type=\"url\"\n            className=\"form-control\"\n            disabled={loading}\n            value={metadata.image}\n            onChange={(e) =>\n              setMetadata({ ...metadata, image: e.target.value })\n            }\n          />\n        </div>\n\n        <div className=\"mb-3\">\n          <h5>Twitter Card Preview</h5>\n          <div className=\"border p-3\">\n            <h6>{metadata.title}</h6>\n            <p>{metadata.description}</p>\n            {metadata.image && (\n              <img\n                src={metadata.image}\n                alt=\"Twitter Card Image\"\n                className=\"img-fluid\"\n                style={{ maxHeight: \"10em\" }}\n              />\n            )}\n          </div>\n        </div>\n\n        <button className=\"btn btn-primary\">Save Changes</button>\n      </div>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mob.near/widget/Near.FM.Edit", "fact_widget_deployments_id": "ecbe4e9b67659a653591031f898203a8", "inserted_timestamp": "2023-10-29T01:55:18.087Z", "modified_timestamp": "2023-10-29T01:55:18.087Z", "__row_index": 1}
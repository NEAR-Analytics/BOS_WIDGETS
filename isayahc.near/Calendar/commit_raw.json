{"tx_hash": "6n2aTPsujxZpFydvtjoKMjpmGMKdNXEbt8nmMdRRPd4o", "action_id_social": "GSj8Ph4kLyf25dCTjoP5CeYHeapGYbk1iPWx6xyx6mxL-0-widget", "block_id": 104403473, "block_timestamp": "2023-10-28T17:52:35.147Z", "signer_id": "isayahc.near", "widget_name": "Calendar", "source_code": "// CALENDAR FROM https://github.com/fullcalendar/fullcalendar/tree/main/bundle\r\n// helper function to fetch all events\r\nconst fetchAllEvents = () => {\r\n  const events = fetch(\"https://8d06-69-193-152-202.ngrok-free.app/get_events\");\r\n  return events;\r\n};\r\n\r\nconst fetchedEvents = fetchAllEvents();\r\n\r\nif (!fetchedEvents) {\r\n  return <div>Loading...</div>;\r\n}\r\n\r\nconst formattedEvents = fetchedEvents.map((event) => {\r\n  return {\r\n    title: event.title,\r\n    start: new Date(`${event.start} ${event.startTime}`),\r\n    end: new Date(`${event.end} ${event.endTime}`),\r\n    url: event.link,\r\n    allDay: event.isAllDay === \"true\",\r\n    editable: false,\r\n\r\n    extendedProps: {\r\n      category: event.category,\r\n    },\r\n    description: event.description,\r\n  };\r\n});\r\n\r\nconst srcData = `\r\n<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet'>\r\n    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css' rel='stylesheet'>\r\n    <script src='https://cdn.jsdelivr.net/npm/fullcalendar/index.global.js'></script>\r\n    <script>\r\n\r\n      document.addEventListener('DOMContentLoaded', function() {\r\n        const calendarEl = document.getElementById('calendar')\r\n        const calendar = new FullCalendar.Calendar(calendarEl, {\r\n          titleFormat: { year: 'numeric', month: 'long', },\r\n          themeSystem: 'bootstrap5',\r\n          initialView: 'dayGridMonth',\r\n          editable: true,\r\n          firstDay: 1,\r\n          buttonText: {\r\n            month: \"Month\",\r\n            list: \"List\",\r\n          },\r\n          customButtons: {\r\n            filterBy: {\r\n              text: 'Filter by',\r\n              click: function(e) {\r\n                e.preventDefault();\r\n                window.parent.postMessage(JSON.stringify({ handler: \"filter\"}), '*');\r\n              }\r\n            },\r\n            addEvent: {\r\n              text: '',\r\n              click: function(e) {\r\n                e.preventDefault();\r\n                window.parent.postMessage(JSON.stringify({ handler: \"add-event\"}), '*');\r\n              }\r\n            },\r\n          },\r\n          expandRows: true,\r\n          headerToolbar: {\r\n            start: 'title prev,next dayGridMonth list', // will normally be on the left. if RTL, will be on the right\r\n            center: '',\r\n            // end: 'timeGridDay list' \r\n            end: 'filterBy addEvent' \r\n          },\r\n          navLinks: true,\r\n          events: ${JSON.stringify(formattedEvents)},\r\n          eventClick: function(info) {\r\n            info.jsEvent.preventDefault(); // don't let the browser navigate\r\n            // Post the event details to the parent window\r\n            window.parent.postMessage(JSON.stringify({ handler: \"event-click\", data: info.event }), '*');\r\n          },\r\n     \r\n\r\n          // Render the custom button with an icon\r\n          viewDidMount: function () {\r\n            var addEvent = document.querySelector('.fc-addEvent-button');\r\n            addEvent.innerHTML = 'Add Event <i class=\"bi bi-plus-circle-fill\" style=\"color: #05EB97; margin-left: 2px;\"></i>';\r\n        \r\n          }\r\n        })\r\n        calendar.render()\r\n      })\r\n\r\n      \r\n    </script>\r\n    \r\n  </head>\r\n  <body>\r\n    <div id='calendar'></div>\r\n  </body>\r\n</html>\r\n\r\n<style>\r\n  html,\r\n  body {\r\n    height: 100%;\r\n  }\r\n\r\n  #calendar: {\r\n    height:  100%;\r\n  }\r\n\r\n  .fc-col-header {\r\n    border-radius: 0px 0px 6px 6px;\r\n    background: rgba(237, 237, 237, 0.93);\r\n  }\r\n\r\n  .fc-scrollgrid-sync-inner a {\r\n    text-decoration: none;\r\n    color: #5C5F62;\r\n    font-size: 12px;\r\n    font-style: normal;\r\n    font-weight: 500;\r\n    line-height: normal;\r\n  }\r\n\r\n  .fc-toolbar-chunk {\r\n    display: flex;\r\n  }\r\n\r\n  .fc .fc-button-primary {\r\n    background-color: white;\r\n    color: black;\r\n    border: none;\r\n  }\r\n\r\n  .fc .fc-button-primary:hover{ \r\n    transition: 300ms;\r\n  }\r\n\r\n  .fc-dayGridMonth-button.fc-button.fc-button-primary {\r\n    width: 67px;\r\n    height: 35px;\r\n    padding: 8px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 4px;\r\n\r\n    border-radius: 3px;\r\n\r\n    background: rgba(3, 177, 114, 0.20);\r\n    color: #03B172;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: normal;\r\n  }\r\n\r\n  .fc-dayGridMonth-button.fc-button.fc-button-primary.fc-button-active {\r\n    border: 1px solid #03B172;\r\n    background-color: white;\r\n    color: #03B172;\r\n  }\r\n\r\n  .fc-list-button.fc-button.fc-button-primary {\r\n    display: flex;\r\n    width: 67px;\r\n    height: 35px;\r\n    padding: 8px;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 4px;\r\n\r\n    border-radius: 3px;\r\n    background: rgba(3, 177, 114, 0.20);\r\n\r\n    color: #03B172;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: normal;\r\n  }\r\n\r\n  .fc-list-button.fc-button.fc-button-primary.fc-button-active {\r\n    border: 1px solid #03B172;\r\n    background-color: white;\r\n    color: #03B172;\r\n  }\r\n\r\n  .fc-header-toolbar.fc-toolbar {\r\n    display: flex;\r\n    padding: 16px;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    align-self: stretch;\r\n\r\n    border-radius: 6px;\r\n    border: 1px solid var(--Stroke, rgba(218, 220, 224, 0.60));\r\n    background: #FFF;\r\n  } \r\n\r\n  .fc .fc-toolbar.fc-header-toolbar {\r\n    margin-bottom: 16px;\r\n  }\r\n\r\n  .fc-toolbar-title {\r\n    font-weight: 400;\r\n  }\r\n\r\n  .fc-filterBy-button.fc-button.fc-button-primary {\r\n    border-radius: 3px;\r\n    background: #EEE;\r\n\r\n    display: flex;\r\n    height: 35px;\r\n    padding: 8px;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 4px;\r\n\r\n    color: #000;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    line-height: normal;\r\n  }\r\n\r\n  .fc-addEvent-button.fc-button.fc-button-primary {\r\n    display: flex;\r\n    height: 35px;\r\n    padding: 8px 16px;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 4px;\r\n\r\n    border-radius: 3px;\r\n    background: #03B172;\r\n\r\n    color: #FFF;\r\n    font-size: 16px;\r\n    font-style: normal;\r\n    font-weight: 500;\r\n    line-height: normal;\r\n  }\r\n\r\n  .fc table {\r\n    border-radius: 6px;\r\n  }\r\n\r\n  .fc .fc-daygrid-day-top {\r\n    flex-direction: row;\r\n  }\r\n\r\n  .fc .fc-daygrid-day-number {\r\n    display: flex;\r\n    width: 22px;\r\n    padding: 5px;\r\n    align-items: flex-start;\r\n    gap: 10px;\r\n\r\n    text-decoration: none;\r\n\r\n    color: #333;\r\n    font-size: 10px;\r\n    font-style: normal;\r\n    font-weight: 500;\r\n    line-height: normal;\r\n  }\r\n\r\n  .fc-day-past,\r\n  .fc-day-other {\r\n    background: #F2F2F2;\r\n  }\r\n\r\n  .fc .fc-view-harness-active > .fc-view {\r\n    border-radius: 6px;\r\n  }\r\n\r\n  tbody, td, tfoot, th, thead, tr {\r\n    border-radius: 6px;\r\n  }\r\n\r\n  @media (width < 720px) {\r\n    .fc .fc-toolbar-title {\r\n      font-size: 1rem;\r\n    }\r\n\r\n    .fc-toolbar-chunk {\r\n      display: flex;\r\n      align-items: center;\r\n    }\r\n  }\r\n\r\n  @media (width < 550px) {\r\n    .fc-dayGridMonth-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n      width: 50px;\r\n      height: 30px;\r\n      padding: 0.5rem;\r\n    }\r\n\r\n    .fc-list-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n      width: 50px;\r\n      height: 30px;\r\n      padding: 0.5rem;\r\n    }\r\n\r\n    .fc-filterBy-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n      width: 60px;\r\n      height: 30px;\r\n      padding: 0.5rem;\r\n    }\r\n\r\n    .fc-addEvent-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n      width: 95px;\r\n      height: 30px;\r\n      padding: 0.5rem;\r\n    }\r\n\r\n    .fc-prev-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n    }\r\n\r\n    .fc-next-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n    }\r\n  }\r\n\r\n  @media (width < 480px) {\r\n    .fc-header-toolbar.fc-toolbar {\r\n      padding: 0.25rem;\r\n      text-align: center;\r\n    } \r\n\r\n    .fc-direction-ltr .fc-toolbar > * > :not(:first-child) {\r\n      margin-left: 0px;\r\n    }\r\n\r\n    .fc-prev-button.fc-button.fc-button-primary {\r\n      padding: 2px;\r\n    }\r\n\r\n    .fc-next-button.fc-button.fc-button-primary {\r\n      padding: 2px;\r\n    }\r\n\r\n    .fc-dayGridMonth-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n      width: 50px;\r\n      height: 30px;\r\n      padding: 0.5rem;\r\n    }\r\n\r\n    .fc-list-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n      width: 50px;\r\n      height: 30px;\r\n      padding: 0.5rem;\r\n    }\r\n\r\n    .fc-filterBy-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n      width: 60px;\r\n      height: 30px;\r\n      padding: 0.5rem;\r\n    }\r\n\r\n    .fc-addEvent-button.fc-button.fc-button-primary {\r\n      font-size: 0.75rem;\r\n      width: 90px;\r\n      height: 30px;\r\n      padding: 0.2rem;\r\n    }\r\n  }\r\n\r\n</style>\r\n`;\r\n\r\nreturn (\r\n  <>\r\n    <div className=\"container\">\r\n      <iframe\r\n        srcDoc={srcData}\r\n        onMessage={(data) => {\r\n          const dataObj = JSON.parse(data);\r\n          switch (dataObj.handler) {\r\n            case \"filter\": {\r\n              console.log(\"filter\");\r\n              if (props.handleFilter) {\r\n                props.handleFilter();\r\n              }\r\n              break;\r\n            }\r\n            case \"add-event\": {\r\n              console.log(\"add event\");\r\n              if (props.handleAddEvent) {\r\n                props.handleAddEvent();\r\n              }\r\n              break;\r\n            }\r\n            case \"event-click\": {\r\n              console.log(\"event click\");\r\n              if (props.handleEventClick) {\r\n                props.handleEventClick();\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }}\r\n        style={{\r\n          height: \"100vh\",\r\n          width: \"100%\",\r\n        }}\r\n      />\r\n    </div>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/isayahc.near/widget/Calendar", "fact_widget_deployments_id": "3ebf6884de964f824f2a96f95bec5b6b", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 15}
{"tx_hash": "AUy6DhPPKnSDXU4wQQCyWEZZUJPpdftMsRMRTezuaSHZ", "action_id_social": "GndiPtUWfQCRew7S9YY3cKcQ1gWLbexL7f6ujBuCfKLJ-0-widget", "block_id": 97983613, "block_timestamp": "2023-08-03T13:18:18.172Z", "signer_id": "humans-of-near.near", "widget_name": "home", "source_code": "const Owner = \"humans-of-near.near\";\nconst API_URL = \"https://humans.nearverselabs.com/api\";\nconst MAP_STYLE = \"mapbox://styles/mapbox/dark-v10\";\nconst MAP_TOKEN =\n  \"pk.eyJ1IjoidGVqMDEiLCJhIjoiY2xqcHZ2dGpkMDB5azNsbzQ0bmMwNjRjaCJ9.FVv2zRPaLwzZMgagbI2YZw\";\n\nconst center = [0, 30];\nconst zoom = 1.7;\nconst accountId = context.accountId;\n\nState.init({\n  showModal: false,\n  edit: false,\n  user: {\n    name: \"\",\n    social: \"\",\n    twitter: \"\",\n  },\n  loocations: [],\n});\n\n//Styles\n\nconst Wrapper = styled.div`\n  display: flex;\n  width: 100%;\n  height: 100%;\n  align-items: stretch;\n  flex-direction: column;\n  background: black;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  position: absolute;\n  padding: 30px 40px;\n`;\n\nconst BtnStyle = {\n  background: \"#191a1a\",\n  padding: \"10px 22px\",\n  borderRadius: \"6px\",\n  border: \"1px solid rgb(255, 255, 255)\",\n  color: \"white\",\n  position: \"absolute\",\n  left: \"58px\",\n  top: \"130px\",\n  zIndex: 1,\n};\n\nconst BtnStyle2 = {\n  background: \"unset\",\n  padding: \"10px 22px\",\n  borderRadius: \"6px\",\n  border: \"1px solid rgb(255, 255, 255)\",\n  color: \"white\",\n  position: \"absolute\",\n  bottom: 50,\n  zIndex: 1,\n};\n\nconst getMyData = () => {\n  return asyncFetch(API_URL + `/auth/account?accountId=${accountId}`).then(\n    (res) => {\n      if (res.ok) {\n        return res.body.user;\n      }\n    }\n  );\n};\n\nconst getLocations = () => {\n  return asyncFetch(API_URL + `/location`).then((res) => {\n    if (res.ok) {\n      return res.body;\n    }\n  });\n};\n\nconst getMyInfor = async () => {\n  getMyData().then((user) => {\n    State.update({\n      user,\n    });\n  });\n};\n\nconst getLocationsData = async () => {\n  getLocations().then((data) => {\n    State.update({\n      locations: data,\n    });\n  });\n};\n\nconst onClose = () => {\n  State.update({ showModal: false });\n};\n\ngetMyInfor();\ngetLocationsData();\n\nreturn (\n  <Wrapper>\n    <Header>\n      <Widget src={`${Owner}/widget/Header`} />\n    </Header>\n\n    <div>\n      <button\n        class=\"btn\"\n        style={BtnStyle}\n        onClick={() => {\n          State.update({ showModal: true });\n        }}\n      >\n        {`Profile`}\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"20\"\n          height=\"20\"\n          viewBox=\"0 0 48 48\"\n        >\n          <mask id=\"ipSDownOne0\">\n            <path\n              fill=\"#fff\"\n              stroke=\"#fff\"\n              stroke-linejoin=\"round\"\n              stroke-width=\"4\"\n              d=\"M36 19L24 31L12 19h24Z\"\n            />\n          </mask>\n          <path\n            fill=\"currentColor\"\n            d=\"M0 0h48v48H0z\"\n            mask=\"url(#ipSDownOne0)\"\n          />\n        </svg>\n      </button>\n    </div>\n\n    <div\n      style={{\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n      }}\n    >\n      <button\n        class=\"btn\"\n        style={BtnStyle2}\n        onClick={() => {\n          State.update({ edit: true });\n        }}\n      >\n        {`Edit location`}\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <g\n            fill=\"none\"\n            stroke=\"currentColor\"\n            stroke-linejoin=\"round\"\n            stroke-width=\"2\"\n          >\n            <path d=\"M13 9a1 1 0 1 1-2 0a1 1 0 0 1 2 0Z\" />\n            <path d=\"M17.5 9.5c0 3.038-2 6.5-5.5 10.5c-3.5-4-5.5-7.462-5.5-10.5a5.5 5.5 0 1 1 11 0Z\" />\n          </g>\n        </svg>\n      </button>\n    </div>\n\n    {state.showModal && (\n      <Widget\n        src={`${Owner}/widget/Modal`}\n        props={{ onClose, API_URL, user: state.user, getMyInfor }}\n      />\n    )}\n\n    <Widget\n      src={`${Owner}/widget/Mapbox`}\n      props={{ accessToken: MAP_TOKEN, styleUrl: MAP_STYLE, center, zoom }}\n    />\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/humans-of-near.near/widget/home", "fact_widget_deployments_id": "856739d5b02fcbd2d189b4cf0b81467b", "inserted_timestamp": "2023-08-03T14:30:25.591Z", "modified_timestamp": "2023-08-03T14:30:25.591Z", "__row_index": 53}
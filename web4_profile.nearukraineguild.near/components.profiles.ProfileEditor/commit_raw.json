{"tx_hash": "83drwgKwYWhrxZgDkbG8m2yf75zuNzCfbwbe1dG3uQNi", "action_id_social": "85zNjbW3c9Gub8zMXc3BeWSvryBh6FtG1j5UqShUQRRm-0-widget", "block_id": 88796479, "block_timestamp": "2023-04-04T11:25:04.090Z", "signer_id": "web4_profile.nearukraineguild.near", "widget_name": "components.profiles.ProfileEditor", "source_code": "/* INCLUDE: \"common.jsx\" */\nconst contractAccountId =\n  props.contractAccountId ||\n  (context.widgetSrc ?? \"web4_profile.near\").split(\"/\", 1)[0];\nconst widgetAccountId =\n  props.widgetAccountId ||\n  (context.widgetSrc ?? \"web4_profile.near\").split(\"/\", 1)[0];\n\nfunction widget(widgetName, widgetProps, key) {\n  widgetProps = {\n    ...widgetProps,\n    contractAccountId: props.contractAccountId,\n    widgetAccountId: props.widgetAccountId,\n    referral: props.referral,\n  };\n  return (\n    <Widget\n      src={`${widgetAccountId}/widget/${widgetName}`}\n      props={widgetProps}\n      key={key}\n    />\n  );\n}\n\nfunction href(widgetName, linkProps) {\n  linkProps = { ...linkProps };\n  if (props.contractAccountId) {\n    linkProps.contractAccountId = props.contractAccountId;\n  }\n  if (props.widgetAccountId) {\n    linkProps.widgetAccountId = props.widgetAccountId;\n  }\n  if (props.referral) {\n    linkProps.referral = props.referral;\n  }\n  const linkPropsQuery = Object.entries(linkProps)\n    .map(([key, value]) => `${key}=${value}`)\n    .join(\"&\");\n  return `#/${widgetAccountId}/widget/pages.${widgetName}${\n    linkPropsQuery ? \"?\" : \"\"\n  }${linkPropsQuery}`;\n}\n/* END_INCLUDE: \"common.jsx\" */\n\nconst profileContractId = props.profileContractId;\n\nState.init({\n  title: props.title ?? \"\",\n  description: props.description ?? \"\",\n  twitter: props.twitter ?? \"\",\n  telegram: props.telegram ?? \"\",\n  github: props.github ?? \"\",\n  medium: props.medium ?? \"\",\n  error: \"\",\n});\n\n// This must be outside onClick, because Near.view returns null at first, and when the view call finished, it returns true/false.\n// If checking this inside onClick, it will give `null` and we cannot tell the result is true or false.\nconst grantNotify = Near.view(\"social.near\", \"is_write_permission_granted\", {\n  predecessor_id: contractAccountId,\n  key: context.accountId + \"/index/notify\",\n});\nif (grantNotify === null) {\n  return;\n}\n\nconst onEditClick = () => {\n  State.update({ error: \"\" });\n\n  if (!state.title) {\n    return State.update({ error: \"Title can't be empty\" });\n  }\n\n  if (!state.description) {\n    return State.update({ error: \"Description can't be empty\" });\n  }\n\n  const data = {\n    title: state.title,\n    description: state.description,\n    twitter: state.twitter,\n    telegram: state.telegram,\n    github: state.github,\n    medium: state.medium,\n  };\n\n  Near.call(\n    profileContractId,\n    \"update_data\",\n    {\n      data: data,\n    },\n    Big(10).pow(12).mul(300)\n  );\n};\n\nreturn (\n  <div className=\"card\">\n    <div className=\"card-header\">Update</div>\n    <div class=\"card-body\">\n      <div className=\"row\">\n        <div className=\"col-lg-6  mb-2\">\n          Title\n          <input\n            type=\"text\"\n            value={state.title}\n            onChange={(event) => {\n              State.update({ title: event.target.value });\n            }}\n          />\n        </div>\n        <div className=\"col-lg-12  mb-2\">\n          Description\n          <textarea\n            value={state.description}\n            type=\"text\"\n            rows={2}\n            className=\"form-control\"\n            onChange={(event) => {\n              State.update({ description: event.target.value });\n            }}\n          />\n        </div>\n        <div className=\"col-lg-3  mb-2\">\n          GitHub\n          <input\n            type=\"text\"\n            value={state.github}\n            placeholder=\"account\"\n            onChange={(event) => {\n              State.update({ github: event.target.value });\n            }}\n          />\n        </div>\n        <div className=\"col-lg-3  mb-2\">\n          Twitter\n          <input\n            type=\"text\"\n            value={state.twitter}\n            placeholder=\"account\"\n            onChange={(event) => {\n              State.update({ twitter: event.target.value });\n            }}\n          />\n        </div>\n        <div className=\"col-lg-3  mb-2\">\n          Telegram\n          <input\n            type=\"text\"\n            placeholder=\"account\"\n            value={state.telegram}\n            onChange={(event) => {\n              State.update({ telegram: event.target.value });\n            }}\n          />\n        </div>\n        <div className=\"col-lg-3  mb-2\">\n          Medium\n          <input\n            type=\"text\"\n            placeholder=\"@account\"\n            value={state.medium}\n            onChange={(event) => {\n              State.update({ medium: event.target.value });\n            }}\n          />\n        </div>\n      </div>\n      <a\n        className=\"btn btn-outline-primary mb-2 mt-2 px-8 py-1\"\n        onClick={onEditClick}\n      >\n        Edit\n      </a>\n      <a\n        className=\"btn btn-secondary ml-2 my-2 px-8 py-1\"\n        href={`https://${profileContractId}.page`}\n        target=\"_blank\"\n      >\n        Open profile\n      </a>\n    </div>\n    {state.error && (\n      <div class=\"card-footer\">\n        <p style={{ color: \"red\" }}>{state.error}</p>\n      </div>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/web4_profile.nearukraineguild.near/widget/components.profiles.ProfileEditor", "fact_widget_deployments_id": "34cbfc2044b78ae4a2ff7b1572b82e9e", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
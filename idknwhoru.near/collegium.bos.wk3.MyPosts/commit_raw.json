{"tx_hash": "3Qrfdc7AY7VwFRM5WbPKGRgmUSyJMQg2M9NXWxcoa5p9", "action_id_social": "F7DnSpGmqy8sBEBVo4H1a68W94iWa7XMVDyPkgm9xkm2-0-widget", "block_id": 96300168, "block_timestamp": "2023-07-12T12:52:54.807Z", "signer_id": "idknwhoru.near", "widget_name": "collegium.bos.wk3.MyPosts", "source_code": "const account_id = context.accountId;\n\nState.init({\n  isInit: false,\n  posts: [],\n});\n\nconst getMyPosts = () => {\n  asyncFetch(\n    \"https://queryapi-hasura-graphql-24ktefolwq-ew.a.run.app/v1/graphql\",\n    {\n      method: \"POST\",\n      headers: { \"x-hasura-role\": \"nearpavel_near\" },\n      body: JSON.stringify({\n        query: `query MyQuery {\n          nearpavel_near_social_posts_posts(where: {account_id: {_eq: \"${account_id}\"}}) {\n          account_id\n          block_height\n          block_timestamp\n          content\n          receipt_id\n        }\n      }`,\n      }),\n    }\n  ).then((postRes) => {\n    if (postRes.body.errors === undefined) {\n      State.update({\n        isInit: true,\n        posts: postRes.body.data.nearpavel_near_social_posts_posts,\n      });\n    }\n  });\n};\n\nif (state.isInit === false) {\n  getMyPosts();\n}\n\nconst Post = state.posts.map((post, index) => {\n  const content = JSON.parse(post.content);\n  const block_timestamp = new Date(post.block_timestamp / 1000000);\n  const { year, month, day, hours, minutes, seconds } = {\n    year: block_timestamp.getFullYear(),\n    month: (block_timestamp.getMonth() + 1).toString().padStart(2, \"0\"),\n    day: block_timestamp.getDate().toString().padStart(2, \"0\"),\n    hours: block_timestamp.getHours().toString().padStart(2, \"0\"),\n    minutes: block_timestamp.getMinutes().toString().padStart(2, \"0\"),\n  };\n\n  return (\n    <div>\n      <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n        <h2>No.{index + 1}</h2>\n        <h3>\n          {year}-{month}-{day} {hours}:{minutes}\n        </h3>\n      </div>\n      <div\n        style={{\n          padding: \"15px 15px 0 15px\",\n          border: \"solid 1px\",\n          borderRadius: \"3px\",\n        }}\n      >\n        <Markdown text={content.text} />\n      </div>\n      <hr />\n    </div>\n  );\n});\n\nreturn (\n  <div>\n    {state.isInit === false ? (\n      <h1>Load Your Posts...</h1>\n    ) : (\n      <div>\n        <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n          <h1>\n            Your({account_id}) Posts: {Post.length}\n          </h1>\n          <button onClick={getMyPosts}>Load Posts</button>\n        </div>\n        <hr />\n        {Post.length === 0 ? <h2>Can not found your post</h2> : Post}\n      </div>\n    )}\n  </div>\n);\n", "metadata": {"platform": "Components.gg"}, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/idknwhoru.near/widget/collegium.bos.wk3.MyPosts", "fact_widget_deployments_id": "70d367dcac1a1a6a27bd3c8ed89a1708", "inserted_timestamp": "2000-01-01T00:00:00.000Z", "modified_timestamp": "2000-01-01T00:00:00.000Z", "__row_index": 5}
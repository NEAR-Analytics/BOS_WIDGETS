{"tx_hash": "3zAj7KmJFnKEkSpSyQ3y2Qse9joCeK5iRJMUb6BUnQqH", "action_id_social": "34ZUQL7JZnz7juM2DBS4JqYVL37vB9X7aeWbLJuqiF1N-0-widget", "block_id": 113702355, "block_timestamp": "2024-02-27T19:03:14.015Z", "signer_id": "owa-is-bos.near", "widget_name": "Maverick-LP-NewOptionsModal", "source_code": "let FEE = props.fee > 0 ? props.fee : 0.1;\r\nlet WIDTH = props.width > 0 ? props.width : 0.5;\r\nlet POOLNAME1 = props.poolName1;\r\nlet POOLNAME2 = props.poolName2;\r\nconst setFeeWidth = props.setFeeWidth;\r\nconst closeModal = props.closeModal;\r\nconsole.log(POOLNAME1, POOLNAME2);\r\nconsole.log(props);\r\n\r\nif (!state.filterPools) {\r\n  asyncFetch(`https://api.mav.xyz/api/v3/pools/324\r\n`)\r\n    .catch((err) => {\r\n      console.log(err);\r\n    })\r\n    .then((res) => {\r\n      const allPools = res.body.pools;\r\n      const filterPools = allPools.filter(\r\n        (p) => p.name == POOLNAME1 || p.name == POOLNAME2\r\n      );\r\n      if (!state.validated) {\r\n        State.update({\r\n          validated: true,\r\n          filterPools: filterPools,\r\n        });\r\n        validateOptions(FEE, WIDTH, filterPools);\r\n      }\r\n    });\r\n}\r\n\r\nconst stylesComponent = `\r\ninput[type=range] {\r\n  -webkit-appearance: none;\r\n  margin: 10px 0;\r\n  width: 100%;\r\n  background: none;\r\npadding: 0px;\r\n}\r\ninput[type=range]:focus {\r\n  outline: none;\r\n}\r\n  \r\ninput[type=range]::-webkit-slider-runnable-track {\r\n  height: 5px;\r\n  cursor: pointer;\r\n  animate: 0.2s;\r\n  background: #9B00CB;\r\n  border-radius: 5px;\r\n}\r\ninput[type=range]::-webkit-slider-thumb {\r\n  box-shadow: 0px 0px 0px #000000;\r\n  border: 1px solid #000000;\r\n  height: 18px;\r\n  width: 18px;\r\n  border-radius: 25px;\r\n  background: #EBEBEB;\r\n  cursor: pointer;\r\n  -webkit-appearance: none;\r\n  margin-top: -7px;\r\n}\r\n`;\r\n\r\nconst feeAllowedValues = [\r\n  0.002, 0.005, 0.008, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09,\r\n  0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.5, 0.75, 1.0, 2.0, 3.0,\r\n];\r\n\r\nconst widthAllowedValues = [\r\n  0.01, 0.02, 0.04, 0.1, 0.2, 0.4, 0.5, 1, 2, 5, 10, 25, 50,\r\n];\r\n\r\nState.init({\r\n  valueFeeRange: feeAllowedValues.indexOf(FEE),\r\n  valueWidthRange: widthAllowedValues.indexOf(WIDTH),\r\n  valueFee: FEE,\r\n  valueWidth: WIDTH,\r\n  validated: false,\r\n});\r\n\r\nconst handleSliderFeeChange = (event) => {\r\n  State.update({\r\n    valueFeeRange: event.target.value,\r\n    valueFee: feeAllowedValues[event.target.value],\r\n  });\r\n  validateOptions(feeAllowedValues[event.target.value], state.valueWidth);\r\n};\r\n\r\nconst handleSliderWidthChange = (event) => {\r\n  State.update({\r\n    valueWidthRange: event.target.value,\r\n    valueWidth: widthAllowedValues[event.target.value],\r\n  });\r\n  validateOptions(state.valueFee, widthAllowedValues[event.target.value]);\r\n};\r\n\r\nconst validateOptions = (fee, width, filterPools) => {\r\n  const existPool = filterPools\r\n    ? filterPools.filter((p) => p.fee * 100 == fee && p.width * 100 == width)\r\n    : state.filterPools.filter(\r\n        (p) => p.fee * 100 == fee && p.width * 100 == width\r\n      );\r\n\r\n  if (existPool.length > 0) {\r\n    console.log(\"Existe la pool\");\r\n    State.update({\r\n      existPool: true,\r\n    });\r\n  } else {\r\n    console.log(\"No existe la pool\");\r\n    State.update({\r\n      existPool: false,\r\n    });\r\n  }\r\n};\r\n\r\nconst formatNumberFee = (n) => {\r\n  if (n >= 0.01) {\r\n    return n.toFixed(2) + \" %\";\r\n  }\r\n  return n.toFixed(3) + \" %\";\r\n};\r\n\r\nconst formatNumberWidth = (n) => {\r\n  if (n < 0.1) {\r\n    return n.toFixed(2) + \" %\";\r\n  }\r\n  if (n < 1) {\r\n    return n.toFixed(1) + \" %\";\r\n  }\r\n  return n + \" %\";\r\n};\r\n\r\nconst css = fetch(\r\n  \"https://raw.githubusercontent.com/yaairnaavaa/Maverick/main/createPool.css\"\r\n).body;\r\n\r\nif (!css) return \"\";\r\n\r\nif (!state.theme) {\r\n  State.update({\r\n    theme: styled.div`\r\n    ${stylesComponent}\r\n`,\r\n  });\r\n}\r\n\r\nconst Theme = state.theme;\r\n\r\nreturn (\r\n  <Theme\r\n    style={{\r\n      width: \"350px\",\r\n      padding: \"22px\",\r\n      background: \"rgb(3, 5, 23)\",\r\n      color: \"rgb(255, 255, 255)\",\r\n      backgroundImage:\r\n        \"linear-gradient(rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.05))\",\r\n      margin: \"auto\",\r\n      position: \"absolute\",\r\n      overflowY: \"auto\",\r\n      display: \"flex\",\r\n      flexDirection: \"column\",\r\n      maxHeight: \"calc(100% - 64px)\",\r\n      maxWidth: \"600px\",\r\n      border: \"1px solid rgba(255, 255, 255, 0.1)\",\r\n      borderRadius: \"20px\",\r\n      right: \"0\",\r\n      left: \"0\",\r\n      top: \"10px\",\r\n      zIndex: \"100\",\r\n    }}\r\n  >\r\n    <div style={{ color: \"rgb(255, 255, 255)\" }}>\r\n      <div\r\n        style={{\r\n          minWidth: \"320px\",\r\n          borderRadius: \"8px\",\r\n          marginBottom: \"16px\",\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          placeContent: \"space-between flex-start\",\r\n        }}\r\n      >\r\n        <div>Select Options</div>\r\n        <div style={{ float: \"right\", right: \"16px\", position: \"absolute\" }}>\r\n          <button\r\n            style={{\r\n              display: \"inline-flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\",\r\n              position: \"relative\",\r\n              boxSizing: \"border-box\",\r\n              backgroundColor: \"transparent\",\r\n              outline: \"0px\",\r\n              border: \"0px\",\r\n              cursor: \"pointer\",\r\n              userSelect: \"none\",\r\n              verticalAlign: \"middle\",\r\n              appearance: \"none\",\r\n              textDecoration: \"none\",\r\n              textAlign: \"center\",\r\n              flex: \"0 0 auto\",\r\n              fontSize: \"1.5rem\",\r\n              padding: \"8px\",\r\n              borderRadius: \"50%\",\r\n              overflow: \"visible\",\r\n              transition:\r\n                \"background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms\",\r\n              color: \"rgb(158, 158, 158)\",\r\n              margin: \"-8px\",\r\n            }}\r\n            onClick={async () => {\r\n              closeModal();\r\n            }}\r\n          >\r\n            x\r\n          </button>\r\n        </div>\r\n      </div>\r\n      {state.filterPools ? (\r\n        <div style={{ width: \"100%\", fontSize: \"0.875rem\", marginTop: \"15px\" }}>\r\n          <div\r\n            style={{\r\n              height: \"150px\",\r\n              overflow: \"auto\",\r\n              border: \"1px solid rgba(255, 255, 255, 0.1)\",\r\n              borderRadius: \"20px\",\r\n              padding: \"14px\",\r\n            }}\r\n          >\r\n            <div class=\"row\">\r\n              <div class=\"col-12\">\r\n                <span>Fee Tier:</span>\r\n              </div>\r\n              <div class=\"col-8\">\r\n                <input\r\n                  type=\"range\"\r\n                  min={0}\r\n                  max={23}\r\n                  step={1}\r\n                  value={state.valueFeeRange}\r\n                  onChange={handleSliderFeeChange}\r\n                  list=\"allowedValues\"\r\n                />\r\n              </div>\r\n              <div class=\"col-4\">\r\n                <span\r\n                  style={{\r\n                    display: \"flex\",\r\n                    width: \"100%\",\r\n                    justifyContent: \"center\",\r\n                    marginRight: \"5px\",\r\n                    fontSize: \"0.75rem\",\r\n                    border: \"1px solid rgb(97, 97, 97)\",\r\n                    borderRadius: \"5px\",\r\n                    padding: \"3px\",\r\n                    backgroundColor: \"rgba(255, 255, 255, 0.15)\",\r\n                    fontWeight: \"bold\",\r\n                  }}\r\n                >\r\n                  {formatNumberFee(state.valueFee)}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div class=\"row mt-2\">\r\n              <div class=\"col-12\">\r\n                <span>Bin Width:</span>\r\n              </div>\r\n              <div class=\"col-8\">\r\n                <input\r\n                  type=\"range\"\r\n                  min={0}\r\n                  max={12}\r\n                  step={1}\r\n                  value={state.valueWidthRange}\r\n                  onChange={handleSliderWidthChange}\r\n                  list=\"allowedValues\"\r\n                />\r\n              </div>\r\n              <div class=\"col-4\">\r\n                <span\r\n                  style={{\r\n                    display: \"flex\",\r\n                    width: \"100%\",\r\n                    justifyContent: \"center\",\r\n                    marginRight: \"5px\",\r\n                    fontSize: \"0.75rem\",\r\n                    border: \"1px solid rgb(97, 97, 97)\",\r\n                    borderRadius: \"5px\",\r\n                    padding: \"3px\",\r\n                    backgroundColor: \"rgba(255, 255, 255, 0.15)\",\r\n                    fontWeight: \"bold\",\r\n                  }}\r\n                >\r\n                  {formatNumberWidth(state.valueWidth)}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {state.validated && !state.existPool ? (\r\n            <button\r\n              style={{\r\n                display: \"inline-flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n                position: \"relative\",\r\n                boxSizing: \"border-box\",\r\n                outline: \"0px\",\r\n                border: \"0px\",\r\n                margin: \"15px 0px 0px\",\r\n                cursor: \"pointer\",\r\n                userSelect: \"none\",\r\n                verticalAlign: \"middle\",\r\n                appearance: \"none\",\r\n                textDecoration: \"none\",\r\n                lineHeight: \"1.0625rem\",\r\n                minWidth: \"64px\",\r\n                backgroundColor: \"rgb(100, 0, 255)\",\r\n                borderRadius: \"0.625rem\",\r\n                textTransform: \"capitalize\",\r\n                padding: \"12px 18px\",\r\n                fontWeight: \"700\",\r\n                fontSize: \"1rem\",\r\n                width: \"100%\",\r\n              }}\r\n              onClick={async () => {\r\n                setFeeWidth(state.valueFee, state.valueWidth);\r\n              }}\r\n            >\r\n              Select\r\n            </button>\r\n          ) : (\r\n            <button\r\n              style={{\r\n                display: \"inline-flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n                position: \"relative\",\r\n                boxSizing: \"border-box\",\r\n                outline: \"0px\",\r\n                border: \"1px solid rgb(100, 0, 255)\",\r\n                margin: \"15px 0px 0px\",\r\n                userSelect: \"none\",\r\n                verticalAlign: \"middle\",\r\n                appearance: \"none\",\r\n                textDecoration: \"none\",\r\n                lineHeight: \"1.0625rem\",\r\n                minWidth: \"64px\",\r\n                borderRadius: \"0.625rem\",\r\n                textTransform: \"capitalize\",\r\n                padding: \"12px 18px\",\r\n                fontWeight: \"700\",\r\n                fontSize: \"1rem\",\r\n                width: \"100%\",\r\n                background: \"none\",\r\n              }}\r\n            >\r\n              Pool Already Deployed\r\n            </button>\r\n          )}\r\n        </div>\r\n      ) : (\r\n        <div class=\"titleStep\">Loading data...</div>\r\n      )}\r\n    </div>\r\n  </Theme>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/owa-is-bos.near/widget/Maverick-LP-NewOptionsModal", "fact_widget_deployments_id": "ac268ca622d2fe519be51f8ecddcc3e2", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}
{"tx_hash": "5Ru456QkYPJHVNBiCbwvsqnr2dmEicuGihgLyWcmVjps", "action_id_social": "5qnTnWC8sjkWaqTXEDEEdkLEYreZcnowJPANeXmf9uyG-0-widget", "block_id": 102430325, "block_timestamp": "2023-10-02T06:38:44.631Z", "signer_id": "nearcon23.near", "widget_name": "Ticket.QRCode", "source_code": "const {\n  props: { contractId, secretKey },\n} = props;\n\nconst qrPayload = `https://keypom.xyz/nearcon/${contractId}:${secretKey}`;\n\nconst SVG_CONTENT_TYPE = \"image/svg+xml\";\n\nconst imageToBase64 = (data, type) => {\n  const buff = Buffer.from(data);\n  return `data:${type};base64,` + buff.toString(\"base64\");\n};\n\nconst qrCodeParams = {\n  type: \"svg\",\n  data: qrPayload,\n  dotsOptions: { color: \"#403E3E\", type: \"dots\" },\n  cornersSquareOptions: { type: \"square\" },\n  qrOptions: { errorCorrectionLevel: \"M\" },\n  backgroundOptions: { color: \"#ffffff\" },\n};\n\nconst srcData = `<script type=\"text/javascript\" src=\"https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js\"></script>\n<script type=\"text/javascript\">\nconsole.log(window.location)\nconsole.log(document.URL)\n  const canvas = document.createElement('canvas');\n  const qrCode = new QRCodeStyling(${JSON.stringify(qrCodeParams)});\n  qrCode.append(canvas);\n  const rawSvg = canvas.firstChild.outerHTML\n  window.top.postMessage(rawSvg, \"*\")\n</script>`;\n\nconst svgTemplate = `<?xml version=\"1.0\" standalone=\"yes\"?>\n<svg width=\"400\" height=\"400\" version=\"1.1\" xmlns = 'http://www.w3.org/2000/svg'>\n    <a href=\"${qrPayload}\">\n    <g transform=\"translate(-100,-30)\">\n    <svg x=\"40%\" y=\"50\" width=\"600\" height=\"600\">\n    ${state.qrCodeData}\n    </svg>\n    </g>\n  </a>\n\n</svg>`;\n\nconst mainSvgImage = imageToBase64(svgTemplate, SVG_CONTENT_TYPE);\n\nreturn (\n  <div>\n    <img src={mainSvgImage} />\n    <iframe\n      srcDoc={srcData}\n      onMessage={(data) => State.update({ qrCodeData: data })}\n      style={{ width: 0, height: 0 }}\n    />\n  </div>\n);\n", "metadata": {"platform": "jutsu.ai"}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearcon23.near/widget/Ticket.QRCode", "fact_widget_deployments_id": "7d14d87a4aabfc5891c4c78b9b85df4e", "inserted_timestamp": "2023-10-02T08:27:00.175Z", "modified_timestamp": "2023-10-02T08:27:00.175Z", "__row_index": 2}
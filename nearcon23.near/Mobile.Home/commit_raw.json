{"tx_hash": "GNEQV8HdPQQDFLnYVi5VRwWoFs3xw5SijYDiCorZtqhV", "action_id_social": "DAwhLUTVSg9PdUti8DfedsyKPrPHhgCBze5uXTxDReeX-0-widget", "block_id": 104667147, "block_timestamp": "2023-11-01T06:28:04.600Z", "signer_id": "nearcon23.near", "widget_name": "Mobile.Home", "source_code": "const theme = props.theme;\nconst accountId = props.accountId || context.accountId;\nconst ownerId = \"nearcon23.near\";\nconst [selectedButton, setSelectedButton] = useState(\"profile\");\n\ninitState({});\n\nconst Container = styled.div`\n  height:100%;\n  max-height: 100vh;\n`;\nconst Content = styled.div`\n  height: calc(100dvh - 106px);\n  flex: 1;\n  flex-direction: column;\n  overflow: auto;\n  position: relative;\n`;\n\nconst { secretkey, selectedtab } = props;\n\nconst storedSecretKey = Storage.get(\n  \"newPrivateKey\",\n  `${ownerId}/widget/Ticket.Page`\n)\n  ? Storage.get(\"newPrivateKey\", `${ownerId}/widget/Ticket.Page`)\n  : Storage.get(\"newPrivateKey\", `${ownerId}/widget/RegisterMobile.Index`);\n\nconst fetchData = () => {\n  const key = secretkey ? secretkey : storedSecretKey;\n  asyncFetch(\n    `https://21mqgszhf3.execute-api.us-east-1.amazonaws.com/testnet/api/v1/accounts/auth/${key}`\n  ).then(({ body }) => {\n    if (!key) {\n      State.update({\n        redirectToHome: \"redirect\",\n      });\n    }\n    State.update({\n      userData: body,\n    });\n  });\n};\n\nconst fetchTransaction = () => {\n  if (state?.userData?.nearconId) {\n    const apiURL = `https://21mqgszhf3.execute-api.us-east-1.amazonaws.com/testnet/api/v1/transactions/${state.userData.nearconId}`;\n    asyncFetch(apiURL).then(({ body }) => {\n      State.update({ transactions: body });\n    });\n  }\n};\n\nuseEffect(() => {\n  fetchData();\n  fetchTransaction();\n}, [secretkey, storedSecretKey, state.userData]);\n\nuseEffect(() => {\n  if (selectedtab) {\n    setSelectedButton(selectedtab);\n  }\n}, [selectedtab]);\n\nif (state.redirectToHome === \"redirect\") {\n  return <Redirect to=\"/\" />;\n}\n\nfunction capitalizeFirstLetter(str) {\n  if (!str) return str;\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nreturn (\n  <Container>\n    <Content>\n      <Widget\n        props={{\n          nearconId: state.userData.nearconId,\n          cid: state.userData.cid,\n        }}\n        src={`${ownerId}/widget/Navbar`}\n      />\n      {selectedButton !== \"map\" && (\n        <Widget\n          src={`${ownerId}/widget/Mobile.TitleBar`}\n          props={{\n            label:\n              selectedButton !== \"profile\" &&\n              capitalizeFirstLetter(selectedButton),\n            ...state.userData,\n          }}\n        />\n      )}\n      {selectedButton === \"schedule\" && (\n        <>\n          <Widget src={`${ownerId}/widget/Schedule.Content`} />\n        </>\n      )}\n      {selectedButton === \"alerts\" && (\n        <>\n          <Widget src={`${ownerId}/widget/Mobile.Home.Alerts`} />\n        </>\n      )}\n      {selectedButton === \"profile\" && (\n        <Widget\n          src={`${ownerId}/widget/Mobile.Home.Profile`}\n          props={{ theme, state }}\n        />\n      )}\n      {selectedButton === \"map\" && (\n        <Widget src={`${ownerId}/widget/Map.Page`} props={{ theme }} />\n      )}\n      {selectedButton === \"help\" && (\n        <Widget src={`${ownerId}/widget/Help`} props={{ theme }} />\n      )}\n    </Content>\n    <Widget\n      src={`${ownerId}/widget/Mobile.Navbar`}\n      props={{\n        selectedButton: selectedButton,\n        setSelectedButton: setSelectedButton,\n      }}\n    />\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearcon23.near/widget/Mobile.Home", "fact_widget_deployments_id": "81efb56c452489fa1e2616e235630f1a", "inserted_timestamp": "2023-11-01T08:29:03.667Z", "modified_timestamp": "2023-11-01T08:29:03.667Z", "__row_index": 12}
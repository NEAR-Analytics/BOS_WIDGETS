{"tx_hash": "5xANuEfrsmADoEUBvE1JKCeKjQopqiVBV6MCrWTLTwju", "action_id_social": "FySQEcBvbSLiBTJF9AgDttTH4zzy6aCJJyoNo9jr2ALM-0-widget", "block_id": 105110173, "block_timestamp": "2023-11-07T00:23:10.328Z", "signer_id": "nearcon23.near", "widget_name": "Mobile.Home.Recieve", "source_code": "const ownerId = \"nearcon23.near\";\nconst apiUrl =\n  \"https://gqqkd7l7mk.execute-api.us-east-1.amazonaws.com/mainnet/api/v1\";\n\nconst appUrl = \"https://nearcon.app\";\n\nconst receiverId = props.receiverId || context.receiverId || \"nearcon23.near\";\n\nconst amount = props.amount || context.amount || 0.0;\n\ninitState({ qrCodeData: \"\" });\n\nconst Container = styled.div`\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  height: max(calc(100dvh - 96px), 500px);\n`;\n  // min-height: 500px;\n  // height: 100%;\n  // max-height: calc(100vh - 96px);\n\nconst Content = styled.div`\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  width: 100%;\n  max-width: 700px;\n  overflow: hidden;\n  height: 100%;\n  // min-height: 836px;\n  div {\n    width: 100%;\n  }\n`;\n\nconst H1 = styled.h1`\n  margin-top:40px;\n\n  color: #00EC97;\n  text-align: center;\n  leading-trim: both;\n  text-edge: cap;\n  // font-family: FK Grotesk;\n  font-size: 63px;\n  font-style: normal;\n  font-weight: 500;\n  line-height: 1;\n  letter-spacing: -1.89px;\n`;\n\nconst H4 = styled.h4`\n  color: #FFF;\n  leading-trim: both;\n  text-edge: cap;\n  // font-family: FK Grotesk;\n  font-size: 24px;\n  font-weight: 400;\n  line-height: 160%;\n  letter-spacing: -0.72px;\n`;\nconst SubmitButton = styled.button`\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 0.5em 1.5em;\n  margin-bottom: 20px;\n  gap: 0.5em;\n  background: #161615;\n  border-radius: 50px;\n  border: none;\n  color: #000000;\n  width: 100%;\n  min-height: 48px;\n  background: #00EC97;\n\n  &.disabled {\n    background: #717069 !important;\n  }\n\n  &:hover,\n  &:focus,\n  &:active {\n    background: #161615;\n    text-decoration: none;\n    color: #ffffff;\n  }\n`;\n\nconst { secretkey } = props;\n\nconst storedSecretKey = Storage.get(\n  \"newPrivateKey\",\n  `${ownerId}/widget/Ticket.Page`\n)\n  ? Storage.get(\"newPrivateKey\", `${ownerId}/widget/Ticket.Page`)\n  : Storage.get(\"newPrivateKey\", `${ownerId}/widget/RegisterMobile.Index`);\n\nconst [qrPayload, setQrPayload] = useState(\"\");\n\nconst fetchData = () => {\n  const key = secretkey ? secretkey : storedSecretKey;\n  asyncFetch(`${apiUrl}/accounts/auth/${key}`).then(({ body }) => {\n    console.log(body);\n    if (\n      !!Storage.get(\n        \"newPrivateKey\",\n        `${ownerId}/widget/RegisterMobile.Index`\n      ) === false\n    ) {\n      State.update({\n        redirectToHome: \"redirect\",\n      });\n    }\n    State.update({\n      userData: body,\n    });\n\n    setQrPayload(\n      `${appUrl}/${ownerId}/widget/Mobile.Home.Send?receiverId=${body?.nearconId}`\n    );\n  });\n};\n\nuseEffect(() => {\n  fetchData();\n}, [secretkey, storedSecretKey]);\n\nconst SVG_CONTENT_TYPE = \"image/svg+xml\";\n\nconst imageToBase64 = (data, type) => {\n  const buff = Buffer.from(data);\n  return `data:${type};base64,` + buff.toString(\"base64\");\n};\n\nconst srcData = `\n<html>\n<body>\n  <div id=\"qrcode\" style=\"display:flex; justify-content:center;\"></div>\n  <script src=\"https://cdn.jsdelivr.net/npm/easyqrcodejs@4.5.0/dist/easy.qrcode.min.js\"></script>\n  <script type=\"text/javascript\">\n    new QRCode(document.getElementById(\"qrcode\"), {\n    text: \"${qrPayload}\",\n    width: 290,\n    height: 290,\n    colorDark: \"#000000\",\n    colorLight: \"#ffffff\",\n    correctLevel: QRCode.CorrectLevel.H, // L, M, Q, H\n\n    // backgroundImage: \"https://nearpad-images.s3.amazonaws.com/nearcon_small.png\",\n    logo: \"https://nearpad-images.s3.amazonaws.com/nearcon_small.png\",\n    logoBackgroundTransparent: true,\n    logoWidth: 150, \n    logoHeight: 150,\n    \n    dotScale: .6,\n    dotScaleTiming: .6,\n    dotScaleA:.6,\n  });\n   </script> \n</body>\n</html>\n`;\n\nconst trimName = (nearconId) => {\n  let name = (nearconId || \"\")?.replace(\".nearcon23.near\", \"\");\n\n  if (name.length > 12) {\n    name = name.substring(0, 15) + \"...\";\n  }\n\n  return \"@\" + name;\n};\n\nreturn (\n  <>\n    <Widget\n      props={{\n        nearconId: state?.userData?.nearconId || props?.userData?.nearconId,\n        cid: state?.userData?.cid,\n      }}\n      src={`${ownerId}/widget/Navbar`}\n    />\n    <Container>\n      <Content>\n\n        <div\n          style={{\n            flex: 1,\n            zIndex: 3,\n            display: \"flex\",\n            flexDirection: \"column\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n\n            margin: 20,\n            width: \"calc(100% - 40px)\",\n          }}\n        >\n          <div style={{ textAlign: \"center\" }}>\n            <p style={{ fontSize: 20 }}>\n              <span style={{ color: \"gray\" }}>Receive</span>{\" \"}\n              <span style={{ fontWeight: 600 }}>NCON</span>\n            </p>\n            {/*{!!state?.userData?.nearconId && (\n          <p\n            style={{\n              fontFamily: \"FK Grotesk\",\n            }}\n          >{`@saidulbadhon.near${state?.userData?.nearconId}`}</p>\n          )}*/}\n\n            {!!state?.userData?.nearconId && (\n              <p\n                style={{\n                  fontFamily: \"FK Grotesk\",\n                }}\n              >\n                {trimName(state?.userData?.nearconId)}\n                <span\n                  style={{\n                    fontWeight: 400,\n                    marginLeft: -4,\n                    color: \"#868682\",\n                  }}\n                >\n                  .nearcon23.near\n                </span>\n              </p>\n            )}\n\n            <div style={{ width: \"fit-content\", margin: \"auto\" }}>\n              <iframe\n                srcDoc={srcData}\n                onMessage={(data) => {\n                  console.log(data);\n                  State.update({ qrCodeData: data });\n                }}\n                style={{\n                  width: 340,\n                  height: 350,\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                  alignItems: \"center\",\n                }}\n              />\n            </div>\n          </div>\n          <a style={{ width: \"100%\" }} href={`/mobile`}>\n            <SubmitButton>Home</SubmitButton>\n          </a>\n        </div>\n      </Content>\n    </Container>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearcon23.near/widget/Mobile.Home.Recieve", "fact_widget_deployments_id": "fe9888fe4b56a0b35b8d1e0a4d642233", "inserted_timestamp": "2024-03-07T05:24:05.087Z", "modified_timestamp": "2024-03-07T05:24:05.087Z", "__row_index": 0}